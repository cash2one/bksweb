var wijmo;!function(t){t.expando=".wijmo";var e=function(){function t(t){this.message=t,this.stack="Wijmo"+(new Error).stack,this.name="WijmoError"}return t}();t.WijmoError=e;var i=e;i.prototype=new Error,i.prototype.constructor=i}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){var i=function(){function e(t){this.object=t}return e.getFrom=function(i,n){"undefined"==typeof n&&(n=!0);var o=t.expando,r;if(Object(i)!==i)return null;if(r=i[o],r&&r.object!==i&&(r=null),n&&!(r instanceof e&&Object.prototype.hasOwnProperty.call(i,o))){r=new e(i);try{Object.defineProperty(i,o,{value:r,configurable:!1,enumerable:!1,writable:!1})}catch(s){i[o]=r}}return r},e}();e.Expando=i}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){!function(t){function e(t){return function(){var e=function(){return t.prototype._call.apply(e,arguments)};return $.extend(e,t.prototype),t.apply(e,arguments),e}}t.funcClass=e}(t.util||(t.util={}));var e=t.util}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){function e(t){return r.isFunction(t.subscribe)}function i(t){return"undefined"==typeof t&&(t=null),new u(t)}function n(t){return"undefined"==typeof t&&(t=null),new u(t,!0)}function o(t){return r.isFunction(t)&&e(t)}var r=jQuery,s=function(){function t(t,e){this.handler=t,this.context=e}return t.prototype.trigger=function(t){return this.handler.apply(this.context,t)},t}();t.SubscriberEntry=s;var a=function(){function e(t){this.defaultContext=t,this._entries=[]}return e.prototype.subscribe=function(e,i){"undefined"==typeof i&&(i=this.defaultContext);var n=this,o=new s(e,i);return this._entries.push(o),{dispose:function(){return t.util.remove(n._entries,o)}}},e.prototype.trigger=function(){for(var e=[],i=0;i<arguments.length-0;i++)e[i]=arguments[i+0];t.util.each(this._entries,function(t,i){return i.trigger(e)})},e.makeSubscribable=function(t){var i=new e(t);return t.subscribe=r.proxy(i.subscribe,i),i},e}();t.Subscribable=a,t.isSubscriptable=e;var l=function(){function t(){}return t.prototype.subscribe=function(t,e){return this._subscribable=this._subscribable||new a(this),this._subscribable.subscribe(t,e)},t.prototype._trigger=function(){for(var t=[],e=0;e<arguments.length-0;e++)t[e]=arguments[e+0];this._subscribable&&this._subscribable.trigger.apply(this._subscribable,arguments)},t}();t.BaseObservable=l;var h=function(t){function e(e){t.call(this),this.mutable=e}return __extends(e,t),e.prototype._call=function(){return this.mutable.value},e}(l);t._ReadOnlyObservable=h;var d=t.util.funcClass(h),c=function(t){function e(e,i){"undefined"==typeof i&&(i=!1),t.call(this),this.value=e,this.checkNewValue=i}return __extends(e,t),e.prototype._call=function(t){return arguments.length>0&&(!this.checkNewValue||t!==this.value)&&(this.value=t,this._trigger(t),this._readOnly&&this._readOnly._trigger(t)),this.value},e.prototype.read=function(){return this._readOnly=this._readOnly||new d(this),this._readOnly},e}(l);t._MutableObservable=c;var u=t.util.funcClass(c);t.observable=i,t.observableWithNewValueCheck=n,t.isObservable=o}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){!function(i){function n(t,e){return"undefined"==typeof e&&(e=!1),b.isArray(t)?t=t.slice(0):b.isPlainObject(t)&&(t=b.extend(!!e,{},t)),t}function o(t){return"string"==typeof t||t instanceof String}function r(t){return"number"==typeof t}function s(e){return e===t.expando||e===b.expando}function a(t,e){var i=this;b.each(t,function(t,n){return s(t)?void 0:e.call(i,t,n)})}function l(e,i){var n=b.map(e,i);return delete n[t.expando],n}function h(t){var e;return e=t&&b.isFunction(t.toString)&&t.toString!==Object.prototype.toString?t.toString():JSON.stringify(t),null!=e&&e.length>2&&'"'===e[0]&&'"'===e[e.length-1]&&(e=e.substr(1,e.length-2)),e}function d(t){for(var e=[],i=0;i<arguments.length-1;i++)e[i]=arguments[i+1];return t.replace(/{(\d+)}/g,function(t,i){return h(e[parseInt(i,10)])})}function c(t,e){var i=!0;return a(t,function(t,n){return i=n,e&&(i=e.call(i,i,t)),i?void 0:!1}),i}function u(t,e){var i=!1;return a(t,function(t,n){return i=n,e&&(i=e.call(i,i,t)),i?!1:void 0}),i}function p(t,e){var i,n,r;if(null==t)return null==e?0:-1;if(null==e)return 1;if(b.isArray(t)&&b.isArray(e)){for(n=Math.min(t.length,e.length),i=0;n>i;i++)if(r=p(t[i],e[i]),0!==r)return r;return t.length-e.length}return o(t)&&o(e)?(t=t.toLowerCase(),e=e.toLowerCase(),e>t?-1:t>e?1:0):(r=t-e,isNaN(r)?0:r)}function g(t,e){return b.inArray(e,t)>=0}function f(t,e){var i=0,n;for(n=0;n<t.length;)t[n]!==e?n++:(t.splice(n,1),i++);return i}function m(t,e){return-1==t?-1:0==t?0:e?Math.ceil(t/e):1}function w(t,e){function i(){return t.apply(e,n)}for(var n=[],o=0;o<arguments.length-2;o++)n[o]=arguments[o+2];return"undefined"==typeof setTimeout?i():void setTimeout(i,10)}function y(t){"undefined"!=typeof console&&(console.error?console.error(t):console.log&&console.log(t))}function v(t,i){for(var n=0,o=t,r;;){var s=i.indexOf(".",n);if(s>=0?(r=i.substring(n,s),n=s+1):r=n>0?i.substring(n):i,o=o[r],e.isObservable(o)&&(o=o()),0>s)break}return o}function _(t,i,n){for(var o=0,r;;){var s=i.indexOf(".",o);s>=0?(r=i.substring(o,s),o=s+1):r=o>0?i.substring(o):i;var a=t[r];if(!(s>=0)){e.isObservable(a)?a(n):t[r]=n;break}e.isObservable(a)&&(a=a()),t=a}}function S(t){return"object"==typeof t&&!b.isArray(t)&&!b.isPlainObject(t)&&t.constructor!==Object.prototype.constructor}function x(t){e.util.each(t,function(t,i){i&&"object"==typeof i&&e.util.each(i,function(t,n){var o;e.util.isString(n)&&(o=/\/Date\((-?\d+)\)\//.exec(n),o&&(i[t]=new Date(parseInt(o[1],10))))})})}var b=jQuery;i.clone=n,i.isString=o,i.isNumeric=r,i.isInternalProperty=s,i.each=a,i.map=l,i.toStr=h,i.format=d,i.every=c,i.some=u,i.compare=p,i.contains=g,i.remove=f,i.pageCount=m,i.executeDelayed=w,i.logError=y,i.getProperty=v,i.setProperty=_,i.isClassInstance=S,i.convertDateProperties=x;var C=function(){function t(t){this.key=t}return t}();i.HashMapEntry=C;var D=function(){function t(){this.hash={}}return t.prototype.getEntry=function(t,e){if("undefined"==typeof e&&(e=!1),null===t)return!this.nullEntry&&e&&(this.nullEntry=new C(t)),this.nullEntry;var i=String(t),n=this.hash[i],o;if(null==n){if(!e)return null;n=[],this.hash[i]=n}for(var r=0;r<n.length;r++)if(n[r].key===t)return n[r];return e&&(o=new C(t),n.push(o)),null},t.prototype.containsKey=function(t){return!!this.getEntry(t)},t.prototype.get=function(t,e){"undefined"==typeof e&&(e=null);var i=this.getEntry(t);return i?i.value:e},t.prototype.put=function(t,e){this.getEntry(t,!0).value=e},t}();i.HashMap=D}(e.util||(e.util={}));var i=e.util}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){e.errors={},e.errors._register=function(i){e.util.each(i,function(i,n){function o(){for(var i=[],o=0;o<arguments.length-0;o++)i[o]=arguments[o+0];var r;return $.isFunction(n)?n=n.apply(this,arguments):arguments.length>0&&(i.unshift(n),n=e.util.format.apply(this,i)),n=$.trim(n),r=n[n.length-1],"."!==r&&"!"!==r&&"?"!==r&&(n+="."),new t.WijmoError(n)}e.errors[i]=function(){throw o.apply(this,arguments)},e.errors[i].create=o})},e.errors._register({indexOutOfBounds:"Index is outside the bounds of the array.",notImplemented:"The operation is not implemented",unsupportedOperation:"Unsupported operation",unsupportedFilterOperator:"Unsupported filter operator: {0}",unsupportedDataSource:"Unsupported data source",argument:function(t){var e="Unexpected argument value.";return t&&(e+="\nParameter name: "+t),e},argumentNull:"Argument '{0}' is null/undefined",noParser:"There is no parser for type '{0}'",noUrl:"Url is not specified",cantConvert:"Value can't be converted to type '{0}': '{1}'",noGlobalize:"Globalize is not defined. Make sure you include globalize.js",itemNotInView:"Item {0} is not in the data view",unsupportedFilterFormat:"The filter format is not supported",multiPropertyKeysNotSupported:"Entities with multiple properties in the primary key are not supported. Entity type: {0}",keyPropertyNotFound:"Key property not found in {0} entity type"})}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){!function(e){function i(i,n){"undefined"==typeof n&&(n=!1),i=i.toLowerCase();var o=e.ops[i];if(!o){var r=e.opMap[i];r&&(o=e.ops[r])}return!o&&n&&t.errors.unsupportedFilterOperator(i),o}function n(n){var o;if(!r.isPlainObject(n))return{operator:"==",op:e.ops.equals,value:n};var s=n.operator||e.ops.equals;if(t.util.isString(n.operator)){if("nofilter"===n.operator.toLowerCase())return null;s=i(n.operator,!0)}else r.isFunction(s.apply)||t.errors.unsupportedFilterOperator(s);return{operator:n.operator,op:s,value:n.value}}function o(e){var i={isEmpty:!1,original:e,func:null,normalized:null};if(r.isFunction(e))i.func=e;else if(r.isArray(e))t.errors.unsupportedFilterFormat(e);else if(e){i.normalized={};var o=!1;t.util.each(e,function(e,s){r.isArray(s)&&t.errors.unsupportedFilterFormat(),s=n(s),s&&(i.normalized[e]=s,o=!0)}),o?i.func=function(e){return t.util.every(i.normalized,function(i,n){var o=t.util.getProperty(e,n);return i.op.apply(o,i.value)})}:i.normalized=null}return!i.normalized&&!i.func&&(i.isEmpty=!0,i.func=function(t){return!0}),i}var r=jQuery;e.opMap={"==":"equals",doesnotcontain:"notcontain","!=":"notequal",">":"greater","<":"less",">=":"greaterorequal","<=":"lessorequal",isnotempty:"notisempty",isnotnull:"notisnull"},e.normalizeCondition=n,e.compile=o,e.ops=function(){function e(t,e,i,n,o){return a[t.toLowerCase()]={name:t,displayName:e,arity:i,applicableTo:n,apply:o}}function i(e){return e instanceof Date&&(e=e.getTime()),t.util.isString(e)&&(e=e.toLowerCase()),e}function n(t,n,o,r){e(t,n,2,o,function(t,e){return r(i(t),i(e))})}function o(t,i,n,o){e(t,i,1,n,o)}function r(t,e,i){n(t,e,l.prim,i)}function s(t,e,i){n(t,e,l.str,i)}var a={},l={str:["string"],prim:["string","number","datetime","currency","boolean"]};return r("Equals","Equals",function(t,e){return t==e}),r("NotEqual","Not equal",function(t,e){return t!=e}),r("Greater","Greater than",function(t,e){return t>e}),r("Less","Less than",function(t,e){return e>t}),r("GreaterOrEqual","Greater or equal",function(t,e){return t>=e}),r("LessOrEqual","Less or equal",function(t,e){return e>=t}),s("Contains","Contains",function(t,e){return t==e||t&&t.indexOf&&t.indexOf(e)>=0}),s("NotContain","Does not contain",function(t,e){return t!=e&&(!t||!t.indexOf||t.indexOf(e)<0)}),s("BeginsWith","Begins with",function(t,e){return t==e||t&&t.indexOf&&0==t.indexOf(e)}),s("EndsWith","Ends with",function(e,i){var n;return t.util.isString(e)&&t.util.isString(i)?(n=e.lastIndexOf(i),n>=0&&e.length-n===i.length):!1}),o("IsEmpty","Is empty",l.str,function(t){return!t&&0!==t&&t!==!1}),o("NotIsEmpty","Is not empty",l.str,function(t){return!!t||0===t||t===!1}),o("IsNull","Is null",l.prim,function(t){return null==t}),o("NotIsNull","Is not null",l.prim,function(t){return null!=t}),a}()}(t.filtering||(t.filtering={}));var e=t.filtering}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){!function(e){function i(e){var i=[];return e=t.util.isString(e)?e.split(/,\s*/):$.isArray(e)?e.slice(0):[e],e=$.isArray(e)?e.slice(0):[e],t.util.each(e,function(e,n){var o=!0,r;if(null!=n){if(!t.util.isString(n))return void(null!=n.property&&i.push(n));if("-"===n[0])o=!1,n=n.substr(1);else{var s=/\s(asc|desc)\s*$/.exec(n);s&&(n=n.substr(0,s.index),o="desc"!==s[1])}i.push({property:n,asc:o})}}),i.length>0?i:null}function n(e,n){"undefined"==typeof n&&(n=t.util.compare);var o=i(e),r={isEmpty:!0,original:e,propertyCompareTo:n,compare:null,normalized:o};return null!=o&&(r.isEmpty=!1,r.compare=function(e,i){var r=0,s,a;for(r=0;r<o.length;r++)if(a=o[r],s=n(t.util.getProperty(e,a.property),t.util.getProperty(i,a.property)),0!==s)return a.asc||(s=-s),s;return 0}),r}e.compile=n}(t.sorting||(t.sorting={}));var e=t.sorting}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){function e(e){return o.isFunction(e)||t.errors.argument("factory"),r.push(e),{dispose:function(){t.util.remove(r,e)}}}function i(e){if(n(e))return e;var i=t.util.some(r,function(t){return t(e)});return i||t.errors.unsupportedDataSource()}function n(t){return t&&o.isFunction(t.count)&&o.isFunction(t.item)&&o.isFunction(t.getProperty)}var o=jQuery,r=[];t.registerDataViewFactory=e,e(function(t){return n(t)&&t}),e(function(e){return o.isArray(e)&&new t.ArrayDataView(e)}),t.asDataView=i,t.isDataView=n}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){var e=jQuery,i=function(){function i(i){function n(t){return function(){if(!o){o=!0;try{t.apply(this,arguments)}finally{o=!1}}}}this.array=i,this.currentItem=t.observableWithNewValueCheck(null),this.currentPosition=t.observableWithNewValueCheck(-1);var o=!1;this.currentItem.subscribe(n(function(t){this.currentPosition(null==t?-1:e.inArray(t,this.array))}),this),this.currentPosition.subscribe(n(function(e){t.util.isNumeric(e)||t.errors.argument("value"),(-1>e||e>=this.array.length)&&t.errors.indexOutOfBounds(),this.currentItem(0>e?null:this.array[e])}),this)}return i.prototype.update=function(){var t=this.currentItem(),i=this.currentPosition(),n=e.inArray(t,this.array);0>n&&null==t&&null!=this._recentlyRemovedItem&&(n=e.inArray(this._recentlyRemovedItem,this.array)),n>=0?(t&&(this._recentlyRemovedItem=t),this.currentPosition(n)):i>=0&&i<this.array.length?this.currentItem(this.array[i]):i==this.array.length&&this.array.length>0?(i=this.array.length-1,this.currentPosition(i),this.currentItem(this.array[i])):(this.currentPosition(-1),this.currentItem(null))},i.prototype.updateDelayed=function(){t.util.executeDelayed(this.update,this)},i}();t.CurrencyManager=i}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){var e=jQuery,i=function(){function e(e){function i(){this.pageSize()>0&&this.pageIndex()>=0?(this._skip=this.pageSize()*this.pageIndex(),this._take=this.pageSize()):(this._skip=0,this._take=-1),e(!0)}this.onChanged=e,this.filter=t.observable(),this._compiledFilter=t.filtering.compile(null),this.sort=t.observable(),this._compiledSort=t.sorting.compile(null),this.pageIndex=t.observable(0),this.pageSize=t.observable(0),this._skip=0,this._take=-1,this.filter.subscribe(function(t){this.onFilterChanged(t),e()},this),this.sort.subscribe(function(){this._compiledSort=t.sorting.compile(this.sort()),e()},this),this.pageIndex.subscribe(i,this),this.pageSize.subscribe(i,this)}return e.prototype.onFilterChanged=function(e){this._compiledFilter=t.filtering.compile(e)},e.prototype.setFilter=function(t){this.filter(t)},e.prototype.update=function(t){"filter"in t&&this.setFilter(t.filter),"sort"in t&&this.sort(t.sort),"pageSize"in t&&this.pageSize(t.pageSize),"pageIndex"in t&&this.pageIndex(t.pageIndex)},e.prototype.apply=function(t,e,i){"undefined"==typeof e&&(e=!0),"undefined"==typeof i&&(i=null);var n;if(this._compiledFilter.isEmpty)if(i)for(i.length=t.length,n=0;n<t.length;n++)i[n]=t[n];else i=t.slice(0);else for(i?i.length=0:i=[],n=0;n<t.length;n++){var o=t[n];this._compiledFilter.func(o)&&i.push(o)}this._compiledSort.isEmpty||i.sort(this._compiledSort.compare);var r=i.length;return e&&this._take>0&&(this._skip>0&&i.splice(0,Math.min(this._skip,i.length)),this._take<i.length&&(i.length=this._take)),{results:i,totalCount:r}},e.prototype.toObj=function(){return{filter:this._compiledFilter.normalized,sort:this._compiledSort.normalized,pageSize:this.pageSize(),pageIndex:this.pageIndex()}},e}();t.Shape=i;var n=function(){function n(e){this.isRemote=!1,this.localPaging=!0,this.local=[],this._updatingShape=!1,this._pageCount=t.observable(1),this._totalItemCount=t.observable(0),this._isLoaded=t.observable(!1),this._isLoading=t.observable(!1),this._currentEditItem=t.observable(),this._isCurrentEditItemNew=!1,this._currentEditItemSnapshot=null,this.isLoading=this._isLoading.read(),this.isLoaded=this._isLoaded.read(),this._changed=new t.Subscribable(this),this.currentEditItem=this._currentEditItem.read(),this._initCurrency(),this._initShape(e)}return n.prototype.dispose=function(){},n.prototype.count=function(){return this.local.length},n.prototype.item=function(e){return(0>e||e>=this.local.length)&&t.errors.indexOutOfBounds(),this.local[e]},n.prototype.indexOf=function(t){return e.inArray(t,this.local)},n.prototype.getSource=function(){return this.sourceArray},n.prototype.toObservableArray=function(){return this._koArray||(this._koArray=ko.observableArray(this.local)),this._koArray},n._getProps=function(i){var n=[];return t.util.each(i,function(t,i){t=String(t),t.match(/^_/)||(!e.isFunction(i)||i.subscribe)&&n.push({name:t})}),n},n.prototype.getProperties=function(){return this.count()?n._getProps(this.item(0)):[]},n.prototype._readProperty=function(e,i){return t.util.getProperty(e,i)},n.prototype.getProperty=function(t,e){var i=this._getItem(t);return this._readProperty(i,e)},n.prototype._writeProperty=function(e,i,n){t.util.setProperty(e,i,n)},n.prototype.setProperty=function(t,e,i){var n=this._getItem(t);return n===this.currentEditItem()&&this._currentEditItemSnapshot&&!(e in this._currentEditItemSnapshot)&&(this._currentEditItemSnapshot[e]=this.getProperty(t,e)),this._writeProperty(n,e,i),this},n.prototype.subscribe=function(t,e){return this._changed.subscribe(t,e)},n.prototype.trigger=function(){this._currencyManager.update(),this._changed.trigger(this.local),this._koArray&&this._koArray.notifySubscribers(this.local)},n.prototype.canFilter=function(){return!0},n.prototype.canSort=function(){return!0},n.prototype._updateShape=function(t){this._updatingShape=!0;try{this._shape.update(t)}finally{this._updatingShape=!1}},n.prototype.prevPage=function(){return this.pageIndex()<1?!1:(this.pageIndex(this.pageIndex()-1),!0)},n.prototype.nextPage=function(){return this.pageCount()>0&&this.pageIndex()+1>=this.pageCount()?!1:(this.pageIndex(this.pageIndex()+1),!0)},n.prototype._createShape=function(t){return new i(t)},n.prototype._initShape=function(t){var e=this,i=function(t){"undefined"==typeof t&&(t=!1),e._updatingShape||e.refresh(null,t&&e.localPaging)};this._shape=this._createShape(i),t&&this._updateShape(t),this.filter=this._shape.filter,this.sort=this._shape.sort,this.pageIndex=this._shape.pageIndex,this.pageSize=this._shape.pageSize,this.pageCount=this._pageCount.read(),this.totalItemCount=this._totalItemCount.read()},n.prototype._localRefresh=function(i){"undefined"==typeof i&&(i=this.localPaging);var n=this._shape.apply(this.sourceArray,i,this.local);return i&&this._totalItemCount(n.totalCount),this._pageCount(t.util.pageCount(this.totalItemCount(),this.pageSize())),this.trigger(),e.Deferred().resolve().promise()},n.prototype._remoteRefresh=function(){return this._localRefresh()},n.prototype.refresh=function(t,e){"undefined"==typeof e&&(e=!1);var i=this;this.cancelRefresh(),t&&this._updateShape(t),this._isLoading(!0);var n=e?this._localRefresh():this._remoteRefresh();return n.then(function(){i._isLoaded(!0),i._isLoading(!1)})},n.prototype.cancelRefresh=function(){},n.prototype._initCurrency=function(){this._currencyManager=new t.CurrencyManager(this.local),this.currentItem=this._currencyManager.currentItem,this.currentPosition=this._currencyManager.currentPosition},n.prototype.isCurrentEditItemNew=function(){return this._isCurrentEditItemNew},n.prototype._beginEdit=function(t,e){this.commitEdit(),this._currentEditItemSnapshot={},this._isCurrentEditItemNew=e,this._currentEditItem(t)},n.prototype.canAdd=function(){return!0},n.prototype.add=function(e){e||t.errors.argument("item"),this.commitEdit(),this.local.push(e),this._beginEdit(e,!0),this.trigger()},n.prototype.canAddNew=function(){return!1},n.prototype.addNew=function(){return t.errors.unsupportedOperation()},n.prototype.editItem=function(t){"undefined"==typeof t&&(t=this.currentItem()),this.commitEdit(),t=this._getItem(t),t&&this._beginEdit(t,!1)},n.prototype.canRemove=function(){return!0},n.prototype._remove=function(e){this.local.splice(e.index,1),t.util.remove(this.sourceArray,e.item),this.trigger()},n.prototype.remove=function(t){"undefined"==typeof t&&(t=this.currentItem()),this.commitEdit();var e=this._resolve(t);return e?(this._remove(e),!0):!1},n.prototype.canCancelEdit=function(){return!0},n.prototype.cancelEdit=function(){var i=this,n;if(this.currentEditItem()){var o=this.currentEditItem();this._currentEditItem(null),this._isCurrentEditItemNew?t.util.remove(this.local,this.item):this._currentEditItemSnapshot&&e.each(this._currentEditItemSnapshot,function(t,e){return i._writeProperty(o,t,e)}),this.trigger()}},n.prototype.canCommitEdit=function(){return!0},n.prototype.commitEdit=function(){if(this.currentEditItem()){var e=this.currentEditItem();this._currentEditItem(null),this._isCurrentEditItemNew&&this.sourceArray.push(e);var i=this._shape._compiledFilter;!i.isEmpty&&!i.func(e)&&t.util.remove(this.local,e),this.trigger()}},n.prototype._getItem=function(e){var i;return t.util.isNumeric(e)?this.item(e):e},n.prototype._resolve=function(e,i){"undefined"==typeof i&&(i=!1);var n;return t.util.isNumeric(e)?{index:e,item:this.item(e)}:(n=this.indexOf(e),0>n?(i&&t.errors.itemNotInView(e),null):{index:n,item:e})},n}();t.ArrayDataViewBase=n;var o=function(t){function e(e,i){t.call(this,i),this.sourceArray=e,this.refresh()}return __extends(e,t),e}(n);t.ArrayDataView=o}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){var e=jQuery,i=function(t){function i(e){t.call(this),this.isRemote=!0,this.sourceArray=[],e&&this._construct(e)}return __extends(i,t),i.prototype._construct=function(t){this.options=t=e.extend({localPaging:!1},t),this.localPaging=t.localPaging,this._updateShape(t)},i}(t.ArrayDataViewBase);t.RemoteDataView=i}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=jQuery,i=function(){function t(t){this._originalReader=t}return t.prototype.read=function(t){if(t.items=null,this._originalReader&&e.isFunction(this._originalReader.read)&&this._originalReader.read(t),e.isArray(t.items)||(e.isArray(t.data)?t.items=t.data:t.data&&e.isArray(t.data.rows)?t.items=t.data.rows:t.items=[]),t.dynamic&&(!t.data||isNaN(t.data.totalRows)))throw"totalRows value is missing"},t}(),n=function(n){function o(t){var o=this;n.call(this),this.dataSource=t,this.isRemote=!0,this.localPaging=!0,this._origLoaded=t.loaded,this._origReader=t.reader,t.loaded=function(t,i){o._loaded(),e.isFunction(o._origLoaded)&&o._origLoaded.apply(o,arguments)},t.reader=new i(t.reader);var r=t.items&&t.items.length>0;e.isArray(t.data)&&!r&&t.read(),t.items&&this._loaded()}return __extends(o,n),o.prototype.dispose=function(){this.dataSource.loaded=this._origLoaded,this.dataSource.reader=this._origReader,n.prototype.dispose.call(this)},o.prototype.getProperties=function(){return this.sourceArray&&this.sourceArray.length?t.ArrayDataViewBase._getProps(this.sourceArray[0]):[]},o.prototype._loaded=function(){this.sourceArray=this.dataSource.items,this.dataSource.data&&t.util.isNumeric(this.dataSource.data.totalRows)&&this._totalItemCount(this.dataSource.data.totalRows);var e=n.prototype._localRefresh.call(this,!this.dataSource.dynamic);this._currentDeferred&&e.then(this._currentDeferred.resolve)},o.prototype._remoteRefresh=function(){this._currentDeferred&&"pending"===this._currentDeferred.state()&&this._currentDeferred.fail(),this._currentDeferred=e.Deferred();var t={},i=!1;return this.dataSource.dynamic&&(i=!0,t.data=this._prepareRequest(),this.dataSource.proxy&&(this._origDataOption||(this._origDataOption=e.extend({},this.dataSource.proxy.options.data)),this.dataSource.proxy.options.data=e.extend({},this._origDataOption,t.data))),this.dataSource.load(t,i),this._currentDeferred},o.prototype._prepareRequest=function(){return{filtering:this._prepareFilterRequest(),paging:this._preparePageRequest(),sorting:this._prepareSortRequest()}},o.prototype._prepareFilterRequest=function(){var t=[];return!this._shape._compiledFilter.isEmpty&&this._shape._compiledFilter.normalized&&e.each(this._shape._compiledFilter.normalized,function(e,i){t.push({dataKey:e,filterOperator:i.op.Name,filterValue:i.value})}),t},o.prototype._preparePageRequest=function(){return{pageIndex:this._shape.pageIndex(),pageSize:this._shape.pageSize()}},o.prototype._prepareSortRequest=function(){return this._shape._compiledSort.isEmpty||!this._shape._compiledSort.normalized||0==this._shape._compiledSort.normalized.length?[]:e.map(this._shape._compiledSort.normalized,function(t){return{dataKey:t.property,sortDirection:t.asc?"ascending":"descending"}})},o}(t.ArrayDataViewBase);t.registerDataViewFactory(function(t){return"function"==typeof wijdatasource&&t instanceof wijdatasource?new n(t):void 0})}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),this.element.addClass(this.options.wijCSS.widget+" wijmo-wijpager "+this.options.wijCSS.helperClearFix),this.options.disabled&&this.disable(),this._refresh()},e.prototype._destroy=function(){this.element.removeClass(this.options.wijCSS.widget+" wijmo-wijpager "+this.options.wijCSS.helperClearFix),this.$ul.remove()},e.prototype._setOption=function(t,e){this._super(t,e),this._refresh()},e.prototype._refresh=function(){switch(this._validate(),this.$ul&&this.$ul.remove(),this.element.append(this.$ul=i('<ul class="ui-list '+this.options.wijCSS.cornerAll+" "+this.options.wijCSS.content+" "+this.options.wijCSS.helperClearFix+'" role="tablist"></ul>')),(this.options.mode||"").toLowerCase()){case"nextprevious":this._createNextPrev(!1);break;case"nextpreviousfirstlast":this._createNextPrev(!0);break;case"numeric":this._createNumeric(!1);break;case"numericfirstlast":this._createNumeric(!0)}},e.prototype._validate=function(){var t=this.options;(isNaN(t.pageCount)||t.pageCount<1)&&(t.pageCount=1),isNaN(t.pageIndex)||t.pageIndex<0?t.pageIndex=0:t.pageIndex>=t.pageCount&&(t.pageIndex=t.pageCount-1),(isNaN(t.pageButtonCount)||t.pageButtonCount<1)&&(t.pageButtonCount=1)},e.prototype._createNextPrev=function(t){var e=this.options;t&&e.pageIndex&&this.$ul.append(this._createPagerItem(!1,e.firstPageText,1,e.firstPageClass)),e.pageIndex&&this.$ul.append(this._createPagerItem(!1,e.previousPageText,e.pageIndex,e.previousPageClass)),e.pageIndex+1<e.pageCount&&this.$ul.append(this._createPagerItem(!1,e.nextPageText,e.pageIndex+2,e.nextPageClass)),t&&e.pageIndex+1<e.pageCount&&this.$ul.append(this._createPagerItem(!1,e.lastPageText,e.pageCount,e.lastPageClass))},e.prototype._createNumeric=function(t){var e=this.options,i=e.pageIndex+1,n=1,o=Math.min(e.pageCount,e.pageButtonCount),r;for(i>o&&(n=Math.floor(e.pageIndex/e.pageButtonCount)*e.pageButtonCount+1,o=n+e.pageButtonCount-1,o=Math.min(o,e.pageCount),o-n+1<e.pageButtonCount&&(n=Math.max(1,o-e.pageButtonCount+1))),1!==n&&(t&&this.$ul.append(this._createPagerItem(!1,e.firstPageText,1,e.firstPageClass)),this.$ul.append(this._createPagerItem(!1,"...",n-1,""))),r=n;o>=r;r++)this.$ul.append(this._createPagerItem(r===i,r.toString(),r,""));e.pageCount>o&&(this.$ul.append(this._createPagerItem(!1,"...",o+1,"")),t&&this.$ul.append(this._createPagerItem(!1,e.lastPageText,e.pageCount,e.lastPageClass)))},e.prototype._createPagerItem=function(t,e,n,o){var r,s=this.options.wijCSS,a=this,l=i("<li />").addClass(s.pagerButton+" "+s.cornerAll).attr({role:"tab","aria-label":e,title:e});return t?l.addClass(s.stateActive).attr("aria-selected","true"):l.addClass(s.stateDefault).hover(function(){a.options.disabled||i(this).addClass(s.stateHover)},function(){a.options.disabled||i(this).removeClass(s.stateHover)}).bind("click."+this.widgetName,{newPageIndex:n-1},i.proxy(this._onClick,this)),r=t?i("<span />"):o?i("<span />").addClass(s.icon+" "+o):i("<a/>").attr("href","#"),r.text(e),l.append(r),l},e.prototype._onClick=function(t){if(this.options.disabled)return!1;var e={newPageIndex:t.data.newPageIndex,handled:!1};if(this._trigger("pageIndexChanging",null,e)!==!1&&this.options.pageIndex!==e.newPageIndex){this.options.pageIndex=e.newPageIndex,e.handled||this._refresh();var i={newPageIndex:e.newPageIndex};this._trigger("pageIndexChanged",null,i)}return!1},e}(t.wijmoWidget);e.wijpager=n,n.prototype.widgetEventPrefix="wijpager";var o=function(){function t(){this.wijCSS={pagerButton:"wijmo-wijpager-button"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-c"},this.firstPageClass=i.wijmo.widget.prototype.options.wijCSS.iconSeekFirst,this.firstPageText="First",this.lastPageClass=i.wijmo.widget.prototype.options.wijCSS.iconSeekEnd,this.lastPageText="Last",this.mode="numeric",this.nextPageClass=i.wijmo.widget.prototype.options.wijCSS.iconSeekNext,this.nextPageText="Next",this.pageButtonCount=10,this.previousPageClass=i.wijmo.widget.prototype.options.wijCSS.iconSeekPrev,this.previousPageText="Previous",this.pageCount=1,this.pageIndex=0,this.pageIndexChanging=null,this.pageIndexChanged=null}return t}();n.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new o),i.wijmo.registerWidget("wijpager",n.prototype)}(t.pager||(t.pager={}));var e=t.pager}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){"use strict";var e=jQuery,i,n,o;i=function(t){var e=this;e.data={},e.reader=null,e.proxy=null,e.items=[],e.loading=null,e.loaded=null,e._constructor(t)},window.wijdatasource=i,e.extend(i.prototype,{_constructor:function(t){e.extend(this,t)},load:function(t,i){var n=this,o=n.proxy;e.isFunction(n.loading)&&n.loading(n,t)===!1||(o?o.request(n,n.loaded,t):((0===n.items.length||i)&&this.read(),e.isFunction(n.loaded)&&n.loaded(n,t)))},read:function(){var t=this,e=t.data;e&&t.reader?t.reader.read(t):t.items=t.data}}),n=function(t){e.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(t),e.isArray(t)&&(this.fields=t)},window.wijarrayreader=n,e.extend(n.prototype,{read:function(t){e.isArray(t.data)?t.items=this._map(t.data):t.items=[]},_map:function(t){var i=this,n=[];return void 0===i.fields||0===i.fields.length?(e.extend(!0,n,t),n):(e.each(t,function(t,o){var r={};e.each(i.fields,function(t,i){if(i.mapping&&typeof i.mapping&&window[i.mapping]&&(i.mapping=window[i.mapping]),e.isFunction(i.mapping))return r[i.name]=i.mapping(o),!0;var n=void 0!==i.mapping?i.mapping:i.name,s=o[n];void 0===s&&(s=void 0!==i.defaultValue?i.defaultValue:o),r[i.name]=s}),n.push(r)}),n)}}),o=function(t){this.options=t,e.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(t)},window.wijhttpproxy=o,e.extend(o.prototype,{request:function(t,i,n){var o=this,r,s;r=e.extend({},this.options),s=r.success,r.success=function(a){e.isFunction(s)&&s(a),o._complete(a,t,i,r,n)},e.ajax(r)},_complete:function(t,i,n,o,r){i.data=void 0!==o.key?t[o.key]:t,i.read(),e.isFunction(n)&&n(i,r)}})}(t.checkbox||(t.checkbox={}));var e=t.checkbox}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijcombobox",o=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){var t=this,e;t.selectedItem=null,t.selectedItems=[],window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i));try{e=document.activeElement}catch(n){}t._initInnerData(),t._createDOMElements(),
t._bindInputEvents(),t._initDropDownList(),t.repaint(),t._checkSelectIndex(),t.options.text=t._input.val(),t._usingRemoteData()&&t.options.data&&(t.originalDataSourceLoaded=t.options.data.loaded),e===t._input[0]&&t.options.isEditable&&i(function(){t._input.focus()}),t.element.is(":hidden")&&t.element.wijAddVisibilityObserver&&t.element.wijAddVisibilityObserver(function(){t.repaint(),t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijcombobox")},n.prototype._initInnerData=function(){var t=this,e=t.options,i;null!==e.dataSource?(i=t._isBind(),i?t.innerData=t._getMappingItems():t.innerData=e.data):t.innerData=e.data,t.listHasCreated=!1},n.prototype._checkSelectIndex=function(){var t=this,e,n=t.options,o=t.innerData;-1===n.selectedIndex&&n.selectedValue&&i.each(o,function(t,e){return o[t].value===n.selectedValue?(n.selectedIndex=t,"multiple"===n.selectionMode&&(n.selectedIndex=[n.selectedIndex]),!1):void 0}),e=n.selectedIndex,!t._usingRemoteData()&&(e>=0||i.isArray(e))&&t.search(null,"checkindex"),-1===n.selectedIndex&&n.text&&(!n.forceSelectionText||n.forceSelectionText&&-1!==t._checkTextInItems(n.text))&&(t._input.val(n.text),n.selectedIndex=t._checkTextInItems(n.text),"multiple"===n.selectionMode&&(n.selectedIndex=[n.selectedIndex]),n.selectedIndex>-1&&t._checkSelectIndex())},n.prototype.repaint=function(){var t=this.options,e=this;if(e.element.is(":visible")||e._comboDiv||void 0!==e._select&&e._input.is(":visible")){if(e._showTrigger(),t.disabledState){var i=t.disabled;e.disable(),t.disabled=i}return t.disabled&&e.disable(),!0}return!1},n.prototype._bindInputEvents=function(){var e=this,n=this.options.wijCSS,o,r,s,a,l;o=e._input,r=e.options,o.bind("keydown.wijcombobox",function(n){if(r.disabledState!==!0&&!r.disabled)switch(s=n.keyCode,a=t.getKeyCodeEnum(),s){case a.UP:e._move("previous",n),n.preventDefault();break;case a.DOWN:e._move("next",n),n.preventDefault();break;case a.ENTER:e.menu.active&&(n.preventDefault(),"multiple"===r.selectionMode&&e.menu&&e.menu.items&&1===e.menu.items.length&&i.each(e.selectedItems,function(t,i){i!==e.menu.items[0]&&(i.selected=!1)}),e.menu.select(n)),n.preventDefault();break;case a.TAB:if(o.trigger("wijcomboblur"),!e.menu.active||"multiple"===r.selectionMode&&a.TAB===s)return;e.menu.select(n);var l=o.val().length;e._selectText(l,l,o);break;case a.ESCAPE:e.close(n,void 0);break;case a.LEFT:case a.RIGHT:case a.SHIFT:case 16:case 17:case a.CONTROL:case a.HOME:case a.END:case a.DELETE:case a.PAGE_UP:case a.PAGE_DOWN:break;case 18:o.trigger("wijcomboblur");break;default:window.clearTimeout(e.searching),r.isEditable===!1&&(void 0===e._cacheKey&&(e._cacheKey=""),e._cacheKey+=String.fromCharCode(s)),e.searching=window.setTimeout(function(){var t;r.isEditable===!1?(t=e._cacheKey,e._cacheKey=void 0):t=o.val(),e.search(t,n)},r.delay)}}).bind("wijcomboblur.wijcombobox",function(t){window.clearTimeout(e.searching),e._addInputFocus(!1,n.stateFocus),e.closing=window.setTimeout(function(){e.close(t,!0)},150)}).bind("focus.wijcombobox",function(){e._addInputFocus(!0,n.stateFocus)}).bind("blur.wijcombobox",function(){e.menu.element.is(":visible")||o.trigger("wijcomboblur"),e._change()}),i.browser.msie&&parseInt(i.browser.version)>9&&o.bind("mouseup.wijcombobox",function(t){""!==o.val()&&setTimeout(function(){""===o.val()&&e.menu.deactivate()},5)})},n.prototype._addInputFocus=function(t,e){var i=this,n,o,r;n=i._input.parent(),o=t?"addClass":"removeClass",r=i._triggerArrow,n[o](e),void 0!==r&&r[o](e)},n.prototype._renderColumnsHeader=function(t){var e=this,n=i("<ul class='wijmo-wijcombobox-rowheader'></ul>");i.each(this.options.columns,function(t,o){var r=i("<li class='wijmo-wijcombobox-cell "+e.options.wijCSS.header+"'></li>");r.html(o.name),void 0!==o.width&&r.width(o.width),r.appendTo(n)}),t.append(n)},n.prototype._hasSameValueText=function(t,e){return t.label===e.label&&t.value===e.value},n.prototype._initDropDownList=function(){var t=this,e,n,o,r,s,a=this.options.wijCSS,l=parseInt(t._input.css("zIndex"),10),h;e=t.element[0].ownerDocument,isNaN(l)&&(l=0),n=t._comboDiv?t._oriList:i("<div class='"+a.comboboxListCss+"'></div>"),o=t.options,o.columns.length>0&&(n.addClass("wijmo-wijcombobox-multicolumn"),r=i("<div class='wijmo-wijsuperpanel-header "+a.stateDefault+"'></div>"),t._renderColumnsHeader(r),n.append(r)),s={keepHightlightOnMouseLeave:!0,selectionMode:o.selectionMode,addHoverItemClass:0===o.columns.length,focus:function(e,i){var n=i;o.selectOnItemFocus&&t.menu.select(null,{notCloseAfterSelected:!0}),o.columns.length>0&&n.element&&(n.element.prev().addClass("wijmo-wijcombobox-active-prev"),n.element.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").addClass(a.stateHover))},selected:function(e,n){window.clearTimeout(t.closing);var r=o.selectionMode,s,a,l=!1,h,d,c;if(s=n.item,a=i.inArray(s,t.items),!(0>a)){if(t._trigger("select",e,s))if("single"===r)if(t._usingRemoteData()){if(null===t.selectedItem||!t._hasSameValueText(s,t.selectedItem)){if(c=t.selectedItem,d=o.selectedIndex,l=t._triggerSelectedIndexChanging(c,s,d,n.selectedIndex),l)return;t._setInputText(s.label),t.selectedItem=s,a!==o.selectedIndex&&(o.selectedIndex=a,o.selectedValue=t.selectedItem.value),o.inputTextInDropDownList=!0,t._trigger("changed",null,{selectedItem:s}),t._triggerSelectedIndexChanged(c,s,d,o.selectedIndex)}}else if(a!==o.selectedIndex){if(d=o.selectedIndex,c=t.selectedItem,l=t._triggerSelectedIndexChanging(c,s,d,a),l)return;t._setInputText(s.label),null!==c&&(c.selected=!1),t.selectedItem=s,o.selectedIndex=a,o.selectedValue=t.selectedItem.value,void 0!==t._select&&(t._select[0].selectedIndex=o.selectedIndex,t._select.trigger("change")),o.inputTextInDropDownList=!0,c&&c.element&&c.element.removeClass("wijmo-wijcombobox-selecteditem"),t._trigger("changed",null,{oldItem:c,selectedItem:t.selectedItem,newIndex:o.selectedIndex,oldIndex:d}),t._triggerSelectedIndexChanged(c,t.selectedItem,d,o.selectedIndex)}else t.selectedItem&&t._input.val()!==t.selectedItem.label&&(void 0===n.data||!n.data.notCloseAfterSelected)&&t._input.val(s.label);else if(!t._usingRemoteData()){if(l=t._triggerSelectedIndexChanging(null,s,d,n.selectedIndex))return;t.selectedItems=n.selectedItems,t._selectedItemsToInputVal(t.selectedItems),o.inputTextInDropDownList=!0,o.selectedIndex=n.selectedIndex,t._trigger("changed",null,{selectedItem:s,selectedItems:t.selectedItems}),t._triggerSelectedIndexChanged(null,s,null,o.selectedIndex)}(void 0===n.data||!n.data.notCloseAfterSelected)&&"single"===r&&(t.close(e),t._input.focus())}},blur:function(t,e){var i=e.element;o.columns.length>0&&i&&(i.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").removeClass(a.stateHover),i.prev().removeClass("wijmo-wijcombobox-active-prev"))},itemRendering:function(t,e){var i=e,n="";i.isSeparator&&(n+=" wijmo-wijcombobox-separator"),i.selected&&(n+=" wijmo-wijcombobox-selecteditem"),n.length>0&&i.element.addClass(n)},itemRendered:function(t,e){var n=e,r,s;void 0!==n.cells&&(r=n.element,r.empty(),s=i("<ul class='wijmo-wijcombobox-row'></ul>"),i.each(n.cells,function(t,e){var n=i("<li class='wijmo-wijcombobox-cell "+a.stateDefault+"'></li>");o.columns&&o.columns.length>t&&"undefined"!=typeof o.columns[t].width&&n.width(o.columns[t].width),n.append(e),n.attr("title",e),s.append(n)}),r.append(s))},listRendered:function(e,n){var r=t.menu.selectedItem,s=t.menu.selectedItems,a,l;if("single"===o.selectionMode&&r){if(a=i.inArray(r,t.items),0>a)return;t.selectedItem=t.items[a],t._setInputText(t.selectedItem.label,!0)}else s&&s.length>0&&(a=[],l=[],i.each(s,function(e,n){var o=i.inArray(n,t.items);return 0>o?!0:(a.push(o),void l.push(t.items[o]))}),t._selectedItemsToInputVal(l));a>=-1&&(o.selectedIndex=a)},superPanelOptions:{resized:function(e){var i=t.menu,n=i.element;o.dropdownWidth=n.outerWidth(),o.dropdownHeight=n.outerHeight(),t._positionList(),t.menu.refreshSuperPanel()}}},s=i.extend(!0,s,o.listOptions),h=o.ensureDropDownOnBody?i("body"):t._comboElement,t.menu=n.appendTo(h,e).wijlist(s).css({zIndex:l+1,top:0,left:0}).hide().data("wijmoWijlist"),t._createDropDownList(),t._menuUL=t.menu.ul},n.prototype._setInputText=function(t,e){var i=this,n=i.options.text;i._input.val(t),i.options.text=t,n!==t&&!e&&i._trigger("textChanged",null,{oldText:n,newText:t})},n.prototype._triggerSelectedIndexChanged=function(t,e,n,o){var r=this.options,s;"single"===r.selectionMode?this._trigger("selectedIndexChanged",null,{oldItem:t,selectedItem:e,newIndex:o,oldIndex:n}):(s=i.inArray(e,this.items),this._trigger("selectedIndexChanged",null,{selectedItem:e,selectedIndex:s,selectedItems:this.selectedItems}))},n.prototype._triggerSelectedIndexChanging=function(t,e,n,o){var r=this.options,s,a,l=!0;return"single"===r.selectionMode?(a={oldItem:t,selectedItem:e,newIndex:o,oldIndex:n},l=this._trigger("selectedIndexChanging",null,a)):(s=i.inArray(e,this.items),a={selectedItem:e,selectedIndex:s,selectedItems:this.selectedItems},l=this._trigger("selectedIndexChanging",null,a)),l||(e.selected=!1,e.element&&e.element.removeClass("wijmo-wijcombobox-selecteditem")),!l},n.prototype._createDropDownList=function(t){var e=this,n,o=e.options,r=t;r||(r=e.innerData),n=null===r?null:i.isArray(r)?r:r.items,e._comboDiv?!e.listHasCreated&&n&&n.length>0&&(e.menu.setTemplateItems(o.data),i.isArray(e.innerData)?e.innerData=e.menu.items:e.innerData.items=e.menu.items,e.items=e.menu.items,e.menu.renderList(),e.listHasCreated=!0):!e.listHasCreated&&n&&n.length>0&&(e.menu.setItems(n),i.isArray(e.innerData)?e.innerData=e.menu.items:e.innerData.items=e.menu.items,e.items=e.menu.items,e.menu.renderList(),e.listHasCreated=!0)},n.prototype._getSelectedItemsText=function(t){var e="",n,o;return n=this,o=n.options.multipleSelectionSeparator,n.selectedItems=t,i.each(t,function(t,i){i&&(e+=i.label+o)}),e.length>0&&(e=e.substr(0,e.lastIndexOf(o))),e},n.prototype._selectedItemsToInputVal=function(t){var e=this;e._setInputText(e._getSelectedItemsText(t))},n.prototype._createDOMElements=function(){var t=this,e,n=this.options.wijCSS,o,r,s;s=i("<div class='"+n.comboboxWrapperCss+" "+n.stateDefault+" "+n.cornerAll+"'></div>"),o=t.element,o.is("select")?(e=i("<div role='combobox' class='"+n.comboboxCss+" "+n.widget+" "+n.helperClearFix+"'></div>"),e.append(s),t._comboElement=e,t._select=o,o.addClass(n.widget),r=t._input=i("<input role='textbox' aria-autocomplete='list' aria-haspopup='true' />").insertAfter(o),t.options.data||(t.options.data=t._convertSelectOptions(),t._initInnerData())):o.is("div")&&i(o.children()[0]).is("input[type='text']")&&i(o.children()[1]).is("div")?(t._comboElement=t._comboDiv=e=o,t._oriList=i(o.children()[1]),r=t._input=i(o.children()[0]),s.prependTo(e).append(r),o.addClass(n.comboboxCss+" "+n.widget+" "+n.helperClearFix),o.attr("role","combobox")):(e=i("<div role='combobox' class='"+n.comboboxCss+" "+n.widget+" "+n.helperClearFix+"'></div>"),e.append(s),t._comboElement=e,r=t._input=o),t._comboDiv||(e.insertBefore(r),t.element.is(":visible")&&r.width(r.width()),e.children("."+n.comboboxWrapperCss).append(r)),o.attr("title")&&t._comboElement.attr("title",o.attr("title")),r.attr({autocomplete:"off",role:"textbox","aria-wijcombobox":"list","aria-haspopup":"true"}).addClass(n.comoboboxInputCss),t._oldWidth=o.css("width"),t.options.isEditable===!1&&(r.attr("readonly","readonly"),s.bind("click",function(){t.options.disabledState===!0||t.options.disabled||t._triggerClick()})),(t.options.disabledState===!0||t.options.disabled===!0)&&r.attr("disabled","disabled"),e.bind("mouseenter",function(){t.options.disabledState===!0||t.options.disabled||t._addInputFocus(!0,n.stateHover)}).bind("mouseleave",function(){t._addInputFocus(!1,n.stateHover)})},n.prototype._convertSelectOptions=function(){var t=[],e,n;return e=this,n=e._select.get(0).options,i.each(n,function(e,i){t.push({label:i.text,value:i.value})}),-1===e.options.selectedIndex&&null===e.options.selectedValue&&null===e.options.text&&(e.options.selectedIndex=e._select[0].selectedIndex),t},n.prototype.getComboElement=function(){return this._comboElement},n.prototype._showTrigger=function(){var t=this,e,n,o,r,s=this.options.wijCSS,a,l=0,h,d,c,u,p,g,f="<label class='wijmo-wijcombobox-label "+s.content+"'></label>",m="<div class='"+s.comboboxTriggerCss+" "+s.stateDefault+" "+s.cornerRight+"'><span class='"+s.icon+" "+s.iconArrowDown+"'></span></div>";e=t.options,n=t._input,o=n.parent(),r=t._comboElement,h=t._triggerArrow,d=t._label,void 0!==t._select&&(i.browser.msie?(a=t._select.clone(),t._select.after(a),l=a.width(),a.remove()):l=t._select.width(),r.css("width",""),n.width(l+(e.dropdownHeight<t.menu.element.height()?e.selectElementWidthFix:0)),t._select.hide()),n.css("margin-left",""),n.css("margin-right",""),r.width(o[0].offsetWidth),null!==e.labelText?(d=t._label=i(f),o.append(d.html(e.labelText))):void 0!==d&&(d.remove(),t._label=void 0),e.showTrigger?(n.removeClass(s.cornerAll),void 0===h&&(h=t._triggerArrow=i(m),r.append(h),h.bind("mouseover.triggerevent",t,function(t){if(e.disabledState!==!0&&!e.disabled){var n=i(t.currentTarget);n.addClass(s.stateHover)}}).bind("mousedown.triggerevent",t,function(t){if(e.disabledState!==!0&&!e.disabled){var n=i(t.currentTarget);n.addClass(s.stateActive)}}).bind("mouseup.triggerevent",t,function(t){var e=i(t.currentTarget);e.removeClass(s.stateActive)}).bind("click.triggerevent",t,function(){e.disabledState===!0||e.disabled||t._triggerClick()})),"right"===e.triggerPosition?(h.css({left:"",right:"0px"}),h.removeClass(s.cornerLeft),h.addClass(s.cornerRight)):(h.css({right:"",left:"0px"}),h.removeClass(s.cornerRight),h.addClass(s.cornerLeft)),h.setOutHeight(r.innerHeight()),c=h.find("span"),c.css("margin-left",(h.innerWidth()-c[0].offsetWidth)/2),c.css("margin-top",(h.innerHeight()-c[0].offsetHeight)/2)):(void 0!==h&&(h.unbind(".triggerevent"),h.remove(),t._triggerArrow=void 0),n.removeClass(s.cornerLeft),n.removeClass(s.cornerRight),n.addClass(s.cornerAll)),u=p=g=0,void 0!==d&&(p+=d[0].offsetWidth),void 0!==h&&(g=h.width()),u=p+g,n.setOutWidth(o.innerWidth()-u),u=0===u?"":u,"right"===e.triggerPosition?(n.css("margin-left",""),n.css("margin-right",u),void 0!==d&&(d.css("left",""),d.css("right",g))):(n.css("margin-right",""),n.css("margin-left",u),void 0!==d&&(d.css("right",""),d.css("left",g)))},n.prototype._triggerClick=function(t){var e=this,i="";window.clearTimeout(e.closing),e.menu.element.is(":visible")?e.close():(e._usingRemoteData()&&(i=e._input.val()),e.search(i,t))},n.prototype.destroy=function(){var t=this,e=this.options.wijCSS,n=t.element;t.options.isEditable===!1&&n.removeAttr("readonly"),void 0!==t._select?(t._select.removeClass(e.widget),t._select.show(),t._input.remove()):t._comboDiv?(t._comboDiv.removeClass(e.comboboxCss+" "+e.widget+" "+e.helperClearFix),t._comboDiv.removeAttr("role"),t._input.insertBefore(t._comboDiv),t._comboDiv.children("."+e.comboboxWrapperCss).remove()):(n.css("width",t._oldWidth),n.removeClass(e.comoboboxInputCss),n.removeAttr("autocomplete").removeAttr("role").removeAttr("aria-wijcombobox").removeAttr("aria-haspopup"),n.insertBefore(t._comboElement),n.css("padding","")),t._comboElement.remove(),t.menu.destroy(),t.menu.element.remove(),i.wijmo.widget.prototype.destroy.call(t)},n.prototype._setOption=function(t,e){var n=this,o,r,s,a,l,h=this.options.wijCSS,d=n._label,c,u,p,g=null,f=0,m="<label class='wijmo-wijcombobox-label "+h.content+"'></label>",w=n.options;if(o=n._comboElement,r=n.element,a=r.parent(),u=w.selectedIndex,n._triggerArrow&&(f=n._triggerArrow.outerWidth()),i.wijmo.widget.prototype._setOption.apply(n,arguments),"disabled"===t)e?(o.addClass("wijmo-wijcombobox-disabled "+h.stateDisabled),n._input.attr("disabled","disabled"),n._comboDiv&&n._input.addClass("wijmo-wijcombobox-disabled "+h.stateDisabled).attr("disabled","disabled"),n._triggerArrow&&n._triggerArrow.unbind("click.triggerevent"),n.close()):(o.removeClass("wijmo-wijcombobox-disabled "+h.stateDisabled),n._input.removeAttr("disabled"),n._comboDiv&&n._input.removeClass("wijmo-wijcombobox-disabled "+h.stateDisabled).removeAttr("disabled"),n._triggerArrow&&n._triggerArrow.bind("click.triggerevent",n,function(){w.disabledState!==!0&&n._triggerClick()}));else if("labelText"===t)null!==w.labelText?(d=n._label=i(m),n._input.parent().append(d.html(w.labelText)),void 0!==n._triggerArrow&&(c=n._triggerArrow[0].offsetWidth),"right"===w.triggerPosition?void 0!==d&&(d.css("left",""),d.css("right",c)):void 0!==d&&(d.css("right",""),d.css("left",c)),n.repaint()):void 0!==d&&(d.remove(),n._label=void 0);else if("showTrigger"===t)n._showTrigger(),!w.showTrigger&&n.element.is("select")&&r.width(r.width()+f);else if("triggerPosition"===t)r.width(r.width()+f),n._showTrigger();else if("selectionMode"===t)n.menu._setOption("selectionMode",e);else if("isEditable"===t)e?(n._input.removeAttr("readonly"),i("."+h.comboboxWrapperCss,n._comboElement[0]).bind("click",function(){n._triggerClick()})):(n._input.attr("readonly","readonly"),i("."+h.comboboxWrapperCss,n._comboElement[0]).unbind("click"));else if("data"===t||"dataSource"===t){if(n._initInnerData(),n._setSelectedIndex(w.selectedIndex),i.isArray(n.innerData))n.listHasCreated=!1,n._createDropDownList();else try{n.innerData.loaded=function(t,e){null===t?n.items=null:n.items=i.isArray(t)?t:t.items,n.listHasCreated=!1,n._createDropDownList()},n.innerData.load(null)}catch(y){}-1!==w.selectedIndex&&(g=s?s[u]:null,s=n.innerData,n._trigger("changed",null,{oldItem:g,selectedItem:n.selectedItem,newIndex:w.selectedIndex,oldIndex:u}),n._triggerSelectedIndexChanged(g,n.selectedItem,u,w.selectedIndex)),n._keypress=!1}else if("selectedIndex"===t){if(e===u)return;if(s=null===n.innerData?null:i.isArray(n.innerData)?n.innerData:n.innerData.items,"single"===w.selectionMode){if(g=s?s[u]:null,e>-1){if(s&&null!==s[e]&&(p=s[e]),l=n._triggerSelectedIndexChanging(g,p,u,e))return void(w.selectedIndex=u);null!==u&&-1!==u&&void 0!==u&&g&&(g.selected=!1,this.menu.unselectItems(u),g.element&&g.element.removeClass("wijmo-wijcombobox-selecteditem")),s&&null!==s[e]&&(n.selectedItem=s[e],n.selectedItem&&(n.selectedItem.selected=!0,n._setInputText(n.selectedItem.label),w.selectedValue=n.selectedItem.value,w.inputTextInDropDownList=!0))}else if(-1>=e||!e){if(l=n._triggerSelectedIndexChanging(g,null,u,e))return void(w.selectedIndex=u);w.inputTextInDropDownList=!1,n._clearSelection()}n._trigger("changed",null,{oldItem:g,selectedItem:n.selectedItem,newIndex:w.selectedIndex,oldIndex:u}),n._triggerSelectedIndexChanged(g,n.selectedItem,u,w.selectedIndex)}else i.isArray(u)||(u=[u]),i.each(u,function(t,e){n.menu.items&&n.menu.items[e]&&(n.menu.items[e].selected=!1)}),this.menu.unselectItems(u),n.selectedItems=[],n.selectedItem=null,i.isArray(e)||(e=[e],w[t]=e),n._setSelectedIndex(e),i.each(e,function(t,e){n.menu.items&&n.menu.items[e]&&(n.menu.items[e].selected=!0)}),n._trigger("changed",null,{oldItem:null,selectedItem:n.selectedItems,newIndex:w.selectedIndex,oldIndex:null})}else if("selectedValue"===t)e?(n.selectedItem&&void 0!==n.selectedItem.selected&&(n.selectedItem.selected=!1),s=n.items,s||(s=n.innerData),s&&(this.options.selectedIndex>-1&&s.length>this.options.selectedIndex&&s[this.options.selectedIndex]&&(s[this.options.selectedIndex].selected=!1,this.menu.deactivate(),this.menu.unselectItems(this.options.selectedIndex),n.menu.items[this.options.selectedIndex].selected=!1),i.each(s,function(t,i){return s[t].value===e?(n.selectedItem=s[t],n.selectedItem.selected=!0,n.menu.items[t].selected=!0,n._setInputText(n.selectedItem.label),"single"===w.selectionMode?w.selectedIndex=t:w.selectedIndex=[t],w.inputTextInDropDownList=!0,!1):void 0}))):"single"===w.selectionMode&&(w.inputTextInDropDownList=!1,n._clearSelection());else if("text"===t){if(w.forceSelectionText&&-1===n._checkTextInItems(e))return;n._setInputText(e)}else"selectElementWidthFix"===t&&n._showTrigger()},n.prototype._setSelectedIndex=function(t){var e=this,n=e.options,o=[],r=e.innerData;null!==t&&void 0!==t&&(-1===t?(e.selectedItem=null,n.selectedIndex=-1,n.selectedValue=null,n.text?e._input.val(n.text):e._input.val("")):i.isArray(t)?(e.selectedItems=[],i.each(t,function(t,e){r&&null!==r[e]&&void 0!==r[e]&&(r[e].selected=!0,o.push(r[e]))}),e.selectedItems=o,e._selectedItemsToInputVal(o)):r&&null!==r[t]&&void 0!==r[t]?(r[t].selected=!0,e._input.val(r[t].label),e.selectedItem=r[t]):r&&i.isArray(r)&&t>r.length-1&&(n.selectedIndex=-1,e._input.val("")),n.text=e._input.val())},n.prototype.search=function(t,e){var n=this,o,r,s,a;if(o=n.options,r=n.innerData,window.clearTimeout(n.closing),s={value:t,e:e,self:n},null!==r||n._comboDiv){if(a=n._isBind(),"checkindex"!==e&&n._trigger("search",e,{datasrc:r,term:s})===!1)return;if(i.isArray(r)||a||n._comboDiv||!n._usingRemoteData()&&r.items&&i.isArray(r.items)&&r.items.length>0)n._hideShowArrow(!1),n._onListLoaded(r,s);else{if(!a&&i.isArray(o.dataSource))return;if(n._usingRemoteData()&&void 0!==e&&t.length<o.minLength)return;n._hideShowArrow(!1),r.loaded=function(t,e){n.listHasCreated=!1,n._createDropDownList(t),n._onListLoaded(t,e),n.originalDataSourceLoaded&&n.originalDataSourceLoaded(t,e)},r.load(s)}}},n.prototype.getSelectedItems=function(){var t=this.options;return"single"===t.selectionMode?this.selectedItem:this.selectedItems},n.prototype._isBind=function(){var t=this.options,e=t.data;return null!==e&&e.label&&e.label.bind?!0:!1},n.prototype._getMappingItems=function(){var t=this.options,e=t.dataSource,n=t.data,o,r,s;return e&&n&&n.label&&n.label.bind&&n.value&&n.value.bind?(r=n.label.bind,s=n.value.bind,e&&0!==e.length?(o=[],i.each(e,function(t,e){o.push({label:e[r],value:e[s]})}),o):null):null},n.prototype._clearSelection=function(){var t=this,e=t.options;"single"===e.selectionMode?null!==t.selectedItem&&(t.selectedItem.selected=!1,t.selectedItem=null):t.selectedItems&&(i.each(t.selectedItems,function(t,e){e&&e.selected&&(e.selected=!1)}),t.selectedItem=null,t.selectedItems=[]),e.selectedValue=null,t._setInputText("")},n.prototype._usingRemoteData=function(){var t=this.options.data,e=!1;return!i.isArray(t)&&null!==t&&t.proxy&&(e=!0),e},n.prototype._hideShowArrow=function(t){var e=this,i,n;i=e.element,n=e._triggerArrow,void 0!==n&&n[t?"show":"hide"](),i[t?"removeClass":"addClass"]("wijmo-wijcombobox-loading")},n.prototype._onListLoaded=function(t,e){var n=e.self,o,r,s=this.options.wijCSS,a,l,h,d;return o=n._input,r=n.options,a=e.value,l=null===t?null:i.isArray(t)?t:t.items,n.items=l,"checkindex"===e.e?(h=r.selectedIndex,"multiple"===r.selectionMode&&i.isArray(h)?(n.selectedItems=[],i.each(h,function(t,e){var i=l[e];i.selected=!0,n.selectedItems.push(i)}),n._selectedItemsToInputVal(n.selectedItems)):(l[h].selected=!0,n.selectedItem=l[h],o.val(n.selectedItem.label)),n._hideShowArrow(!0),void 0):(""===o.val()&&(!this.selectedItem||""!==this.selectedItem.label)&&n.menu.deactivate(),!n._usingRemoteData()&&l?d=l:(n._topHit=null,d=l),d&&d.length>0||n._comboDiv?(n._openlist(d,e,a),n._addInputFocus(!0,s.stateFocus)):n.close(null,!0),n._hideShowArrow(!0),void 0)},n.prototype.close=function(t,e){var n=this,o,r=this.options.wijCSS,s,a;o=n.menu,n._dropDownHeight=o.element.outerHeight(),n._dropDownWidth=o.element.outerWidth(),window.clearTimeout(n.closing),o.element.is(":visible")&&!o.element.is(":animated")&&!o.element.parent().is(":animated")&&(n._trigger("close",t),o.deactivate(),s=n.options.hidingAnimation,s&&("size"===s.effect||"size"===s.animated)&&(s.options=i.extend({to:{width:0,height:0}},s.options)),a=o.element.attr("style"),e!==!0&&s?o.element.hide(s.effect||s.animated,s.options,s.speed||s.duration,function(){o.element.removeAttr("style").attr("style",a).hide(),s.callback&&s.callback.apply(this,arguments)}):o.element.hide(),n._addInputFocus(!1,r.stateFocus),i(document).unbind("mouseup",n.closeOnClick))},n.prototype._change=function(){var t=this,e,i,n,o,r,s,a,l,h,d=-1;if(e=t.options,i=e.forceSelectionText,n=e.selectionMode,o=t._input,r=o.val(),s=t.selectedItem,a=t.selectedItems,l=e.selectedIndex||e.selectedIndex>-1?e.selectedIndex:-1,h=t.innerData,i)"single"===n&&(null!==s?s.label!==r&&t._setInputText(s.label):t._setInputText(""));else if("single"===n){var c=!1;null!==s&&(c=s.label?s.label.toString()!==r:""!==r),(!s&&""!==r||c)&&(null!==t.selectedItem&&(t.selectedItem.selected=!1),d=t._checkTextInItems(r),-1===d?(t.selectedItem=null,e.selectedIndex=-1,e.selectedValue=null,e.inputTextInDropDownList=!1):h&&(t.selectedItem=h[d],e.selectedIndex=d,e.selectedValue=t.selectedItem.value,e.inputTextInDropDownList=!0),t._setInputText(t._input.val()),t._trigger("changed",null,{oldItem:s,selectedItem:t.selectedItem,newIndex:e.selectedIndex,oldIndex:l}),l!==d&&t._triggerSelectedIndexChanged(s,t.selectedItem,l,e.selectedIndex))}"multiple"===n&&(t.selectedItems&&0!==t.selectedItems.length||(a=[s]),t._selectedItemsToInputVal(a))},n.prototype._checkTextInItems=function(t){var e=-1,n=this.items;return t&&i.each(n,function(i,n){return n&&n.label&&n.label.toString()===t?(e=i,!1):void 0}),e},n.prototype._openlist=function(e,n,o){var r=n.self,s=n.e,a,l,h,d,c,u=2,p=0,g,f,m,w,y,v,_=i.trim(r._input.val()).length,S=t.getKeyCodeEnum(),x,b=!1;return a=r._keypress=!!s,d=r.options,h=r.menu.element,i.ui?h.zIndex(r.element.zIndex()+100):(x=parseInt(r.element.css("zIndex"),10),isNaN(x)&&(x=0),h.css("zIndex",x+100)),r.listHasCreated||r._createDropDownList(),!r._usingRemoteData()&&null!==o&&void 0!==o&&(b=r._keypress&&d.isEditable&&0===d.columns.length&&d.highlightMatching&&_>0,s&&s.keyCode===S.DOWN&&0===o.length&&_>0?r._topHit=r.menu.filterItems(r._input.val(),!1,b):r._topHit=r.menu.filterItems(o,d.autoFilter,b),null===r._topHit&&r.innerData&&i("li[wijhidden]",r.menu.element).length===r.innerData.length)?(r.close(null,!0),!1):(r.menu.element.show(),l="auto"===d.dropdownWidth?r._comboElement.outerWidth():d.dropdownWidth,c=h.css("padding"),h.css("padding","0px"),h.setOutWidth(l),h.css("padding",c),g=d.dropdownHeight,h.children(".wijmo-wijsuperpanel-header")&&(p=h.children(".wijmo-wijsuperpanel-header").outerHeight()||0),m=Math.min(r._menuUL.outerHeight()+u+p,g),h.setOutHeight(m),r.menu.refreshSuperPanel(),r._positionList(),!a&&void 0!==r.selectedItem&&r.menu.activate(null,r.selectedItem,!0),a&&s.keyCode!==S.BACKSPACE?d.isEditable?r._runAutoComplete():r.menu.activate(null,r._topHit,!0):(w=r.options.showingAnimation,null!==d.showingAnimation&&(void 0===s||s.keyCode!==S.BACKSPACE)&&(r.menu.element.hide(),v={from:{width:0,height:0},to:{width:r._dropDownWidth||h.outerWidth(),height:r._dropDownHeight||h.outerHeight()}},w&&("size"===w.effect||"size"===w.animated)&&(w.options=i.extend(v,w.options)),y=h.attr("style"),h.show(w.effect||w.animated,w.options,w.speed||w.duration,function(){h.removeAttr("style").attr("style",y).show(),w.callback&&w.callback.apply(this,arguments),i.browser.msie&&h.css("filter","")}))),r.hasOwnProperty("closeOnClick")||(f=r.closeOnClick,r.closeOnClick=function(t){return f(t)}),r._trigger("open"),i(document).bind("mouseup",r,r.closeOnClick),!0)},n.prototype.closeOnClick=function(t){var e=t.data,n=e.options.wijCSS,o,r=t.target;!i.contains(e._comboElement[0],r)&&!i.contains(e.menu.element[0],r)&&(i.support.isTouchEnabled&&i.support.isTouchEnabled()?(o=e.menu.element.offset(),(t.pageX<o.left||t.pageX>o.left+e.menu.element.width()||t.pageY<o.top||t.pageY>o.top+e.menu.element.height())&&e.close()):e.close(),i("."+n.comboboxWrapperCss,e._comboElement[0]).removeClass(n.stateHover).removeClass(n.stateFocus),i("."+n.comboboxTriggerCss,e._comboElement[0]).removeClass(n.stateHover).removeClass(n.stateFocus))},n.prototype._positionList=function(){var t=this,e,n;e=t.options.dropDownListPosition,n={my:"left top",at:"left bottom",of:t._comboElement,collision:"none"},n=i.extend(n,e),t.menu.element.position(n)},n.prototype._runAutoComplete=function(){var t=this,e,i,n,o,r,s;e=t._input,i=t._topHit,t.options.autoComplete&&null!==i&&void 0!==i&&(t.menu.activate(null,i,!0),n=e.val(),o=i.label,e.val(o),r=n.length,s=o.length,t._selectText(r,s,e))},n.prototype._selectText=function(t,e,i){var n=i.val(),o=i.get(0),r;n.length>0&&(void 0!==o.setSelectionRange?o.setSelectionRange(t,e):void 0!==o.createTextRange&&(r=o.createTextRange(),r.moveStart("character",t),r.moveEnd("character",e-n.length),r.select()))},n.prototype._move=function(t,e){return this.menu.element.is(":visible")?void(this.menu.first()&&/^previous/.test(t)||this.menu.last()&&/^next/.test(t)||this.menu[t](e)):void this.search("",e)},n.prototype._escapeRegex=function(t){return void 0===t?t:t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},n.prototype._filter=function(t,e){var n=this._escapeRegex(e),o,r=null;return t?(o=new RegExp(n,"i"),i.each(t,function(t,e){if(void 0===n||0===n.length)return void(e.match=!0);var i=o.exec(e.label);null===i?e.match=!1:(null===r&&0===i.index&&(r=e),e.match=i.index>=0)}),this._topHit=r,t):null},n}(t.wijmoWidget);e.wijcombobox=o;var r=function(){function t(){this.initSelector=":jqmData(role='wijcombobox')",this.wijCSS={comboboxCss:"wijmo-wijcombobox",comboboxWrapperCss:"wijmo-wijcombobox-wrapper",comoboboxInputCss:"wijmo-wijcombobox-input",comboboxListCss:"wijmo-wijcombobox-list",comboboxTriggerCss:"wijmo-wijcombobox-trigger"},this.dataSource=null,this.data=null,this.labelText=null,this.minLength=4,this.delay=300,this.showingAnimation=null,this.hidingAnimation=null,this.showTrigger=!0,this.triggerPosition="right",this.dropdownHeight=300,this.dropdownWidth="auto",this.selectOnItemFocus=!1,this.autoFilter=!0,this.autoComplete=!0,this.highlightMatching=!0,this.dropDownListPosition={},this.columns=[],this.selectionMode="single",this.multipleSelectionSeparator=",",this.forceSelectionText=!1,this.select=null,this.isEditable=!0,this.selectedIndex=-1,this.selectedValue=null,this.inputTextInDropDownList=!1,this.text=null,this.ensureDropDownOnBody=!0,this.open=null,this.close=null,this.selectElementWidthFix=6,this.search=null,this.changed=null,this.textChanged=null,this.selectedIndexChanged=null,this.selectedIndexChanging=null,this.listOptions=null}return t}();o.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new r),i.wijmo.registerWidget("wijcombobox",o.prototype)}(t.combobox||(t.combobox={}));var e=t.combobox}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(wijmo){!function(input){"use strict";var $=jQuery,jqKeyCode=wijmo.getKeyCodeEnum(),wijinputcore=function(t){function e(){t.apply(this,arguments),this._boundMouseWheel=!1,this._wasPopupShowing=!1,this._blockNextTriggerClickedEvent=!1}return __extends(e,t),e.prototype._elemWithClasses=function(t,e){return"undefined"==typeof e&&(e=[]),$(t).addClass(e.join(" "))},e.prototype._divWithClasses=function(){for(var t=[],e=0;e<arguments.length-0;e++)t[e]=arguments[e+0];return this._elemWithClasses("<div/>",t)},e.prototype._spanWithClasses=function(){for(var t=[],e=0;e<arguments.length-0;e++)t[e]=arguments[e+0];return this._elemWithClasses("<span/>",t)},e.prototype._horizontalBorderWidth=function(t){return t.leftBorderWidth()+t.rightBorderWidth()},e.prototype._verticalBorderWidth=function(t){return t.topBorderWidth()+t.bottomBorderWidth()},e.prototype._create=function(){var t=this;try{var e=document.activeElement==this.element[0]}catch(i){}var n=this._horizontalBorderWidth(this.element),o=this._verticalBorderWidth(this.element);if("input"!==this.element[0].tagName.toLowerCase()&&"textarea"!==this.element[0].tagName.toLowerCase())throw"Target element is not a INPUT";this._creationDate=new Date,window.wijmoApplyWijTouchUtilEvents&&($=window.wijmoApplyWijTouchUtilEvents($)),this.element.is(":hidden")&&this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){t._destroy(),t._create(),t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijinput"),this.element.data("widgetName",this.widgetName),$.effects&&$.effects.save?$.effects.save(this.element,["width","height"]):$.save&&$.save(this.element,["width","height"]);var r=this.options.wijCSS;
if(this.element.wrap("<div><span/></div"),this.wrapper=this.element.parent(),this.outerDiv=this.wrapper.parent(),this.outerDiv.addClass([r.wijinput,r.widget,r.helperClearFix,r.stateDefault,r.cornerAll].join(" ")),this.wrapper.addClass(r.wijinputWrapper),this.element.addClass(r.wijinputInput).addClass(r.cornerAll).attr("role","textbox"),!(Utility.IsIE()&&parseFloat($.browser.version)<=7))try{this.element.attr("aria-multiline",!1)}catch(i){this.element[0].setAttribute("aria-multiline","false")}this._createDropDownAndSpin(),this._initialize(),e&&$(function(){return t.element.focus().wijtextselection(0,t.element.val().length)});var s=this.element[0].style;s.width&&(this._isInPercents(s.width)?this.outerDiv.width(s.width):this.outerDiv.width(this.element.width()+n-this._horizontalBorderWidth(this.outerDiv)),this.element.width("")),s.height&&(this._isInPercents(s.height)?this.outerDiv.height(s.height):this.outerDiv.height(this.element.height()+o-this._verticalBorderWidth(this.outerDiv)),this.element.height(this.outerDiv.height()-(parseInt(this.wrapper.css("padding-top"))+parseInt(this.wrapper.css("padding-bottom")))))},e.prototype._createDropDownAndSpin=function(){this._createDropDownAndSpinElement(),this._createDropDownAndSpinStyle(),this._createDropDownAndSpinLayout()},e.prototype._createDropDownAndSpinElement=function(){var t=this.options.wijCSS,e=this.options.spinnerAlign,i="verticalLeft"===e,n="left"===this.options.dropDownButtonAlign,o=this.options.showSpinner,r=this._isDropDownButtonShown();if(null!=this.options.buttonAlign&&(i="left"==this.options.buttonAlign,n="left"==this.options.buttonAlign,e="left"==this.options.buttonAlign?"verticalLeft":"verticalRight"),this.triggerBtn=null,this.spinUpElement=null,this.spinDownElement=null,this.outerDiv.css("overflow","hidden"),r){var s=n?t.cornerLeft:t.cornerRight;this.triggerBtn=this._divWithClasses(t.wijinputTrigger,t.stateDefault,s).append(this._spanWithClasses(t.icon,t.iconArrowDown)).attr("role","button"),this.element.attr({role:"combobox","aria-expanded":!1})}o&&(this.spinnerLeft=this._divWithClasses(t.wijinputSpinnerLeft,t.wijinputButton),this.spinnerRight=this._divWithClasses(t.wijinputSpinnerRight,t.wijinputButton),"verticalLeft"===e||"verticalRight"===e?(this.spinUpElement=this._divWithClasses(t.stateDefault,t.wijinputSpinUp).append(this._spanWithClasses(t.icon,t.iconArrowUp)).attr("role","upbutton"),this.spinDownElement=this._divWithClasses(t.stateDefault,t.wijinputSpinDown).append(this._spanWithClasses(t.icon,t.iconArrowDown)).attr("role","downbutton")):(this.spinUpElement=this._divWithClasses(t.stateDefault,t.wijinputSpin).append(this._spanWithClasses(t.icon,t.iconPlus)).attr("role","upbutton"),this.spinDownElement=this._divWithClasses(t.stateDefault,t.wijinputSpin).append(this._spanWithClasses(t.icon,t.iconMinus)).attr("role","downbutton")),this.element.attr("role","spinner"))},e.prototype._createDropDownAndSpinStyle=function(){var t=this.options.wijCSS,e=this.options.spinnerAlign,i="verticalLeft"===this.options.spinnerAlign,n="left"===this.options.dropDownButtonAlign,o=this.options.showSpinner,r=this._isDropDownButtonShown();if(null!=this.options.buttonAlign&&(i="left"==this.options.buttonAlign,n="left"==this.options.buttonAlign,e="left"==this.options.buttonAlign?"verticalLeft":"verticalRight"),r&&o)if(n)switch(e){case"verticalLeft":this.outerDiv.addClass(t.inputSpinnerTriggerLeft);break;case"verticalRight":this.outerDiv.addClass(t.inputTriggerLeft),this.outerDiv.addClass(t.inputSpinnerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(t.inputSpinnerTriggerLeft),this.outerDiv.addClass(t.inputSpinnerRight)}else switch(e){case"verticalLeft":this.outerDiv.addClass(t.inputTriggerRight),this.outerDiv.addClass(t.inputSpinnerLeft);break;case"verticalRight":this.outerDiv.addClass(t.inputSpinnerTriggerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(t.inputSpinnerTriggerRight),this.outerDiv.addClass(t.inputSpinnerLeft)}else if(r)n?this.outerDiv.addClass(t.inputTriggerLeft):this.outerDiv.addClass(t.inputTriggerRight);else if(o)switch(e){case"verticalLeft":this.outerDiv.addClass(t.inputSpinnerLeft);break;case"verticalRight":this.outerDiv.addClass(t.inputSpinnerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(t.inputSpinnerLeft),this.outerDiv.addClass(t.inputSpinnerRight)}if(r&&o)if(n)switch(e){case"verticalRight":this.spinUpElement.addClass(t.cornerTR),this.spinDownElement.addClass(t.cornerBR);break;case"horizontalDownLeft":this.spinUpElement.addClass(t.cornerRight);break;case"horizontalUpLeft":this.spinDownElement.addClass(t.cornerRight)}else switch(e){case"verticalLeft":this.spinUpElement.addClass(t.cornerTL),this.spinDownElement.addClass(t.cornerBL);break;case"horizontalDownLeft":this.spinDownElement.addClass(t.cornerLeft);break;case"horizontalUpLeft":this.spinUpElement.addClass(t.cornerLeft)}else if(o)switch(e){case"verticalLeft":this.spinUpElement.addClass(t.cornerTL),this.spinDownElement.addClass(t.cornerBL);break;case"verticalRight":this.spinUpElement.addClass(t.cornerTR),this.spinDownElement.addClass(t.cornerBR);break;case"horizontalDownLeft":this.spinDownElement.addClass(t.cornerLeft),this.spinUpElement.addClass(t.cornerRight);break;case"horizontalUpLeft":this.spinUpElement.addClass(t.cornerLeft),this.spinDownElement.addClass(t.cornerRight)}},e.prototype._createDropDownAndSpinLayout=function(){var t=this.options.spinnerAlign,e=this.options.showSpinner,i=this._isDropDownButtonShown();if(null!=this.options.buttonAlign&&(t="left"==this.options.buttonAlign?"verticalLeft":"verticalRight"),i&&this.triggerBtn.appendTo(this.outerDiv),e)switch(t){case"verticalLeft":this.spinnerLeft.append(this.spinUpElement).append(this.spinDownElement).appendTo(this.outerDiv);break;case"verticalRight":this.spinnerRight.append(this.spinUpElement).append(this.spinDownElement).appendTo(this.outerDiv);break;case"horizontalDownLeft":this.spinnerLeft.append(this.spinDownElement).appendTo(this.outerDiv),this.spinnerRight.append(this.spinUpElement).appendTo(this.outerDiv);break;case"horizontalUpLeft":this.spinnerLeft.append(this.spinUpElement).appendTo(this.outerDiv),this.spinnerRight.append(this.spinDownElement).appendTo(this.outerDiv)}},e.prototype._isDropDownButtonShown=function(){var t=this.options.showTrigger;return void 0===t&&(t=!1),t||this.options.showDropDownButton},e.prototype._isInPercents=function(t){return t.match(/%$/)},e.prototype._createTextProvider=function(){return void 0},e.prototype._beginUpdate=function(){},e.prototype._endUpdate=function(){var t=this;this.element.mousewheel&&!this._boundMouseWheel&&(this.element.mousewheel(function(e,i){t.isFocused()&&t._doSpin(i>0,!1)&&e.preventDefault()}),this._boundMouseWheel=!0)},e.prototype._isPopupShowing=function(){return!!this._comboDiv&&this._comboDiv.wijpopup("isVisible")},e.prototype._onTriggerMouseDown=function(t){this._wasPopupShowing&&(this._blockNextTriggerClickedEvent=!0)},e.prototype._onTriggerMouseUp=function(t){},e.prototype._onTriggerClicked=function(){return this._blockNextTriggerClickedEvent?void(this._blockNextTriggerClickedEvent=!1):void(this._popupVisible()?this._hidePopup():this._showPopup())},e.prototype._showPopup=function(){return this._popupComboList()},e.prototype._hidePopup=function(){this._comboDiv.wijpopup("hide")},e.prototype._initialize=function(){var t=this;this.element.data("initializing",!0),this._trigger("initializing"),this.element.data("preText",this.element.val()),this.element.data("elementValue",this.element.val()),this.element.data("errorstate",!1),this.element.data("breakSpinner",!0),this.element.data("prevCursorPos",-1),this.element.data("simulating",!1),this._createTextProvider(),this._beginUpdate();var e=this.options,i=function(t){return 1===(t.which?t.which:t.button)},n=function(e){t.options.disabled||i(e)&&(t.options.disableUserInput||(t._trySetFocus(),Utility.IsFireFox4OrLater()&&t._stopEvent(e),t.element.data("breakSpinner",!1),t._addState("active",$(t)),t._doSpin("upbutton"==$(e.currentTarget).attr("role"),!0)))},o=function(e){t.options.disabled||i(e)&&(t.options.disableUserInput||(t._stopSpin(),t._removeState("active",$(t))))};if(this.triggerBtn&&!e.disabledState&&this.triggerBtn.bind({mouseover:function(){t.options.disabled||t._addState("hover",$(t))},mouseout:function(){t.options.disabled||t._removeState("hover",$(t))},mousedown:function(e){t.options.disabled||i(e)&&(t._stopEvent(e),t._addState("active",$(t)),t._trigger("triggerMouseDown"),t._trigger("dropDownButtonMouseDown"),t._onTriggerMouseDown(e))},mouseup:function(e){t._onTriggerMouseUp(e)},click:function(e){t.options.disabled||(t._stopEvent(e),t._stopSpin(),t._removeState("active",$(t)),t._trigger("triggerMouseUp"),t._trigger("dropDownButtonMouseUp"),t._onTriggerClicked(),t._trySetFocus())}}),this.spinUpElement&&!e.disabledState&&this.spinUpElement.bind({mouseover:function(){t.options.disabled||t._addState("hover",$(t))},mouseout:function(){t.options.disabled||(t._removeState("hover",$(t)),t._removeState("active",$(t)),t._stopSpin())},mousedown:n,mouseup:o}),this.spinDownElement&&!e.disabledState&&this.spinDownElement.bind({mouseover:function(){t.options.disabled||t._addState("hover",$(t))},mouseout:function(){t.options.disabled||(t._removeState("hover",$(t)),t._removeState("active",$(t)),t._stopSpin())},mousedown:n,mouseup:o}),this._attachInputEvent(),this.element.data("initializing",!1),this._resetData(),this._endUpdate(),this._updateText(),this.options.disabledState){var r=e.disabled;this.disable(),e.disabled=r}this.options.disabled&&this.disable(),this.options.imeMode&&this.element.css("ime-mode",this.options.imeMode),this.element.data("initialized",!0),this._trigger("initialized")},e.prototype._attachInputEvent=function(){this.element.bind({"focus.wijinput":$.proxy(this._onFocus,this),"beforedeactivate.wijinput":$.proxy(this._onBeforeDeactivate,this),"blur.wijinput":$.proxy(this._onBlur,this),"mousedown.wijinput":$.proxy(this._onMouseDown,this),"mouseup.wijinput":$.proxy(this._onMouseUp,this),"keypress.wijinput":$.proxy(this._onKeyPress,this),"keydown.wijinput":$.proxy(this._onKeyDown,this),"keyup.wijinput":$.proxy(this._onKeyUp,this),"compositionstart.wijinput":$.proxy(this._onCompositionStart,this),"compositionend.wijinput":$.proxy(this._onCompositionEnd,this),"change.wijinput":$.proxy(this._onChange,this),"paste.wijinput":$.proxy(this._onPaste,this),"drop.wijinput":$.proxy(this._onDrop,this)}),this.element.bind("propertychange.wijinput input.wijinput",$.proxy(this._onInput,this))},e.prototype._detachInputEvent=function(){this.element.unbind(".wijinput")},e.prototype._init=function(){this.element.attr("readOnly")&&(this.options.readonly=!0),this.options.readonly===!0&&(this.options.disableUserInput=!0),(this.options.readonly===!0||this.options.disableUserInput===!0)&&this.element.attr("readOnly",!0),null!=this.options.placeholder&&(this.options.nullText=this.options.placeholder),void 0!=this.options.showTrigger&&this._setOption("showDropDownButton",this.options.showTrigger)},e.prototype._showNullText=function(){return!!this.options.nullText||""===this.options.nullText},e.prototype._setOption=function(t,e){switch(t){case"readonly":this._super(t,e),t="disableUserInput";break;case"placeholder":this._super(t,e),t="nullText";break;case"showTrigger":this.options.showDropDownButton=e}switch(this._super(t,e),t){case"spinnerAlign":case"dropDownButtonAlign":case"showDropDownButton":case"buttonAlign":case"showTrigger":case"showSpinner":this._destroy(),this._create();break;case"showNullText":case"nullText":this._updateText();break;case"imeMode":this.element.css("ime-mode",this.options.imeMode);break;case"disabled":this.element.attr("disabled",e);var i=e?"addClass":"removeClass",n=this.options.wijCSS.stateDisabled;this.element[i](n),this.triggerBtn&&this.triggerBtn[i](n),this.spinUpElement&&this.spinUpElement[i](n),this.spinDownElement&&this.spinDownElement[i](n);break;case"disableUserInput":this.element.attr("readOnly",e)}},e.prototype.destroy=function(){this._super(),this._comboDiv&&this._comboDiv.remove(),this._destroy()},e.prototype.drop=function(){this._onTriggerClicked()},e.prototype.isDestroyed=function(){return!this.outerDiv},e.prototype._destroy=function(){this.isDestroyed()||(this.wrapper=void 0,this.outerDiv=void 0,this._detachInputEvent(),this.element.removeData("errorstate").removeData("breakSpinner").removeData("prevCursorPos").removeData("simulating").removeData("isPassword").removeClass(this.options.wijCSS.wijinputInput).removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow").removeAttr("aria-expanded"),this.element.parent().replaceWith(this.element),this.element.parent().replaceWith(this.element),$.effects&&$.effects.restore?$.effects.restore(this.element,["width","height"]):$.restore&&$.restore(this.element,["width","height"]))},e.prototype.widget=function(){return this.outerDiv||this._super()},e.prototype._getCulture=function(t){return"undefined"==typeof t&&(t=this.options.culture),Globalize.findClosestCulture(t||this.options.culture)},e.prototype._addState=function(t,e){e.is(":not(.ui-state-disabled)")&&e.addClass(this.options.wijCSS.getState(t))},e.prototype._removeState=function(t,e){e.removeClass(this.options.wijCSS.getState(t))},e.prototype._isInitialized=function(){return!this.element.data("initializing")},e.prototype._setData=function(t){this.setText(t)},e.prototype._resetData=function(){},e.prototype._validateData=function(){},e.prototype.getText=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!1):this.element.val()},e.prototype.setText=function(t){this._isInitialized()?(this._textProvider.setText(t),this._updateText()):this.element.val(t)},e.prototype.getPostValue=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!0):this.element.val()},e.prototype.selectText=function(t,e){"undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=this.getText().length),isNaN(t)&&(t=0),isNaN(e)&&(e=0),Utility.IsFireFox4OrLater()&&this.focus(),this.element.is(":disabled")||this.element.wijtextselection(t,e)},e.prototype.focus=function(){this.element.is(":disabled")||this.element.get(0).focus()},e.prototype.isFocused=function(){return this.outerDiv?this.outerDiv.hasClass(this.options.wijCSS.stateFocus):!1},e.prototype._raiseTextChanged=function(){var t=this.element.val(),e=this.element.data("preText");!!this.element.data("initialized")&&e!==t&&(this._trigger("textChanged",null,{text:t}),this.element.data("changed",!0)),this.element.data("preText",t)},e.prototype._raiseDataChanged=function(){},e.prototype._allowEdit=function(){return!this.element.is(":disabled")},e.prototype._updateText=function(t){if("undefined"==typeof t&&(t=!1),this._isInitialized()){t=!!t;var e;void 0!==this.element.data("selectionbeforeblur")?(e=this.element.data("selectionbeforeblur"),this.element.removeData("selectionbeforeblur")):e=this.element.wijtextselection();var i=this.options;this.isDeleteAll&&this._showNullText()?(this.isDeleteAll=!1,i.date=null,this.element.val(i.nullText)):(this.element.val(this._textProvider.toString()),this.options.text=this._textProvider.toString(!0,!1,!1)),this.element.is(":disabled")||(t&&this.selectText(e.start,e.end),this.element.data("prevCursorPos",e.start),this._raiseTextChanged(),this._raiseDataChanged())}},e.prototype._trySetFocus=function(){if(document.activeElement!==this.element[0])try{this.options.disableUserInput||this.element.focus()}catch(t){}},e.prototype._deleteSelText=function(t){if("undefined"==typeof t&&(t=!1),this._allowEdit()){var e=this.element.wijtextselection();if(t){if(e.end<1)return;e.end===e.start&&e.start--}e.end--,e.end<e.start&&(e.end=e.start);var i=new wijInputResult;this._textProvider.removeAt(e.start,e.end,i),this._updateText(),this.selectText(i.testPosition,i.testPosition)}},e.prototype._fireIvalidInputEvent=function(t){var e=this,i=this._trigger("invalidInput",null,{widget:this,"char":t});if(!($.isFunction(this.options.invalidInput)&&i===!0||this.element.data("errorstate"))){var n=this.options.invalidClass||this.options.wijCSS.stateError;this.element.data("errorstate",!0),window.setTimeout(function(){e.outerDiv&&e.outerDiv.removeClass(n),e.element.data("errorstate",!1)},200),this.outerDiv.addClass(n)}},e.prototype._onInput=function(t){return this._isSimulating()&&this.element.data("ime")&&!this.element.data("isComposingIME")?void this._simulate():void(this.element.data("isComposingIME")&&this.element.data("simulationPending",!0))},e.prototype._keyDownPreview=function(t){var e=t.keyCode||t.which;return t.ctrlKey===!0&&88===e?!0:t.ctrlKey===!0&&90===e?!0:!1},e.prototype._onDoubleByteCharacter=function(){var t=this.element.data("lastDbsState"),e=this.element.wijtextselection(),i=this.element.val();this.element.data("isComposingIME")&&t&&t.selection.start===e.start&&t.Text===i?(this.element.removeData("lastDbsState"),this._onCompositionEnd()):(this.element.data("lastDbsState",{selection:e,text:i}),this._onCompositionStart())},e.prototype._onCompositionStart=function(){this.element.data("isComposingIME")||(this.element.data("isComposingIME",!0),this._beforeSimulate(!0))},e.prototype._onCompositionEnd=function(){this.element.data("isComposingIME")&&(this.element.data("isComposingIME",!1),this._isInitialized()&&(!this._textProvider||!this._textProvider.noMask)&&this._simulateIfPending())},e.prototype._simulateIfPending=function(){this.element.data("simulationPending")&&this.element.data("lastSelection")&&this._simulate()},e.prototype._beforeSimulate=function(t){"undefined"==typeof t&&(t=!1),this.element.data("lastSelection")||(this.element.data("lastSelection",this.element.wijtextselection()),this.element.data("lastValue",this.element.val())),this.element.data("ime",t),this.element.data("simulating",!0)},e.prototype._isSimulating=function(){return this.element.data("simulating")},e.prototype._simulate=function(t){var e=this,i=null;if(this.element.data("simulationPending",!1),"string"==typeof t)i=t;else{var n=this.element.wijtextselection(),o=this.element.data("lastSelection").start,r=n.end;r>=o&&(i=this.element.val().substring(o,r))}i&&window.setTimeout(function(){if(!e._isLastValueNull()){e.element.val(e.element.data("lastValue"));var t=e.element.data("lastSelection");e.element.wijtextselection(t),e.element.data("batchKeyPress",!0),e.element.data("simulating",!1);var n=jQuery.Event("keypress");n.ctrlKey=n.altKey=!1;for(var o=0;o<i.length;o++){n.which=n.charCode=n.keyCode=i.charCodeAt(o),e.element.data("nextChar",o===i.length-1?"":i.charAt(o+1)),e._onKeyPress(n),e.element.data("nextChar","");var r=e.element.data("appendChar");r&&r.length>0&&(e.element.data("appendChar",""),n.which=n.charCode=n.keyCode=r.charCodeAt(o),e._onKeyPress(n)),e.element.data("skipNextChar")&&(o++,e.element.data("skipNextChar",!1))}e.element.data("batchKeyPress",!1),e._endSimulate()}},1)},e.prototype._isLastValueNull=function(){return!this.element.data("lastValue")},e.prototype._endSimulate=function(){this._simulateIfPending(),this.element.removeData("ime"),this.element.removeData("lastSelection"),this.element.removeData("lastValue")},e.prototype._processKeyForDropDownList=function(t){var e=this._getKeyCode(t);if(t.altKey&&(e===jqKeyCode.UP||e===jqKeyCode.DOWN))return this._onTriggerClicked(),this._stopEvent(t),!0;if(e===jqKeyCode.ESCAPE&&this._wasPopupShowing)return this._hidePopup(),this._stopEvent(t),!0;if(this._wasPopupShowing&&void 0!==this._comboDiv){if(e===jqKeyCode.DOWN){try{this._comboDiv.wijlist("next")}catch(i){}return this._stopEvent(t),!0}if(e===jqKeyCode.UP){try{this._comboDiv.wijlist("previous")}catch(i){}return this._stopEvent(t),!0}if(e===jqKeyCode.ENTER)return this._comboDiv.wijlist("select"),this._stopEvent(t),!0;if(e===jqKeyCode.PAGE_DOWN){try{this._comboDiv.wijlist("nextPage")}catch(i){}return this._stopEvent(t),!0}if(e===jqKeyCode.PAGE_UP){try{this._comboDiv.wijlist("previousPage")}catch(i){}return this._stopEvent(t),!0}}},e.prototype._processKeyOnNoMask=function(t){var e=this._getKeyCode(t);return e===jqKeyCode.Enter&&this._onEnterDown(t),e!==jqKeyCode.LEFT&&e!==jqKeyCode.RIGHT||!this._processLeftRightKey(e===jqKeyCode.LEFT)?void this._processKeyForDropDownList(t):void this._stopEvent(t)},e.prototype._onKeyDown=function(t){if(this.element.data("prevCursorPos",-1),this._deleteKeyDown=!1,this._isInitialized()){if(this._textProvider&&this._textProvider.noMask)return void this._processKeyOnNoMask(t);var e=this._getKeyCode(t);if(229===e)return void this._onDoubleByteCharacter();if(this._onCompositionEnd(),this.options.disableUserInput)return void(e===jqKeyCode.TAB?this._processTabKey(t)&&this._stopEvent(t):this._stopEvent(t));if(this._keyDownPreview(t))return void this._stopEvent(t);if(!this._processKeyForDropDownList(t)){switch(e){case jqKeyCode.UP:return this._doSpin(!0,!1),void this._stopEvent(t);case jqKeyCode.DOWN:return this._doSpin(!1,!1),void this._stopEvent(t);case jqKeyCode.LEFT:case jqKeyCode.RIGHT:return void(this._processLeftRightKey(e===jqKeyCode.LEFT)&&this._stopEvent(t));case jqKeyCode.TAB:return void(this._processTabKey(t)&&this._stopEvent(t))}if(t.ctrlKey)switch(e){case jqKeyCode.INSERT:case 67:return}if(!t.ctrlKey&&!t.altKey)switch(e){case 112:case 113:case 114:case 115:case 116:case 117:case jqKeyCode.TAB:case jqKeyCode.CAPSLOCK:case jqKeyCode.END:case jqKeyCode.HOME:case jqKeyCode.CTRL:case jqKeyCode.SHIFT:return;case jqKeyCode.BACKSPACE:return this._deleteSelText(!0),void this._stopEvent(t);case jqKeyCode.DELETE:return this._deleteSelText(!1),this._stopEvent(t),this._deleteKeyDown=!0,void 0;case jqKeyCode.ENTER:this._onEnterDown(t);break;case jqKeyCode.ESCAPE:return this._stopEvent(t),void window.setTimeout($.proxy(this._resetData,this),1);case jqKeyCode.PAGE_UP:case jqKeyCode.PAGE_DOWN:case jqKeyCode.ALT:return void this._stopEvent(t)}}}},e.prototype._onEnterDown=function(t){this.options.hideEnter&&this._stopEvent(t)},e.prototype._onKeyUp=function(t){if(!this._textProvider||!this._textProvider.noMask){var e=this._getKeyCode(t);if(this._isSimulating())return void(e===jqKeyCode.ENTER&&this._onCompositionEnd());if(this._isInitialized()&&e!==jqKeyCode.ENTER&&e!==jqKeyCode.ESCAPE)return this.options.disableUserInput?(this._raiseTextChanged(),void this._raiseDataChanged()):void this._stopEvent(t)}},e.prototype._getKeyCode=function(t){var e=window.navigator.userAgent;return-1===e.indexOf("iPod")&&-1===e.indexOf("iPhone")||127!==t.which?t.keyCode||t.which:8},e.prototype._keyPressPreview=function(t){return!1},e.prototype._onKeyPress=function(t){if(!(this._isSimulating()||this._textProvider&&this._textProvider.noMask)&&(this.element.data("prevCursorPos",-1),!this.options.disableUserInput&&this._allowEdit())){if(t.ctrlKey&&119===t.keyCode)return void this._onPaste(t);var e=t.keyCode||t.which;if(Utility.IsFireFox4OrLater())switch(t.keyCode){case jqKeyCode.UP:case jqKeyCode.DOWN:case jqKeyCode.LEFT:case jqKeyCode.RIGHT:case jqKeyCode.HOME:case jqKeyCode.END:return}switch(e){case 0:case jqKeyCode.TAB:return;case jqKeyCode.BACKSPACE:return void this._stopEvent(t);case jqKeyCode.DELETE:if(this._deleteKeyDown)return void this._stopEvent(t);break;case jqKeyCode.ENTER:return void(this.options.hideEnter&&this._stopEvent(t))}if((!t.ctrlKey&&!t.altKey||e===jqKeyCode.SPACE)&&!this._keyPressPreview(t)){var i=String.fromCharCode(e),n=this._textProvider.replaceWith(this.element.wijtextselection(),i);n?(this._updateText(),this.selectText(n.testPosition+1,n.testPosition+1),this.element.data("prevCursorPos",n.testPosition+1)):this._fireIvalidInputEvent(i),this.element.data("batchKeyPress")||this._stopEvent(t)}}},e.prototype._isNullText=function(t){return t=t||this.element.val(),this._showNullText()&&t===this.options.nullText},e.prototype._doFocus=function(){var t=this.element.wijtextselection(),e=t.start;this._updateText();var i=this.element.val();i.length===e&&(e=0),$.browser.safari||this.selectText(e,e)},e.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},e.prototype._onFocus=function(t){this.options.disableUserInput||(this._addState("focus",this.outerDiv),this.element.data("breakSpinner")&&this._isInitialized()&&this._allowEdit()&&(this.element.data("focusNotCalledFirstTime")||this.element.data("focusNotCalledFirstTime",(new Date).getTime()),this._afterFocused()))},e.prototype._onBeforeDeactivate=function(t){this.options.disableUserInput||this.element.data("breakSpinner")&&this._isInitialized()&&this._allowEdit()&&this.element.data("selectionbeforeblur",this.element.wijtextselection())},e.prototype._onBlur=function(t){if(!this.options.disableUserInput&&(this._onCompositionEnd(),!this._isComboListVisible())){var e=this.isFocused();if(this._removeState("focus",this.outerDiv),!this.element.data("breakSpinner")){this.element.get(0).focus();var i=this.element.data("prevCursorPos");return void(void 0!==i&&-1!==i&&this.selectText(i,i))}this._isInitialized()&&e&&(this.element.data("value",this.element.val()),this._updateTextOnLostFocus())}},e.prototype._updateTextOnLostFocus=function(){var t=this;window.setTimeout(function(){t._onChange(),t._updateText(),t._validateData(),t.element.data("changed")&&(t.element.data("changed",!1),t._popupVisible()||(t._trigger("change"),t.element.change()))},100)},e.prototype._popupVisible=function(){return this._wasPopupShowing},e.prototype._onMouseDown=function(t){if(this._isInitialized()&&!this.element.is(":disabled")&&Utility.IsMouseDownOnClearButton(t)){var e=!1;try{e=document.activeElement===t.target}catch(i){}return this.element.data("focusedWhenMouseDown",e),void this.element.data("mouseDownOnClearButton",!0)}},e.prototype._onMouseUp=function(t){if(this._isInitialized()&&!this.element.is(":disabled")){if(Utility.IsMouseDownOnClearButton(t)&&this.element.data("mouseDownOnClearButton")&&this.element.data("focusedWhenMouseDown")===!0){if(!this.options.disableUserInput){var e=this;setTimeout(function(){e._processClearButton()},0)}return void this.element.data("mouseDownOnClearButton",!1)}this.element.data("mouseDownOnClearButton",!1),this.element.data("focusedWhenMouseDown",!1);var i=this.element.wijtextselection();if(this.element.data("prevCursorPos",i.start),""!=this.element.val()){var e=this;setTimeout(function(){""==e.element.val()&&e.setText("")},5)}}},e.prototype._onChange=function(){if(this.element){var t=this.element.val(),e=this.getText();e!==t&&this.setText(t)}},e.prototype._onPaste=function(t){if(!this._textProvider||!this._textProvider.noMask){this._beforeSimulate();var e=this;window.setTimeout(function(){e._simulate()},1)}},e.prototype._onDrop=function(t){if(this._beforeSimulate(),t.originalEvent&&t.originalEvent.dataTransfer){var e=t.originalEvent.dataTransfer.getData("Text");e&&this._simulate(e)}},e.prototype._stopEvent=function(t){t.stopPropagation(),t.preventDefault()},e.prototype._calcSpinInterval=function(){return this._repeatingCount++,this._repeatingCount>10?50:this._repeatingCount>4?100:this._repeatingCount>2?200:400},e.prototype._doSpin=function(t,e){return!1},e.prototype._stopSpin=function(){this.element.data("breakSpinner",!0),this._repeatingCount=0;var t=this.element.data("spintimer");t&&(clearTimeout(t),this.element.data("spintimer",void 0))},e.prototype._hasComboItems=function(){return!!this._getcomboItems()&&this._getcomboItems().length},e.prototype._getcomboItems=function(){return this.options.comboItems&&this.options.comboItems.length>0?this.options.comboItems:this.options.pickers.list},e.prototype._getcomboWidth=function(){return this.options.comboWidth||this.options.pickers.width},e.prototype._getcomboHeight=function(){return this.options.comboHeight||this.options.pickers.height},e.prototype._isComboListVisible=function(){return this._comboDiv?this._comboDiv.wijpopup("isVisible"):!1},e.prototype._createComboDiv=function(){var t=this;if(void 0===this._comboDiv){this._comboDiv=$("<div></div>").appendTo(document.body).css("position","absolute");var e=this._normalize(this._getcomboItems());this._comboDiv.wijlist({maxItemsCount:5,selected:function(e,i){t.options.disableUserInput||t._setData(i.item.value),t._comboDiv.wijpopup("hide"),t._trySetFocus()}}),this._comboDiv.wijlist("setItems",e),this._comboDiv.wijlist("renderList")}},e.prototype._popupComboList=function(){var t=this;return this._hasComboItems()&&this._allowEdit()?(this._createComboDiv(),this._comboDiv.width(this.outerDiv.width()),this._comboDiv.wijlist("option","autoSize",!this._getcomboHeight()),this._getcomboHeight()&&this._comboDiv.height(this._getcomboHeight()),this._getcomboWidth()&&parseInt(this._getcomboWidth())!==this._comboDiv.width()&&(this._comboDiv.wijlist("destroy"),this._comboDiv.remove(),delete this._comboDiv,this._createComboDiv(),this._comboDiv.width(this._getcomboWidth()),this._comboDiv.wijlist("option","autoSize",!this._getcomboHeight()),this._getcomboHeight()&&this._comboDiv.height(this._getcomboHeight())),this._comboDiv.wijlist("refreshSuperPanel"),this._comboDiv.wijpopup({autoHide:!0,hidden:function(){t._trigger("dropDownClose"),t._wasPopupShowing=!1,t._comboDiv.wijlist("unselectItems"),t._comboDiv.wijlist("deactivate")},shown:function(){t._trigger("dropDownOpen"),t._wasPopupShowing=!0}}),this.outerDiv.attr("aria-expanded",!0),this._comboDiv.wijpopup("show",{of:this.outerDiv,offset:"0 4",hidden:function(){t.outerDiv.attr("aria-expanded",!1)}}),!0):!1},e.prototype._normalize=function(t){return t.length&&t[0].label&&t[0].value?t:$.map(t,function(t){return"string"==typeof t?{label:t,value:t}:$.extend({label:t.label||t.value,value:t.value||t.label},t)})},e.prototype._processLeftRightKey=function(t){return!1},e.prototype._processTabKey=function(t){return!1},e.prototype._moveControl=function(t,e,i){var n=Utility.GetElements(),o=null,r={};if(n.length<2)return null;var s=Utility.GetNextFocusableControl(t,n,e);setTimeout(function(){Utility.SetElementFocus(s)},0)},e.prototype._processClearButton=function(){},e}(wijmo.wijmoWidget);input.wijinputcore=wijinputcore;var wijinputClass="wijmo-wijinput",classPrefix=wijinputClass+"-",wijinputcore_options=function(){function t(){this.wijCSS={wijinput:wijinputClass,wijinputInput:classPrefix+"input",wijinputWrapper:classPrefix+"wrapper",wijinputWrapperSpinnerLeft:classPrefix+"wrapper-spinner-left",wijinputWrapperSpinnerRight:classPrefix+"wrapper-spinner-right",wijinputTrigger:classPrefix+"trigger",wijinputSpinnerLeft:classPrefix+"spinner-left",wijinputSpinnerRight:classPrefix+"spinner-right",wijinputButton:classPrefix+"button",wijinputSpin:classPrefix+"spin",wijinputSpinUp:classPrefix+"spinup",wijinputSpinDown:classPrefix+"spindown",iconPlus:"ui-icon-plus",iconMinus:"ui-icon-minus"},this.imeMode="",this.culture="",this.invalidClass=$.wijmo.wijCSS.stateError,this.nullText=void 0,this.placeholder=void 0,this.showNullText=!1,this.hideEnter=!1,this.disableUserInput=!1,this.readonly=!1,this.buttonAlign=null,this.dropDownButtonAlign="right",this.showDropDownButton=!1,this.showTrigger=void 0,this.showSpinner=!1,this.comboItems=void 0,this.comboWidth=void 0,this.comboHeight=void 0,this.blurOnLeftRightKey="none",this.spinnerAlign="verticalRight",this.allowSpinLoop=!1,this.pickers={list:void 0,width:void 0,height:void 0},this.dropDownOpen=null,this.dropDownClose=null,this.initializing=null,this.initialized=null,this.triggerMouseDown=null,this.triggerMouseUp=null,this.dropDownButtonMouseDown=null,this.dropDownButtonMouseUp=null,this.textChanged=null,this.invalidInput=null}return t}();wijinputcore.prototype.options=$.extend(!0,{},wijmo.wijmoWidget.prototype.options,new wijinputcore_options);var wijInputResult=function(){function t(){this.characterEscaped=1,this.noEffect=2,this.sideEffect=3,this.success=4,this.unknown=0,this.hint=0,this.alphanumericCharacterExpected=-2,this.asciiCharacterExpected=-1,this.digitExpected=-3,this.invalidInput=-51,this.letterExpected=-4,this.nonEditPosition=-54,this.positionOutOfRange=-55,this.promptCharNotAllowed=-52,this.signedDigitExpected=-5,this.unavailableEditPosition=-53,
this.testPosition=-1,this.binaryExpected=-6}return t.prototype.clone=function(){var e=new t;return e.hint=this.hint,e.testPosition=this.testPosition,e},t}();input.wijInputResult=wijInputResult;var wijTextProvider=function(){function t(){}return t.prototype.setText=function(t,e){},t.prototype.toString=function(t,e,i,n,o){return""},t.prototype.insertAt=function(t,e,i){return!1},t.prototype.removeAt=function(t,e,i,n){},t.prototype.replaceWith=function(t,e){var i=t.start,n=new wijInputResult;return t.start<t.end&&(this.removeAt(t.start,t.end-1,n,!0),i=n.testPosition),this.insertAt(e,i,n)?n:null},t}();input.wijTextProvider=wijTextProvider;var Utility=function(){function Utility(){}return Utility.IdCounter=0,Utility.EditFieldSuffix="_EidtField",Utility.MaskValChar="\ufeff",Utility.Hold="g-C2",Utility.FireEvent=function(t,e,i,n){if(!e)return!1;try{e.call(window,t,i)}catch(o){return!1}return!0},Utility.FindIMControl=function(t){},Utility.ArrayIndexOf=function(t,e){if(t.indeOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},Utility.AttachEvent=function(t,e,i,n){null!==t&&void 0!==t&&(t.addEventListener?t.addEventListener(e,i,n):t.attachEvent&&t.attachEvent("on"+e,i))},Utility.AttachFocusEventOfDocument=function(){Utility.IsIE8OrBelow()?Utility.AttachEvent(document,"beforeactivate",function(t){Utility.FocusControlUpdate(t)},!0):Utility.AttachEvent(document,"focus",function(t){Utility.FocusControlUpdate(t)},!0)},Utility.FocusControlUpdate=function(t){Utility.PreviousFocusControl=Utility.FocusControl,Utility.FocusControl=t.target||t.srcElement},Utility.ToString=function(t,e,i,n){var o=t+"";if(null!=i){for(;o.length<e;)n?o+=i:o=i+o;return o}for(;o.length<e;)o+=t+"";return o},Utility.GetSelectionEndPosition=function(t){if(!Utility.IsIE()||Utility.IsIE11OrLater()){var e=0;if(e=t.selectionEnd,t.value){var i=t.value.substring(0,e);e=i.GetLength()}var n=0;if(n=t.selectionStart,t.value){var i=t.value.substring(0,n);n=i.GetLength()}return n>e&&(e=n),e}return Utility.GetSelectionStartPosition(t)+document.selection.createRange().text.GetLength()},Utility.GetSelectionStartPosition=function(t){if(null!=t.selectionStart){var e=0;if(e=t.selectionStart,t.value){var i=t.value.substring(0,e);e=i.GetLength()}var n=0;if(n=t.selectionEnd,t.value){var i=t.value.substring(0,n);n=i.GetLength()}return e>n&&(e=n),e}try{for(var o=t.createTextRange(),r=document.selection.createRange(),s=t.value.GetLength(),a=0,l=s,h=0;l>a;){h=Math.floor((a+l)/2),o=t.createTextRange();for(var d=h,i=t.value.Substring(0,h);;){var c=i.IndexOf("\r\n");if(-1==c)break;d--,i=i.Substring(c+2,i.GetLength())}var u=h-d;if(d=h-u,o.moveStart("character",d),o.offsetTop>r.offsetTop)l=h;else if(o.offsetTop<r.offsetTop){if(a==h)return l;a=h}else if(o.offsetLeft>r.offsetLeft)l=h;else{if(!(o.offsetLeft<r.offsetLeft))return"\r"==t.value.Substring(h-1,h)&&h++,h;if(a==h)return l;a=h}}return s}catch(p){return 0}},Utility.GetCursorPosition=function(t,e){if(null==t)return-1;if(!Utility.IsIE()||Utility.IsIE11OrLater()){var i=0;if(i=t.selectionStart,t.value){var n=t.value.substring(0,i);i=n.GetLength()}return i}var o=0;if(document.selection){t.focus();var r=document.selection.createRange();r.moveStart("character",-t.value.length),o=r.text.length}return o},Utility.GetPasteData=function(t){return Utility.GetDataFromClipboard(t)},Utility.GetDataFromClipboard=function(t){return 0==t?Utility.SavedText:window.clipboardData?window.clipboardData.getData("Text"):null!==Utility.CutCopyPasteEventObject&&void 0!==Utility.CutCopyPasteEventObject.clipboardData?Utility.CutCopyPasteEventObject.clipboardData.getData("text"):null},Utility.ClearSelection=function(t){Utility.IsIE()&&!Utility.IsIE11OrLater()?""!=document.selection.createRange().text&&document.selection.empty():""!=Utility.GetSelectionText(t)&&(t.selectionStart=t.value.length,t.selectionEnd=t.selectionStart)},Utility.GetSelectionText=function(t){if(null!=t.selectionStart)return t.value.substring(t.selectionStart,t.selectionEnd);if(null!=document.selection)return document.selection.createRange().text;if(null!==document.activeElement){var t=document.activeElement,e=t.selectionStart,i=t.selectionEnd;return t.value.substring(e,i)}return""},Utility.GetNextFocusableControl=function(t,e,i){for(var n=0,o=0;o<e.length;o++)if(t===e[o]){n=i?(o+1)%e.length:(o-1+e.length)%e.length;break}return e[n]},Utility.FireSystemEvent=function(t,e){if(Utility.IsIE())t.fireEvent(e);else{var i=document.createEvent("HTMLEvents");i.initEvent(e.substring(2,e.length),!0,!0),t.dispatchEvent(i)}},Utility.GetTextBoxScrollWidth=function(t,e){return Utility.MeasureText(t.value,t).Width},Utility.MoveFocus=function(t,e){var i=Utility.GetElements(),n=Utility.GetNextFocusableControl(t,i,e);return Utility.SetElementFocus(n),n},Utility.SetElementFocus=function(t){t.focus()},Utility.GetAllElements=function(){return document.body.querySelectorAll?document.body.querySelectorAll("button, input, object, select, textarea"):document.body.all?document.body.all:document.body.getElementsByTagName("*")},Utility.GetElements=function(){for(var t=[],e=Utility.GetAllElements(),i=0,n=/^(?:button|input|object|select|textarea)$/i,o=0;o<e.length;o++)if(document.body.querySelectorAll&&!Utility.IsIE()||n.test(e[o].tagName.toLowerCase())){var r=!e[o].disabled,s="hidden"!==e[o].style.visibility,a="hidden"!=e[o].type&&-1!=e[o].tabIndex,l="textarea"==e[o].tagName.toLowerCase()&&-1!=e[o].tabIndex,h=a||l;r&&s&&h&&(t[i++]=e[o])}for(var o=0;o<t.length-1;o++)for(var d=o+1;d<t.length;d++)if(t[d].tabIndex<t[o].tabIndex){var c=t[o];t[o]=t[d],t[d]=c}return t},Utility.CheckInt=function(t,e,i){var n=parseInt(t);if(isNaN(n))throw"value is invalid";if(e>n||n>i)throw t+" is out of range, should between "+e+" and "+i;return n},Utility.CheckFloat=function(t,e,i){var n=parseFloat(t);if(isNaN(n))throw"value is invalid";if(e>t||t>i)throw t+" is out of range, should between "+e+" and "+i;return n},Utility.CheckDate=function(t,e,i){if(!(t instanceof Date))throw"Type is invalid";if(isNaN(t))throw"Date is a invalid date";if(void 0!=i&&(e>t||t>i))throw t+" is out of range, should between "+e+" and "+i},Utility.CheckBool=function(t){return"string"==typeof t&&"true"===t.toLowerCase()?!0:1==t},Utility.CheckFunction=function CheckFunction(fun){if(void 0===fun||null===fun)return null;if("string"==typeof fun){if(fun=Utility.Trim(fun),0==fun.length)return null;try{eval("fun ="+fun)}catch(e){}}if("function"==typeof fun)return fun;throw"The value is not a valid function"},Utility.GetCheckElement=function(){if(null==Utility.CheckElement){var t=document.createElement("div");Utility.CheckElement=t,t.style.display="none"}return Utility.CheckElement},Utility.CheckString=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return null==t&&(t=""),t.toString();throw t+" type is not a string."},Utility.GetCSSLength=function(t){var e=parseInt(t);return isNaN(e)?0:e},Utility.CheckCSSLength=function(t){return t=Utility.CheckInt(t,0,Math.pow(2,31)),parseInt(t)==t&&(t+="px"),Utility.GetCheckElement().style.width="",Utility.GetCheckElement().style.width=t,Utility.GetCheckElement().style.width},Utility.CheckFontSizeValue=function(t){return parseInt(t)==t&&(t+="px"),Utility.GetCheckElement().style.fontSize="",Utility.GetCheckElement().style.fontSize=t,Utility.GetCheckElement().style.fontSize},Utility.CheckColor=function(t){return Utility.GetCheckElement().style.backgroundColor="",Utility.GetCheckElement().style.backgroundColor=t,Utility.GetCheckElement().style.backgroundColor},Utility.CheckImageUrl=function(t){return Utility.CheckString(t)},Utility.GetCssImageUrl=function(t){return t.startWith('url("')?t=t.substring(5,t.length-2):t.startWith("url(")&&(t=t.substring(4,t.length-1)),t},Utility.CheckCssImageUrl=function(t){return t.length>0&&!t.startWith("url(")&&(t="url("+t+")"),Utility.GetCheckElement().style.backgroundImage="",Utility.GetCheckElement().style.backgroundImage=t,Utility.GetCheckElement().style.backgroundImage},Utility.CheckEnum=function(t,e){for(var i in t)if(t[i]==e||t[i]==e.toLowerCase())return t[i];throw"Enum value is invalid"},Utility.CheckChar=function(t){if(t=Utility.CheckString(t),1!==t.length)throw"Invalid value";return t},Utility.GetMultipleStringEnum=function(t){var e=t.split(" ");return e.sort(),e.join(",")},Utility.CheckMultipleStringEnum=function(t,e){for(var i=e.split(","),n=[],o=0;o<i.length;o++)n.push(Utility.CheckEnum(t,Utility.Trim(i[o])));return n.join(" ")},Utility.EncodingToHTML=function(t){if(-1!=t.IndexOf("&")){for(var e=t,i="";-1!=e.IndexOf("&");){var n=e.IndexOf("&");e=e.replace("&","&amp;"),i+=e.Substring(0,n+5),e=e.Substring(n+5,e.GetLength())}-1==e.IndexOf("&")&&""!=e&&(i+=e),t=i}for(;-1!=t.IndexOf(" ");)t=t.replace(" ","&nbsp;");for(;-1!=t.IndexOf("<");)t=t.replace("<","&lt;");for(;-1!=t.IndexOf(">");)t=t.replace(">","&gt;");return t},Utility.DecodingFromHTML=function(t){for(;-1!=t.IndexOf("&nbsp;");)t=t.replace("&nbsp;"," ");for(;-1!=t.IndexOf("&lt;");)t=t.replace("&lt;","<");for(;-1!=t.IndexOf("&gt;");)t=t.replace("&gt;",">");if(-1!=t.IndexOf("&amp;")){for(var e=t,i="";-1!=e.IndexOf("&amp;");){var n=e.IndexOf("&amp;");e=e.replace("&amp;","&"),i+=e.Substring(0,n+1),e=e.Substring(n+1,e.GetLength())}-1==e.IndexOf("&amp;")&&""!=e&&(i+=e),t=i}return t},Utility.IsStandCompliantModeOn=function(){return Utility.IsIE()?"CSS1Compat"==document.compatMode:"CSS1Compat"==document.compatMode||"BackCompat"==document.compatMode},Utility.GetPageZoomRate=function(){if(Utility.IsIE()&&8===Utility.engine)return screen.deviceXDPI/screen.logicalXDPI;var t=document.getElementById("gcsh_standard_control_for_get_normal_position");if("undefined"!=typeof t&&null!=t)return document.getElementById("gcsh_standard_control_for_get_normal_position").offsetLeft/100;var e=document.createElement("div");return document.body.appendChild(e),e.id="gcsh_standard_control_for_get_normal_position",e.style.visibility="hidden",e.style.left="100px",e.style.top="1px",e.style.width="1px",e.style.height="1px",e.style.position="absolute",document.getElementById("gcsh_standard_control_for_get_normal_position").offsetLeft/100},Utility.GetElementPosition=function(t){if(Utility.IsIE()||Utility.chrome||Utility.safari){if(Utility.engine>=8){var e=Utility.GetElementPositionForIE8(t);if(0==e.Left&&0==e.Top){var i=Utility.GetElementPositionForFireFox(t);return i}return e}var n=Utility.GetElementPositionForIE(t);return{Left:n.Left,Top:n.Top}}return Utility.GetElementPositionForFireFox(t)},Utility.GetElementPositionForIE8=function(t){var e=t;"string"==typeof t&&(e=document.getElementById(t));var i=0,n=0;if(null==e||e.self||9===e.nodeType)return{Left:n,Top:i};var o=e.getBoundingClientRect();if(!o)return{Left:n,Top:i};var r=e.ownerDocument.documentElement,n=o.left+r.scrollLeft,i=o.top+r.scrollTop;try{var s=e.ownerDocument.parentWindow.frameElement||null;if(s){var a="0"===s.frameBorder||"no"===s.frameBorder?2:0;n+=a,i+=a}}catch(l){}return{Left:n,Top:i}},Utility.GetElementPositionForIE=function(t){var e=t;"string"==typeof t&&(e=document.getElementById(t));var i=0,n=0;if(null==e)return{Left:n,Top:i};if(e.offsetParent)for(;null!=e.offsetParent;){var o=e.offsetParent,r=o.tagName.toLowerCase();if("table"!=r&&"body"!=r&&"html"!=r&&o.clientTop&&o.clientLeft&&(n+=o.clientLeft,i+=o.clientTop),7==Utility.engine&&"relative"==o.style.position.toLowerCase()){n+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop;var s=Utility.GetPageZoomRate();if(1==s){for(var a=e.offsetTop,l=0;l<o.children.length;l++){var h=o.children[l];if(h==e)break;if(h.offsetTop){a=h.offsetTop;break}}i-=a}}else if(!Utility.IsStandCompliantModeOn()||7!=Utility.engine||"absolute"!=e.style.position.toLowerCase()&&"relative"!=e.style.position.toLowerCase())"input"==e.tagName.toLowerCase()&&"text"==e.type.toLowerCase()||"textarea"==e.tagName.toLowerCase()?(i+=e.offsetTop,n+=e.offsetLeft):(i+=e.offsetTop-e.scrollTop,n+=e.offsetLeft-e.scrollLeft);else{var s=Utility.GetPageZoomRate();i+=(e.offsetTop-e.scrollTop)/s,n+=(e.offsetLeft-e.scrollLeft)/s}e=o}else e.left&&e.top?(n+=e.left,i+=e.top):(e.x&&(n+=e.x),e.y&&(i+=e.y));if("relative"!=e.style.position.toLowerCase()&&"absolute"!=e.style.position.toLowerCase()&&"body"==e.tagName.toLowerCase()&&Utility.IsStandCompliantModeOn())if(7!=Utility.engine)i+=e.offsetTop,n+=e.offsetLeft;else{var d=parseInt(e.currentStyle.marginTop),c=parseInt(e.currentStyle.marginLeft);isNaN(d)&&(d=0),isNaN(c)&&(c=0),i+=d,n+=c}return{Left:n,Top:i}},Utility.GetElementPositionForFireFox=function(t){var e=t;"string"==typeof t&&(e=document.getElementById(t));var i=0,n=0,o=0,r=0;if(null==e)return{Left:n,Top:i};if(e.offsetParent)for(;null!=e.offsetParent;){var s=e.offsetParent.tagName.toLowerCase();"table"!=s&&"body"!=s&&"html"!=s&&"div"!=s&&e.offsetParent.clientTop&&e.offsetParent.clientLeft&&(n+=e.offsetParent.clientLeft,i+=e.offsetParent.clientTop),i+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent}else e.left&&e.top?(n+=e.left,i+=e.top):(e.x&&(n+=e.x),e.y&&(i+=e.y));if(e=t,"string"==typeof t&&(e=document.getElementById(t)),e.parentElement)for(;null!=e.parentElement&&"html"!=e.tagName.toLowerCase();)r+=e.scrollTop,o+=e.scrollLeft,e=e.parentElement;return i-=r,n-=o,"relative"!=e.style.position.toLowerCase()&&"absolute"!=e.style.position.toLowerCase()&&"body"==e.tagName.toLowerCase()&&Utility.IsStandCompliantModeOn()&&(i+=e.offsetTop,n+=e.offsetLeft),{Left:n,Top:i}},Utility.MeasureText=function(t,e){if(void 0===Utility.MeasureElement){var i=document.createElement("div");i.style.position="absolute",i.style.border="solid 0px",i.style.left="-100000px",i.style.top="-100000px";var n=window.document.createTextNode("");i.appendChild(n),document.body.appendChild(i),Utility.MeasureElement=i,Utility.MeasureTextElement=n}var i=Utility.MeasureElement,n=Utility.MeasureTextElement;if(null!=document){var o=document.body.contains(e);o||document.body.appendChild(e);var r=e.currentStyle||window.getComputedStyle(e,null);i.style.fontFamily=r.fontFamily,i.style.fontSize=r.fontSize,i.style.fontStyle=r.fontStyle,i.style.fontWeight=r.fontWeight,o||document.body.removeChild(e)}var s=null;if("string"==typeof t)n.nodeValue=t,s={Width:i.clientWidth,Height:i.clientHeight};else{s=[];for(var a=0;a<t.length;a++)n.nodeValue=t[a],s.push({Width:i.clientWidth,Height:i.clientHeight})}return s},Utility.GetOSDefaultFontFamily=function(){switch(Utility.GetClientOS().toLowerCase()){case"winxp":return"MS UI Gothic";case"vista":return"¥á¥¤¥ê¥ª";case"win7":return"¥á¥¤¥ê¥ª";case"win8":return"Meiryo UI";case"win2003":return"MS UI Gothic";case"win2000":return"MS UI Gothic"}return"MS UI Gothic"},Utility.IsTouchSupport=function(){return-1!=window.navigator.userAgent.toLowerCase().indexOf("touch")},Utility.DisabledHoldVisual=function(t){null!==t&&void 0!==t&&Utility.IsTouchSupport()&&Utility.IsIE10OrLater()&&(t.addEventListener("MSHoldVisual",function(t){t.preventDefault()},!1),t.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),t.addEventListener("contextmenu",function(t){t.preventDefault()},!1))},Utility.IsMouseDownOnClearButton=function(t){if(!Utility.IsIE10OrLater())return!1;for(var e=0;e<document.styleSheets.length;e++)for(var i=document.styleSheets[e],n=0;n<i.cssRules.length;n++)if("::-ms-clear"==i.cssRules[n].selectorText&&"none"==i.cssRules[n].style.display)return!1;var o=t.offsetX,r=t.offsetY,s=t.srcElement||t.target,a=s.clientWidth,l=s.clientHeight,h=parseInt(s.currentStyle.paddingLeft),d=parseInt(s.currentStyle.paddingRight);if(s.readOnly||t.button!=MouseButton.Left)return!1;if(a-l+h+d<Utility.GetClearButtonShowThreshold(s))return!1;var c=a-l;return o>c&&a>=o&&r>=0&&l>r?!0:!1},Utility.GetClearButtonShowThreshold=function(t){var e=Utility.MeasureText("ABCDQ",t).Height,i=4.3604432*e-.76207324;return i=Math.round(i)},Utility.IsFocusFromIMControl=function(t,e){try{for(var i=e.fromElement;null!=i;){if(i.id==t||i.id==t+this.Hold+"_DropDownObj"||i.id==t+"_DropDown_Container"||i.id==t+"_ContextMenu"||i.id==t+"_HistoryList"||i.id==t+"_EditField"||i.id==t+"_BorderContainer"||i.id==t+"_DropDown_EditField")return!0;i=i.parentNode}return!1}catch(n){return!1}},Utility.IsFocusToIMControl=function(t,e){try{for(var i=e.toElement;null!=i;){if(i.id==t||i.id==t+this.Hold+"_DropDownObj"||i.id==t+"_DropDown_Container"||i.id==t+"_ContextMenu"||i.id==t+"_HistoryList"||i.id==t+this.Hold+"_DropDownObj_PopupMonth"||i.id==t+"_EditField"||i.id==t+"_BorderContainer"||i.id==t+"_DropDown_EditField")return!0;i=i.parentNode}return!1}catch(n){return!1}},Utility.Trim=function(t){if(""==t)return"";for(var e=0,i=0,n=0;n<t.length;n++)if(" "!=t.CharAt(n)&&"¡¡"!=t.CharAt(n)){e=n;break}for(var n=t.length-1;n>=0;n--)if(" "!=t.CharAt(n)&&"¡¡"!=t.CharAt(n)){i=n+1;break}try{var o=t.Substring(e,i);return o}catch(r){return t}},Utility.GetBrowserType=function(){var t=navigator.userAgent.toLowerCase();if(-1!=t.indexOf("msie"))Utility.ie=t.match(/msie ([\d.]+)/)[1];else if(-1!=t.indexOf("chrome"))Utility.chrome=t.match(/chrome\/([\d.]+)/)[1];else if(-1!=t.indexOf("safari")){var e=t.match(/version\/([\d.]+)/);e&&(Utility.safari=e[1])}else-1!=t.indexOf("firefox")?Utility.firefox=t.match(/firefox\/([\d.]+)/)[1]:-1!=t.indexOf("opera")&&(Utility.opera=t.match(/opera.([\d.]+)/)[1]);-1!=t.indexOf("ipad")&&(Utility.IPad=!0),Utility.engine=null,"Microsoft Internet Explorer"==window.navigator.appName&&(document.documentMode?Utility.engine=document.documentMode:(Utility.engine=5,document.compatMode&&"CSS1Compat"==document.compatMode&&(Utility.engine=7),Utility.ie&&0==Utility.ie.indexOf("6")&&(Utility.engine=6))),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(Utility.ie=Utility.engine=t.match(/rv:([\d.]+)/)[1])},Utility.GetTouchPath=function(t,e){return-1===t||-1===e?"Error":t>e?t-e>20?"ToTop":"NotMove":e>t&&e-t>20?"ToBottom":"NotMove"},Utility.IsPad=function(){var t=Utility.IPad||"android"==Utility.GetClientOS().toLowerCase();return t},Utility.IsJapan=function(){return navigator.userLanguage?-1!=navigator.userLanguage.indexOf("ja"):navigator.language?-1!=navigator.language.indexOf("ja"):!1},Utility.IsFireFox4OrLater=function(){return null!=Utility.firefox&&parseFloat(Utility.firefox)>=4},Utility.IsIE11OrLater=function(){return Utility.IsIE()&&Utility.engine>=11},Utility.IsIE10OrLater=function(){return Utility.IsIE()&&Utility.engine>=10},Utility.IsIE9OrLater=function(){return Utility.IsIE()&&Utility.engine>=9},Utility.IsIE8OrLater=function(){return Utility.IsIE()&&Utility.engine>=8},Utility.IsIE8OrBelow=function(){return Utility.IsIE()&&Utility.engine<=8},Utility.IsIE8=function(){return Utility.IsIE()&&8==Utility.engine},Utility.IsIE7=function(){return Utility.IsIE()&&7==Utility.engine},Utility.IsIE7OrLater=function(){return Utility.IsIE()&&Utility.engine>=7},Utility.IsIE=function(){return void 0!==Utility.ie},Utility.IsIE9=function(){return Utility.IsIE()&&9==Utility.engine},Utility.GetClientOS=function(){var t;if(Utility.IsIE())t=navigator.appVersion;else{var e=navigator.userAgent,i=e.indexOf("("),n=e.indexOf(")");t=e.substring(i+1,n)}return-1!=t.indexOf("NT 6.0")?"vista":-1!=t.indexOf("NT 5.2")?"win2003":-1!=t.indexOf("NT 5.1")?"winxp":-1!=t.indexOf("NT 5.0")?"win2000":-1!=t.indexOf("NT 6.1")?"Win7":-1!=t.indexOf("NT 6.2")?"Win8":-1!=t.indexOf("NT 6.3")?"Win8":-1!=t.indexOf("Android")?"Android":"unknow"},Utility.CreateStyleElement=function(t){var e=document.createElement("style");return e.id=t,e.type="text/css",e},Utility.CreateClassStyle=function(t){return Utility.CreateSelectorStyle("."+t)},Utility.CreateSelectorStyle=function(t){var e=document.getElementById("tableStyle");null==e&&(e=this.CreateStyleElement("tableStyle"),document.body.appendChild(e));var i=e.sheet||e.styleSheet,n=i.cssRules||i.rules;return i.insertRule?i.insertRule(t+"{ }",n.length):i.addRule(t,"{ }",n.length),n.item(n.length-1)},Utility.SetSelection=function(t,e,i,n){$(t).wijtextselection(Math.min(e,i),Math.max(e,i))},Utility.PreventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},Utility.CancelBubble=function(t){void 0!==t.cancelBubble?t.cancelBubble=!0:t.stopPropagation()},Utility.DragDrop=function(t){try{t.dragDrop(!0)}catch(e){}},Utility.GetMouseButton=function(t){var e=MouseButton.Default,i=Utility.IsIE8OrBelow()?1:0;return t.button==i?e=MouseButton.Left:1==t.button?e=MouseButton.Middle:2==t.button&&(e=MouseButton.Right),e},Utility.GetMouseWheelValue=function(t,e){return Utility.IsFireFox4OrLater()?-e.detail/3:(e.wheelDelta>=120?t++:e.wheelDelta<=-120&&t--,t)},Utility.SetCopy=function(t,e){var i;try{if((null==t||""==t)&&(document.selection&&(i=document.selection.createRange().text),""==i))return}catch(n){}null!=t&&(i=t),Utility.CopyDataToClipBoard(i,e)},Utility.CopyDataToClipBoard=function(t,e){return 0==e?void(Utility.SavedText=t):void(window.clipboardData?setTimeout(function(){try{window.clipboardData.setData("Text",t)}catch(e){}},0):null!==Utility.CutCopyPasteEventObject&&void 0!==Utility.CutCopyPasteEventObject.clipboardData&&Utility.CutCopyPasteEventObject.clipboardData.setData("text",t))},Utility.SetZoomStyle=function(t,e,i){if(void 0!==t&&null!==t){var n="top left";i===DropDownAlign.Right&&(n="top right"),Utility.firefox?(t.style.MozTransformOrigin=""===e?"":n,t.style.MozTransform=""===e?"":"scale("+e+")",t.setAttribute("ZoomValue",e)):Utility.chrome||Utility.safari?""!==e?(t.style.MozTransform="scale("+e+")",t.style.WebkitTransform="scale("+e+")",t.style.webkitTransformOrigin=n):(t.style.MozTransform="",t.style.WebkitTransform="",t.style.WebkitTransformOrigin=""):Utility.IsIE9OrLater()?""!==e?(t.style.msTransform="scale("+e+")",t.style.msTransformOrigin=n):(t.style.msTransform="",t.style.msTransformOrigin=""):t.style.zoom=e}},Utility.FilterText=function(t,e){if(0==e.GetLength())return"";var i="",n=0,o=0;for(n=0;n<e.GetLength();n++){var r=!1;for(o=0;o<t.GetLength();o++)e.Substring(n,n+1)==t.Substring(o,o+1)&&(r=!0);1==r&&(i+=e.Substring(n,n+1))}return i},Utility.IndexOfAny=function(t,e,i){if(i>=t.length)return-1;for(var n=i;n<t.length;n++)for(var o=0;o<e.length;o++)if(t.charAt(n)==e[o])return n;return-1},Utility}();input.Utility=Utility,Utility.GetBrowserType();var CharType=function(){function t(){this.OtherChar=0,this.Control=1,this.Numeric=2,this.MathSymbol=3,this.Symbol=4,this.Punctuation=5,this.Space=6,this.UpperCase=7,this.LowerCase=8,this.Katakana=9,this.Hiragana=10,this.FarEastPunctation=11,this.Hangul=12,this.FullWidth=32768}return t}();input.CharType=CharType;var CharCategory=function(){function t(){this.MinValue="\x00",this.MaxValue="￿",this.ANSISTART=0,this.ANSIEND=255,this.BOTHWIDTHSTART=65280,this.BOTHWIDTHEND=65519,this.FULLALPHASTART=65281,this.FULLUPPERSTART=65313,this.FULLUPPEREND=65338,this.FULLALPHAEND=65374,this.CJKHALFSYMBOLSTART=65377,this.CJKHALFSYMBOLEND=65380,this.KANAHALFSTART=65381,this.KANAHALFEND=65439,this.HANGULHALFSTART=65440,this.HANGULHALFEND=65500,this.FULLSYMBOLSTART=65504,this.FULLSYMBOLEND=65510,this.HALFPUNCTSTART=65512,this.HALFPUNCTEND=65518,this.KATAKANA_VOICED="ﾞ",this.KATAKANA_SEMIVOICED="ﾟ",this.Tab="	",this.Space=" ",this._charstarts=["\x00","","Ā","ƀ","ɐ","ʰ","̀","Ͱ","Ѐ","԰","֐","؀","܀","ހ","ऀ","ঀ","਀","઀","଀","஀","ఀ","ಀ","ഀ","඀","฀","຀","ༀ","က","Ⴀ","ᄀ","ሀ","Ꭰ","᐀"," ","ᚠ","ក","᠀","Ḁ","ἀ"," ","⁰","₠","⃐","℀","⅐","←","∀","⌀","␀","⑀","①","─","▀","■","☀","✀","⠀","⺀","⼀","⿰","　","぀","゠","㄀","㄰","㆐","ㆠ","㈀","㌀","㐀","一","ꀀ","꒐","가","豈","ﬀ","ﭐ","︠","︰","﹐","ﹰ","＀","￰"],this.Blocks=["BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"],this._fullhalfblocks=["！","０","：","Ａ","［","ａ","｛","｡","･","ﾠ","￠","￨"],this._halfkana=["・","ヲ","ァ","ィ","ゥ","ェ","ォ","ャ","ュ","ョ","ッ","ー","ア","イ","ウ","エ","オ","カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","タ","チ","ツ","テ","ト","ナ","ニ","ヌ","ネ","ノ","ハ","ヒ","フ","ヘ","ホ","マ","ミ","ム","メ","モ","ヤ","ユ","ヨ","ラ","リ","ル","レ","ロ","ワ","ン","゙","゚"],this._fullkana=["ｧ","ｱ","ｨ","ｲ","ｩ","ｳ","ｪ","ｴ","ｫ","ｵ","ｶ","ｶ","ｷ","ｷ","ｸ","ｸ","ｹ","ｹ","ｺ","ｺ","ｻ","ｻ","ｼ","ｼ","ｽ","ｽ","ｾ","ｾ","ｿ","ｿ","ﾀ","ﾀ","ﾁ","ﾁ","ｯ","ﾂ","ﾂ","ﾃ","ﾃ","ﾄ","ﾄ","ﾅ","ﾆ","ﾇ","ﾈ","ﾉ","ﾊ","ﾊ","ﾊ","ﾋ","ﾋ","ﾋ","ﾌ","ﾌ","ﾌ","ﾍ","ﾍ","ﾍ","ﾎ","ﾎ","ﾎ","ﾏ","ﾐ","ﾑ","ﾒ","ﾓ","ｬ","ﾔ","ｭ","ﾕ","ｮ","ﾖ","ﾗ","ﾘ","ﾙ","ﾚ","ﾛ","ﾜ","ﾜ","ｨ","ｪ","ｦ","ﾝ","ｳ","ｶ","ｹ","ﾜ","ｨ","ｪ","ｦ","･","ｰ"],this._fullkanaSmall=["ｧ","ｨ","ｩ","ｪ","ｫ","ｬ","ｭ","ｮ","ｯ"],this._accentkana=[0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0],this._feQuotes=["‘","’","“","”"],this._jpnMixed=["ー"],this._jpnSpecialFull=["　","、","。","「","」","“","”","‘","’","゛","゜","￥"],this._jpnSpecialHalf=[" ","､","｡","｢","｣",'"','"',"'","'","ﾞ","ﾟ","¥"];var t=new CharType;this._mwtable=[t.Symbol|t.FullWidth,t.Numeric|t.FullWidth,t.Symbol|t.FullWidth,t.UpperCase|t.FullWidth,t.Symbol|t.FullWidth,t.LowerCase|t.FullWidth,t.Symbol|t.FullWidth,t.FarEastPunctation,t.Katakana,t.Hangul,t.Symbol|t.FullWidth,t.Symbol]}return t}();input.CharCategory=CharCategory;var CharProcess=function(){function t(){this.CharCategory=new CharCategory,this.Ctype=new CharType}return t.LowerKana="ぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮｧｨｩｪｫｬｭｮｯヵヶゕゖ",t.UpperKana="あいうえおつやゆよわアイウエオツヤユヨワｱｲｳｴｵﾔﾕﾖﾂカケかけ",t.FullWidthSymbolArray=["、","。","，","．","・","：","；","？","！","゛","゜","´","｀","¨","＾","￣","＿","ヽ","ヾ","ゝ","ゞ","〃","仝","々","〆","〇","ー","—","‐","／","〜","‖","｜","…","‥","‘","’","“","”","（","）","〔","〕","［","］","｛","｝","〈","〉","《","》","「","」","『","』","【","】","＋","−","±","×","÷","＝","≠","＜","＞","≦","≧","∞","∴","♂","♀","°","′","″","℃","￥","＄","¢","£","％","＃","＆","＊","＠","§","☆","★","○","●","◎","◇","◆","□","■","△","▲","▽","▼","※","〒","→","←","↑","↓","〓","＇","＂","－","〳","〴","〵","〻","〼","ヿ","ゟ","∈","∋","⊆","⊇","⊂","⊃","∪","∩","⊄","⊅","⊊","⊋","∉","∅","⌅","⌆","∧","∨","¬","⇒","⇔","∀","∃","⊕","⊖","⊗","∥","∦","⦅","⦆","〘","〙","〖","〗","∠","⊥","⌒","∂","∇","≡","≒","≪","≫","√","∽","∝","∵","∫","∬","≢","≃","≅","≈","≶","≷","↔","Å","‰","♯","♭","♪","†","‡","¶","♮","♫","♬","♩","◯","＼","～","￠","￡","￢","―"],t.HalfWidthSymbolArray=["\\","~","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","]","^","_","`","{","|","}","｡","｢","｣","､","･","¡","¤","¥"],t.CharEx=new t,t.prototype.ToHalfKatakana=function(t){var e="";if(this.IsFullWidth(t)){if(this.IsKatakana(t)){var i=t,n=i.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(0>n||n>91)return i;i=this.CharCategory._fullkana[n];var o=this.CharCategory._accentkana[n];o>0&&(i+=String.fromCharCode(1==o?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0))),e=i}else if(this.IsHiragana(t)){var i=String.fromCharCode(t.charCodeAt(0)-this.CharCategory._charstarts[61].charCodeAt(0)+this.CharCategory._charstarts[62].charCodeAt(0)),n=i.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(0>n||n>91)return i;i=this.CharCategory._fullkana[n];var o=this.CharCategory._accentkana[n];o>0&&(i+=String.fromCharCode(1==o?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0))),e=i}}else this.IsKatakana(t)&&(e=t);return e},t.prototype.GetCharType=function(t){var e=this.Ctype.OtherChar,i=this.BelongTo(t);if(""==t||t>="\x00"&&"">=t||t>=""&&"">=t)return this.Ctype.Control;if(t>="A"&&"Z">=t)return this.Ctype.UpperCase;if(t>="a"&&"z">=t)return this.Ctype.LowerCase;if(t>="0"&&"9">=t)return this.Ctype.Numeric;switch((this.IsFullWidthSymbol(t)||this.IsHalfWidthSymbol(t))&&(e=this.Ctype.Symbol),(8216==t.charCodeAt(0)||8217==t.charCodeAt(0)||8220==t.charCodeAt(0)||8221==t.charCodeAt(0))&&(e=this.Ctype.Punctuation),12288==t.charCodeAt(0)&&(e=this.Ctype.Space),this.CharCategory.Blocks[i]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return this.MultiWidthDetails(t);case"KATAKANA":return this.Ctype.Katakana|this.Ctype.FullWidth;case"HIRAGANA":return this.Ctype.Hiragana|this.Ctype.FullWidth}return this.IsFarEastBlock(i,t)&&(e|=this.Ctype.FullWidth),e},t.prototype.IsCharOfType=function(t,e){return this.GetCharType(t)==e},t.prototype.IsMultiWidth=function(t){var e=this.BelongTo(t),i=this.CharCategory.Blocks[e];return"KATAKANA"==i||"CJK_SYMBOLS_AND_PUNCTUATION"==i||"HALFWIDTH_AND_FULLWIDTH_FORMS"==i||"BASIC_LATIN"==i&&t>=" "},t.prototype.IsFullWidthSymbol=function(e){for(var i=0;i<t.FullWidthSymbolArray.length;i++)if(e===t.FullWidthSymbolArray[i])return!0;return!1},t.prototype.IsHalfWidthSymbol=function(e){for(var i=0;i<t.HalfWidthSymbolArray.length;i++)if(e===t.HalfWidthSymbolArray[i])return!0;return!1},t.prototype.IsFullWidth=function(t){if(this.IsFullWidthSymbol(t))return!0;if(this.IsHalfWidthSymbol(t))return!1;var e=this.BelongTo(t),i=this.IsFarEastBlock(e,t);return"HALFWIDTH_AND_FULLWIDTH_FORMS"==this.CharCategory.Blocks[e]&&(i=(this.MultiWidthDetails(t)&this.Ctype.FullWidth)==this.Ctype.FullWidth),i},t.prototype.IsSurrogatePair=function(t){return t.charCodeAt(0)>="�".charCodeAt(0)&&t.charCodeAt(0)<="�".charCodeAt(0)&&t.charCodeAt(1)>="�".charCodeAt(0)&&t.charCodeAt(1)<="�".charCodeAt(0)?!0:!1},t.prototype.IsSurrogate=function(t){return null!=t&&t.charCodeAt(0)>="�".charCodeAt(0)&&t.charCodeAt(0)<="�".charCodeAt(0)},t.prototype.IsOther=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.OtherChar},t.prototype.IsControl=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.Control},t.prototype.IsKatakana=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.Katakana},t.prototype.IsSmallHalfKatakana=function(t){var e=new Array("ァ","ィ","ゥ","ェ","ォ","ャ","ュ","ョ","ッ","ヮ"),i=t;t.charCodeAt(0)>this.CharCategory.KANAHALFSTART&&(i=this.CharCategory._halfkana[t.charCodeAt(0)-this.CharCategory.KANAHALFSTART]);for(var n=0;n<e.length;n++)if(i==e[n])return!0;return!1},t.prototype.IsHiragana=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.Hiragana||this.CharCategory._jpnMixed[0]==t},t.prototype.IsShiftJIS=function(t){return!1},t.prototype.IsJISX0208=function(t){return!1},t.prototype.IsDigit=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.Numeric},t.prototype.IsPunctuation=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.Punctuation},t.prototype.IsMathSymbol=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.MathSymbol},t.prototype.IsSymbol=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.Symbol},t.prototype.IsLower=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.LowerCase},t.prototype.IsUpper=function(t){return(this.GetCharType(t)&~this.Ctype.FullWidth)==this.Ctype.UpperCase},t.prototype.IsDigitOrSymbol=function(t){return this.IsDigit(t)||this.IsMathSymbol(t);
},t.prototype.IsAlphabet=function(t){return this.IsUpper(t)||this.IsLower(t)},t.prototype.IsAlphaOrDigit=function(t){return this.IsUpper(t)||this.IsLower(t)||this.IsDigit(t)},t.prototype.IsUpperKana=function(t){return!this.IsLowerKana(t)},t.prototype.IsLowerKana=function(e){return-1!=t.LowerKana.search(e)},t.prototype.HasLowerKana=function(e){return-1!=t.UpperKana.search(e)||this.IsLowerKana(e)},t.prototype.ToUpperKana=function(e){var i=t.LowerKana.search(e);return-1==i?e:t.UpperKana.substr(i,1)},t.prototype.ToLowerKana=function(e){var i=t.UpperKana.search(e);return i>=t.UpperKana.length-4&&i<t.UpperKana.length?e:-1==i?e:t.LowerKana.substr(i,1)},t.prototype.ToLower=function(t){return this.IsUpper(t)?String.fromCharCode(t.charCodeAt(0)+32):t},t.prototype.ToUpper=function(t){return this.IsLower(t)?String.fromCharCode(t.charCodeAt(0)-32):t},t.prototype.IsSpace=function(t){return" "==t||"　"===t},t.prototype.ToFullWidth=function(t){var e={text:"",processedAll:!1};if(e.text=t,e.processedAll=!1,0==t.length)return e;var i=t.Substring(0,1);if(this.IsMultiWidth(i)){if(i<this.CharCategory._charstarts[1]){if(" "==i)return e.text="　",e;var n="!";return e.text=String.fromCharCode(i.charCodeAt(0)-n.charCodeAt(0)+(this.CharCategory._charstarts[81].charCodeAt(0)+1)),e}if((this.MultiWidthDetails(i)&this.Ctype.Katakana)==this.Ctype.Katakana){if(i.charCodeAt(0)<this.CharCategory.KANAHALFSTART){var o=this.GetFullHalfWidthSpecialChar(i,!0);return e.text=""!==o?o:i,e}if(i=this.CharCategory._halfkana[i.charCodeAt(0)-this.CharCategory.KANAHALFSTART],t.length<2)return e.text=i,e;var r=t.charCodeAt(1)-(this.CharCategory.KATAKANA_VOICED.charCodeAt(0)-1);if(1==r||2==r){e.processedAll=!0;var s=this.CharCategory._accentkana[i.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1)];0!=s&&((2&Math.abs(s))==r&&(i=String.fromCharCode(i.charCodeAt(0)+1)),i=String.fromCharCode(i.charCodeAt(0)+1))}1==r&&"ウ"==i&&(i="ヴ")}}return e.text=i,e},t.prototype.ToHalfWidth=function(t){return this.ToHalfWidthEx(t)},t.prototype.ToHalfWidthEx=function(t){var e=this.GetCharType(t),i=this.IsMultiWidth(t);if((e&this.Ctype.FullWidth)==this.Ctype.FullWidth)switch(e&~this.Ctype.FullWidth){case this.Ctype.Punctuation:case this.Ctype.UpperCase:case this.Ctype.LowerCase:case this.Ctype.Symbol:case this.Ctype.Numeric:case this.Ctype.MathSymbol:var n=this.GetFullHalfWidthSpecialChar(t,!1);if(""!==n)t=n;else if(i){var o="!";t=String.fromCharCode(t.charCodeAt(0)-(this.CharCategory._charstarts[81].charCodeAt(0)+1)+o.charCodeAt(0))}break;case this.Ctype.Katakana:var r=t.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(0>r||r>91)return t;t=this.CharCategory._fullkana[r];var s=this.CharCategory._accentkana[r];if(s>0)return t+=String.fromCharCode(1==s?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0));break;case this.Ctype.Space:t=" ";break;case this.Ctype.Hangul:}return t},t.prototype.ToKatakana=function(t){if(!this.IsCharOfType(t,this.Ctype.Hiragana|this.Ctype.FullWidth))return t;var e=this.GetFullHalfWidthSpecialChar(t,!1);return""!==e?e:String.fromCharCode(t.charCodeAt(0)-this.CharCategory._charstarts[61].charCodeAt(0)+this.CharCategory._charstarts[62].charCodeAt(0))},t.prototype.ToHiragana=function(t){return this.IsKatakana(t)?(this.IsFullWidth(t)||(t=this.ToFullWidth(t).text),this.IsCharOfType(t,this.Ctype.Katakana|this.Ctype.FullWidth)?t>="ヷ"&&"ヿ">=t?t:"ヵ"==t?"か":"ヶ"==t?"け":String.fromCharCode(t.charCodeAt(0)+this.CharCategory._charstarts[61].charCodeAt(0)-this.CharCategory._charstarts[62].charCodeAt(0)):t):t},t.prototype.ToBigHalfKatakana=function(t){if(!this.IsSmallHalfKatakana(t))return t;var e=this.CharCategory._halfkana[t.charCodeAt(0)-this.CharCategory.KANAHALFSTART];return e=String.fromCharCode(e.charCodeAt(0)+1)},t.prototype.BelongTo=function(t){for(var e=0,i=83,n=i>>1;i-e>1;)t>=this.CharCategory._charstarts[n]?e=n:i=n,n=i+e>>1;return n},t.prototype.MultiWidthDetails=function(t){for(var e=0,i=this.CharCategory._fullhalfblocks.length,n=i>>1;i-e>1;)t>=this.CharCategory._fullhalfblocks[n]?e=n:i=n,n=i+e>>1;return this.CharCategory._mwtable[n]},t.prototype.IsFarEastBlock=function(t,e){switch(this.CharCategory.Blocks[t]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return!0;default:for(var i=0;i<this.CharCategory._feQuotes.length;i++)if(e==this.CharCategory._feQuotes[i])return!0;if(e.charCodeAt(0)>255)return!0;if(8216==e.charCodeAt(0)||8217==e.charCodeAt(0)||8220==e.charCodeAt(0)||8221==e.charCodeAt(0))return!0}return!1},t.prototype.GetFullHalfWidthSpecialChar=function(t,e){if(1==e)var i=this.CharCategory._jpnSpecialHalf,n=this.CharCategory._jpnSpecialFull;else var i=this.CharCategory._jpnSpecialFull,n=this.CharCategory._jpnSpecialHalf;for(var o=-1,r=0;r<i.length;){if(i[r]==t){o=r;break}r++}return-1!=o&&r<n.length?n[r]:""},t}();input.CharProcess=CharProcess,function(t){t._map=[],t.None=0,t.Click=1,t.ContextMenu=2,t.ClientEvent=3,t.KeyExit=4,t.Default=5,t.SpinButton=6,t.DropDown=7,t.ImeInput=8,t.Left=9,t.Right=10,t.DragDrop=11}(input.FocusType||(input.FocusType={}));var FocusType=input.FocusType;!function(t){t._map=[],t.Default=0,t.Era=1,t.Year=2,t.Month=3,t.Day=4,t.AMPM=5,t.Hour=6,t.Minute=7,t.Second=8}(input.DateCursorPosition||(input.DateCursorPosition={}));var DateCursorPosition=input.DateCursorPosition;!function(t){t._map=[],t.NoControl=0,t.Filter=1,t.Cut=2}(input.CrLfMode||(input.CrLfMode={}));var CrLfMode=input.CrLfMode;!function(t){t._map=[],t.IncludeLiterals=0,t.ExcludeLiterals=1}(input.ClipContent||(input.ClipContent={}));var ClipContent=input.ClipContent;!function(t){t._map=[],t.Insert=0,t.Overwrite=1,t.FixedInsert=2,t.FixedOverwrite=3}(input.EditMode||(input.EditMode={}));var EditMode=input.EditMode;!function(t){t._map=[],t.Always=1,t.PostDisplay=2,t.PreDisplay=3}(input.ShowLiterals||(input.ShowLiterals={}));var ShowLiterals=input.ShowLiterals;!function(t){t._map=[],t.None=0,t.Left=1,t.Right=2,t.Both=3}(input.ExitOnLeftRightKey||(input.ExitOnLeftRightKey={}));var ExitOnLeftRightKey=input.ExitOnLeftRightKey;!function(t){t._map=[],t.None=0,t.Field=1,t.All=2}(input.HighlightText||(input.HighlightText={}));var HighlightText=input.HighlightText;!function(t){t._map=[],t.Default=-1,t.Left=0,t.Middle=1,t.Right=2}(input.MouseButton||(input.MouseButton={}));var MouseButton=input.MouseButton;!function(t){t._map=[],t.Left=1,t.Right=2}(input.DropDownAlign||(input.DropDownAlign={}));var DropDownAlign=input.DropDownAlign;!function(t){t._map=[],t._map[0]="Automatic",t.Automatic=0,t._map[1]="Fixed",t.Fixed=1}(input.ScrollBarMode||(input.ScrollBarMode={}));var ScrollBarMode=input.ScrollBarMode;!function(t){t._map=[],t._map[0]="None",t.None=0,t._map[1]="Horizontal",t.Horizontal=1,t._map[2]="Vertical",t.Vertical=2,t._map[3]="Both",t.Both=3}(input.ScrollBars||(input.ScrollBars={}));var ScrollBars=input.ScrollBars;!function(t){t._map=[],t.Normal=0,t.Hover=1,t.Pressed=2,t.Focused=4,t.Disabled=8}(input.ControlStatus||(input.ControlStatus={}));var ControlStatus=input.ControlStatus;!function(t){t._map=[],t.Tab=1,t.ShiftTab=2,t.NextControl=3,t.PreviousControl=4,t.Right=5,t.Left=6,t.CtrlRight=7,t.CtrlLeft=8,t.CharInput=9}(input.ExitKeys||(input.ExitKeys={}));var ExitKeys=input.ExitKeys;!function(t){t._map=[],t.Control=0,t.Field=1}(input.TabAction||(input.TabAction={}));var TabAction=input.TabAction;!function(t){t._map=[],t.BackSpace=8,t.Tab=9,t.Clear=12,t.Enter=13,t.Shift=16,t.Control=17,t.Alt=18,t.Pause=19,t.Caps_Lock=20,t.Escape=27,t.Space=32,t.PageUp=33,t.PageDown=34,t.End=35,t.Home=36,t.Left=37,t.Up=38,t.Right=39,t.Down=40,t.Select=41,t.Print=42,t.Execute=43,t.Insert=45,t.Delete=46,t.Help=47,t.equalbraceright=48,t.exclamonesuperior=49,t.quotedbltwosuperior=50,t.sectionthreesuperior=51,t.dollar=52,t.percent=53,t.ampersand=54,t.slashbraceleft=55,t.parenleftbracketleft=56,t.parenrightbracketright=57,t.A=65,t.B=66,t.C=67,t.D=68,t.E=69,t.F=70,t.G=71,t.H=72,t.I=73,t.J=74,t.K=75,t.L=76,t.M=77,t.N=78,t.O=79,t.P=80,t.Q=81,t.R=82,t.S=83,t.T=84,t.U=85,t.V=86,t.W=87,t.X=88,t.Y=89,t.Z=90,t.KP_0=96,t.KP_1=97,t.KP_2=98,t.KP_3=99,t.KP_4=100,t.KP_5=101,t.KP_6=102,t.KP_7=103,t.KP_8=104,t.KP_9=105,t.KP_Multiply=106,t.KP_Add=107,t.KP_Separator=108,t.KP_Subtract=109,t.KP_Decimal=110,t.KP_Divide=111,t.F1=112,t.F2=113,t.F3=114,t.F4=115,t.F5=116,t.F6=117,t.F7=118,t.F8=119,t.F9=120,t.F10=121,t.F11=122,t.F12=123,t.F13=124,t.F14=125,t.F15=126,t.F16=127,t.F17=128,t.F18=129,t.F19=130,t.F20=131,t.F21=132,t.F22=133,t.F23=134,t.F24=135,t.Num_Lock=136,t.Scroll_Lock=137}(input.Key||(input.Key={}));var Key=input.Key,BaseUIProcess=function(){function t(){this.isMulSelected=!1,this.isDblClick=!1,this.isTriClick=!1,this.isOverWrite=!1,this.moveFocusExitOnLastChar=!1}return t.prototype.GetInputElement=function(){return this.Owner.GetInputElement()},t.prototype.GetElementId=function(){return this.Owner.GetInputElement().id},t.prototype.GetShowLiterals=function(){return void 0!==this.Owner.GetShowLiterals?this.Owner.GetShowLiterals():ShowLiterals.Always},t.prototype.SetCursorPositionAndSelection=function(t,e,i,n){var o={};return(1==t||t==HighlightText.All)&&(o.SelectionStart=0,o.SelectionEnd=e.GetLength()),o},t.prototype.Clear=function(){return null},t.prototype.Focus=function(t){var e=t.Text,i=t.DisplayText,n=t.FocusType,o=t.Element,r=t.HighlightText,s=t.CursorPosition,a={};if(this.isMulSelected=!1,n==FocusType.Click&&(a.SelectionStart=Utility.GetCursorPosition(o),a.SelectionEnd=a.SelectionStart),a.Text=e,-1==a.SelectionStart?(a.SelectionStart=0,a.SelectionEnd=0):a.SelectionStart>a.Text.GetLength()?(a.SelectionStart=a.Text.GetLength(),a.SelectionEnd=a.Text.GetLength()):a.SelectionStart==i.GetLength()&&(a.SelectionStart=a.Text.GetLength(),a.SelectionEnd=a.Text.GetLength()),n==FocusType.Left&&s==DateCursorPosition.Default?(a.SelectionStart=0,a.SelectionEnd=0):n==FocusType.Right&&s==DateCursorPosition.Default&&(a.SelectionStart=a.Text.GetLength(),a.SelectionEnd=a.Text.GetLength()),r==HighlightText.None&&s==DateCursorPosition.Default)return a;if(n==FocusType.ContextMenu)return a;var l=null==a.SelectionStart?t.SelectionStart:a.SelectionStart,h=this.SetCursorPositionAndSelection(r,a.Text,s,l);return null!=h&&(a.SelectionStart=h.SelectionStart,a.SelectionEnd=h.SelectionEnd,a.IsSelectionDeterminedByHighlightText=!0),a},t.prototype.LoseFocus=function(t){},t.prototype.MouseDown=function(t){var e={};return this.isTriClick=!1,this.isDblClick&&!Utility.GrapeCityTimeout&&t==MouseButton.Left&&(this.isTriClick=!0,e=this.SelectAll()),this.isDblClick=!1,e},t.prototype.MouseUp=function(t,e,i,n,o){var r={};return this.isTriClick?(Utility.SetSelection(t,e,i),null):o?(r=this.SelectAll(),Utility.SetSelection(t,r.SelectionStart,r.SelectionEnd),r):(r.SelectionStart=e,r.SelectionEnd=i,n==MouseButton.Left&&(r.SelectionStart=Utility.GetSelectionStartPosition(t),r.SelectionEnd=Utility.GetSelectionEndPosition(t)),r.SelectionStart!=r.SelectionEnd?this.isMulSelected=!0:this.isMulSelected=!1,r)},t.prototype.ProcessShortcutKey=function(t,e,i,n){var o={};switch(t){case"Clear":return e?(o.System=!1,o):this.Clear();case"NextControl":var r=this.MoveControl(this.GetInputElement(),!0,!1,"NextControl");return null!=r&&(o.EventInfo=r.EventInfo,o.FocusType=r.FocusType,o.FocusExit=!0),o.System=!1,o;case"PreviousControl":var r=this.MoveControl(this.GetInputElement(),!1,!1,"PreviousControl");return null!=r&&(o.EventInfo=r.EventInfo,o.FocusType=r.FocusType,o.FocusExit=!0),o.System=!1,o;case"NextField":return o=this.MoveField(i,!0);case"PreviousField":return o=this.MoveField(i,!1);case"NextField/NextControl":var o=this.MoveFieldAndControl(i,!0);return o;case"PreviousField/PreviousControl":var o=this.MoveFieldAndControl(i,!1);return o}},t.prototype.ProcessCharKeyInput=function(t,e,i,n,o){return null},t.prototype.ProcessNavigatorKeyInput=function(t,e,i,n,o,r,s,a){var l={};switch(t){case 45:return e==EditMode.FixedInsert?this.isOverWrite=!1:e==EditMode.FixedOverwrite?this.isOverWrite=!0:this.isOverWrite=!this.isOverWrite,l.Overwrite=this.isOverWrite,l.System=!1,0==this.Format.Fields.fieldCount&&(l.System=!0),l;case 8:l=this.ProcessBackSpace(o,r,n),l.System=!1;break;case 46:l=this.ProcessDelete(o,r,n),l.System=!1;break;case 196643:case 196644:case 196645:case 196647:case 65569:case 196641:case 65570:case 196642:65569==t||196641==t?t=196644:(65570==t||196642==t)&&(t=196643),l.SelectionEnd=this.GetCaretPosition(r,t),this.isMulSelected=!0,l.System=!1;break;case 65582:case 65544:if(this.isMulSelected){if(!this.Owner._isSupportClipBoard()){l.System=!0;break}l=this.Cut(i,o,r)}else l=this.ProcessBackSpace(o,r);l.System=!1;break;case 65581:case 131158:if(this.Owner._isSupportClipBoard()){var h=Utility.GetPasteData(this.Owner?this.Owner.GetUseClipboard():!0);l=this.Paste(o,r,h,a),l.System=!1}else l.System=!0;break;case 65571:case 65572:case 65573:case 65575:case 65574:case 65576:this.isMulSelected=!0,l.SelectionEnd=this.GetCaretPosition(r,t),l.System=!1;break;case 131139:case 131117:this.Owner._isSupportClipBoard()?(this.Copy(i,o,r),l.System=!1):l.System=!0;break;case 131118:this.isMulSelected||(r=this.GetCaretPosition(r,t)),l=this.ProcessDelete(o,r),l.System=!1;break;case 131080:case 196616:this.isMulSelected||(r=this.GetCaretPosition(r,t)),l=this.ProcessBackSpace(o,r),l.System=!1;break;case 131137:l=this.SelectAll(),l.System=!1;break;case 131160:this.Owner._isSupportClipBoard()?(l=this.Cut(i,o,r),l.System=!1):l.System=!0;break;case 131162:l=this.Undo(),l.System=!1;break;case 131109:case 37:if(0==o&&(s==ExitOnLeftRightKey.Both||s==ExitOnLeftRightKey.Left)){var d=37==t?"Left":"CtrlLeft",c=this.MoveControl(this.GetInputElement(),!1,!0,d);return null!=c&&(l.EventInfo=c.EventInfo,l.FocusType=c.FocusType,l.FocusExit=!0),l}case 131108:case 131110:case 36:case 33:case 131105:(33==t||131105==t)&&(t=131108),l=this.ProcessLeftDirection(o,r,t),l.System=!1;break;case 131111:case 39:if(o==n.GetLength()&&(s==ExitOnLeftRightKey.Both||s==ExitOnLeftRightKey.Right)){var d=39==t?"Right":"CtrlRight",c=this.MoveControl(this.GetInputElement(),!0,!0,d);return null!=c&&(l.EventInfo=c.EventInfo,l.FocusType=c.FocusType,l.FocusExit=!0),l}case 131107:case 131112:case 35:case 34:case 131106:(34==t||131106==t)&&(t=131107),l=this.ProcessRightDirection(o,r,t),l.System=!1;break;default:l=null}return l},t.prototype.ProcessLeftDirection=function(t,e,i){},t.prototype.ProcessRightDirection=function(t,e,i){},t.prototype.KeyDown=function(t){var e=t.KeyCode,i=t.SelectionStart,n=t.SelectionEnd,o=t.Text,r=t.EditMode,s=t.KeyAction,a=t.ReadOnly,l=t.ClipContent,h=t.ExitOnLastChar,d=t.ExitOnLeftRightKey,c=t.TabAction,u={};switch(r){case EditMode.Insert:this.isOverWrite=!1;break;case EditMode.Overwrite:this.isOverWrite=!0;break;case EditMode.FixedInsert:this.isOverWrite=!1;break;case EditMode.FixedOverwrite:this.isOverWrite=!0}switch(i!=n?this.isMulSelected=!0:this.isMulSelected=!1,e){case 9:return u=this.ProcessTabKey(n,!0,c);case 65545:return u=this.ProcessTabKey(n,!1,c)}if(null!=s)return this.ProcessShortcutKey(s,a,n,i);if(a){if(27==e||262182==e||262184==e||38==e||40==e)return null;if(131117!=e&&131139!=e&&9!=e&&65545!=e&&131081!=e&&196617!=e&&131137!=e&&37!=e&&39!=e&&38!=e&&40!=e)return u}if(0==this.Format.Fields.fieldCount){switch(e){case 45:return r==EditMode.FixedInsert?this.isOverWrite=!1:r==EditMode.FixedOverwrite?this.isOverWrite=!0:this.isOverWrite=!this.isOverWrite,u.Overwrite=this.isOverWrite,0==this.Format.Fields.fieldCount&&(u.System=!0),u;case 37:case 131109:if(0==i&&(d==ExitOnLeftRightKey.Both||d==ExitOnLeftRightKey.Left)){var p=37==e?"Left":"CtrlLeft",g=this.MoveControl(this.GetInputElement(),!1,!0,p);return null!=g&&(u.EventInfo=g.EventInfo,u.FocusType=g.FocusType,u.FocusExit=!0),u}break;case 39:case 131111:if(i==o.GetLength()&&(d==ExitOnLeftRightKey.Both||d==ExitOnLeftRightKey.Right)){var p=39==e?"Right":"CtrlRight",g=this.MoveControl(this.GetInputElement(),!0,!0,p);return null!=g&&(u.EventInfo=g.EventInfo,u.FocusType=g.FocusType,u.FocusExit=!0),u}}return null}var f=this.ProcessCharKeyInput(e,i,n,h,o);return null!=f?f:u=this.ProcessNavigatorKeyInput(e,r,l,o,i,n,d,h)},t.prototype.KeyPress=function(t){},t.prototype.KeyUp=function(t){},t.prototype.ShowContextMenu=function(t,e){var i={};return""==e&&(i.SelectionStart=Utility.GetCursorPosition(t),i.SelectionEnd=i.SelectionStart),i},t.prototype.SelectStart=function(t,e,i){var n={};return""==e&&!this.isTriClick&&!this.isDblClick&&i!=MouseButton.Default&&(n.SelectionStart=Utility.GetCursorPosition(t),n.SetFalse=!0),n},t.prototype.DoubleClick=function(t){var e={},i=this.Format.Fields.GetFieldIndexByPos(t),n=this.Format.Fields.GetFieldRange(i.index);return e.SelectionStart=n.start,e.SelectionEnd=n.length+n.start,Utility.GrapeCityTimeout=!1,this.isDblClick=!0,this.isMulSelect=!0,setTimeout(function(){Utility.GrapeCityTimeout=!0},300),e},t.prototype.Undo=function(){},t.prototype.Cut=function(t,e,i){var n={};return e==i?n:(this.FireClientEvent("OnBeforeCut"),this.Copy(t,e,i),n=this.ProcessDelete(e,i),this.FireClientEvent("OnCut"),n)},t.prototype.Copy=function(e,i,n){var o=null,r=!0;if(e==ClipContent.ExcludeLiterals){var s=Math.abs(i-n),i=Math.min(i,n);if(0==s)return;o=this.Format.Fields.GetNonLiteralsText(i,s)}else o=!Utility.IsIE()||Utility.IsIE11OrLater()?Utility.GetSelectionText(this.Owner.GetInputElement()):document.selection.createRange().text;this.Owner&&(o=t.UpdateCrLfString(o,this.Owner.GetAcceptsCrlf()),r=this.Owner.GetUseClipboard()),Utility.IsIE()?setTimeout(function(){Utility.SetCopy(o,r)}):Utility.SetCopy(o,r)},t.prototype.Paste=function(t,e,i,n){},t.prototype.SelectAll=function(){var t={SelectionStart:0,SelectionEnd:0};t.SelectionStart=0;var e;return this.ID&&(e=this.GetShowLiterals()),"PostDisplay"==e||"PreDisplay"==e?t.SelectionEnd=Utility.FindIMControl(this.ID).GetText().GetLength():t.SelectionEnd=this.Format.Fields.GetLength(),this.isMulSelected=!0,t},t.prototype.FireEvent=function(t,e,i,n){return Utility.FireEvent(t,e,i,n)?FocusType.ClientEvent:void 0},t.prototype.ProcessCharKey=function(t,e,i,n){var o={},r=Math.min(t,e),s=Math.abs(e-t),a={};if(o.start=r,o.success=!1,-1==this.Format.Fields.GetFieldIndex(r).index){var l={};return l.Name=this.Owner.InvalidInputEvent,l.Args=null,l.Type="invalidInput",o.EventInfo=l,o}var h=i.toString();if(0!=s||this.isOverWrite)if(0==s)if(r==this.Format.Fields.GetLength())a=this.Format.Fields.Insert(r,h,!1);else{var d=!1,c=this.Format.Fields.GetFieldIndexByPos(r),u=c.index,p=c.offset,g=this.Format.Fields.GetFieldRange(u);if("PromptField"==this.Format.Fields.GetFieldByIndex(u).fieldLabel?r-p+g.length==this.Format.Fields.GetLength()?d=!1:(d=!0,s=g.length-p+1):(d=!0,s=i.GetLength()),-1==this.Format.Fields.GetFieldIndexByPos(r+s).index){var l={};return l.Name=this.Owner.InvalidInputEvent,l.Args=null,l.Type="invalidInput",o.EventInfo=l,o}a=d?this.Format.Fields.Replace(r,s,h,!1):this.Format.Fields.Insert(r,h,!1)}else a=this.Format.Fields.Replace(r,s,h,!1);else a=this.Format.Fields.Insert(r,h,!1);if(r=a.cursorPos,""!=a.text){var l={};return l.Name=this.Owner.InvalidInputEvent,l.Args=null,l.Type="invalidInput",o.EventInfo=l,o.start=r,o.success=!1,o}if(1==n)if(r==this.Format.Fields.GetLength())this.moveFocusExitOnLastChar=!0;else{var c=this.Format.Fields.GetFieldIndexByPos(r),u=c.index,p=c.offset;u==this.Format.Fields.fieldCount-1&&0==p&&"PromptField"==this.Format.Fields.GetFieldByIndex(u).fieldLabel&&(this.moveFocusExitOnLastChar=!0)}return o.start=r,o.success=!0,o},t.prototype.ProcessDeleteKey=function(t,e){var i=Math.min(t,e),n=Math.abs(t-e),o={};if(i==this.Format.Fields.GetLength()&&0==n)return o;var r,s=this.Format.Fields.GetFieldIndexByPos(i);if(r=s.index,-1==r)return o;if(0==n){if("PromptField"==this.Format.Fields.GetFieldByIndex(r).fieldLabel)return o;i=this.Format.Fields.Delete(i,1).cursorPos,o.SelectionStart=i,o.SelectionEnd=o.SelectionStart}else{var a,l;if(s=this.Format.Fields.GetFieldIndexByPos(i+n),a=s.offset,l=s.index,-1==l)return o;if(0==a&&l--,r==l&&"PromptField"==this.Format.Fields.GetFieldByIndex(r).fieldLabel)return o;var h=this.Format.Fields.Delete(i,n);if(!h.isSucceed)return o;o.SelectionStart=h.cursorPos,0==o.SelectionStart&&"PromptField"==this.Format.Fields.GetFieldByIndex(0).fieldLabel&&(o.SelectionStart=this.Format.Fields.GetFieldByIndex(0).GetLength()),o.SelectionEnd=o.SelectionStart;var d,c,u=this.Format.Fields.GetFieldIndexByPos(o.SelectionStart);c=u.index,d=u.offset,0!=d&&"PromptField"==this.Format.Fields.GetFieldByIndex(c).fieldLabel&&(o.SelectionStart=o.SelectionStart-d+this.Format.Fields.GetFieldByIndex(c).GetLength(),o.SelectionEnd=o.SelectionStart)}return o},t.prototype.ProcessBackSpace=function(t,e,i){},t.prototype.ProcessDelete=function(t,e,i){},t.prototype.GetCaretPosition=function(t,e,i,n,o){var r=this.Format.Fields,s=r.GetFieldIndexByPos(t),a=s.index,l=s.offset,h,i,n,d=0;switch(e){case 36:case 65572:case 65574:return i>=t?0:i;case 35:case 65571:case 65576:return t>=n?r.GetLength():n;case 37:if(0==t)return 0;r.GetFieldByIndex(a).fieldLabel==o?l>0?t-=l:t--:0==l&&r.GetFieldByIndex(a-1).fieldLabel==o?t-=r.GetFieldRange(a-1).length:t--;break;case 39:if(t==r.GetLength())return t;if(r.GetFieldByIndex(a).fieldLabel==o){if(h=r.GetFieldRange(a),i=h.start,n=i+h.length,n>t)return n}else t++;break;case 131109:if(0==t||0==a)return 0;if(r.GetFieldByIndex(a).fieldLabel==o)h=r.GetFieldRange(a-1),t=h.start;else{if(0==l){for(d=a-1;d>=0;d--)if(r.GetFieldByIndex(d).fieldLabel!=o)return h=r.GetFieldRange(d),h.start;return 0}t-=l}break;case 196645:if(0==t||0==a)return 0;0==l?(h=r.GetFieldRange(a-1),t=h.start):t-=l;break;case 131111:if(t==r.GetLength()||a==r.fieldCount-1)return r.GetLength();if(r.GetFieldByIndex(a).fieldLabel!=o){for(d=a+1;d<r.fieldCount;d++)if(r.GetFieldByIndex(d).fieldLabel!=o)return h=r.GetFieldRange(d),h.start;return r.GetLength()}h=r.GetFieldRange(a+1),t=h.start;break;case 196647:if(t==r.GetLength()||a==r.fieldCount-1)return r.GetLength();h=r.GetFieldRange(a+1),t=h.start;break;case 131118:return t==r.GetLength()||r.GetFieldByIndex(a).fieldLabel==o?t:(h=r.GetFieldRange(a),h.start+h.length);case 131080:case 196616:if(0==t||r.GetFieldByIndex(a).fieldLabel==o&&0==a)return t;if(r.GetFieldByIndex(a).fieldLabel==o)return r.GetFieldRange(a-1).start;if(0==l){for(d=a-1;d>=0;d--)if(r.GetFieldByIndex(d).fieldLabel!=o)return h=r.GetFieldRange(d),h.start;return t}t-=l;break;case 196643:case 131107:case 131112:return r.GetLength();case 196644:case 131108:case 131110:return 0;case 65573:return 0==t?0:--t;case 65575:return t==r.GetLength()?t:++t}return t},t.prototype.CompareShortcut=function(t,e){if(-1==e.toString().IndexOf("|"))return e==t?!0:!1;for(var i=null;-1!=i;){i=e.toString().IndexOf("|");var n=e.toString().GetLength();if(e.Substring(0,-1==i?n:i)==t)return!0;e=e.Substring(i+1,n)}return!1},t.prototype.MoveControl=function(t,e,i,n){var o=Utility.GetElements(),r=null,s={};if(o.length<2)return null;var a=Utility.GetNextFocusableControl(t,o,e);if("CharInput"!=n&&Utility.IsIE()?Utility.SetElementFocus(a):(Utility.NextID=a,setTimeout(function(){Utility.SetElementFocus(a)},0)),i){var l=document.getElementById(a);if(null!=l&&("textarea"==l.tagName.toLowerCase()||"text"==l.type)&&Utility.IsIE()){var h=l.createTextRange();("Left"==n||"CtrlLeft"==n)&&(h.moveStart("character",l.value.length),h.select())}}var d={Key:ExitKeys.CharInput};switch(n){case"NextControl":d.Key=ExitKeys.NextControl;break;case"PreviousControl":d.Key=ExitKeys.PreviousControl;break;case"Right":d.Key=ExitKeys.Right;break;case"Left":d.Key=ExitKeys.Left;break;case"CtrlRight":d.Key=ExitKeys.CtrlRight;break;case"CtrlLeft":d.Key=ExitKeys.CtrlLeft;break;case"CharInput":d.Key=ExitKeys.CharInput}return r={},r.Name=this.Owner.KeyExitEvent,r.Args=d,r.Type="KeyExit",null!=r&&(s.EventInfo=r),s},t.prototype.MoveField=function(t,e){var i=this.Format.Fields.MoveField(t,e),n={};return-1==i?(n.NextPos=i,n):(n.SelectionStart=i,n.SelectionEnd=i,n)},t.prototype.ProcessTabKey=function(t,e,i){var n={Key:ExitKeys.Tab},o={};e?n.Key=ExitKeys.Tab:n.Key=ExitKeys.ShiftTab;var r={};return r.Name=this.Owner.KeyExitEvent,r.Args=n,r.Type="KeyExit",o.EventInfo=r,o.FocusType=FocusType.KeyExit,o.System=!0,o},t.prototype.MoveFieldAndControl=function(t,e){var i=this.MoveField(t,e);if(-1!=i.NextPos)return i;var n=e?"NextControl":"PreviousControl",o=this.MoveControl(this.GetInputElement(),e,!1,n);return null!=o&&(i.EventInfo=o.EventInfo,i.FocusType=o.FocusType,i.FocusExit=!0),i},t.prototype.DragStart=function(){},t.prototype.DragEnd=function(){},t.prototype.Drop=function(){},t.prototype.DragOver=function(){},t.prototype.GetKeyActionName=function(t,e){if(null==e)return null;var i=e,n=new Array,o=i.IndexOf(","),r=0;if(""!=e){for(;-1!=o;)n[r++]=i.Substring(0,o),i=i.Substring(o+1,i.GetLength()),o=i.IndexOf(",");n[r++]=i;for(var s=0;r>s;s+=2)if(this.IsKeyCodeContained(t,n[s+1]))return n[s]}return null},t.prototype.IsKeyCodeContained=function(t,e){for(var i=e,n=i.IndexOf("|");-1!=n;){if(i.Substring(0,n)==t)return!0;i=i.Substring(n+1,i.GetLength()),n=i.IndexOf("|")}return i==t?!0:!1},t.prototype.FireClientEvent=function(t){},t.prototype.PerformSpin=function(t,e,i){},t.UpdateCrLfString=function(t,e){var i=t;if(t)if(e==CrLfMode.Filter)i=t.replace(new RegExp("[\r\n]","g"),"");else if(e==CrLfMode.Cut){var n=t.split(new RegExp("[\r\n]","g"));i=n.length>0?n[0]:""}return i},t.FilterReturnChar=function(t){return null!=t&&(t=t.replace(new RegExp("[\r]","g"),"")),t},t}();input.BaseUIProcess=BaseUIProcess;var InputUIUpdate=function(){function t(t){this.Owner=t}return t.prototype.SetLastClientValues=function(t){},t.prototype.GetText=function(){return null!=this.Owner.GetInputElement()?this.Owner.GetInputElement().value:void 0},t.prototype.SetText=function(t){null!=this.GetText()&&this.GetText().replace(/\r\n/g,"\n")!=t.replace(/\r\n/g,"\n")&&null!=this.Owner.GetInputElement()&&(this.Owner.GetInputElement().value=t)},t.prototype.SetFocus=function(){try{null!=this.Owner.GetInputElement()&&this.Owner.GetInputElement().focus()}catch(t){}},t.prototype.GetTextHAlign=function(){return null!==this.Owner.GetInputElement()?this.Owner.GetInputElement().style.textAlign:""},t.prototype.SetTextHAlign=function(t){if(null!==this.Owner.GetInputElement()&&(this.Owner.GetInputElement().style.textAlign=t,Utility.IsIE())){var e=this.Owner.GetInputElement().style.width,i=parseInt(e);isNaN(i)&&(i=120),this.Owner.GetInputElement().style.width=i+1+"px";var n=this;setTimeout(function(){n.InputElement.style.width=e},0)}},t.prototype.SetForeColor=function(t){null!=this.Owner.GetInputElement()&&(this.Owner.GetInputElement().style.color=t)},t.prototype.WriteCssStyle=function(t){try{var e=document.getElementById("gcsh_InputManWeb_Style_Container");if(Utility.IsIE())e.styleSheet.cssText=t;else{for(var i=e.sheet,n=i.cssRules.length-1;n>=0;n--)i.deleteRule(n);for(var o=t.split("}"),r=0;r<o.length;r++){var s=o[r],a=s.indexOf("{");if(-1!=a){var t=s.substring(a+1);if(0!=t.length){var l=s.substring(0,a);i.insertRule(l+"{"+t+"}",i.cssRules.length)}}}}}catch(h){}},t.prototype.ClearCssStyle=function(){},t}();input.InputUIUpdate=InputUIUpdate;var GlobalEventHandler=function(){function t(){}return t.OnKeyDown=function(t,e,i){if(t.ImeMode!==!0||Utility.IsIE8OrBelow()){var n=e.keyCode;i&&(n|=524288);var o={};o.Shift=!1,o.Ctrl=!1,o.Alt=!1,e.shiftKey&&(o.Shift=!0),e.ctrlKey&&(o.Ctrl=!0),e.altKey&&(o.Alt=!0);var r=null;Utility.FuncKeysPressed=o;try{r=t.KeyDown(e)}catch(s){}return null!=r&&null!=r.KeyCode?(Utility.IsIE()&&(e.keyCode=r.KeyCode),void(Utility.IsIE()||(Utility.ShouldInvokeKeyPress=!1))):void(r?Utility.IsIE()?null!=e&&(e.returnValue=!0):Utility.ShouldInvokeKeyPress=!0:(Utility.PreventDefault(e),Utility.IsIE()||(Utility.ShouldInvokeKeyPress=!1)))}},t.OnKeyPress=function(t,e){if((118!==e.charCode&&120!==e.charCode&&99!==e.charCode||!e.ctrlKey)&&!(Utility.IPad&&e.charCode>256||46==e.keyCode&&e.shiftKey||t.ImeMode===!0)){var i=t;if(!(Utility.IsIE()||0!=e.charCode&&Utility.ShouldInvokeKeyPress)){if(!Utility.ShouldInvokeKeyPress||(38==e.keyCode||40==e.keyCode)&&"Edit"!=i.Type)return Utility.ShouldInvokeKeyPress=!0,Utility.PreventDefault(e),null!=i&&"Edit"==i.Type&&null!=i.DropDownObj&&i.DropDownObj.IsKeyFromDropDown&&(i.DropDownObj.IsKeyFromDropDown=!1),void 0;if(13!=e.keyCode||"Edit"!=i.Type)return}var n=e.keyCode||e.charCode;if(13!=n||"Edit"==i.Type){var o=String.fromCharCode(n);try{if(CharProcess.CharEx.IsSurrogate(o.charAt(0)))return void(i.IsSurrogateKeyPressing=!0)}catch(r){}if(null!=o){var s=null;try{s=t.KeyPress(o,e)}catch(r){}}if(!s)return void Utility.PreventDefault(e)}}},t.OnKeyUp=function(t,e){if(t.ImeMode!==!0||Utility.IsIE8OrBelow())try{var i=t;if(i.IsSurrogateKeyPressing)try{if(null!=i.InputElement){var n=i.InputElement.value,o=i.InputElement.selectionStart,r=n.substr(o-2,o);i.KeyPress(r,e)}}finally{i.IsSurrogateKeyPressing=!1}Utility.FuncKeysPressed={Shift:e.shiftKey,Ctrl:e.ctrlKey,Alt:e.altKey},i.KeyUp(e)}catch(s){}},t.OnCompositionStart=function(t,e){try{t.CompositionStart(e)}catch(i){}},t.OnCompositionUpdate=function(t,e){try{t.CompositionUpdate(e)}catch(i){}},t.OnCompositionEnd=function(t,e){try{t.CompositionEnd(e)}catch(i){}},t.OnWebkitEditableContentChanged=function(t,e){try{t.WebkitEditableContentChanged(e)}catch(i){}},t.OnMouseOver=function(t,e){try{t.MouseOver&&t.MouseOver()}catch(i){}},t.OnMouseOut=function(t,e){try{t.MouseOut()}catch(i){}},t.OnMouseMove=function(t,e){try{t.MouseMove&&t.MouseMove(e)}catch(i){}},t.OnMouseDown=function(t,e){if(!t.ImeMode||t.ImeMode!==!0||Utility.IsIE8OrBelow())try{t.MouseDown(e),Utility.IsIE()||(Utility.DragStartElementID=t)}catch(i){}},t.OnMouseUp=function(t,e){if(!t.ImeMode||t.ImeMode!==!0||Utility.IsIE8OrBelow())try{if(null!=t.MouseUpPointerType&&4!==t.MouseUpPointerType&&"mouse"!==t.MouseUpPointerType){var i={};for(var n in e)i[n]=e[n];setTimeout(function(e){t.MouseUp(i)},300)}else t.MouseUp(e);Utility.IsIE()||(Utility.DragStartElementID="")}catch(o){}},t.OnSelectStart=function(t,e){Utility.InnerSelect===!0&&0==Utility.ShouldFireOnSelectStart&&Utility.CancelBubble(e);var i=Utility.GetSelectionText(t.GetInputElement());("undefined"==typeof i||null==i)&&(i="");var n=null;try{n=t.SelectStart(i)}catch(o){}0==n&&Utility.PreventDefault(e)},t.OnDblClick=function(t,e){var i=null;try{i=t.DoubleClick()}catch(n){}i||Utility.PreventDefault(e)},t.OnHTML5BeforeCopy=function(t,e){try{Utility.CutCopyPasteEventObject=e?e.originalEvent:e,t.Copy(e)}catch(i){}finally{Utility.CutCopyPasteEventObject=null}},t.OnHTML5Cut=function(t,e){try{var i=t.GetInputElement(),n=i.value,o=i.selectionStart,r=i.selectionEnd;setTimeout(function(){i.value=n,i.selectionStart=o,i.selectionEnd=r,t.Cut(e)},0)}catch(s){}},t.OnHTML5Paste=function(t,e){try{if(Utility.chrome&&"android"!==Utility.GetClientOS().toLowerCase())Utility.CutCopyPasteEventObject=e?e.originalEvent:e,t.Paste(Utility.GetDataFromClipboard(!0)),Utility.PreventDefault(e);else{var i=t.SelectionStart,n=t.SelectionEnd;setTimeout(function(){"android"===Utility.GetClientOS().toLowerCase()&&(t.SelectionStart=i,t.SelectionEnd=n),t.isPasting=!0,t.ImeInput("DirectInput")},0)}}catch(o){}finally{Utility.CutCopyPasteEventObject=null}},t.OnMouseWheel=function(t,e){try{t.MouseWheel(e),t.ShouldCancelMouseWheelDefaultBehavior()&&Utility.PreventDefault(e)}catch(i){}},t.OnDragStart=function(t,e){try{t.DragStart()}catch(i){}},t.OnDragEnd=function(t,e){try{t.DragEnd(e)}catch(i){}},t.OnDrop=function(t,e){try{var i=e.originalEvent.dataTransfer.getData("Text");t.DragDrop(i,e)}catch(n){}},t.OnTouchStart=function(t,e){Utility.TouchStartTime=new Date,Utility.TouchStartEvt=e},t.OnTouchEnd=function(t,e){if(void 0!==Utility.TouchStartTime){Utility.TouchEndTime=new Date;var i=Utility.TouchEndTime.valueOf()-Utility.TouchStartTime.valueOf();
if(i>1e3){var n="";try{n=Utility.GetSelectionText(t.GetInputElement())}catch(o){}t.ShowContextMenu(n,Utility.TouchStartEvt),t.GetEnabled()&&Utility.PreventDefault(e)}Utility.TouchStartTime=void 0,Utility.TouchEndTime=void 0}},t.OnDragEnter=function(t,e){try{t.DragEnter()}catch(i){}},t.OnDragLeave=function(t,e){try{t.DragLeave()}catch(i){}},t.OnSelect=function(t,e){try{t&&t.Focused&&t.Select()}catch(i){}},t.OnPropertyChanged=function(t,e){try{t.PropertyChange(e)}catch(i){}},t.OnMSPointerUp=function(t,e){t.MSPointerUp(e)},t.OnMSPointerDown=function(t,e){try{t.MSPointerDown(e)}catch(i){}},t.OnMSGestureTap=function(t,e){try{t.MSGestureTap(e)}catch(i){}},t.OnEditFieldFocus=function(t,e){Utility.IsFocusFromIMControl(t._id,e)&&(Utility.IsIE()||Utility.HasGetFocus)||(Utility.IsOnFocus=!0,Utility.IsIE()||(Utility.HasGetFocus=!0),this.OnFocus(t,e))},t.OnEditFieldLoseFocus=function(e,i){try{var n=e;if(null!=n&&"Edit"==n.Type&&n.IsFocusToDropDownEdit)return void(n.IsFocusToDropDownEdit=!1);if(Utility.IsFocusToIMControl(e._id,i))return;if(Utility.firefox){if(Utility.IsOnFocus&&Utility.IsIE()&&Utility.IsOnActivate&&Utility.IsOnActivateControlID==e._id)return void(null!=Utility.FocusToBorder&&1==Utility.FocusToBorder&&(Utility.FocusToBorder=!1,n.SetInnerFocus()));Utility.FocusToBorder=!1,Utility.IsIE()?Utility.IsOnFocus=!1:Utility.HasGetFocus=!1}t.OnLostFocus(e,i),Utility.FuncKeysPressed={Shift:!1,Ctrl:!1,Alt:!1}}catch(o){}},t.OnFocusOut=function(t,e){if(Utility.FocusToBorder=!1,Utility.IsIE()&&e.toElement){var i=e.toElement.id;i==t._id+"_Inside_Div_Container"&&(Utility.FocusToBorder=!0)}return Utility.IsFocusToIMControl(t._id,e)?void(Utility.IsIE()&&Utility.engine>=9&&(Utility.IsOnActivate=!0,Utility.IsOnActivateControlID=t._id,Utility.IsOnFocus=!0)):(Utility.IsIE()&&Utility.IsOnActivate&&(Utility.IsOnActivate=!1,Utility.IsOnActivateControlID=""),void(Utility.IsOnFocus&&(Utility.IsOnFocus=!1)))},t.OnActivate=function(t,e){Utility.IsOnActivate=!0,Utility.IsOnActivateControlID=t._id,Utility.IsFocusFromIMControl(t._id,e)||(Utility.IsOnActivate=!0,Utility.IsOnActivateControlID=t._id)},t.OnDeActivate=function(t,e){Utility.IsFocusToIMControl(t._id,e)||(Utility.IsOnActivate=!1,Utility.IsOnActivateControlID="",Utility.IsOnFocus=!1)},t.OnFocus=function(t,e){try{var i=function(){t.Focus(),t.Focused=!0,Utility.IsPad()&&(t.IPadSelectionRefreshTimer=setInterval(function(){t.Select()},400))};Utility.IsIE()?i.call(this):setTimeout(i,0)}catch(n){}},t.OnLostFocus=function(t,e){try{t.LoseFocus(e),t.Focused=!1,Utility.IsPad()&&clearInterval(t.IPadSelectionRefreshTimer)}catch(i){}},t}();input.GlobalEventHandler=GlobalEventHandler,String.prototype.GetLength=function(){return this.length},String.prototype.Substring=function(t,e){return this.substring(t,e)},String.prototype.IndexOf=function(t,e){return this.indexOf(t,e)},String.prototype.LastIndexOf=function(t){return this.lastIndexOf(t)},String.prototype.CharAt=function(t){return this.charAt(t)}}(wijmo.input||(wijmo.input={}));var input=wijmo.input}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";function i(t,e){"undefined"==typeof e&&(e=2);var i=""+t;if(i.length>e)i=i.substr(i.length-e);else for(;i.length<e;)i="0"+i;return i}var n=jQuery,o=t.getKeyCodeEnum(),r=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype._createTextProvider=function(){this._textProvider=new l(this,this.options.dateFormat,this.options.displayFormat)},i.prototype._strToDate=function(t){return this._textProvider.parseDate(t)},i.prototype._beginUpdate=function(){var e,i=null;t.prototype._beginUpdate.call(this),this.options.minDate&&"string"==typeof this.options.minDate&&(this.options.minDate=this._strToDate(this.options.minDate)),this.options.maxDate&&"string"==typeof this.options.maxDate&&(this.options.maxDate=this._strToDate(this.options.maxDate)),void 0===this.options.date?!this.element.data("elementValue")||(e=this.element.data("elementValue")):"string"==typeof this.options.date?e=this.options.date:i=this.options.date,void 0===this.options.date&&(this.options.date=new Date),e&&(i=this._strToDate(e)),null==i&&(i=this.options.date),this._safeSetDate(i);var n=this._getCulture();null!=n&&(""==this.options.amDesignator&&(this.options.amDesignator=this._getStandardAMPM("AM")),""==this.options.pmDesignator&&(this.options.pmDesignator=this._getStandardAMPM("PM"))),this.element.data({defaultDate:null===i?i:new Date(this.options.date.getTime()),preDate:null===i?i:new Date(this.options.date.getTime())}),this._resetTimeStamp(),this._initPicker(),this.element.addClass(this.options.wijCSS.wijinputdate).attr({"aria-valuemin":new Date(1900,1,1),"aria-valuemax":new Date(2099,1,1),"aria-valuenow":this.options.date})},i.prototype._endUpdate=function(){var i=this;t.prototype._endUpdate.call(this),this.element.bind("click.wijinput",function(){if(i._allowEdit()){var t=i.options.activeField,n=i.element.wijtextselection();i._updateText(),i.element.wijtextselection(n),i._highLightCursor(),e.Utility.chrome&&1==i.element.data("needResoteActiveField")&&i._setOption("activeField",t)}})},i.prototype._getInnerNullText=function(){return null!=this.options.placeholder?this.options.placeholder:this.options.showNullText?this.options.nullText:null},i.prototype._getInnerAmDesignator=function(){return""==this.options.amDesignator?this._getStandardAMPM("AM"):this.options.amDesignator},i.prototype._getInnerPmDesignator=function(){return""==this.options.pmDesignator?this._getStandardAMPM("PM"):this.options.pmDesignator},i.prototype._getAllowSpinLoop=function(){return!!this.options.allowSpinLoop},i.prototype._getRealMaxDate=function(){return this.options.maxDate?this.options.maxDate:new Date(9999,11,31,23,59,59)},i.prototype._getRealMinDate=function(){if(this.options.minDate)return this.options.minDate;var t=new Date(1,0,1,0,0,0);return t.setFullYear(1),t},i.prototype._getRealEraMaxDate=function(){return this.options.maxDate?a.GetEraMax()<this.options.maxDate?a.GetEraMax():this.options.maxDate:a.GetEraMax()},i.prototype._getRealEraMinDate=function(){return this.options.minDate?a.GetEraMin()>this.options.minDate?a.GetEraMin():this.options.minDate:a.GetEraMin()},i.prototype._isEraFormatExist=function(){return this._textProvider._isEraFormatExist()},i.prototype._checkDate=function(){var t=this.options.date,e=this._checkRange(this.options.date);a.Equal(t,e)||(this._setOption("date",e),this._trigger("valueBoundsExceeded",null))},i.prototype._checkRange=function(t){return t&&(this.options.minDate&&t<this.options.minDate&&(t=new Date(Math.max(this.options.minDate,t))),this.options.maxDate&&t>this.options.maxDate&&(t=new Date(Math.min(this.options.maxDate,t)))),t},i.prototype._safeSetDate=function(t,e){var i=t;return e||(t=this._checkRange(t)),isNaN(t)&&(t=i),this.options.date=t,!0},i.prototype._safeGetDate=function(t){var e=this.options.date;return null==e&&(e=new Date),t||(e=this._checkRange(e)),e},i.prototype._setOption=function(e,i){if("showTrigger"==e)return void this._setOption("showDropDownButton",i);switch(t.prototype._setOption.call(this,e,i),e){case"pickers":this._reInitPicker();break;case"minDate":case"maxDate":"string"==typeof this.options[e]&&(this.options[e]=this._strToDate(i));var n=this.options.date;null===n&&(n=new Date);var o=this._getRealMinDate(),r=this._getRealMaxDate();(o>n||n>r)&&this._safeSetDate(n),this._updateText(),this._highLightField();break;case"date":!i||(i="string"==typeof i?this._strToDate(i):"object"==typeof i?new Date(i.getTime()):new Date(i),isNaN(i)&&(i=new Date)),this._safeSetDate(i),this._updateText(),this._highLightField();break;case"midnightAs0":case"hour12As0":case"amDesignator":case"pmDesignator":this._updateText(),this._highLightField();break;case"culture":this._textProvider._setFormat(this.options.dateFormat);var s=""==this.options.displayFormat?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(s),this.options.amDesignator=this._getStandardAMPM("AM"),this.options.pmDesignator=this._getStandardAMPM("PM"),this._updateText();var a=this.element.data("calendar");a&&a.wijcalendar("option",e,i),this._reInitPicker();break;case"dateFormat":if(this._textProvider._setFormat(this.options.dateFormat),""==this.options.displayFormat&&this._textProvider._setDisplayFormat(this.options.dateFormat),this._isEraFormatExist()&&null!=this.options.date){var l=this._getRealEraMinDate(),h=this._getRealEraMaxDate();this.options.date<l?this._setOption("date",l):this.options.date>h&&this._setOption("date",h)}this._updateText();var a=this.element.data("calendar");a&&a.wijcalendar("option",e,i),this._reInitPicker();break;case"displayFormat":var s=""==this.options.displayFormat?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(s),this._updateText();break;case"activeField":i=Math.min(i,this._textProvider.getFieldCount()-1),i=Math.max(i,0),this.options.activeField=i,this._checkDate(),this._highLightField(),this._resetTimeStamp();break;case"nextTooltip":case"prevTooltip":case"titleFormat":case"toolTipFormat":var a=this.element.data("calendar",a);a&&a.wijcalendar("option",e,i);break;case"comboItems":this._reInitPicker()}},i.prototype._setData=function(t){this.option("date",t)},i.prototype._resetData=function(){var t=this.element.data("defaultDate");void 0===t||null===t?(t=this.element.data("elementValue"),void 0!==t&&null!==t&&""!==t?this.setText(t):this._setData(null)):this._setData(t)},i.prototype._resetTimeStamp=function(){this.element.data("cursorPos",0),this.element.data("timeStamp",new Date("1900/1/1")),this.element.data("lastInputChar","")},i.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(t.prototype._showNullText.call(this)&&this.isDateNull())return"";var e=this._textProvider.toString();return e===this.options.nullText?"":e},i.prototype._highLightField=function(t){if("undefined"==typeof t&&(t=this.options.activeField),this.isFocused()){var e=this._textProvider.getFieldRange(t);e&&this.element.wijtextselection(e)}},i.prototype._highLightCursor=function(t){if(!this._isNullText()){void 0===t&&(t=Math.max(0,this.element.wijtextselection().start));var e=this._textProvider.getCursorField(t);0>e||this._setOption("activeField",e)}},i.prototype._toNextField=function(){this._setOption("activeField",this.options.activeField+1)},i.prototype._toPrevField=function(){this._setOption("activeField",this.options.activeField-1)},i.prototype._toFirstField=function(){this._setOption("activeField",0)},i.prototype._toLastField=function(){this._setOption("activeField",this._textProvider.getFieldCount())},i.prototype._clearField=function(t){"undefined"==typeof t&&(t=this.options.activeField);var i=this._textProvider.getFieldRange(t),n,o=this;i&&(n=new e.wijInputResult,this._textProvider.removeAt(i.start,i.end,n),this._updateText(),window.setTimeout(function(){o._highLightField()},1))},i.prototype.spinUp=function(){this._doSpin(!0,!1)},i.prototype.spinDown=function(){this._doSpin(!1,!1)},i.prototype.drop=function(){t.prototype._onTriggerClicked.call(this)},i.prototype.focus=function(){t.prototype.focus.call(this),this._addState("focus",this.outerDiv),this._updateText(),this._highLightField()},i.prototype.isDateNull=function(){return null===this.options.date||void 0===this.options.date},i.prototype._min=function(t,e){return void 0==e?t:e>t?t:e},i.prototype._max=function(t,e){return void 0==e?t:t>e?t:e},i.prototype._allowEdit=function(){return!this.option("disableUserInput")},i.prototype._onFocus=function(i){if(t.prototype._onFocus.call(this,i),this._allowEdit()&&(this._updateText(),this._highLightField(),e.Utility.chrome)){var n=this;n.element.data("needResoteActiveField",!0),window.setTimeout(function(){n.element.data("needResoteActiveField",!1)},200)}},i.prototype._simulate=function(e){var i=null;if("string"==typeof e)i=e;else{var n=this.element.wijtextselection(),o=this.element.data("lastSelection").start,r=n.end;r>=o&&(i=this.element.val().substring(o,r))}for(var s=0;s<a.GetEraCount();s++)if(i.toLowerCase()===a.GetEraShortNames()[s].toLowerCase()||i.toLowerCase()===a.GetEraAbbreviations()[s].toLowerCase()||i.toLowerCase()===a.GetEraSymbols()[s].toLowerCase()||i.toLowerCase()===a.GetEraNames()[s].toLowerCase()){i=a.GetEraShortNames()[s].toLowerCase();break}t.prototype._simulate.call(this,i)},i.prototype._doSpin=function(t,e){var i=this;if(!this._allowEdit())return!1;if(e&&this.element.data("breakSpinner"))return!1;if(t?this._trigger("spinUp",null):this._trigger("spinDown",null),null==this.options.date)return void this._setDefaultDate(t);if(this._textProvider[t?"incEnumPart":"decEnumPart"]()&&(this._updateText(),this._highLightField()),e&&!this.element.data("breakSpinner")){var n=window.setTimeout(function(){return i._doSpin(t,!0)},this._calcSpinInterval());this.element.data("spintimer",n)}return!0},i.prototype._setDefaultDate=function(t){t?this.options.date=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate():this.options.date=this._isEraFormatExist()?this._getRealEraMaxDate():this._getRealMaxDate(),this._updateText(),this._highLightField()},i.prototype._onChange=function(){},i.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},i.prototype._onBlur=function(e){t.prototype._onBlur.call(this,e),this._checkDate()},i.prototype._keyDownPreview=function(i){if(t.prototype._keyDownPreview.call(this,i))return!0;var n=i.keyCode||i.which,r;switch(n){case o.UP:case o.DOWN:if(i.altKey)return this._onTriggerClicked(),!0;if("List"!=this.element.data("pickerCurrentTab"))return this._doSpin(n==o.UP,!1),this._stopEvent(i),!0;break;case o.LEFT:return 0!=this.options.activeField||"left"!=this.options.blurOnLeftRightKey.toLowerCase()&&"both"!=this.options.blurOnLeftRightKey.toLowerCase()?this._toPrevField():e.Utility.MoveFocus(this.element.get(0),!1),!0;case o.RIGHT:return this.options.activeField!=this._textProvider.getFieldCount()-1||"right"!=this.options.blurOnLeftRightKey.toLowerCase()&&"both"!=this.options.blurOnLeftRightKey.toLowerCase()?this._toNextField():e.Utility.MoveFocus(this.element.get(0),!0),!0;case o.ENTER:if(this._wasPopupShowing)return"Calendar"==this.element.data("pickerCurrentTab")?null==this.options.date&&this._setOption("date",new Date):"List"==this.element.data("pickerCurrentTab")?this._processKeyForDropDownList(i):this._okButtonMouseDown(null,null),this._hidePopup(),!0;this.options.hideEnter&&t.prototype._stopEvent.call(this,i);break;case o.TAB:if("field"!==this.options.tabAction)break;if(r=this.element.wijtextselection(),r&&r.end-r.start!==this.element.val().length)if(i.shiftKey){if(!(this.options.activeField>0))break;this._toPrevField()}else{if(!(this.options.activeField<this._textProvider.getFieldCount()-1))break;this._toNextField()}return!0;case o.SPACE:case 188:case 190:case 110:case 191:if(i.shiftKey){if(this.options.activeField>0)return this._toPrevField(),!0}else if(this.options.activeField<this._textProvider.getFieldCount()-1)return this._toNextField(),!0;break;case o.HOME:return i.ctrlKey?this._setOption("date",new Date):this._toFirstField(),!0;case o.END:return i.ctrlKey?this._processClearButton():this._toLastField(),!0;case o.BACKSPACE:case o.DELETE:if(this._allowEdit())return this._processDeleteKey(),!0}return!1},i.prototype._processDeleteKey=function(){if(null!=this.options.date){var t=this.element.wijtextselection();if(t.end-t.start===this.element.val().length){var e=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate();if(this.options.date>e)return void this._setOption("date",e)}else{var i=this.options.activeField,n=this._textProvider.getFiledText(i);this._clearField();var o=this._textProvider.getFiledText(i);if(n!=o)return}this._processClearButton()}},i.prototype._autoMoveToNextField=function(t,e){this.options.autoNextField&&this._textProvider.needToMove(this.options.activeField,t,e)&&this._toNextField()},i.prototype._processClearButton=function(){this._allowEdit()?this._setOption("date",null):this._updateText()},i.prototype._autoMoveToNextControl=function(t,i,n){this.options.blurOnLastChar&&n===this._textProvider.getFieldCount()-1&&this._textProvider.needToMove(n,t,i)&&e.Utility.MoveFocus(this.element.get(0),!0)},i.prototype._keyPressPreview=function(t){var e=t.keyCode||t.which,i,n,r,s,a,l,h,d,c,u,p;if(e===o.ENTER)return this.isDateNull()&&this._setOption("date",new Date),!1;if(i=this._textProvider.getFieldRange(this.options.activeField)){if(e===o.TAB)return!0;if(e===o.SPACE)return this._stopEvent(t),!0;if(n=String.fromCharCode(e),r=this._textProvider.isFieldSep(n,this.options.activeField))return this._toNextField(),this._stopEvent(t),!0;s=this.element.data("cursorPos"),a=new Date,h=this.element.data("timeStamp"),p=this.element.data("lastInput"),l=a.getTime()-h.getTime()>this.options.keyDelay;var u=n;l?s=0:p&&(u=p+u),this.element.data({timeStamp:a,lastInput:u}),d=i.start+s,this.element.data("cursorPos",++s);var g=null==this.options.date;if(c=this._textProvider.addToField(u,this.options.activeField,d)){var f=this.options.activeField;this._updateText(),this._autoMoveToNextField(s,n),this._highLightField(),this._autoMoveToNextControl(s,n,f)}else g&&this._setOption("date",null),this._resetTimeStamp(),this._fireIvalidInputEvent();return this.element.data("lastInputChar",n),this._stopEvent(t),!0}return!1},i.prototype._raiseDataChanged=function(){var t=this.options.date,e=this.element.data("preDate");this.element.data("preDate",t?new Date(t.getTime()):null),(!e&&t||e&&!t||e&&t&&e.getTime()!==t.getTime())&&(this._popupVisible()&&this._syncCalendar(),this.element.attr("aria-valuenow",t),this._trigger("dateChanged",null,{date:t}))},i.prototype._isMinDate=function(t){return 1===t.getFullYear()&&0===t.getMonth()&&1===t.getDate()},i.prototype._reInitPicker=function(){this._destroyPicker(),this._initPicker()},i.prototype._destroy=function(){t.prototype._destroy.call(this),this._destroyPicker()},i.prototype._destroyPicker=function(){var t=this.element.data("pickers");void 0!=t&&(t.remove(),this.element.data("pickers",null),this.element.data("calendar",null),this.element.data("datePicker",null),this.element.data("timePicker",null),this._comboDiv=void 0)},i.prototype._initPicker=function(){var t=this,i=this.element.data("pickers");if(void 0==i){var o=this;this._initPickerData();var r=this._getPickerCount(),s=this.element.data("pickerWidth"),a=this.element.data("pickerHeight"),l=this.element.data("pickerAreaHeight");r>1&&(a+=8,l+=8);var h=r>1?a:l;i=n("<table/>").appendTo(document.body).attr({"class":"ui-widget-content ui-corner-all",borderWidth:"0px",cellspacing:"0px",cellpadding:"0px",cursor:"default"}).css({"font-size":"12px"});var d=n("<tr/>").appendTo(i),c=n("<tr/>").appendTo(i),u=n("<td/>").appendTo(d).css({width:"100%",height:"100%"}),p=n("<td/>").appendTo(c).attr("align","center").css({width:"100%",height:"30px",display:"none"}),g=n("<input type='button'/>").appendTo(p).attr({"class":"ui-state-active ui-widget",value:"OK"}).css({width:"80px",height:"26px",margin:"1px","text-align":"center",cursor:"pointer",visibility:"hidden"}).mousedown(function(t,e){o._okButtonMouseDown(t,e)}),f=n("<div/>").appendTo(u).css({width:"100%",height:"100%",padding:"0px",margin:"0px",borderWidth:"0px",overflow:"hidden"}),m=n("<ul/>").css({"line-height":"1px","font-size":"12px"});r>1&&m.appendTo(f);var w="";if(this._isCalendarPickerShown()){r>1?this._addPickerTab(m,"Calendar","#calendarDiv"):e.Utility.IsIE9()&&(u.css({width:""}),f.css({width:""})),this._initCalendarPicker();var y=this.element.data("calendar");this._addPickerEditor(f,y,"calendarDiv"),w="Calendar"}if(this._isListPickerShown()&&(r>1&&this._addPickerTab(m,"List","#listDiv"),this._initListPicker(),this._addPickerEditor(f,this._comboDiv,"listDiv"),w=""==w?"List":w),this._isDatePickerShown()){r>1&&this._addPickerTab(m,"Date","#dateDiv"),this._initDatePicker();var v=this.element.data("datePicker");this._addPickerEditor(f,v,"dateDiv"),w=""==w?"Date":w}if(this._isTimePickerShown()){r>1&&this._addPickerTab(m,"Time","#timeDiv"),this._initTimePicker();var _=this.element.data("timePicker");this._addPickerEditor(f,_,"timeDiv"),w=""==w?"Time":w}"Calendar"==w?i.css({width:s+"px",height:""}):("Date"==w||"Time"==w)&&(p.css({display:""}),i.css({width:s+"px",height:a+"px"}),f.css({height:h+"px"})),this.element.data("pickerCurrentTab",w);var o=this;f.wijtabs({select:function(t,e){var n=e.tab.outerText||e.tab.text;if(p.css({display:"none"}),o.element.data("pickerCurrentTab",n),"Calendar"==n)o.focus(),i.css({width:s+"px",height:"","font-size":""}),f.css({height:"100%"});else if("List"==n){var r=o._getListPickerWidth();o._comboDiv.wijlist("option","width",r),i.css({width:r,height:"","font-size":""}),f.css({height:"100%"}),o._comboDiv.wijlist("renderList"),o._comboDiv.focus()}else o.focus(),("Time"==n||"Date"==n)&&(p.css({display:""}),i.css({width:s+"px",height:a+"px","font-size":"12px"}),f.css({height:h+"px"}))}}),i.wijpopup({autoHide:!0,hidden:function(){t._trigger("dropDownClose"),t._wasPopupShowing=!1},shown:function(){t._trigger("dropDownOpen"),t._wasPopupShowing=!0}}),this.element.data("pickers",i),this.element.data("divPickers",f),this.element.data("divOK",g)}},i.prototype._initPickerData=function(){var t=70,e=32,i=26,n=30,o=150,r=100,s=235,a=242,l=220,h=220,d=this._getPickerCount(),c=d*t,u=r;if(c=o>c?o:c,this._isCalendarPickerShown()&&(c=s>c?s:c,u=a>u?a:u),this._isListPickerShown()){var p=this._getcomboItems();if(void 0!=p){var g=p.length*i;u=g>u?g:u}}if(this._isDatePickerShown()){c=l>c?l:c,u=l>u?l:u;var f=this._getDatePickerMinYear(),m=this._getDatePickerMaxYear(),w=this._getDefaultDatePickerFormat(),y=void 0!=this.options.pickers.datePicker.format?this.options.pickers.datePicker.format:w,v=y.split(",");3!=v.length&&(v=w.split(","),this.options.pickers.datePicker.format=w);var _=this._getRollFormat(v,"y"),S=this._getRollFormat(v,"M"),x=this._getRollFormat(v,"d");this._isValidatePickerFormat(_)&&this._isValidatePickerFormat(S)&&this._isValidatePickerFormat(x)||(v=w.split(","),_=this._getRollFormat(v,"y"),S=this._getRollFormat(v,"M"),x=this._getRollFormat(v,"d"),this.options.pickers.datePicker.format=w),this.element.data("pickerDateYearFormat",_),this.element.data("pickerDateMonthFormat",S),this.element.data("pickerDateDayFormat",x),this.element.data("pickerMinYear",f),this.element.data("pickerMaxYear",m),this.element.data("pickerDateFormat",v)}if(this._isTimePickerShown()){c=l>c?l:c,u=l>u?l:u;var b=this._getDefaultTimePickerFormat(),C=void 0!=this.options.pickers.timePicker.format?this.options.pickers.timePicker.format:b,D=C.split(",");3!=D.length&&(D=b.split(","),this.options.pickers.timePicker.format=b);var I=this._getRollFormat(D,"h"),j=this._getRollFormat(D,"m"),T=this._getRollFormat(D,"t");this._isValidatePickerFormat(I)&&this._isValidatePickerFormat(j)&&this._isValidatePickerFormat(T)||(D=b.split(","),I=this._getRollFormat(D,"h"),j=this._getRollFormat(D,"m"),T=this._getRollFormat(D,"t"),this.options.pickers.timePicker.format=b),this.element.data("pickerTimeHourFormat",I),this.element.data("pickerTimeMinuteFormat",j),this.element.data("pickerTimeAMFormat",T),this.element.data("pickerTimeFormat",D)}var E=void 0!=this.options.pickers.width?this.options.pickers.width:0,k=void 0!=this.options.pickers.height?this.options.pickers.height:0;E=c>E?c:E,k=u>k?u:k,k-=d>1?e:0;var L=k-n,P=Math.floor(L/5)+1,M=2*P,F=5*P+6,A=4*P-3,B=2*P+2,R=P;this.element.data("itemHeight",P),this.element.data("indicatorHeight",M),this.element.data("pickerWidth",E),this.element.data("pickerHeight",k),this.element.data("pickerAreaHeight",L),this.element.data("indicatorTranslateTop",F),this.element.data("indicatorTranslateDown",A),this.element.data("indicatorTranslateSelector",B),this.element.data("indicatorTranslateContent",R)},i.prototype._initListPicker=function(){var t=this;if(void 0===this._comboDiv){this._comboDiv=n("<div/>").css({overflow:"hidden",display:"block",left:"",top:"",position:""});var i=this._normalize(this._getcomboItems());this._comboDiv.wijlist({maxItemsCount:5,autoSize:!0,selected:function(e,i){t.options.disableUserInput||t._setData(i.item.value);var n=t.element.data("pickers");void 0!=n&&n.wijpopup("hide"),t._trySetFocus()}}),this._comboDiv.wijlist("setItems",i),this._comboDiv.wijlist("renderList"),e.Utility.IsIE7()&&this._comboDiv.attr("align","left")}},i.prototype._initCalendarPicker=function(){var e=this,i=this.element.data("calendar");if(void 0==i){var o=this.options.calendar;void 0!==o&&null!==o&&(("boolean"==typeof o||"default"===o)&&(o=n("<div/>")),i=n(o),1===i.length&&(this.element.data("calendar",i),this.options.localization&&(this.options.nextTooltip=this.options.localization.nextTooltip,this.options.prevTooltip=this.options.localization.prevTooltip,this.options.titleFormat=this.options.localization.titleFormat,this.options.toolTipFormat=this.options.localization.toolTipFormat),i.wijcalendar({popupMode:!0,culture:this.options.culture,nextTooltip:this.options.nextTooltip||"Next",prevTooltip:this.options.prevTooltip||"Previous",titleFormat:this.options.titleFormat||"MMMM yyyy",toolTipFormat:this.options.toolTipFormat||"dddd, MMMM dd, yyyy",selectedDatesChanged:function(){var n=i.wijcalendar("getSelectedDate"),o=e.option("date");t.prototype._wasPopupShowing=!1;var r=e.element.data("pickers");void 0!=r&&r.wijpopup("hide"),e._trigger("dropDownClose",null),n&&(o&&(n.setHours(o.getHours()),n.setMinutes(o.getMinutes()),n.setSeconds(o.getSeconds()),n.setMilliseconds(o.getMilliseconds())),e._allowEdit()&&(e.option("date",n),e.selectText())),e._trySetFocus()}}),i.css({display:"block",left:"",top:"",position:"","margin-bottom":"0px"}),this._syncCalendar(),this._updateCalendarPicker()))}},i.prototype._initTimePicker=function(){var t=this.element.data("timePicker");if(void 0==t){for(var i=this,o=5*this.element.data("itemHeight"),r=this.element.data("pickerWidth"),s=this.element.data("itemHeight")+"px",a=this.element.data("indicatorHeight")+"px",l=this.element.data("indicatorTranslateTop"),h=this.element.data("indicatorTranslateDown"),d=this.element.data("indicatorTranslateSelector"),c=this.element.data("indicatorTranslateContent"),u=this._createDivElement(document.body,r+"px"),p=this._createDivIndicatiorElement(u,s,"",d),g=this._createTableElement(u,o+"px","-",c),f=n("<tr/>").appendTo(g),m=n("<td/>").css({width:"33%"}),w=this._createPickerDivElement(m,o),y=this._createMaskElement(w,o),v={},_=1;12>=_;_++){var S=this._getRollText(_,this.element.data("pickerTimeHourFormat")),x=this._createItemElement(_,y,s,S);v[_-1]=x}for(var b=n("<td/>").css({width:"33%"}),C=this._createPickerDivElement(b,o),D=this._createMaskElement(C,o),I={},_=0;60>_;_++){var S=this._getRollText(_,this.element.data("pickerTimeMinuteFormat")),x=this._createItemElement(_,D,s,S);I[_]=x}for(var j=n("<td/>").css({width:"34%"}),T=this._createPickerDivElement(j,o),E=this._createMaskElement(T,o),k={},_=0;2>_;_++){var S=this._getRollText(_,this.element.data("pickerTimeAMFormat")),x=this._createItemElement(_,E,s,S);k[_]=x}for(var L=this.element.data("pickerTimeFormat"),P=!1,M=!1,F=!1,_=0;_<L.length;_++)("h"==L[_]||"hh"==L[_])&&!P&&(m.appendTo(f),P=!0),("m"==L[_]||"mm"==L[_])&&!M&&(b.appendTo(f),M=!0),("t"==L[_]||"tt"==L[_])&&!F&&(j.appendTo(f),F=!0);if(this.element.data("timePicker",u),this.element.data("divHour",w),this.element.data("divMinute",C),this.element.data("divAM",T),this.element.data("divHourMask",y),this.element.data("divMinuteMask",D),this.element.data("divAMMask",E),this.element.data("pickerHourArray",v),this.element.data("pickerMinuteArray",I),this.element.data("pickerAMArray",k),!e.Utility.IsIE8OrBelow()){var A=this._createIndicatiorElement(w,a,"-",l),B=this._createIndicatiorElement(w,a,"-",h),R=this._createIndicatiorElement(C,a,"-",l),O=this._createIndicatiorElement(C,a,"-",h),G=this._createIndicatiorElement(T,a,"-",l),U=this._createIndicatiorElement(T,a,"-",h);this.element.data("divHourIndicatorTop",A),this.element.data("divMinuteIndicatorTop",R),this.element.data("divAMIndicatorTop",G),this.element.data("divHourIndicatorDown",B),this.element.data("divMinuteIndicatorDown",O),this.element.data("divAMIndicatorDown",U)}this._initTimePickerEvent(),this._initTouchPickerEvent("Hour"),this._initTouchPickerEvent("Minute"),this._initTouchPickerEvent("AM")}},i.prototype._initTimePickerEvent=function(){var t=this,e=this.element.data("divHour"),i=this.element.data("divMinute"),n=this.element.data("divAM");e.mousewheel(function(e,i){t._hourMouseWheel(e,i)}),i.mousewheel(function(e,i){t._minuteMouseWheel(e,i)}),n.mousewheel(function(e,i){t._amMouseWheel(e,i)})},i.prototype._initDatePicker=function(){var t=this.element.data("datePicker");if(void 0==t){var i=this,o=this.element.data("pickerMinYear"),r=this.element.data("pickerMaxYear"),s=5*this.element.data("itemHeight"),a=this.element.data("pickerWidth"),l=this.element.data("itemHeight")+"px",h=this.element.data("indicatorHeight")+"px",d=this.element.data("indicatorTranslateTop"),c=this.element.data("indicatorTranslateDown"),u=this.element.data("indicatorTranslateSelector"),p=this.element.data("indicatorTranslateContent"),g=this._createDivElement(document.body,a+"px"),f=this._createDivIndicatiorElement(g,l,"",u),m=this._createTableElement(g,s+"px","-",p),w=n("<tr/>").appendTo(m),y="33%",v="33%",_="33%";"MMMM"==this.element.data("pickerDateMonthFormat")&&(y="30%",v="45%",_="25%");for(var S=n("<td/>").css({width:y}),x=this._createPickerDivElement(S,s),b=this._createMaskElement(x,s),C=new Array,D=o;r>=D;D++){var I=this._getRollText(D,this.element.data("pickerDateYearFormat")),j=this._createItemElement(D,b,l,I);C[D-o]=j}for(var T=n("<td/>").css({width:v}),E=this._createPickerDivElement(T,s),k=this._createMaskElement(E,s),L={},D=1;12>=D;D++){var I=this._getRollText(D,this.element.data("pickerDateMonthFormat")),j=this._createItemElement(D-1,k,l,I);L[D-1]=j}for(var P=n("<td/>").css({width:_}),M=this._createPickerDivElement(P,s),F=this._createMaskElement(M,s),A={},D=1;31>=D;D++){var I=this._getRollText(D,this.element.data("pickerDateDayFormat")),j=this._createItemElement(D,F,l,I);A[D-1]=j}for(var B=this.element.data("pickerDateFormat"),R=!1,O=!1,G=!1,D=0;D<B.length;D++)"yyyy"==B[D]&&!R&&(S.appendTo(w),R=!0),("M"==B[D]||"MM"==B[D]||"MMM"==B[D]||"MMMM"==B[D])&&!O&&(T.appendTo(w),O=!0),("d"==B[D]||"dd"==B[D])&&!G&&(P.appendTo(w),G=!0);if(this.element.data("datePicker",g),this.element.data("divYear",x),this.element.data("divMonth",E),this.element.data("divDay",M),this.element.data("divYearMask",b),this.element.data("divMonthMask",k),this.element.data("divDayMask",F),this.element.data("pickerYearArray",C),this.element.data("pickerMonthArray",L),this.element.data("pickerDayArray",A),!e.Utility.IsIE8OrBelow()){var U=this._createIndicatiorElement(x,h,"-",d),N=this._createIndicatiorElement(x,h,"-",c),V=this._createIndicatiorElement(E,h,"-",d),H=this._createIndicatiorElement(E,h,"-",c),W=this._createIndicatiorElement(M,h,"-",d),z=this._createIndicatiorElement(M,h,"-",c);this.element.data("divYearIndicatorTop",U),this.element.data("divMonthIndicatorTop",V),this.element.data("divDayIndicatorTop",W),this.element.data("divYearIndicatorDown",N),this.element.data("divMonthIndicatorDown",H),this.element.data("divDayIndicatorDown",z)}this._initDatePickerEvent(),this._initTouchPickerEvent("Year"),this._initTouchPickerEvent("Month"),this._initTouchPickerEvent("Day")}},i.prototype._initDatePickerEvent=function(){var t=this,e=this.element.data("divYear"),i=this.element.data("divMonth"),n=this.element.data("divDay");e.mousewheel(function(e,i){t._yearMouseWheel(e,i)}),i.mousewheel(function(e,i){t._monthMouseWheel(e,i)}),n.mousewheel(function(e,i){t._dayMouseWheel(e,i)})},i.prototype._initTouchPickerEvent=function(t){var i=this.element.data("div"+t),n=this.element.data("div"+t+"Mask");if(this._addPickerTouchEvent(n,t),!e.Utility.IsIE8OrBelow()){var o=this.element.data("div"+t+"IndicatorTop"),r=this.element.data("div"+t+"IndicatorDown");
this._addPickerTouchEvent(o,t),this._addPickerTouchEvent(r,t)}},i.prototype._addPickerTouchEvent=function(t,e){var i=this;t.bind("touchstart",function(t){i._touchStart(t,e),t.preventDefault()}).bind("touchmove",function(t){i._touchMove(t,e),t.preventDefault()}).bind("touchend",function(t){i._touchEnd(t,e),t.preventDefault()})},i.prototype._touchStart=function(t,e){var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],n=i.clientY;this.element.data("touch"+e+"StartY",n),this.element.data("touch"+e+"BaseY",this.element.data("picker"+e+"ScrollCurrent")),this.element.data("touch"+e+"Started",!0),this.element.data("touchStartTime",new Date);var o=this.element.data("picker"+e+"ScrollCurrent");this.element.data("picker"+e+"ScrollTo",o)},i.prototype._touchMove=function(t,e){if(1==this.element.data("touch"+e+"Started")){var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],n=i.clientY,o=this.element.data("touch"+e+"StartY"),r=this.element.data("touch"+e+"BaseY"),s=r+n-o;this._scrollTheViewByTouch(e,s)}},i.prototype._touchEnd=function(t,e){var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],n=this.element.data("touch"+e+"StartY"),o=this.element.data("touch"+e+"BaseY"),r=i.clientY-n,s=o+r;if(Math.abs(r)<10){var a=this.element.data("picker"+e+"ScrollCurrent");return this.element.data("picker"+e+"ScrollTo",a),void this._adjustTouchPosition(e,a)}this.element.data("touch"+e+"StartY",-1),this.element.data("touch"+e+"BaseY",-1),this.element.data("touch"+e+"Started",!1);var l=new Date,h=l-this.element.data("touchStartTime");if(200>h){var d=5*this.element.data("itemHeight"),c=0>r?-1:1;r*=4,r=Math.abs(r)<d?c*d:r,s+=r,this.element.data("touchQuickScroll",!0),this.element.data("picker"+e+"ScrollRate",3)}this._adjustTouchPosition(e,s)},i.prototype._hourMouseWheel=function(t,e){if(!isNaN(e)){var i=this.element.data("pickerHour"),n=this.element.data("pickerHour"),o=n;n-=e,n=1>n?1:n,n=n>12?12:n;var r=this.element.data("pickerAM");12==n?0==r&&(r=1,this._updateItemTransform("AM",r),this._scrollTheView("AM",r,0,!1),this.element.data("pickerAM",r)):12==o&&1==r&&(r=0,this._updateItemTransform("AM",r),this._scrollTheView("AM",r,1,!1),this.element.data("pickerAM",r)),this._updateItemTransform("Hour",n-1),this._scrollTheView("Hour",n-1,i-1,!1),this.element.data("pickerHour",n),t.preventDefault&&t.preventDefault()}},i.prototype._minuteMouseWheel=function(t,e){if(!isNaN(e)){var i=this.element.data("pickerMinute"),n=this.element.data("pickerMinute");n-=e,n=0>n?0:n,n=n>59?59:n,this._updateItemTransform("Minute",n),this._scrollTheView("Minute",n,i,!1),this.element.data("pickerMinute",n),t.preventDefault&&t.preventDefault()}},i.prototype._amMouseWheel=function(t,e){if(!isNaN(e)){var i=n(t.currentTarget).data("pickerAM"),o=this.element.data("pickerAM");o-=e,o=0>o?0:o,o=o>1?1:o,this._updateItemTransform("AM",o),this._scrollTheView("AM",o,i,!1),this.element.data("pickerAM",o),t.preventDefault&&t.preventDefault()}},i.prototype._yearMouseWheel=function(t,e){if(!isNaN(e)){var i=this.element.data("pickerMinYear"),n=this.element.data("pickerMaxYear"),o=this.element.data("pickerYear"),r=this.element.data("pickerYear");o-=e,o=i>o?i:o,o=o>n?n:o,this._updateItemTransform("Year",o-i),this._scrollTheView("Year",o-i,r-i,!1),this.element.data("pickerYear",o),this._updateDayPickerMaxCount(),t.preventDefault&&t.preventDefault()}},i.prototype._monthMouseWheel=function(t,e){if(!isNaN(e)){var i=this.element.data("pickerMonth"),n=this.element.data("pickerMonth");i-=e,i=1>i?1:i,i=i>12?12:i,this._updateItemTransform("Month",i-1),this._scrollTheView("Month",i-1,n,!1),this.element.data("pickerMonth",i),this._updateDayPickerMaxCount(),t.preventDefault&&t.preventDefault()}},i.prototype._dayMouseWheel=function(t,e){if(!isNaN(e)){var i=this.element.data("pickerDayMaxCount"),n=this.element.data("pickerDay"),o=this.element.data("pickerDay");o-=e,o=1>o?1:o,o=o>i?i:o,this._updateItemTransform("Day",o-1),this._scrollTheView("Day",o-1,n-1,!1),this.element.data("pickerDay",o),t.preventDefault&&t.preventDefault()}},i.prototype._hourMouseDown=function(t,e){var i=this.element.data("pickerHour"),o=n(t.currentTarget).data("rollValue");this._scrollTheView("Hour",o,i,!1),this.element.data("pickerHour",o)},i.prototype._minuteMouseDown=function(t,e){var i=this.element.data("pickerMinute"),o=n(t.currentTarget).data("rollValue");this._scrollTheView("Minute",o,i,!1),this.element.data("pickerMinute",o)},i.prototype._amMouseDown=function(t,e){var i=n(t.currentTarget).data("pickerAM"),o=n(t.currentTarget).data("rollValue");this._scrollTheView("AM",o,i,!1),this.element.data("pickerAM",o)},i.prototype._yearMouseDown=function(t,e){var i=this.element.data("pickerMinYear"),o=n(t.currentTarget).data("rollValue"),r=this.element.data("pickerYear");this._scrollTheView("Year",o-i,r-i,!1),this.element.data("pickerYear",o),this._updateDayPickerMaxCount()},i.prototype._monthMouseDown=function(t,e){var i=this.element.data("pickerMonth"),o=n(t.currentTarget).data("rollValue");this._scrollTheView("Month",o,i,!1),this.element.data("pickerMonth",o),this._updateDayPickerMaxCount()},i.prototype._dayMouseDown=function(t,e){var i=this.element.data("pickerDay"),o=n(t.currentTarget).data("rollValue");this._scrollTheView("Day",o-1,i-1,!1),this.element.data("pickerDay",o)},i.prototype._updateCalendarPicker=function(){var t=this.element.data("calendar"),e=this.options.pickers;void 0!=t&&void 0!=e&&void 0!=e.calendar&&(void 0!=e.calendar.allowQuickPick&&t.wijcalendar("option","allowQuickPick",e.calendar.allowQuickPick),void 0!=e.calendar.navButtons&&t.wijcalendar("option","navButtons",e.calendar.navButtons),void 0!=e.calendar.nextTooltip&&t.wijcalendar("option","nextTooltip",e.calendar.nextTooltip),void 0!=e.calendar.prevTooltip&&t.wijcalendar("option","prevTooltip",e.calendar.prevTooltip),void 0!=e.calendar.showDayPadding&&t.wijcalendar("option","showDayPadding",e.calendar.showDayPadding),void 0!=e.calendar.showOtherMonthDays&&t.wijcalendar("option","showOtherMonthDays",e.calendar.showOtherMonthDays),void 0!=e.calendar.showTitle&&t.wijcalendar("option","showTitle",e.calendar.showTitle),void 0!=e.calendar.showWeekDays&&t.wijcalendar("option","showWeekDays",e.calendar.showWeekDays),void 0!=e.calendar.showWeekNumbers&&t.wijcalendar("option","showWeekNumbers",e.calendar.showWeekNumbers),void 0!=e.calendar.titleFormat&&t.wijcalendar("option","titleFormat",e.calendar.titleFormat),void 0!=e.calendar.toolTipFormat&&t.wijcalendar("option","toolTipFormat",e.calendar.toolTipFormat),void 0!=e.calendar.weekDayFormat&&t.wijcalendar("option","weekDayFormat",e.calendar.weekDayFormat))},i.prototype._updateTimePicker=function(){var t=this.element.data("pickerHour")-1,e=this.element.data("pickerMinute"),i=this.element.data("pickerAM"),n=this.element.data("divHourMask"),o=this.element.data("divMinuteMask"),r=this.element.data("divAMMask");this._updateItemTransform("Hour",t),this._updateItemTransform("Minute",e),this._updateItemTransform("AM",i),this._scrollTheView("Hour",t,t,!0),this._scrollTheView("Minute",e,e,!0),this._scrollTheView("AM",i,i,!0),this.element.data("pickerHourScrollDelay",5),this.element.data("pickerMinuteScrollDelay",5),this.element.data("pickerAMScrollDelay",5),this.element.data("pickerHourScrollRate",1),this.element.data("pickerMinuteScrollRate",1),this.element.data("pickerAMScrollRate",1)},i.prototype._updateDatePicker=function(){var t=this.element.data("pickerMinYear"),e=this.element.data("pickerYear"),i=this.element.data("pickerMonth"),n=this.element.data("pickerDay"),o=a.DaysInMonth(e,i);this._updateItemTransform("Year",e-t),this._updateItemTransform("Month",i-1),this._updateItemTransform("Day",n-1),this._scrollTheView("Year",e-t,e-t,!0),this._scrollTheView("Month",i-1,i-1,!0),this._scrollTheView("Day",n-1,n-1,!0),this.element.data("pickerYearScrollDelay",5),this.element.data("pickerMonthScrollDelay",5),this.element.data("pickerDayScrollDelay",5),this.element.data("pickerYearScrollRate",1),this.element.data("pickerMonthScrollRate",1),this.element.data("pickerDayScrollRate",1),this._updateDayPickerMaxCount()},i.prototype._updateDayPickerMaxCount=function(){var t=this.element.data("pickerYear"),e=this.element.data("pickerMonth"),i=this.element.data("pickerDay"),n=a.DaysInMonth(t,e);this.element.data("pickerDayMaxCount",n);for(var o=this.element.data("pickerDayArray"),r=29;31>=r;r++){var s=r>n?"none":"";o[r-1].css("display",s)}if(i>n){var l=this.element.data("divDayMask");i=n,this._updateItemTransform("Day",i-1),this._scrollTheView("Day",i-1,null,!1),this.element.data("pickerDay",i)}},i.prototype._updateItemTransform=function(t,i){if(!(e.Utility.IsIE8OrBelow()||0>i))for(var n=this.element.data("picker"+t+"Array"),o=this._getItemLength(t),r="skew(0deg) scale(1.2, 1.2) translate(0px, 0px)",s="skew(-5deg) scale(0.9, 0.9) translate(0px, 0px)",a="skew(-10deg) scale(0.7, 0.7) translate(0px, 0px)",l="skew(-15deg) scale(0.5, 0.5) translate(0px, 0px)",h=0;o>h;h++)h==i-3?this._setCssTransform(n[h],"",l,!0):h==i-2?this._setCssTransform(n[h],"",a,!0):h==i-1?this._setCssTransform(n[h],"",s,!0):h==i?this._setCssTransform(n[h],"",r,!0):h==i+1?this._setCssTransform(n[h],"",s,!0):h==i+2?this._setCssTransform(n[h],"",a,!0):h==i+3?this._setCssTransform(n[h],"",l,!0):this._setCssTransform(n[h],"","",!0)},i.prototype._createDivElement=function(t,e){var t=n("<div/>").appendTo(t).css({width:e+"px",display:"block",left:"",top:"",position:""}).bind("touchstart",function(t){t.preventDefault()}).bind("touchmove",function(t){t.preventDefault()});return t},i.prototype._createTableElement=function(t,e,i,o){var r=n("<table/>").appendTo(t).css({width:"100%",height:e+"px"}).attr({cellspacing:"0px",cellpadding:"0px"});return this._setCssTransform(r,i,o,!1),r},i.prototype._createItemElement=function(t,e,i,o){var r=n("<div/>").appendTo(e).css({height:i,lineHeight:i,cursor:"default"}).html(o).data("rollValue",t);return r},i.prototype._createPickerDivElement=function(t,e){var i=n("<div/>").appendTo(t).css({height:e,border:"0px","text-align":"center",overflow:"hidden",background:"transparent"});return i},i.prototype._createMaskElement=function(t,e){var i=n("<div/>").appendTo(t).css({height:e});return i},i.prototype._createDivIndicatiorElement=function(t,e,i,o){var r=n("<div/>").appendTo(t).css({height:e,opacity:"0.5",lineHeight:e,margin:"0px",cursor:"default"}).attr("class","ui-state-active");return this._setCssTransform(r,i,o,!1),r},i.prototype._createIndicatiorElement=function(t,e,i,o){var r=n("<div/>").appendTo(t).css({height:e,opacity:"0.5",lineHeight:e,"border-width":"0px",cursor:"default"}).attr("class","ui-widget-content");return this._setCssTransform(r,i,o,!1),r},i.prototype._hideItemInIE7=function(t,i){if(e.Utility.IsIE7()){var n=this.element.data("picker"+t+"LastItemIndex"),o=this._getItemIndexByPosition(t,i);if(o!=n){for(var r=o-2,s=o+2,a=this.element.data("picker"+t+"Array"),l=this._getItemLength(t),h=0;l>h;h++)h>=r&&s>=h?a[h].css("visibility",""):a[h].css("visibility","hidden");this.element.data("picker"+t+"LastItemIndex",o)}}},i.prototype._okButtonMouseDown=function(e,i){var n=this.element.data("pickerYear"),o=this.element.data("pickerMonth")-1,r=this.element.data("pickerDay"),s=this.element.data("pickerHour"),a=this.element.data("pickerMinute"),l=this.element.data("pickerAM");12==s&&(s=0),1==l&&(s+=12);var h=this._getPickerValue();h.setFullYear(n),h.setMonth(o),h.setDate(r),h.setHours(s),h.setMinutes(a),t.prototype._wasPopupShowing=!1;var d=this.element.data("pickers");void 0!=d&&d.wijpopup("hide"),this._trigger("dropDownClose",null),this._allowEdit()&&(this.option("date",h),this.selectText()),this._trySetFocus()},i.prototype._getCorrentPickerFormat=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++)if(t[i].index<t[e].index){var n=t[e];t[e]=t[i],t[i]=n}for(var o="",e=0;e<t.length;e++)o+=t[e].value,e<t.length-1&&(o+=",");return o},i.prototype._getDefaultDatePickerFormat=function(){var t=this._getCulture();if(null==t)return"yyyy,M,d";var e=t.calendars.standard,i=e.patterns.d,n={index:i.indexOf("y"),value:"yyyy"},o={index:i.indexOf("M"),value:"MM"},r={index:i.indexOf("d"),value:"dd"};if(-1==n.index||-1==o.index||-1==r.index)return"yyyy,M,d";var s=new Array;return s[0]=n,s[1]=o,s[2]=r,this._getCorrentPickerFormat(s)},i.prototype._getDefaultTimePickerFormat=function(){if(this.options.culture.length>=2){var t=this.options.culture.substr(0,2);if("ja"==t||"zh"==t)return"tt,hh,mm"}return"hh,mm,tt"},i.prototype._getListPickerWidth=function(){var t=this._getcomboWidth(),e=this.element.data("pickerWidth"),i=void 0!=t?t:this.outerDiv.width();return e>i?e+"px":i+"px"},i.prototype._getDatePickerMinYear=function(){var t=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate(),e=t.getFullYear(),i=this._getPickerValue(),n=this._max(i.getFullYear()-50,e);return n},i.prototype._getDatePickerMaxYear=function(){var t=this._isEraFormatExist()?this._getRealEraMaxDate():this._getRealMaxDate(),e=t.getFullYear(),i=this._getPickerValue(),n=this._min(i.getFullYear()+50,e);return n},i.prototype._getPickerValue=function(){var t=this.options.date;return t=null==t?new Date:t},i.prototype._getRollFormat=function(t,e){for(var i=0;i<t.length;i++)if(-1!=t[i].indexOf(e))return t[i];return""},i.prototype._getRollText=function(t,e){var i=this._getCulture(),n="";switch(e){case"M":case"h":n=t.toString();break;case"MM":case"hh":n=10>t?"0"+t.toString():t.toString();break;case"m":case"d":case"yyyy":n=t.toString();break;case"mm":case"dd":n=10>t?"0"+t.toString():t.toString();break;case"t":n=0==t?this._getStandardAMPM("AM"):this._getStandardAMPM("PM"),n=n.substr(0,1);break;case"tt":n=0==t?this._getStandardAMPM("AM"):this._getStandardAMPM("PM");break;case"MMM":n=i.calendars.standard.months.namesAbbr[t-1];break;case"MMMM":n=i.calendars.standard.months.names[t-1]}return n},i.prototype._getStandardAMPM=function(t){var e=this._getCulture();if(e&&e.calendar){var i=e.calendars.standard[t];if(i)return i[0]}return t},i.prototype._getItemIndexByPosition=function(t,e){var i=this._getTouchPositionArray(t),n=this._getItemLength(t);"Day"==t&&n>this.element.data("pickerDayMaxCount")&&(n=this.element.data("pickerDayMaxCount"));for(var o=-1,r=0;n>r;r++){if(0==r){if(e>i[r]){o=0;break}}else if(e<=i[r-1]&&e>=i[r]){var s=i[r-1]-e,a=e-i[r];o=s>a?r:r-1;break}if(r==n-1&&e<i[r]){o=r;break}}return o},i.prototype._getItemLength=function(t){switch(t){case"Hour":case"Month":return 12;case"Year":var e=this.element.data("pickerMinYear"),i=this.element.data("pickerMaxYear");return i-e+1;case"Day":return 31;case"Minute":return 60;case"AM":return 2}return-1},i.prototype._getTouchPositionArray=function(t){for(var e={},i=this.element.data("itemHeight"),n=this._getItemLength(t),o=0;n>o;o++)e[o]=(2-o)*i;return e},i.prototype._adjustTouchPosition=function(t,e){var i=this._getTouchPositionArray(t),n=this._getItemIndexByPosition(t,e),o=this._itemIndexToValue(t,n);this.element.data("picker"+t,o),this._scrollTheViewByTouch(t,i[n])},i.prototype._itemIndexToValue=function(t,e){switch(t){case"Minute":case"AM":return e;case"Hour":case"Month":case"Day":return e+1;case"Year":var i=this.element.data("pickerMinYear");return i+e}return-1},i.prototype._scrollTheView=function(t,e,i,n){var o=this.element.data("itemHeight"),r=(2-e)*o;if(this.element.data("picker"+t+"ScrollTo",r),1==n){var s=this.element.data("div"+t+"Mask"),a=r;this._setCssTransform(s,"",a,!1),this._hideItemInIE7(t,a),this.element.data("picker"+t+"ScrollCurrent",a)}else this._scrollPicker(t)},i.prototype._scrollPicker=function(t){var e=this.element.data("div"+t+"Mask"),i=this.element.data("picker"+t+"ScrollTo"),n=this.element.data("picker"+t+"ScrollCurrent"),o=this.element.data("picker"+t+"ScrollDelay");if(void 0==n&&(n=i,this._setCssTransform(e,"",n,!1),this.element.data("picker"+t+"ScrollCurrent",n)),i==n||void 0==n)return!1;n+=i>n?1:-1;var r="translate(0,"+n+"px) ";this._setCssTransform(e,"",n,!1),this._hideItemInIE7(t,n),this.element.data("picker"+t+"ScrollCurrent",n);var s=this;return setTimeout(function(){s._scrollPicker(t)},o),!0},i.prototype._scrollTheViewByTouch=function(t,e){var i=this.element.data("itemHeight"),n=this.element.data("picker"+t+"ScrollCurrent"),o=this.element.data("picker"+t+"ScrollTo");this.element.data("picker"+t+"ScrollTo",e),this._scrollPickerByTouch(t)},i.prototype._setCssTransform=function(t,i,n,o){var r=n;o||(r="translate(0, "+i+n+"px)"),t.css("position",""),t.css("top",""),e.Utility.IsIE8OrBelow()?(t.css("position","relative"),t.css("top",i+n+"px")):e.Utility.IsIE9()?t.css("-ms-transform",r):t.css("transform",r)},i.prototype._scrollPickerByTouch=function(t){var e=this.element.data("div"+t+"Mask"),i=this.element.data("picker"+t+"ScrollTo"),n=this.element.data("picker"+t+"ScrollCurrent");if(void 0==n&&(n=i,this._setCssTransform(e,"",n,!1),this.element.data("picker"+t+"ScrollCurrent",n)),i==n){if(this.element.data("picker"+t+"ScrollRate",1),this.element.data("picker"+t+"ScrollDelay",5),this.element.data("touchQuickScroll",!1),"Month"==t||"Year"==t)this._updateDayPickerMaxCount();else if("Hour"==t){var o=this._getItemIndexByPosition(t,n),r=this.element.data("pickerAM");11==o?0==r&&(r=1,this._updateItemTransform("AM",r),this._scrollTheView("AM",r,0,!1),this.element.data("pickerAM",r)):1==r&&(r=0,this._updateItemTransform("AM",r),this._scrollTheView("AM",r,1,!1),this.element.data("pickerAM",r))}return!1}var s=this.element.data("itemHeight"),a=this.element.data("picker"+t+"ScrollDelay"),l=this.element.data("picker"+t+"ScrollRate"),h=Math.abs(i-n),d=h>l?l:h;1==this.element.data("touchQuickScroll")&&(s>h?a=80:2*s>h?a=50:5*s>h?a=30:8*s>h?a=20:10*s>h&&(a=10),this.element.data("picker"+t+"ScrollDelay",a)),n+=i>n?d:-1*d,this._setCssTransform(e,"",n,!1),this.element.data("picker"+t+"ScrollCurrent",n);var o=this._getItemIndexByPosition(t,n),c=this.element.data("picker"+t+"LastItemIndex");o!=c&&this._updateItemTransform(t,o),this.element.data("picker"+t+"LastItemIndex",c);var u=this;return setTimeout(function(){u._scrollPickerByTouch(t)},a),!0},i.prototype._syncCalendar=function(){var t=this.element.data("calendar");if(t){var e=this._safeGetDate();(null==e||this._isMinDate(e))&&(e=new Date),t.wijcalendar("option","displayDate",e),this.options.minDate&&t.wijcalendar("option","minDate",this.options.minDate),this.options.maxDate&&t.wijcalendar("option","maxDate",this.options.maxDate),t.wijcalendar("unSelectAll"),t.wijcalendar("selectDate",e),t.wijcalendar("refresh")}},i.prototype._showPopup=function(){if(!this._allowEdit())return!1;this._isDatePickerNeedReInit()&&this._reInitPicker();var t=this.element.data("pickers");if(void 0==t)return!1;t.wijpopup("show",n.extend({},this.options.popupPosition,{of:this.outerDiv}));var e=this._getPickerValue(),i=e.getHours();if(i>12?i-=12:0==i&&(i=12),this.element.data("pickerValue",e),this.element.data("pickerYear",e.getFullYear()),this.element.data("pickerMonth",e.getMonth()+1),this.element.data("pickerDay",e.getDate()),this.element.data("pickerHour",i),this.element.data("pickerMinute",e.getMinutes()),this.element.data("pickerAM",e.getHours()<12?0:1),this.element.data("divOK").css("visibility",""),this._isTimePickerShown()&&(this._updateTimePicker(),t.attr({"class":"ui-widget-content ui-corner-all"})),this._isDatePickerShown()&&(this._updateDatePicker(),t.css({"font-size":"12px"}).attr({"class":"ui-widget-content ui-corner-all"})),this._isListPickerShown()&&(1==this._getPickerCount()&&(t.attr({"class":""}),this._comboDiv.focus()),"List"==this.element.data("pickerCurrentTab"))){var o=this._getListPickerWidth();t.css({width:o,height:""}),t.css({"font-size":""});var r=this._comboDiv[0].parentElement;this._comboDiv.wijlist("destroy"),this._comboDiv.remove(),delete this._comboDiv,this._initListPicker(),this._comboDiv.appendTo(r),this._comboDiv.focus()}return this._isCalendarPickerShown()&&(this._syncCalendar(),"Calendar"==this.element.data("pickerCurrentTab")&&(this._getPickerCount()<=1&&t.css({width:""}).attr({"class":""}),t.css({"font-size":""}))),!0},i.prototype._hidePopup=function(){var t=this.element.data("pickers");void 0!=t&&t.wijpopup("hide"),this.element.data("divOK").css("visibility","hidden")},i.prototype._popupVisible=function(){var t=this.element.data("pickers");return void 0!=t?t.wijpopup("isVisible"):!1},i.prototype._isComboListVisible=function(){return this._popupVisible()},i.prototype._isValidDate=function(t,e){if(void 0===t)return!1;if(isNaN(t))return!1;if(t.getFullYear()<1||t.getFullYear()>9999)return!1;if(e){if(this.options.minDate&&t<this.options.minDate)return!1;if(this.options.maxDate&&t>this.options.maxDate)return!1}return!0},i.prototype._isValidatePickerFormat=function(t){switch(t){case"yyyy":case"M":case"MM":case"MMM":case"MMMM":case"d":case"dd":case"h":case"hh":case"m":case"mm":case"t":case"tt":return!0}return!1},i.prototype._isDatePickerNeedReInit=function(){if(!this._isDatePickerShown())return!1;var t=this.element.data("pickerMinYear"),e=this.element.data("pickerMaxYear"),i=this._getPickerValue().getFullYear();if(t>i||i>e)return!0;var n=this._isEraFormatExist()?this._getRealEraMinDate().getFullYear():this._getRealMinDate().getFullYear(),o=this._isEraFormatExist()?this._getRealEraMaxDate().getFullYear():this._getRealMaxDate().getFullYear();return n>t||e>o?!0:!1},i.prototype._isDropDownButtonShown=function(){return this.options.showDropDownButton},i.prototype._isCalendarPickerShown=function(){return void 0!=this.options.pickers.calendar&&this.options.pickers.calendar.visible!==!1||0==this._getPickerCount()},i.prototype._isListPickerShown=function(){var t=this._getcomboItems();return void 0!=t&&void 0!=t.length?t.length>0:!1},i.prototype._isTimePickerShown=function(){return void 0!=this.options.pickers.timePicker&&this.options.pickers.timePicker.visible!==!1},i.prototype._isDatePickerShown=function(){return void 0!=this.options.pickers.datePicker&&this.options.pickers.datePicker.visible!==!1},i.prototype._getPickerCount=function(){var t=0,e=void 0!=this.options.pickers.calendar&&this.options.pickers.calendar.visible!==!1;return t+=e?1:0,t+=this._isListPickerShown()?1:0,t+=this._isTimePickerShown()?1:0,t+=this._isDatePickerShown()?1:0},i.prototype._addPickerEditor=function(t,e,i){var o=n("<div/>").attr({id:i,align:"center"}).css({padding:"0px"}).append(e).appendTo(t)},i.prototype._addPickerTab=function(t,e,i){var o=n("<li/>").appendTo(t).css("line-height","1px"),r=n("<a/>").attr("href",i).html(e).appendTo(o)},i.prototype.selectText=function(e,i){if("undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=this.getText().length),this.isFocused())t.prototype.selectText.call(this,e,i);else{this.focus();var n=this;setTimeout(function(){n.selectText(e,i)},0)}},i}(e.wijinputcore);e.wijinputdate=r;var s=function(){function t(){this.wijCSS={wijinputdate:e.wijinputcore.prototype.options.wijCSS.wijinput+"-date"},this.date=void 0,this.minDate=null,this.maxDate=null,this.dateFormat="d",this.displayFormat="",this.amDesignator="",this.pmDesignator="",this.midnightAs0=!0,this.hour12As0=!1,this.blurOnLastChar=!1,this.blurOnLeftRightKey="none",this.tabAction="field",this.startYear=1950,this.smartInputMode=!1,this.activeField=0,this.keyDelay=800,this.autoNextField=!0,this.calendar="default",this.popupPosition={offset:"0 4"},this.imeMode="auto",this.showDropDownButton=!0,this.showTrigger=void 0,this.pickers={list:void 0,width:void 0,height:void 0,calendar:void 0,datePicker:void 0,timePicker:void 0},this.dateChanged=null,this.spinUp=null,this.spinDown=null,this.valueBoundsExceeded=null}return t}();r.prototype.options=n.extend(!0,{},e.wijinputcore.prototype.options,new s),n.wijmo.registerWidget("wijinputdate",r.prototype);var a=function(){function t(){}return t.EraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),t.EraCount=4,t.EraYears=new Array(45,15,64,99),t.EraMax=new Date(2087,11,31,23,59,59),t.EraMin=new Date(1868,8,8),t.EraKeys=new Array("1","2","3","4","m","t","s","h"),t.EraIndices=new Array(0,1,2,3,0,1,2,3),t.DateLongFormat="yyyyMMddHHmmss",t.EraNames=new Array("M","T","S","H","明","大","昭","平","明治","大正","昭和","平成"),t.WeekDays=new Array("日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"),t.MonthNames=new Array("1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"),t.ShortWeekDays=new Array("日","月","火","水","木","金","土"),t.ShortMonthNames=new Array("1","2","3","4","5","6","7","8","9","10","11","12"),t.RokuyouTextArray=new Array("先勝","友引","先負","仏滅","大安","赤口"),t.RokuyouTextArrayEn=new Array("Senshou","Tomobiki","Senbu","Butsumetsu","Taian","Shakkou"),t.DefaultTwoDigitYear=2029,t.Digits=2,t.EraYearMax=99,t.RokuyouMin=new Date(1960,0,28),t.RokuyouMax=new Date(2050,0,22),t.LunarInfo=new Array(44710,43856,19808,43748,42352,21104,29283,55632,27479,22176,39632,19925,19168,42208,54484,53840,54680,46400,54944,103846,38320,18864,43444,42160,45690,27216,27968,46934,11104,38320,19317,18800,25776,29859,59984,28056,21968,11104,38629,37600,51552,59732,54432,55888,30034,22208,43959,9680,37584,51893,43344,46240,111779,46416,21977,19360,42416,21877,21168,43344,47444,27296,44368,27474,19296,42726,42352,21104,27237,55600,23200,46755,38608,19415,19168,42192,118998,53840,54560,56645,46752,38608,21938,18864,42359,42160,45648,111189,27968,44448),t.IsValidEraDate=function(t){return t<this.GetEraMin()||t>this.GetEraMax()?!1:!0},t.ConvertToGregorianYear=function(t,e,i){return 0>t||t>=this.GetEraCount()||1>e||i&&e>this.GetEraYears()[t]?-1:this.GetEraDates()[t].getFullYear()+e-1},t.GetEraDates=function(){if(void 0!=window.eras){for(var t=new Array,e=0;e<window.eras.length;e++){var i=new Date(window.eras[e].startDate.replace(/-/g,"/"));t[e]=i}return t}return this.EraDates},t.GetEraNames=function(){var t=new Array;if(void 0!=window.eras){for(var e=0;e<window.eras.length;e++)t[e]=window.eras[e].name;return t}for(var e=0;e<this.EraCount;e++)t[e]=this.EraNames[e+2*this.EraCount];return t},t.GetEraSymbols=function(){var t=new Array;if(void 0!=window.eras){for(var e=0;e<window.eras.length;e++)t[e]=window.eras[e].symbol;return t}for(var e=0;e<this.EraCount;e++)t[e]=this.EraNames[e];return t},t.GetEraAbbreviations=function(){var t=new Array;if(void 0!=window.eras){for(var e=0;e<window.eras.length;e++)t[e]=window.eras[e].abbreviation;return t}for(var e=0;e<this.EraCount;e++)t[e]=this.EraNames[e+this.EraCount];return t},t.GetEraShortNames=function(){var t=new Array;if(void 0!=window.eras){for(var e=0;e<window.eras.length;e++)t[e]=window.eras[e].shortcuts.split(",")[1];return t}for(var e=0;e<this.EraCount;e++)t[e]=this.EraNames[e];return t},t.GetEraShortcuts=function(){var t=new Array;if(void 0!=window.eras){for(var e=0;e<window.eras.length;e++)t[e]=window.eras[e].shortcuts.split(",")[0];return t}for(var e=0;e<this.EraCount;e++)t[e]=this.EraKeys[e];return t},t.GetEraMax=function(){if(void 0!=window.eras&&window.eras.length>0){var t=new Date(window.eras[window.eras.length-1].startDate.replace(/-/g,"/"));return t.setFullYear(t.getFullYear()+99),t}return this.EraMax},t.GetEraMin=function(){if(void 0!=window.eras&&window.eras.length>0){var t=new Date(window.eras[0].startDate.replace(/-/g,"/"));return t}return this.EraMin},t.GetEraCount=function(){return void 0!=window.eras?window.eras.length:this.EraCount},t.GetEraYears=function(){if(void 0!=window.eras){for(var t=new Array,e=1;e<window.eras.length;e++){var i=new Date(window.eras[e-1].startDate.replace(/-/g,"/")),n=new Date(window.eras[e].startDate.replace(/-/g,"/"));t[e-1]=n.getFullYear()-i.getFullYear()+1}return t[e-1]=99,t}return this.EraYears},t.ConvertToGregorianDate=function(t,e,i,n,o,r,s,a){var l=this.ConvertToGregorianYear(t,e,a);if(1>l||l>9999)return null;if(1>i||i>12)return null;var h=this.DaysInMonth(l,i);if(1>n||n>h)return null;if(0>o||o>23)return null;if(0>r||r>59)return null;if(0>s||s>59)return null;var d=new Date(l,i-1,n,o,r,s);if(a){var c=this.GetEraDates()[t],u=t+1!=this.GetEraCount()?this.AddMilliseconds(this.GetEraDates()[t+1],-1):this.GetEraMax();if(c>d||d>u)return null}return d},t.String2Date=function(t){if(null==t||0==t.Length)return null;var e=new Date(Date.parse(t));return e},t.Date2String=function(t,i,n,o){var r="";try{r=1==i?1==n?t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate():1==o?t.getHours()+":"+e.Utility.ToString(t.getMinutes(),2,"0")+":"+e.Utility.ToString(t.getSeconds(),2,"0"):t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+t.getHours()+":"+e.Utility.ToString(t.getMinutes(),2,"0")+":"+e.Utility.ToString(t.getSeconds(),2,"0"):1==n?t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear():1==o?t.getHours()+":"+e.Utility.ToString(t.getMinutes(),2,"0")+":"+e.Utility.ToString(t.getSeconds(),2,"0"):t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+" "+t.getHours()+":"+e.Utility.ToString(t.getMinutes(),2,"0")+":"+e.Utility.ToString(t.getSeconds(),2,"0")}catch(s){r=""}return r},t.Date2Long=function(t){try{return 100*(100*t.getFullYear()+t.getMonth()+1)+t.getDate()}catch(e){return 0}},t.Date2Number=function(t){return null==t?0:100*(100*(100*(100*(100*t.getFullYear()+t.getMonth()+1)+t.getDate())+t.getHours())+t.getMinutes())+t.getSeconds()},t.Long2Date=function(t){return new Date(Math.floor(t/1e4),Math.floor(t%1e4/100)-1,t%100)},t.GetEraDate=function(t){var e=new Object;if(e.era=-1,e.eraYear=-1,!this.IsValidEraDate(t))return e;for(var i=0;i<this.GetEraCount();i++){var n=i+1!=this.GetEraCount()?this.GetEraDates()[i+1]:this.AddMilliseconds(this.GetEraMax(),1);if(n>t){e.era=i,e.eraYear=t.getFullYear()-this.GetEraDates()[i].getFullYear()+1;break}}return e},t.MakeDate=function(t,e,i,n){var o=new Date;return o=this.ConvertToGregorianDate(t,e,i,n,0,0,0,!0),null==o?-1:o},t.GetValidMonthRange=function(t,e){var i={};return i.min=1,i.max=12,-1==t||-1==e?i:(1==e?i.min=this.GetEraDates()[t].getMonth()+1:e==this.EraYears[t]&&t<this.EraCount-1&&(i.max=this.AddMilliseconds(this.GetEraDates()[t+1],-1).getMonth()+1),i)},t.GetValidDayRange=function(t,e,i){var n=new Object;n.min=1,n.max=this.DaysInMonth(this.ConvertToGregorianYear(t,e,!0),i);var o=this.GetEraDates()[t],r=t<this.GetEraCount()-1?this.AddMilliseconds(this.GetEraDates()[t+1],-1):this.GetEraMax();return-1==t||-1==e?n:(1==e&&i==o.getMonth()+1?n.min=o.getDate():e==this.EraYears[t]&&i==r.getMonth()+1&&(n.max=r.getDate()),n)},t.IsLeapYear=function(t){return t%400==0||t%4==0&&t%100!=0?!0:!1},t.DayOfYear=function(t,e,i){for(var n=0,o=1;e>o;o++)n+=this.DaysInMonth(t,o);return n+=i},t.DaysInMonth=function(t,e){if(e>12)t+=Math.floor(e/12),e%=12;else if(0>e){var i=-1*e;t-=Math.ceil(i/12),e=12-i%12}switch(e){case 2:return this.IsLeapYear(t)?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},t.Equal=function(t,e,i){if(null==t&&null==e)return!0;if(null==t)return!1;if(null==e)return!1;try{return i?t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==e.getDate()&&t.getHours()==e.getHours()&&t.getMinutes()==e.getMinutes()&&t.getSeconds()==e.getSeconds()?!0:!1:t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==e.getDate()?!0:!1}catch(n){return!1}},t.YearMonthEqual=function(t,e){if(null==t&&null==e)return!0;if(null==t)return!1;if(null==e)return!1;try{return t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()?!0:!1}catch(i){return!1}},t.SetDate=function(t,e,i){var n=new Date,o=12e4;if(12*t+e>o)n=new Date(9999,11,31);else if(100>12*t+e)n=new Date(100,0,1);else{var r=this.DaysInMonth(t,e);i>r&&(i=r),n=new Date(t,e-1,i)}return n},t.SetFullDate=function(t,e,i){var n=new Date;n.setDate(1);var o=12e4,r=this.DaysInMonth(t,e);return e>0&&12>e&&i>r&&(i=r),n.setFullYear(t),n.setMonth(e-1),n.setDate(i),n},t.SetFullDateByDate=function(t){var e=new Date;return e.setDate(1),e.setFullYear(t.getFullYear()),e.setMonth(t.getMonth()),e.setDate(t.getDate()),e.setHours(0,0,0,0),e},t.LYearDays=function(t){var e,i=348;for(e=32768;e>8;e>>=1)i+=this.LunarInfo[t-1960]&e?1:0;return i+this.leapDays(t)},t.leapDays=function(t){return this.LeapMonth(t)?65536&this.LunarInfo[t-1960]?30:29:0},t.LeapDays=function(t){return this.LeapMonth(t)?65536&this.LunarInfo[t-1960]?30:29:0},t.LeapMonth=function(t){
return 15&this.LunarInfo[t-1960]},t.MonthDays=function(t,e){return this.LunarInfo[t-1960]&65536>>e?30:29},t.GetRokuyou=function(t){if(!(t-this.RokuyouMin<0||t-this.RokuyouMax>0)){var e,i=0,n=0,o=new Date(1960,0,28),r=Math.round((t-o)/864e5);for(e=1960;2050>e&&r>0;e++)n=this.LYearDays(e),r-=n;for(0>r&&(r+=n,e--),this.year=e,i=this.LeapMonth(e),this.isLeap=!1,e=1;13>e&&r>0;e++)i>0&&e==i+1&&0==this.isLeap?(--e,this.isLeap=!0,n=this.LeapDays(this.year)):n=this.MonthDays(this.year,e),1==this.isLeap&&e==i+1&&(this.isLeap=!1),r-=n;0==r&&i>0&&e==i+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--e)),0>r&&(r+=n,--e),this.month=e,this.day=r+1;var s=(this.month+this.day-2)%6,a=new Date(1996,6,15),l=new Date(1996,7,13);this.IsDateInRange(t,a,l)&&(s=(6+s-1)%6);var h=new Date(1996,8,12),d=new Date(1996,9,11);this.IsDateInRange(t,h,d)&&(s=(6+s-1)%6);var c=new Date(2033,7,25),u=new Date(2033,11,21);this.IsDateInRange(t,c,u)&&(s=(s+1)%6),this.Equal(t,a)&&(s=(6+s-1)%6),this.Equal(t,h)&&(s=(6+s-1)%6);var p;return p}},t.IsDateInRange=function(t,e,i){var n=t.getYear(),o=e.getYear(),r=i.getYear(),s=t.getMonth(),a=e.getMonth(),l=i.getMonth(),h=t.getDate(),d=e.getDate(),c=i.getDate(),u=1e4*n+100*s+h,p=1e4*o+100*a+d,g=1e4*r+100*l+c;return u>=p&&g>=u},t.GetRokuyouText=function(t){var e=new Array;switch(e=this.RokuyouTextArray.slice(0),t){default:return""}},t.DaysInSpecialWeek=function(t,e,i){for(var n=new Array,o=this.DaysInMonth(t,e+1),r=new Date(t,e,1),s,a=1;o>=a;a++)if(r.setDate(a),r.getDay()==i){var l=new Date(t,e,a);n.push(l),s=a;break}for(s+=7;o>=s;){r.setDate(s);var h=new Date(t,e,s);n.push(h),s+=7}return n},t.GetDaysByFirstWeekday=function(t){var e=new Array;e.push(t);for(var i=new Date(t);i.getDate()+7<=this.DaysInMonth(t.getFullYear(),t.getMonth()+1);)i=new Date(i.getFullYear(),i.getMonth(),i.getDate()+7),e.push(i);return e},t.AddMilliseconds=function(t,e){var i=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return i.setMilliseconds(i.getMilliseconds()+e),new Date(i.valueOf())},t.GetWeekIndexByDate=function(t){return Math.floor(t.getDate()/7)},t}();e.DateTimeInfo=a;var l=function(t){function o(e,n,o){t.call(this),this.inputWidget=e,this.maskPartsCount=0,this.pattern="M/d/yyyy",this.displayPattern="M/d/yyyy",this._disableSmartInputMode=!1,this.paddingZero=i,this.descriptors=new Array(0),this.desPostions=new Array(0),this.fields=new Array(0),this.displayDescriptors=new Array(0),this.displayDesPostions=new Array(0),this.displayFields=new Array(0),this._setFormat(n),o=""==o?n:o,this._setDisplayFormat(o)}return __extends(o,t),o.prototype.initialize=function(){},o.prototype.getFiledText=function(t){var e=this.fields[t];return e.getText()},o.prototype.getFieldCount=function(){return this.fields.length},o.prototype.getFieldRange=function(t){t>=this.fields.length&&(t=this.fields.length-1);var e=this.fields[t];return{start:e.startIndex,end:e.startIndex+e.getText().length}},o.prototype.getCursorField=function(t){if(0==this.desPostions.length)return 0;t=Math.min(t,this.desPostions.length-1),t=Math.max(t,0);var e=this.desPostions[t].desc,i;if(-1===e.type){if(i=n.inArray(e,this.descriptors),!(i>0&&-1!==this.descriptors[i-1].type))return-1;e=this.descriptors[i-1]}return n.inArray(e,this.fields)},o.prototype.needToMove=function(t,e,i){if(!this.inputWidget._isValidDate(this.inputWidget._safeGetDate(),!0))return!1;var n=this.fields[t];switch(n.type){case 72:case 73:case 74:for(var o=0;o<a.GetEraCount();o++)if(i.toLowerCase()===a.GetEraShortcuts()[o].toLowerCase()||i.toLowerCase()===a.GetEraShortNames()[o].toLowerCase()||i.toLowerCase()===a.GetEraAbbreviations()[o].toLowerCase()||i.toLowerCase()===a.GetEraNames()[o].toLowerCase())return!0;return!1}var r=parseInt(i,10);if(e===n.maxLen)return!0;if(isNaN(r))return!1;var s=this.inputWidget.element.data("lastInputChar");switch(n.type){case 10:return this._isSmartInputMode()&&2===e;case 20:case 25:case 45:case 46:return"0"==s&&1==r?!0:r>1;case 47:case 48:return"0"==s&&2>=r?!0:r>2;case 30:case 31:return"0"==s&&3>=r?!0:r>3;case 50:case 51:case 60:case 61:return"0"==s&&6>=r?!0:r>6;case 70:case 71:return!1}return!1},o.prototype._isEraFormatExist=function(){for(var t=0;t<this.descriptors.length;t++)if(this.descriptors[t].type>=70&&this.descriptors[t].type<=74)return!0;return!1},o.prototype._getCulture=function(){return this.inputWidget._getCulture()},o.prototype._isDigitString=function(t){if(t=n.trim(t),0===t.length)return!0;var e=t.charAt(0),i,o;if(("+"===e||"-"===e)&&(t=t.substr(1),t=n.trim(t)),0===t.length)return!0;try{return i=parseFloat(t),o=i.toString(),o===t}catch(r){return!1}},o.prototype._setFormat=function(t){var e=this.inputWidget._getCulture();null!=e&&(this.pattern=this._parseFormatToPattern(t),this.descriptors=this._parseFormat(this.pattern),this.fields=n.grep(this.descriptors,function(t){return-1!==t.type}))},o.prototype._setDisplayFormat=function(t){var e=this.inputWidget._getCulture();null!=e&&(this.displayPattern=this._parseFormatToPattern(t),this.displayDescriptors=this._parseFormat(this.displayPattern),this.displayFields=n.grep(this.descriptors,function(t){return-1!==t.type}))},o.prototype._parseFormat=function(t){var e=[],i="",n="",o=!1,r=!1,s,a;for(s=0;s<t.length;s++)a=t.charAt(s),r?(e.push(this.createDescriptor(-1,a)),i="",r=!1):"\\"!==a?"'"!==a?o?(e.push(this.createDescriptor(-1,a)),i=""):(s||(n=a),n!==a&&i.length>0&&(this.handlePattern(i,e)||e.push(this.createDescriptor(-1,n)),i=""),i+=a,n=a):o?(o=!1,i=""):(o=!0,i.length>0&&(this.handlePattern(i,e)||e.push(this.createDescriptor(-1,n)),i="")):(r=!0,i.length>0&&(this.handlePattern(i,e)||e.push(this.createDescriptor(-1,n)),i=""));return i.length>0&&(this.handlePattern(i,e)||e.push(this.createDescriptor(-1,n))),e},o.prototype._parseFormatToPattern=function(t){var e=this.inputWidget._getCulture().calendars.standard,i=e.patterns.d;if(t.length<=1)switch(t){case"":case"d":i=e.patterns.d;break;case"D":i=e.patterns.D;break;case"f":i=e.patterns.D+" "+e.patterns.t;break;case"F":i=e.patterns.D+" "+e.patterns.T;break;case"g":i=e.patterns.d+" "+e.patterns.t;break;case"G":i=e.patterns.d+" "+e.patterns.T;break;case"m":i=e.patterns.M;break;case"M":i=e.patterns.M;break;case"s":i=e.patterns.S;break;case"t":i=e.patterns.t;break;case"T":i=e.patterns.T;break;case"u":i=e.patterns.S;break;case"U":i=e.patterns.D+" "+e.patterns.T;break;case"y":i=e.patterns.Y;break;case"Y":i=e.patterns.Y}else i=t;return i},o.prototype.getDate=function(){return this.inputWidget?new Date(this.inputWidget._safeGetDate(!0).getTime()):void 0},o.prototype.setDate=function(t){this.inputWidget&&this.inputWidget._setData(t)},o.prototype._internalSetDate=function(t){if(this.inputWidget){var e=this,i=this.inputWidget.options,n=this.inputWidget.element,o=!!n.data("typing"),r;o?(i.date=t,r=function(){var t=new Date,o=n.data("timeStamp");o&&(t.getTime()-o.getTime()>i.keyDelay?(e.inputWidget._safeSetDate(i.date,!0),e.inputWidget._updateText(),e.inputWidget._highLightField()):window.setTimeout(r,i.keyDelay))},window.setTimeout(r,i.keyDelay)):this.inputWidget._safeSetDate(t)}},o.prototype.daysInMonth=function(t,e){t-=1;var i=new Date(e,++t,1,-1).getDate();return i},o.prototype.setYear=function(t,e,i){try{if(e&&e.isfullreset&&(e.offset=1,t="1970"),"string"==typeof t&&!this._isDigitString(t))return!1;t*=1;var n=this.inputWidget.options,o=1,r=9999,s,a,l;return i&&(n.minDate&&(o=Math.max(o,n.minDate.getFullYear())),n.maxDate&&(r=Math.min(r,n.maxDate.getFullYear()))),e&&e.isreset&&(t=o),o>t&&(t=o),t>r&&(t=r),s=this.getDate(),a=new Date(s.getTime()),a.setFullYear(t),this._isValidDate(a)?(l=this.daysInMonth(this.getMonth(),this.getYear()),l===s.getDate()?(a=new Date(s.getTime()),a.setDate(1),a.setFullYear(t),l=this.daysInMonth(a.getMonth()+1,a.getFullYear()),a.setDate(l),this._isValidDate(a)?(this._internalSetDate(a),!0):!1):(s.setFullYear(t),this._internalSetDate(s),!0)):e&&e.isreset?(s.setFullYear(1),this._internalSetDate(s),!0):!1}catch(h){return!1}},o.prototype.getYear=function(){return this.getDate().getFullYear()},o.prototype.setMonth=function(t,e,i){try{i&&i.isfullreset&&(t="1"),t*=1;var n=this.getDate(),o,r;if("undefined"!=typeof e&&!e&&(t>12||1>t)){if(!i||!i.isreset)return!1;t=1}return o=this.daysInMonth(this.getMonth(),this.getYear()),o===this.getDate().getDate()?(r=new Date(n.getTime()),r.setDate(1),r.setMonth(t-1),o=this.daysInMonth(r.getMonth()+1,r.getFullYear()),r.setDate(o),this._isValidDate(r)?(this._internalSetDate(r),!0):!1):(r=new Date(n.getTime()),r.setMonth(t-1),this._isValidDate(r)?(this._internalSetDate(r),!0):!1)}catch(s){return!1}},o.prototype.getMonth=function(){return this.getDate().getMonth()+1},o.prototype.setDayOfMonth=function(t,e,i){try{if(i&&i.isfullreset)return this.setDayOfMonth(1,e);var n=this.getDate(),o,r;return t*=1,"undefined"!=typeof e&&!e&&(o=this.daysInMonth(this.getMonth(),this.getYear()),t>o||1>t)?i&&i.isreset?this.setDayOfMonth(1,e,i):!1:(r=new Date(n.getTime()),r.setDate(t),this._isValidDate(r)?(this._internalSetDate(r),!0):!1)}catch(s){return!1}},o.prototype.getDayOfMonth=function(){return this.getDate().getDate()},o.prototype.setHours=function(t,e){try{if(t*=1,"undefined"!=typeof e&&!e&&t>24)return!1;var i=new Date(this.getDate().getTime());return i.setHours(t),this._isValidDate(i)?(this._internalSetDate(i),!0):!1}catch(n){return!1}},o.prototype.getHours=function(){return this.getDate().getHours()},o.prototype.setMinutes=function(t,e){try{if(t*=1,"undefined"!=typeof e&&!e&&t>60)return!1;var i=new Date(this.getDate().getTime());return i.setMinutes(t),this._isValidDate(i)?(this._internalSetDate(i),!0):!1}catch(n){return!1}},o.prototype.getMinutes=function(){return this.getDate().getMinutes()},o.prototype.setSeconds=function(t,e){try{if(t*=1,"undefined"!=typeof e&&!e&&t>60)return!1;var i=new Date(this.getDate().getTime());return i.setSeconds(t),this._isValidDate(i)?(this._internalSetDate(i),!0):!1}catch(n){return!1}},o.prototype.getSeconds=function(){return this.getDate().getSeconds()},o.prototype.setDayOfWeek=function(t){try{t*=1;var e=t-this.getDayOfWeek();return this.setDayOfMonth(this.getDayOfMonth()+e,!0)}catch(i){return!1}},o.prototype.getDayOfWeek=function(){return this.getDate().getDay()+1},o.prototype.handlePattern=function(t,e){var i=new RegExp("y{3,4}"),n=i.test(t);return n?(e.push(this.createDescriptor(10)),!0):(i=new RegExp("y{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(2)),!0):(i=new RegExp("y{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(1)),!0):(i=new RegExp("d{4,4}"),n=i.test(t),n?(e.push(this.createDescriptor(101)),!0):(i=new RegExp("d{3,3}"),n=i.test(t),n?(e.push(this.createDescriptor(100)),!0):(i=new RegExp("d{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(30)),!0):(i=new RegExp("d{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(31)),!0):(i=new RegExp("M{4,4}"),n=i.test(t),n?(e.push(this.createDescriptor(27)),!0):(i=new RegExp("M{3,3}"),n=i.test(t),n?(e.push(this.createDescriptor(26)),!0):(i=new RegExp("M{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(20)),!0):(i=new RegExp("M{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(25)),!0):(i=new RegExp("h{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(46)),!0):(i=new RegExp("h{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(45)),!0):(i=new RegExp("H{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(48)),!0):(i=new RegExp("H{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(47)),!0):(i=new RegExp("m{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(50)),!0):(i=new RegExp("m{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(51)),!0):(i=new RegExp("s{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(60)),!0):(i=new RegExp("s{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(61)),!0):(i=new RegExp("t{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(251)),!0):(i=new RegExp("t{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(250)),!0):(i=new RegExp("e{2,10}"),n=i.test(t),n?(e.push(this.createDescriptor(71)),!0):(i=new RegExp("e{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(70)),!0):(i=new RegExp("g{3,10}"),n=i.test(t),n?(e.push(this.createDescriptor(74)),!0):(i=new RegExp("g{2,2}"),n=i.test(t),n?(e.push(this.createDescriptor(73)),!0):(i=new RegExp("g{1,1}"),n=i.test(t),n?(e.push(this.createDescriptor(72)),!0):!1)))))))))))))))))))))))))},o.prototype.createDescriptor=function(t,e){var i=null,n=this.maskPartsCount++;switch(t){case-1:i=new c(this,n),i.liternal=e;break;case 20:i=new _(this,n);break;case 25:i=new S(this,n);break;case 26:i=new x(this,n);break;case 27:i=new b(this,n);break;case 30:i=new D(this,n);break;case 31:i=new I(this,n);break;case 100:i=new j(this,n);break;case 101:i=new T(this,n);break;case 10:i=new L(this,n);break;case 1:i=new P(this,n);break;case 2:i=new M(this,n);break;case 45:i=new B(this,n);break;case 46:i=new R(this,n);break;case 47:i=new G(this,n);break;case 48:i=new U(this,n);break;case 250:i=new V(this,n);break;case 251:i=new H(this,n);break;case 50:i=new z(this,n);break;case 51:i=new K(this,n);break;case 60:i=new Y(this,n);break;case 61:i=new q(this,n);break;case 70:i=new p(this,n);break;case 71:i=new g(this,n);break;case 72:i=new m(this,n);break;case 73:i=new w(this,n);break;case 74:i=new y(this,n)}return i},o.prototype.toString=function(){if(this.inputWidget._isEraFormatExist()&&null!=this.inputWidget.options.date){var t=this.inputWidget._getRealEraMinDate(),e=this.inputWidget._getRealEraMaxDate();if(this.inputWidget.options.date<t||this.inputWidget.options.date>e)return""}if(!this.inputWidget.isFocused())return this.inputWidget.isDateNull()&&null!=this.inputWidget._getInnerNullText()?this.inputWidget._getInnerNullText():this.getDisplayString();var i="",n=0,o,r,s;for(this.desPostions=new Array(0),o=0;o<this.descriptors.length;o++)for(this.descriptors[o].startIndex=i.length,r=this.descriptors[o].getText(),i+=r,s=0;s<r.length;s++)if(this.desPostions.push({desc:this.descriptors[o],pos:s,text:r,length:r.length}),n++,this.desPostions.length!==n)throw"Fatal Error !!!!!!!!!!!!!!!";return i},o.prototype.getDisplayString=function(){var t="",e=0,i,n,o,r=new Array(0);for(i=0;i<this.displayDescriptors.length;i++)for(this.displayDescriptors[i].startIndex=t.length,n=this.displayDescriptors[i].getText(),t+=n,o=0;o<n.length;o++)if(r.push({desc:this.displayDescriptors[i],pos:o,text:n,length:n.length}),e++,r.length!==e)throw"Fatal Error !!!!!!!!!!!!!!!";return t},o.prototype.parseDate=function(t){var e;if("dddd"===this.pattern||"ddd"===this.pattern||"object"==typeof t)try{e=new Date(t),isNaN(e)&&(e=new Date)}catch(i){e=new Date}else e=Globalize.parseDate(t,this.pattern,this._getCulture()),e||(e=this._tryParseDate(t,this.pattern)),e||(e=null);return e},o.prototype.setText=function(t){var e=this.parseDate(t);return null==e?this._internalSetDate(null):this._internalSetDate(new Date(e)),!0},o.prototype.haveEnumParts=function(){return!1},o.prototype.removeLiterals=function(t){return t=""+t,t=t.replace(new RegExp("[+]","g"),""),t=t.replace(new RegExp("[.]","g"),""),t=t.replace(new RegExp("[:]","g"),""),t=t.replace(new RegExp("[-]","g"),""),t=t.replace(new RegExp("[()=]","g"),"")},o.prototype.getFirstDelimiterPos=function(t,e){for(var i=0,n=0,o,r;i<e.length&&n<t.length;){if(o=e.charAt(i),r=t.charAt(n),o!==r)return n-1;n++,i++}return t.length-1},o.prototype.findAlikeArrayItemIndex=function(t,e){var i=-1,n=99999,o,r;for(o=0;o<t.length;o++)r=t[o].toLowerCase().indexOf(e.toLowerCase()),-1!==r&&n>r&&(n=r,i=o);return i},o.prototype._isValidDate=function(t){return this.inputWidget._isValidDate(t)},o.prototype.isFieldSep=function(t,e){var i=e++,n;return i<this.descriptors.length?(n=this.descriptors[i],-1!==n.type?!1:t===n.text):!1},o.prototype.getPositionType=function(t){var e=this.desPostions[t];return e.desc.type},o.prototype.addToField=function(t,e,i){var n=this.fields[e],o,r,s;return o=t,r={val:t,pos:0,offset:0,isreset:!1},this.inputWidget.element.data("typing",!0),s=n.setText(o,1===t.length?!1:!0,r),this.inputWidget.element.data("typing",!1),s},o.prototype.insertAt=function(t,i,n){"undefined"==typeof n&&(n=new e.wijInputResult),n.testPosition=-1;var o,r,s,a,l,h,d,c,u,p,g,f,m,w,y,v,_;if(1===t.length&&(o=this.desPostions[i],o&&-1===o.desc.type&&o.text===t))return n.testPosition=i,n.hint=n.characterEscaped,!0;for(r=t,s=i,t=this.removeLiterals(t),a=t,l=!1,d=!1,s>0&&1===a.length&&(s--,i=s,o=this.desPostions[s],l=!0,o&&(-1===o.desc.type||1!==o.desc.getText().length)&&(i++,s++,l=!1)),h=!1;a.length>0&&s<this.desPostions.length;)if(o=this.desPostions[s],-1!==o.desc.type)if(o.desc.needAdjustInsertPos()){c=a.substr(0,o.length-o.pos),c=o.text.slice(0,o.pos)+c+o.text.slice(o.pos+c.length,o.length),l&&(c=o.text+c),d&&(c+=o.text),p=o.desc.getText().length,f="";try{1===t.length&&(o.pos?o.pos>0&&(f=c.substring(0,o.pos+1)):f=t)}catch(S){}if(1===p&&c.length>1&&1===t.length&&(31===o.desc.type||25===o.desc.type)&&(this._disableSmartInputMode=!0),u={val:t,pos:o.pos,offset:0,isreset:!1},h=o.desc.setText(c,1===t.length?!1:!0,u),this._disableSmartInputMode=!1,!h&&"undefined"!=typeof f&&f.length>0&&(26===o.desc.type||27===o.desc.type||100===o.desc.type||101===o.desc.type||250===o.desc.type||251===o.desc.type)&&(h=o.desc.setText(f,1===t.length?!1:!0,u)),h)n.hint=n.success,n.testPosition=s+u.offset,1===t.length&&(m=o.desc.getText().length,g=o.pos,o.pos>m-1&&(g=m),w=m-p,w>0&&o.pos===p-1&&(g=m-1),y=this.toString(),n.testPosition=o.desc.startIndex+g+u.offset),a=a.slice(o.length-o.pos,a.length);else if(n.hint=n.invalidInput,-1!==n.testPosition&&(n.testPosition=i),-1!==o.desc.type&&1===t.length)return!1;s+=o.length}else v=this.getFirstDelimiterPos(a,r),0>v&&(v=0),c=a.substring(0,v+1),u={val:t,pos:o.pos,offset:0,isreset:!1},h=o.desc.setText(c,1===t.length?!1:!0,u),h?(n.hint=n.success,n.testPosition=s+u.offset,a=a.slice(v+1,a.length)):(n.hint=n.invalidInput,-1!==n.testPosition&&(n.testPosition=i)),0>v&&(v=0),_=v+1,s+=_;else s+=o.length;return h},o.prototype.removeAt=function(t,e,i){try{var n=this.desPostions[t],o,r,s,a,l=this.inputWidget,h=l.element,d=h.val().length;return d===e+1&&0===t&&(l.isDeleteAll=!0),n.desc.needAdjustInsertPos()&&(o="0",r=t,n.text=n.desc.getText(),o=n.text.slice(0,n.pos)+o+n.text.slice(n.pos+o.length,n.length),"tt"===n.desc.name?o="AM":"t"===n.desc.name?o="A":"ee"===n.desc.formatString?o="01":"e"===n.desc.formatString&&(o="1"),s={val:o,pos:n.pos,offset:0,isreset:!0,isfullreset:!1},e-t+1>=n.length&&(s.isfullreset=!0,t+=n.length,r=t),a=n.desc.setText(o,!1,s),a?(i.hint=i.success,i.testPosition=r):(i.hint=i.invalidInput,-1===i.testPosition&&(i.testPosition=t))),e>t&&this.removeAt(t+1,e,i),!0}catch(c){return!1}},o.prototype.incEnumPart=function(){var t=this.fields[this.inputWidget.options.activeField];return t&&t.inc(),!0},o.prototype.decEnumPart=function(t){var e=this.fields[this.inputWidget.options.activeField];return e&&e.dec(),!0},o.prototype.setValue=function(t){return this.setDate(new Date(t instanceof Date?t.getTime():t)),!0},o.prototype.getValue=function(){return this.getDate()},o.prototype._isSmartInputMode=function(){return this._disableSmartInputMode?!1:this.inputWidget?this.inputWidget.options.smartInputMode:!0},o.prototype._getInt=function(t,e,i,o){var r,s;for(r=o;r>=i;r--){if(s=t.substring(e,e+r),s.length<i)return null;if(n.wij.charValidator.isDigit(s))return s}return null},o.prototype._tryParseDate=function(t,e){var i=this._getCulture().calendars,n,o,r,s;return e=e||i.standard.patterns.d,e&&(-1===e.indexOf("MMM")&&-1===e.indexOf("MMMM")&&(e=e.replace("MM","M")),e=e.replace("dd","d"),e=e.replace("tt","a")),n=e.replace("yyyy","yy"),o=i.standard["/"],r=[e,n,e.replace(new RegExp(o,"g"),"-"),n.replace(new RegExp(o,"g"),"-"),e.replace(new RegExp(o,"g"),"."),n.replace(new RegExp(o,"g"),".")],s=Globalize.parseDate(t,r,this._getCulture()),s?s:(s=new Date(t),"Invalid Date"!==s.toString()&&t&&""!==t?s:0)},o.prototype._formatDate=function(t,e,n){var o=this;if(!t.valueOf())return"&nbsp;";var r=this.inputWidget._getCulture().calendars.standard,s=e.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(e){var s;switch(e){case"yyyy":return i(t.getFullYear(),4);case"MMMM":return n.dateTimeFormat.monthNames[t.getMonth()];case"MMM":return n.dateTimeFormat.abbreviatedMonthNames[t.getMonth()];case"MM":return o.paddingZero(t.getMonth()+1,2);case"M":return o.paddingZero(t.getMonth()+1,1);case"mm":return o.paddingZero(t.getMinutes(),2);case"m":return o.paddingZero(t.getMinutes(),1);case"dddd":return n.dateTimeFormat.dayNames[t.getDay()];case"ddd":return n.dateTimeFormat.abbreviatedDayNames[t.getDay()];case"dd":return o.paddingZero(t.getDate(),2);case"d":return o.paddingZero(t.getDate(),1);case"hh":return s=t.getHours()%12,o.paddingZero(s?s:12,2);case"h":return s=t.getHours()%12,o.paddingZero(s?s:12,1);case"HH":return o.paddingZero(t.getHours(),2);case"H":return o.paddingZero(t.getHours(),1);case"ss":return o.paddingZero(t.getSeconds(),2);case"s":return o.paddingZero(t.getSeconds(),1);case"tt":return t.getHours()<12?r.AM[0]:r.PM[0];case"t":return t.getHours()<12?r.AM[0].length>0?r.AM[0].charAt(0):"":r.PM[0].length>0?r.PM[0].charAt(0):"";case"a/p":return t.getHours()<12?"a":"p"}return"N"});return s},o}(e.wijTextProvider);e.wijDateTextProvider=l,function(t){t._map=[],t.liternal=-1,t.OneDigitYear=1,t.TwoDigitYear=2,t.FourDigitYear=10,t.TwoDigitMonth=20,t.Month=25,t.AbbreviatedMonthNames=26,t.MonthNames=27,t.EraYear=70,t.TwoEraYear=71,t.EraName=72,t.TwoEraName=73,t.ThreeEraName=74,t.TwoDigityDayOfMonth=30,t.DayOfMonth=31,t.AbbreviatedDayNames=100,t.DayNames=101,t.h=45,t.hh=46,t.H=47,t.HH=48,t.ShortAmPm=250,t.AmPm=251,t.mm=50,t.m=51,t.ss=60,t.s=61}(e.DescriptorType||(e.DescriptorType={}));var h=e.DescriptorType,d=function(){function t(t,e){this.id=e,this.startIndex=0,this.name=null,this.type=h.liternal,this.maxLen=2,this.formatString="",this._txtProvider=t,this.startIndex=0}return t.prototype.getText=function(){return null},t.prototype.getRealText=function(t){return null==this._txtProvider.inputWidget.options.date?this.formatString:t},t.prototype.setText=function(t,e,i){return!1},t.prototype.inc=function(){},t.prototype.dec=function(){},t.prototype.needAdjustInsertPos=function(){return!0},t.prototype.reachMaxLen=function(){var t=this.getText();do{if("0"!==t.charAt(0))break;t=t.slice(1)}while(t.length>0);return t.length>=this.maxLen},t}();e._iDateDescriptor=d;var c=function(t){function e(e,i){t.call(this,e,i),this.liternal="",this.maxLen=100}return __extends(e,t),e.prototype.getText=function(){return this.liternal},e}(d),u=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=this._txtProvider.getDate(),e=this._txtProvider.inputWidget._getRealEraMinDate(),i=this._txtProvider.inputWidget._getRealEraMaxDate();a.Equal(t,i)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(e.valueOf())):(this._txtProvider.setYear(this._txtProvider.getYear()+1,null,!0),this._txtProvider.getDate()>i&&this._txtProvider.setDate(new Date(i.valueOf())))},e.prototype.dec=function(){var t=this._txtProvider.getDate(),e=this._txtProvider.inputWidget._getRealEraMinDate(),i=this._txtProvider.inputWidget._getRealEraMaxDate();a.Equal(t,e)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(i.valueOf())):(this._txtProvider.setYear(this._txtProvider.getYear()-1,null,!0),this._txtProvider.getDate()<e&&this._txtProvider.setDate(new Date(e.valueOf())))},e}(d),p=function(t){function e(e,i){t.call(this,e,i),this.name="Era Year",this.formatString="e",this.type=h.EraYear}return __extends(e,t),e.prototype.getText=function(){var t=a.GetEraDate(this._txtProvider.getDate());return-1===t.eraYear?"":(t.eraYear=t.eraYear>99?99:t.eraYear,this.getRealText(String(t.eraYear)))},e.prototype.setText=function(t,e,i){if(isNaN(parseInt(t)))return!1;var n=this._txtProvider.getDate(),o=a.GetEraDate(n);if(-1!==o.eraYear){var r=parseInt(t);r>=a.GetEraYears()[o.era]&&(r=a.GetEraYears()[o.era]);var s=null==this._txtProvider.inputWidget.options.date;s&&(r=parseInt(t));var l=a.ConvertToGregorianDate(o.era,r,n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),!1);if(o.era<a.GetEraCount()-1){var h=a.GetEraDates()[o.era+1];l>h&&(r=a.GetEraYears()[o.era]-1,l=a.ConvertToGregorianDate(o.era,r,n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),!1))}return this._txtProvider.setDate(l),!0}return!1},e}(u),g=function(t){function e(e,i){t.call(this,e,i),this.name="Two Era Year",this.formatString="ee",this.type=h.TwoEraYear}return __extends(e,t),e.prototype.getText=function(){var t=a.GetEraDate(this._txtProvider.getDate());return-1===t.eraYear?"":(t.eraYear=t.eraYear>99?99:t.eraYear,this.getRealText(i(t.eraYear,2)))},e.prototype.setText=function(t,e,i){if(isNaN(parseInt(t)))return!1;var n=this._txtProvider.getDate(),o=a.GetEraDate(n);if(-1!==o.eraYear){var r=String(o.eraYear)+t,s=parseInt(r.substring(r.length-2,r.length));s>a.GetEraYears()[o.era]&&(s=a.GetEraYears()[o.era]);var l=null==this._txtProvider.inputWidget.options.date;l&&(s=parseInt(t));var h=a.ConvertToGregorianDate(o.era,s,n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),!1);if(o.era<a.GetEraCount()-1){var d=a.GetEraDates()[o.era+1];h>d&&(s=a.GetEraYears()[o.era]-1,h=a.ConvertToGregorianDate(o.era,s,n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),!1))}return this._txtProvider.setDate(h),!0}return!1},e}(u),f=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=this._txtProvider.getDate(),e=a.GetEraDate(t);if(-1!==e.era){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();if(a.Equal(t,n))this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(i.valueOf()));else if(e.era>=a.GetEraCount()-1)this._txtProvider.setDate(new Date(n.valueOf()));else{var o=e.era+1,r=e.eraYear>a.GetEraYears()[o]?a.GetEraYears()[o]:e.eraYear,s=a.ConvertToGregorianDate(o,r,t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),!0);s=null==s?a.GetEraDates()[o]:s,s>n?this._txtProvider.setDate(new Date(n.valueOf())):this._txtProvider.setDate(s)}}},e.prototype.dec=function(){var t=this._txtProvider.getDate(),e=a.GetEraDate(t);if(-1!==e.era){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();if(a.Equal(t,i))this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(n.valueOf()));else if(0==e.era)this._txtProvider.setDate(new Date(i.valueOf()));else{var o=e.era-1,r=e.eraYear>a.GetEraYears()[o]?a.GetEraYears()[o]:e.eraYear,s=a.ConvertToGregorianDate(o,r,t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),!0);null==s&&(s=new Date(a.GetEraDates()[o+1]),s.setDate(s.getDate()-1)),s>n?this._txtProvider.setDate(new Date(i.valueOf())):this._txtProvider.setDate(s)}}},e}(d),m=function(t){function e(e,i){t.call(this,e,i),this.name="Era Name",this.formatString="g",this.type=h.EraName}return __extends(e,t),e.prototype.getText=function(){var t=a.GetEraDate(this._txtProvider.getDate());return-1===t.era?"":this.getRealText(a.GetEraSymbols()[t.era])},e.prototype.setText=function(t,e,i){var n=t.substr(t.length-1,1),o=0;for(o=0;o<a.GetEraCount()&&(n.toLowerCase()!==a.GetEraShortcuts()[o].toLowerCase()&&t.toLowerCase()!==a.GetEraShortNames()[o].toLowerCase());o++);if(o==a.GetEraCount())return!0;var r=this._txtProvider.getDate(),s=a.GetEraDate(r);if(-1===s.era)return!0;var l=s.eraYear>a.GetEraYears()[o]?a.GetEraYears()[o]:s.eraYear,h=a.ConvertToGregorianDate(o,l,r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),!0);if(h=null==h?a.GetEraDates()[o]:h,o<a.GetEraCount()-1){var d=a.GetEraDates()[o+1];h=h>d?d:h}return this._txtProvider.setDate(h),!0},e}(f),w=function(t){function e(e,i){t.call(this,e,i),this.name="Two Era Name",this.formatString="gg",this.type=h.TwoEraName}return __extends(e,t),e.prototype.getText=function(){var t=a.GetEraDate(this._txtProvider.getDate());return-1===t.era?"":this.getRealText(a.GetEraAbbreviations()[t.era])},e.prototype.setText=function(t,e,i){var n=t.substr(t.length-1,1),o=0;for(o=0;o<a.GetEraCount()&&(n.toLowerCase()!==a.GetEraShortcuts()[o].toLowerCase()&&t.toLowerCase()!==a.GetEraShortNames()[o].toLowerCase()&&t.toLowerCase()!==a.GetEraAbbreviations()[o].toLowerCase());o++);if(o==a.GetEraCount())return!0;var r=this._txtProvider.getDate(),s=a.GetEraDate(r);if(-1===s.era)return!0;var l=s.eraYear>a.GetEraYears()[o]?a.GetEraYears()[o]:s.eraYear,h=a.ConvertToGregorianDate(o,l,r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),!0);if(h=null==h?a.GetEraDates()[o]:h,o<a.GetEraCount()-1){var d=a.GetEraDates()[o+1];h=h>d?d:h}return this._txtProvider.setDate(h),!0},e}(f),y=function(t){function e(e,i){t.call(this,e,i),this.name="Three Era Name",this.formatString="ggg",this.type=h.ThreeEraName}return __extends(e,t),e.prototype.getText=function(){var t=a.GetEraDate(this._txtProvider.getDate());return-1===t.era?"":this.getRealText(a.GetEraNames()[t.era])},e.prototype.setText=function(t,e,i){var n=t.substr(t.length-1,1),o=0;for(o=0;o<a.GetEraCount()&&(n.toLowerCase()!==a.GetEraShortcuts()[o].toLowerCase()&&t.toLowerCase()!==a.GetEraShortNames()[o].toLowerCase()&&t.toLowerCase()!==a.GetEraAbbreviations()[o].toLowerCase()&&t.toLowerCase()!==a.GetEraNames()[o].toLowerCase());o++);if(o==a.GetEraCount())return!0;var r=this._txtProvider.getDate(),s=a.GetEraDate(r);if(-1===s.era)return!0;var l=s.eraYear>a.GetEraYears()[o]?a.GetEraYears()[o]:s.eraYear,h=a.ConvertToGregorianDate(o,l,r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),!0);if(h=null==h?a.GetEraDates()[o]:h,o<a.GetEraCount()-1){var d=a.GetEraDates()[o+1];h=h>d?d:h}return this._txtProvider.setDate(h),!0},e}(f),v=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){t.prototype.inc.call(this);var e=new Date(this._txtProvider.getDate().valueOf()),i=e.getMonth()+1;if(e.setMonth(i),this._txtProvider.inputWidget._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),o=this._txtProvider.inputWidget._getRealEraMaxDate();a.Equal(this._txtProvider.getDate(),o)?e>o?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(e):this._txtProvider.setDate(o)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),o=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):a.Equal(this._txtProvider.getDate(),o)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(o)}},e.prototype.dec=function(){t.prototype.inc.call(this);var e=new Date(this._txtProvider.getDate().valueOf()),i=e.getMonth()-1;if(e.setMonth(i),this._txtProvider.inputWidget._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),o=this._txtProvider.inputWidget._getRealEraMaxDate();n>e?a.Equal(this._txtProvider.getDate(),n)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(o):this._txtProvider.setDate(n):this._txtProvider.setDate(e)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),o=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):a.Equal(this._txtProvider.getDate(),n)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(o):this._txtProvider.setDate(n)}},e.prototype.setText=function(t,e,i){return parseInt(t)>12&&(t=t.substr(t.length-1,1)),this._txtProvider.setMonth(t,e,i)},e}(d),_=function(t){function e(e,i){t.call(this,e,i),this.name="Two-digit month",this.formatString="MM",this.type=h.TwoDigitMonth}return __extends(e,t),e.prototype.getText=function(){var t=""+this._txtProvider.getMonth();return this.getRealText(1===t.length?"0"+t:t)},e}(v),S=function(t){function e(e,i){t.call(this,e,i),this.name="month",this.formatString="M",this.type=h.Month;
}return __extends(e,t),e.prototype.getText=function(){var t=""+this._txtProvider.getMonth();return this.getRealText(t)},e}(v),x=function(t){function e(e,i){t.call(this,e,i),this.name="AbbreviatedMonthNames",this.formatString="MMM",this.type=h.AbbreviatedMonthNames,this.maxLen=h.AbbreviatedMonthNames}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getMonth(),e=this._txtProvider._getCulture();return this.getRealText(e.calendars.standard.months.namesAbbr[t-1])},e.prototype.setText=function(t,e,i){var n=-1,o=this._txtProvider.inputWidget._getCulture().calendars.standard;return n=this._txtProvider.findAlikeArrayItemIndex(o.months.namesAbbr,t),-1===n?!1:this._txtProvider.setMonth(n+1,e,i)},e}(v),b=function(t){function e(e,i){t.call(this,e,i),this.name="MonthNames",this.formatString="MMMM",this.type=h.MonthNames,this.maxLen=100}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getMonth(),e=this._txtProvider._getCulture();return this.getRealText(e.calendars.standard.months.names[t-1])},e.prototype.setText=function(t,e,i){var n=-1,o;if(i&&i.isfullreset)n=1;else if(o=this._txtProvider._getCulture(),n=this._txtProvider.findAlikeArrayItemIndex(o.calendars.standard.months.names,t),-1===n)return!1;return this._txtProvider.setMonth(n+1,e,i)},e}(v),C=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=this._txtProvider.getDayOfMonth()+1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setDate(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();e>n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i)}},e.prototype.dec=function(){var t=this._txtProvider.getDayOfMonth()-1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setDate(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();i>e?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},e.prototype.setText=function(t,e,i){var n=this._txtProvider.getDate(),o=a.DaysInMonth(n.getFullYear(),n.getMonth()+1);return parseInt(t)>o&&(t=o+""),this._txtProvider.setDayOfMonth(t,e,i)},e}(d),D=function(t){function e(e,i){t.call(this,e,i),this.name="Two-digit day of month",this.formatString="dd",this.type=h.TwoDigityDayOfMonth}return __extends(e,t),e.prototype.getText=function(){return this.getRealText(i(this._txtProvider.getDayOfMonth()))},e}(C),I=function(t){function e(e,i){t.call(this,e,i),this.name="Day of month",this.formatString="d",this.type=h.DayOfMonth}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getDayOfMonth();return this.getRealText(""+t)},e}(C),j=function(t){function e(e,i){t.call(this,e,i),this.name="AbbreviatedDayNames",this.formatString="ddd",this.type=h.AbbreviatedDayNames,this.maxLen=100}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getDayOfWeek(),e=this._txtProvider._getCulture();return this.getRealText(e.calendars.standard.days.namesShort[t-1])},e.prototype.setText=function(t,e,i){var n=-1,o=this._txtProvider._getCulture();return n=this._txtProvider.findAlikeArrayItemIndex(o.calendars.standard.days.namesShort,t),-1===n?!1:this._txtProvider.setDayOfWeek(n+1)},e.prototype.needAdjustInsertPos=function(){return!1},e}(C),T=function(t){function e(e,i){t.call(this,e,i),this.name="DayNames",this.formatString="dddd",this.type=h.DayNames,this.maxLen=100}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getDayOfWeek(),e=this._txtProvider._getCulture();return this.getRealText(e.calendars.standard.days.names[t-1])},e.prototype.setText=function(t,e,i){var n=-1,o=this._txtProvider._getCulture();return n=this._txtProvider.findAlikeArrayItemIndex(o.calendars.standard.days.names,t),-1===n?!1:this._txtProvider.setDayOfWeek(n+1)},e.prototype.needAdjustInsertPos=function(){return!1},e}(C),E=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=this._txtProvider.getYear()+1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setFullYear(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();e>n?a.Equal(this._txtProvider.getDate(),n)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i):this._txtProvider.setDate(n):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):a.Equal(this._txtProvider.getDate(),n)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i):this._txtProvider.setDate(n)}},e.prototype.dec=function(){var t=this._txtProvider.getYear()-1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setFullYear(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();i>e?a.Equal(this._txtProvider.getDate(),i)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(i):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):a.Equal(this._txtProvider.getDate(),i)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(i)}},e}(d),k=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.setText=function(t,e,n){t=i(t);var o=i(this._txtProvider.getYear(),4),r,s,a,l,h;return"00"===t&&(r=this._txtProvider.getMonth(),s=this._txtProvider.getDayOfMonth(),a=this._txtProvider.getHours(),l=this._txtProvider.getMinutes(),h=this._txtProvider.getSeconds(),1===r&&1===s&&!a&&!l&&!h&&(o="0001",t="01")),o.length>=2&&(o=o.substr(0,2)+t.substr(0,2)),this._txtProvider.setYear(parseInt(o),n,!1)},e}(E),L=function(t){function e(e,i){t.call(this,e,i),this.name="Four-digit year",this.formatString="yyyy",this.type=h.FourDigitYear,this.maxLen=4}return __extends(e,t),e.prototype.getText=function(){return this.getRealText(i(this._txtProvider.getYear(),4))},e.prototype.setText=function(t,e,i){if(this._txtProvider._isSmartInputMode()&&i){t*=1,t%=100;var n=2e3;this._txtProvider.inputWidget.options.startYear&&(n=this._txtProvider.inputWidget.options.startYear);var o=n%100,r=n-o;t=t>=o?r+t:r+t+100}return this._txtProvider.setYear(t,i,!1)},e}(E),P=function(t){function e(e,i){t.call(this,e,i),this.name="One-digit year",this.formatString="y",this.type=h.OneDigitYear}return __extends(e,t),e.prototype.getText=function(){var t=i(this._txtProvider.getYear());return"0"===t[0]&&(t=t[1]),this.getRealText(t)},e}(k),M=function(t){function e(e,i){t.call(this,e,i),this.name="Two-digit year",this.formatString="yy",this.type=h.TwoDigitYear}return __extends(e,t),e.prototype.getText=function(){return this._txtProvider.inputWidget.isFocused()&&null==this._txtProvider.inputWidget.options.date?"yy":this.getRealText(i(this._txtProvider.getYear(),2))},e}(k),F=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=this._txtProvider.getHours()+1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setHours(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();e>n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i)}},e.prototype.dec=function(){var t=this._txtProvider.getHours()-1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setHours(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();i>e?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},e}(d),A=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.setText=function(t,e,i){var n=this._txtProvider.getHours();return n>12&&(t=1*t+12),this._txtProvider.setHours(t,e)},e}(F),B=function(t){function e(e,i){t.call(this,e,i),this.name="h",this.formatString="h",this.type=h.h}return __extends(e,t),e.prototype.getText=function(){if(this._txtProvider.inputWidget.isFocused()&&null==this._txtProvider.inputWidget.options.date)return"h";var t=this._txtProvider.getHours();return t>12?t-=12:0===t&&(t=12),12==t&&this._txtProvider.inputWidget.options.hour12As0&&(t=0),this.getRealText(""+t)},e}(A),R=function(t){function e(e,i){t.call(this,e,i),this.name="hh",this.formatString="hh",this.type=h.hh}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getHours();return t>12?t-=12:0===t&&(t=12),12==t&&this._txtProvider.inputWidget.options.hour12As0&&(t=0),this.getRealText(i(t,2))},e}(A),O=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.setText=function(t,e,i){return this._txtProvider.setHours(t,e)},e}(F),G=function(t){function e(e,i){t.call(this,e,i),this.name="H",this.formatString="H",this.type=h.H}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getHours();return 0==t&&!this._txtProvider.inputWidget.options.midnightAs0&&(t=24),this.getRealText(""+t)},e}(O),U=function(t){function e(e,i){t.call(this,e,i),this.name="HH",this.formatString="HH",this.type=h.HH}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getHours();return 0==t&&!this._txtProvider.inputWidget.options.midnightAs0&&(t=24),this.getRealText(i(t,2))},e}(O),N=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(t,!0)},e.prototype.dec=function(){var t=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(t,!0)},e.prototype.setText=function(t,e,i){var n;return t.toLowerCase().indexOf("a")>=0?(n=this._txtProvider.getHours()%12,this._txtProvider.setHours(n,!0)):t.toLowerCase().indexOf("p")>=0&&(n=this._txtProvider.getHours()%12+12,this._txtProvider.setHours(n,!0)),!0},e}(d),V=function(t){function e(e,i){t.call(this,e,i),this.name="t",this.formatString="t",this.type=h.ShortAmPm}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getHours(),e=this._txtProvider._getCulture(),i=this._txtProvider.inputWidget._getInnerAmDesignator(),n=this._txtProvider.inputWidget._getInnerPmDesignator(),o=12>t?i:n;return this.getRealText(o.charAt(0)||" ")},e}(N),H=function(t){function e(e,i){t.call(this,e,i),this.name="tt",this.formatString="tt",this.type=h.AmPm}return __extends(e,t),e.prototype.getText=function(){var t=this._txtProvider.getHours(),e=this._txtProvider._getCulture(),i=this._txtProvider.inputWidget._getInnerAmDesignator(),n=this._txtProvider.inputWidget._getInnerPmDesignator(),o=12>t?i:n;return o.length<=0&&(o=" "),this.getRealText(o)},e}(N),W=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=this._txtProvider.getMinutes()+1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setMinutes(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();e>n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i)}},e.prototype.dec=function(){var t=this._txtProvider.getMinutes()-1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setMinutes(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();i>e?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},e.prototype.setText=function(t,e,i){return i&&i.isfullreset&&(t="0"),this._txtProvider.setMinutes(t,e)},e}(d),z=function(t){function e(e,i){t.call(this,e,i),this.name="mm",this.formatString="mm",this.type=h.mm}return __extends(e,t),e.prototype.getText=function(){return this.getRealText(i(this._txtProvider.getMinutes()))},e}(W),K=function(t){function e(e,i){t.call(this,e,i),this.name="m",this.formatString="m",this.type=h.m,this.delta=12}return __extends(e,t),e.prototype.getText=function(){return this.getRealText(this._txtProvider.getMinutes().toString())},e}(W),$=function(t){function e(e,i){t.call(this,e,i)}return __extends(e,t),e.prototype.inc=function(){var t=this._txtProvider.getSeconds()+1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setSeconds(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();e>n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(i)}},e.prototype.dec=function(){var t=this._txtProvider.getSeconds()-1,e=new Date(this._txtProvider.getDate().valueOf());if(e.setSeconds(t),this._txtProvider.inputWidget._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();i>e?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(e)}else{var i=this._txtProvider.inputWidget._getRealMinDate(),n=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(e,!0)?this._txtProvider.setDate(e):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},e.prototype.setText=function(t,e,i){return i&&i.isfullreset&&(t="0"),this._txtProvider.setSeconds(t,e)},e}(d),Y=function(t){function e(e,i){t.call(this,e,i),this.name="ss",this.formatString="ss",this.type=h.ss}return __extends(e,t),e.prototype.getText=function(){return this.getRealText(i(this._txtProvider.getSeconds()))},e}($),q=function(t){function e(e,i){t.call(this,e,i),this.name="s",this.formatString="s",this.type=h.s}return __extends(e,t),e.prototype.getText=function(){return this.getRealText(this._txtProvider.getSeconds().toString())},e}($)}(t.input||(t.input={}));var e=t.input}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){"use strict";var e=jQuery,i=function(){function e(t,e,i){this.filterLabel=t,this._include=i,this._owner=e}return e.prototype.Check=function(t,e){var i={};i.success=!1,i.strValue="",i.index=e;var n=t.Substring(e,e+1),o=this.IsValid(n);return o?(t=t.Substring(e,e+1),e++,i.strValue=t,i.index=e,i):this._owner.GetAutoConvert()&&(1===n.length||3===n.length)&&(i=this.Convert(t,e),i.success)?i:i},e.prototype.IsValid=function(e){return(2!==e.length||65438!==e.charCodeAt(1)&&65439!==e.charCodeAt(1)||t.CharProcess.CharEx.IsFullWidth(e)||!t.CharProcess.CharEx.IsKatakana(e))&&e.length>1?this.IsValidMoreByte(e):this.IsValidTwoByte(e)},e.prototype.IsValidTwoByte=function(t){return!1},e.prototype.IsValidMoreByte=function(t){return!1},e.prototype.Convert=function(e,i){var n={};n.success=!0,n.strValue="",n.index=i;var o=e.Substring(i,i+1),r,s=t.CharProcess.CharEx;if(s.IsAlphabet(o)){var a=s.IsLower(o)?o.toUpperCase():o.toLowerCase();return r=this.IsValid(a),r&&this._include||!r&&!this._include?(i++,n.index=i,n.strValue=a,n):(o=s.IsFullWidth(o)?s.ToHalfWidth(o):s.ToFullWidth(o).text,r=this.IsValid(o),r&&this._include||!r&&!this._include?(i++,n.index=i,n.strValue=o,n):(a=s.IsFullWidth(a)?s.ToHalfWidth(a):s.ToFullWidth(a).text,r=this.IsValid(a),r&&this._include||!r&&!this._include?(i++,n.index=i,n.strValue=a,n):(n.success=!1,n)))}if(s.IsHiragana(o)){if(s.IsLowerKana(o)){var l=s.ToUpperKana(o);if(r=this.IsValid(l),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=l,n}else if(s.HasLowerKana(o)){var h=s.ToLowerKana(o);if(r=this.IsValid(h),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=h,n}if(o=s.ToKatakana(o),r=this.IsValid(o),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=o,n;if(s.IsLowerKana(o)){var l=s.ToUpperKana(o);if(r=this.IsValid(l),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=l,n}else if(s.HasLowerKana(o)){var h=s.ToLowerKana(o);if(r=this.IsValid(h),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=h,n}var d=s.ToHalfWidthEx(o);if(r=this.IsValid(d),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=d,n;if(s.IsLowerKana(d)){if(d=s.ToUpperKana(d),r=this.IsValid(d),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=d,n}else if(s.HasLowerKana(d)&&(d=s.ToLowerKana(d),r=this.IsValid(d),r&&this._include||!r&&!this._include))return i++,n.index=i,n.strValue=d,n;return n.success=!1,n}if(s.IsKatakana(o)){if(s.IsLowerKana(o)){var l=s.ToUpperKana(o);if(r=this.IsValid(l),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=l,n}else if(s.HasLowerKana(o)){var h=s.ToLowerKana(o);if(r=this.IsValid(h),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=h,n}var a=o,c=!1;if(s.IsFullWidth(o)){var u=s.ToHalfWidthEx(o);if(u.GetLength()>0&&(r=this.IsValid(u),r&&this._include||!r&&!this._include))return i++,n.index=i,n.strValue=u,n;if(s.IsLowerKana(u)){if(u=s.ToUpperKana(u),r=this.IsValid(u),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=u,n}else if(s.HasLowerKana(u)&&(u=s.ToLowerKana(u),r=this.IsValid(u),r&&this._include||!r&&!this._include))return i++,n.index=i,n.strValue=u,n}else{if(null==i){if(a=s.ToFullWidth(o).text,!s.IsKatakana(a))return n;if(r=this.IsValid(a),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=a,n}else{if(i+1<e.GetLength()){var p=s.ToFullWidth(e.Substring(i,i+2));a=p.text,c=p.processedAll}else a=s.ToFullWidth(o).text;if(!s.IsKatakana(a))return n;if(r=this.IsValid(a),r&&this._include||!r&&!this._include)return i++,c&&i++,n.index=i,n.strValue=a,n}if(s.IsLowerKana(a)){var l=s.ToUpperKana(a);if(r=this.IsValid(l),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=l,n}else if(s.HasLowerKana(a)){var h=s.ToLowerKana(a);if(r=this.IsValid(h),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=h,n}}if(a=s.ToHiragana(a),r=this.IsValid(a),r&&this._include||!r&&!this._include)return i++,c&&i++,n.index=i,n.strValue=a,"ゔ"===a&&(c?n.strValue="う゛":(i--,n.index=i,n.strValue="",n.success=!1)),n;if(s.IsLowerKana(a)){var l=s.ToUpperKana(a);if(r=this.IsValid(l),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=l,n}else if(s.HasLowerKana(a)){var h=s.ToLowerKana(a);if(r=this.IsValid(h),r&&this._include||!r&&!this._include)return i++,n.index=i,n.strValue=h,n}}return o=s.IsFullWidth(o)?s.ToHalfWidth(o):s.ToFullWidth(o).text,r=this.IsValid(o),r&&this._include||!r&&!this._include?(i++,n.index=i,n.strValue=o,n):(n.success=!1,n)},e}();t.CharacterFilter=i;var n=function(e){function i(t,i){e.call(this,"HalfWidthFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsFullWidth(e)?"\r"===e||"\n"===e?!0:!1:!0},i}(i),o=function(e){function i(t,i){e.call(this,"FullWidthFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsFullWidth(e)?!0:"\r"===e||"\n"===e?!0:!1},i}(i),r=function(e){function i(t,i){e.call(this,"HiraganaFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsHiragana(e)?!0:"\r"===e||"\n"===e?!0:!1},i}(i),s=function(e){function i(t,i){e.call(this,"ShiftJISFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsShiftJIS(e)},i}(i),a=function(e){function i(t,i){e.call(this,"JISX0208Filter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsJISX0208(e)},i}(i),l=function(e){function i(t,i){e.call(this,"DBCSHiraganaFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsUpperKana(e)&&t.CharProcess.CharEx.IsHiragana(e)},i}(i),h=function(e){function i(t,i){e.call(this,"DBCSKatakanaFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)&&!t.CharProcess.CharEx.IsLowerKana(e)},i}(i),d=function(e){function i(t,i){e.call(this,"SBCSKatakanaFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return!t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)&&!t.CharProcess.CharEx.IsLowerKana(e)},i}(i),c=function(e){function i(t,i){e.call(this,"SurrogateFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsSurrogatePair(e)?!0:"\r"===e||"\n"===e?!0:!1},i.prototype.IsValidMoreByte=function(e){for(var i=0;i<e.length;i++)if(t.CharProcess.CharEx.IsSurrogate(e[i]))return!0;return!1},i}(i),u=function(e){function i(t,i){e.call(this,"HalfWidthKatakanaFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return!t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)?!0:"\r"===e||"\n"===e?!0:!1},i}(i),p=function(e){function i(t,i){e.call(this,"FullWidthKatakanaFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)?!0:"\r"===e||"\n"===e?!0:!1},i}(i),g=function(e){function i(t,i){e.call(this,"HalfWidthSymbolsFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return!t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsSymbol(e)?!0:"\r"===e||"\n"===e?!0:!1},i}(i),f=function(e){function i(t,i){e.call(this,"FullWidthSymbolsFilter",t,i)}return __extends(i,e),i.prototype.IsValidTwoByte=function(e){return t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsSymbol(e)?!0:"\r"===e||"\n"===e?!0:!1},i}(i),m=function(t){function e(e,i,n,o){t.call(this,"LimitedFilter",n,o),this._includeChars=e,this._excludeChars=i}return __extends(e,t),e.prototype.IsValidTwoByte=function(t){return""!==this._includeChars&&this._includeChars.IndexOf(t)>-1||""!==this._excludeChars&&-1===this._excludeChars.IndexOf(t)?!0:"\r"===t||"\n"===t?!0:!1},e.prototype.IsValidMoreByte=function(t){return""!==this._includeChars&&this._includeChars.IndexOf(t)>-1||""!==this._excludeChars&&-1===this._excludeChars.IndexOf(t)?!0:"\r"===t||"\n"===t?!0:!1},e}(i),w=function(t){function e(e,i,n,o){t.call(this,"RangeFilter",n,o),this._startChar=e,this._endChar=i}return __extends(e,t),e.prototype.IsValidTwoByte=function(t){return t>=this._startChar&&t<=this._endChar?!0:"\r"===t||"\n"===t?!0:!1},e}(i),y=function(t){function e(e,i){t.call(this,"UnionFilter",e,i),this.filterArray=[]}return __extends(e,t),e.prototype.Add=function(t){null!=t&&("HiraganaFilter"===t.filterLabel?this.hiranagaFilter=t:"FullWidthKatakanaFilter"===t.filterLabel&&(this.katakanaFilter=t),this.filterArray.push(t))},e.prototype.AddRange=function(t){for(var e=0;e<t.length;e++)this.Add(t[e])},e.prototype.IsValidTwoByte=function(t){if(0===this.filterArray.length)return"\r"===t||"\n"===t?!0:!1;for(var e=!1,i=!1,n=0;n<this.filterArray.length;n++)this.filterArray[n]._include&&(i=!0);var o="ー"===t;if(o)if(this.hiranagaFilter&&this.katakanaFilter){if(i)return!0}else{if(this.hiranagaFilter)return!0;if(this.katakanaFilter)return!0}for(var n=0;n<this.filterArray.length;n++)if(this.filterArray[n].IsValid(t)){if(!this.filterArray[n]._include)return!1;e=!0}else i||(e=!0);return e?!0:"\r"===t||"\n"===t?!0:!1},e.prototype.IsValidMoreByte=function(t){return this.IsValidTwoByte(t)},e}(i),v=function(){function t(t){this.minLength=-1,this.maxLength=-1,this.text="",this.oldText="",this.fieldLabel=t}return t.prototype.Snap=function(){var t={};return t.text=this.text,t.oldText=this.oldText,t},t.prototype.Revert=function(t){this.text=t.text,this.oldText=t.oldText},t.prototype.GetFieldText=function(){return null==this.oldText?null:this.oldText},t.prototype.GetText=function(){return this.text},t.prototype.SetText=function(t){this.text=t},t.prototype.GetFillingString=function(t){if(!t)return null;for(var e="",i=0;i<this.minLength;i++)e+=t;return e},t.prototype.GetFieldStatus=function(){return 0},t.prototype.GetTextExcludeLiterals=function(t,e){var i=this.text.GetLength();e>i&&(e=i);var n=this.text.Substring(t,e);return n=n.replace(/[^\d]/g,"")},t.prototype.SaveOldState=function(){},t.prototype.RollBack=function(){},t.prototype.PerformSpin=function(t,e,i){return 0},t.prototype.Insert=function(t,e,i,n){},t.prototype.Replace=function(t,e,i){},t.prototype.Delete=function(t,e){},t.prototype.SaveUndoState=function(){},t.prototype.Clear=function(){this.text=null},t.prototype.Undo=function(){},t.prototype.SetTextInternal=function(t,e,i,n){},t.prototype.GetLength=function(){return this.text.GetLength()>this.minLength?this.text.GetLength():this.minLength},t}();t.Field=v;var _=function(t){function e(e){t.call(this,"PromptField"),this.text=e,this.minLength=this.text.GetLength(),this.maxLength=this.text.GetLength()}return __extends(e,t),e.prototype.GetFillingString=function(){return this.text},e.prototype.SetText=function(t){var e={};return t===this.promptText?(e.existInvalid=!1,t=t.Substring(this.text.GetLength())):e.existInvalid=!0,e.text=t,e},e.prototype.GetLength=function(){return this.text.GetLength()},e}(v),S=function(e){function n(t){e.call(this,"FilterField"),this._minLength=0,this._maxLength=0,this._filter=new i,this._bitStates=null,this._oldBitState=null,this.undoText="",this.undoTempText="",this._undoBitState=null,this._trueLength=0,this._bitState=null,this._owner=t}return __extends(n,e),n.prototype.GetPromptChar=function(){return this._owner.GetPromptChar()},n.prototype.GetAutoConvert=function(){return this._owner.GetAutoConvert()},n.prototype.FilterField=function(t,e,i,n){if(t>e)return!1;if(!i)return!1;if(this._minLength=t,this._maxLength=e,this._filter=i,this._bitState=n,this._oldBitState=n,this._undoBitState=n,this._trueLength=0,null!=this._bitState){for(var o=0;null!=this._bitState[o];)o++;for(var r=o;r>=0;r--)if(null!=this._bitState[r])this._bitState[r]===!1&&this._trueLength--;else{if(null!=this._bitState[r])break;this._trueLength--}}return this.Clear(),!0},n.prototype.InitialText=function(t){for(;-1!=t.IndexOf("@#GCD#@");)t=t.replace("@#GCD#@","'");for(;-1!=t.IndexOf("@#GCM#@");)t=t.replace("@#GCM#@",'"');this.text=t,this.oldText=t,this.undoText=t,this.undoTempText=t},n.prototype.GetFieldStatus=function(){return this._trueLength>=this._minLength&&this._trueLength>0?2:this._trueLength>0&&this._trueLength<this._minLength?1:0},n.prototype.GetFieldIsFull=function(){if(this._trueLength>=this._minLength&&this._trueLength>0){for(var t=0;t<this._trueLength;t++)if(this._bitState[t]===!1)return!1;return!0}return!1},n.prototype.SetTextInternal=function(e,i,n,o){var r={};r.offset=i,r.text=e,r.existInvalid=!1,r.exception=!1;var s=!1;if(i>this._maxLength||""===e||0===e.GetLength())return r;for(var a="",l=0,h=[],d=i,c=0;i>c;c++)h[c]=this._bitState[c];for(;l<e.GetLength();){var u=this._filter.Check(e,l),p=u.strValue;if(l=u.index,""===p&&e.Substring(l,l+1)!==this.GetPromptChar()){if(!n&&i+a.GetLength()>=this._minLength&&i+a.GetLength()===this._trueLength+a.GetLength())break;s=!0,l++;break}if(""!==p?(o&&""!==o&&o.Substring(d,d+1)===t.Utility.MaskValChar?(a+=this.GetPromptChar(),h[d]=!1):"\r"===p||"\n"===p?(a+=this.GetPromptChar(),h[d]=!1):(a+=p,h[d]=!0),d++,2===p.GetLength()&&(h[d]=!0,d++)):(a+=this.GetPromptChar(),l++,h[d]=!1,d++),i+a.GetLength()===this._maxLength)break;if(i+a.GetLength()>this._maxLength){a=a.Substring(0,a.GetLength()-1);break}}i+a.GetLength()<this._minLength&&(e=e.Substring(l,e.GetLength()-l),r.existInvalid=s,r.exception=!0);var g=this.text.Substring(0,i)+a+this.text.Substring(i,this.text.GetLength());if(g.GetLength()>this._maxLength&&(g=g.Substring(0,this._maxLength)),g.GetLength()>i+a.GetLength())for(var f=1;f<=g.GetLength()-i-a.GetLength();f++)null!=this._bitState[i+f]&&(h[d]=this._bitState[i+f],d++);this._bitState=new Array(d),this._bitState=h,this._trueLength=d;for(var f=d-1;f>=0&&this._bitState[f]===!1;f--)this._trueLength--;if(g.GetLength()<this._minLength)for(var f=0;f<this._minLength-g.GetLength();f--)g+=this.GetPromptChar();for(var f=g.GetLength();f>this._minLength&&(g.Substring(f-1,f)===this.GetPromptChar()&&f>this._trueLength);f--)g=g.Substring(0,f-1);return this.text=g,e=l===e.GetLength()?"":e.Substring(l,e.GetLength()),i+=a.GetLength(),r.offset=i,r.text=e,r},n.prototype.SaveOldState=function(){this.oldText=this.text,this._oldBitState=this._bitState},n.prototype.SaveUndoState=function(){this.undoText=this.text,this.undoTempText=this.text,this._undoBitState=this._bitState},n.prototype.GetValue=function(){},n.prototype.GetText=function(){return this._text},n.prototype.UpdateState=function(t){},n.prototype.RollBack=function(){if(this.oldText!==this.text){var t=this.oldText;this.text=t,this._bitState=this._oldBitState,this._trueLength=t.GetLength();for(var e=t.GetLength()-1;e>=0&&this._bitState[e]===!1;e--)this._trueLength--}},n.prototype.Undo=function(){if(this.undoTempText===this.text)return!1;var t=this.undoTempText;this.undoTempText=this.text;var e=this._bitState;if(this.text=t,this._bitState=this._undoBitState,this._trueLength=t.GetLength(),0===this._bitState.length)this._trueLength=0;else for(var i=t.GetLength()-1;i>=0&&this._bitState[i]===!1;i--)this._trueLength--;return this._undoBitState=e,!0},n.prototype.Clear=function(){this._trueLength=0;var t="",e=[];if(this._minLength>0){for(var i=0;i<this._minLength;i++)e[i]=!1;if(this._bitState=new Array(this._minLength),this._bitState=e,""!==this.GetPromptChar())for(var i=0;i<this._minLength;i++)t+=this.GetPromptChar();else for(var i=0;i<this._minLength;i++)t+=" ";
this.text=t}else this.text="",this._bitStates=null},n.prototype.Insert=function(t,e,i,n){n||(n=!0);var o={};o.offset=t,o.text=e,o.existInvalid=!1,o.exception=!1;var r=!1;if(t>this._maxLength||""===e||0===e.GetLength())return o;for(var s=[],a=t,l=0;t>l;l++)s[l]=this._bitState[l];for(var h="",d=0;d<e.GetLength();){var c=this._filter.Check(e,d),u=c.strValue;if(d=c.index,""!==u||!n&&" "===e.CharAt(d)){if(""!==u||n||" "!==e.CharAt(d)?"\r"===u||"\n"===u?(h+=this.GetPromptChar(),s[a]=!1,a++):(h+=u,s[a]=!0,a++,2===u.GetLength()&&(s[a]=!0,a++)):(h+=this.GetPromptChar(),s[a]=!1,a++,d++),t+h.GetLength()===this._maxLength)break;if(t+h.GetLength()>this._maxLength){h=h.Substring(0,h.GetLength()-1);break}}else{if(!i&&t+h.GetLength()>=this._minLength&&t+h.GetLength()>=this._trueLength+h.GetLength())break;r=!0,d++}}if(0===h.GetLength())return e=e.Substring(d,e.GetLength()-d),o.existInvalid=r,o.exception=!0,o;var p=this.text.Substring(0,t)+h+this.text.Substring(t,this.text.GetLength());if(p.GetLength()>this._maxLength&&(p=p.Substring(0,this._maxLength)),p.GetLength()>t+h.GetLength())for(var g=0;g<p.GetLength()-t-h.GetLength();g++)null!=this._bitState[t+g]?s[a]=this._bitState[t+g]:s[a]=!1,a++;this._bitState=new Array(a),this._bitState=s,this._trueLength=a;for(var g=a-1;g>=0&&this._bitState[g]===!1;g--)this._trueLength--;if(p.GetLength()<this._minLength)for(var g=0;g<this._minLength-p.GetLength();g--)p+=this.GetPromptChar();for(var g=p.GetLength();g>this._minLength&&(p.Substring(g-1,g)===this.GetPromptChar()&&g>this._trueLength);g--)p=p.Substring(0,g-1);return this.text=p,e=d===e.GetLength()?"":e.Substring(d,e.GetLength()),t+=h.GetLength(),o.offset=t,o.text=e,o},n.prototype.Replace=function(e,i,n,o){var r={};if(r.offset=e,r.text=n,0===i)return r;var s=n.charCodeAt(0),a=[12364,12460,12366,12462,12376,12472];if(-1!==t.Utility.ArrayIndexOf(a,s)&&1===i){var l=this._filter.Check(n,0);l.strValue&&2===l.strValue.length&&(i=2)}return e=this.Delete(e,i),r=this.Insert(e,n,o)},n.prototype.Delete=function(t,e){if(0===e||t>=this.text.GetLength())return t;t+e>this.text.GetLength()&&(e=this.text.GetLength()-t);for(var i=[],n=t,o=0;t>o;o++)i[o]=this._bitState[o];var r=this.text.Substring(0,t)+this.text.Substring(t+e,this.text.GetLength());if(t+e<this.text.GetLength())for(var s=0;s<this.text.Substring(t+e,this.text.GetLength()).GetLength();s++)null!=this._bitState[t+e+s]?i[n]=this._bitState[t+e+s]:i[n]=!1,n++;if(n<this._minLength)for(var s=n;s<this._minLength;s++)i[s]=!1;this._bitState=new Array(n),this._bitState=i,this._trueLength=n;for(var s=n-1;s>=0&&this._bitState[s]===!1;s--)this._trueLength--;if(r.GetLength()<this._minLength)for(var a=this._minLength-r.GetLength(),s=0;a>s;s++)r+=this.GetPromptChar();return this.text=r,t},n}(v),x=function(e){function i(t){e.call(this,"EnumField"),this._activeItem=-1,this._trueLength=0,this._lastActiveItem=-1,this.undoText="",this.undoTempText="",this._undoItem=-1,this._minLength=0,this._maxLength=0,this._itemCount=0,this._owner=t}return __extends(i,e),i.prototype.GetPromptChar=function(){return this._owner.GetPromptChar()},i.prototype.GetText=function(){var e="";return this._activeItem<0?e=t.Utility.ToString(this.GetPromptChar(),this._minLength):e+=this._items[this._activeItem],e},i.prototype.GetFieldStatus=function(){return-1===this._activeItem?0:2},i.prototype.GetFieldIsFull=function(){return-1===this._activeItem?!1:!0},i.prototype.IsOver=function(){return-1!==this._activeItem},i.prototype.Init=function(t){for(var e=Number.MAX_VALUE,i=Number.MIN_VALUE,n=0;n<t.length;n++)e=Math.min(e,t[n].length),i=Math.max(i,t[n].length);this.EnumField(e,i,t,t.length,-1)},i.prototype.EnumField=function(t,e,i,n,o){return this._minLength=t,this._maxLength=e,i?(this._itemCount=n,this._activeItem=o,this._lastActiveItem=o,this._undoItem=o,this.InitialItems(i),-1!==o?this._trueLength=i[o].toString().GetLength():this._trueLength=0,this.text=this.GetText(),void 0):!1},i.prototype.InitialItems=function(t){this._items=new Array(t.length);for(var e=0;e<t.length;e++){for(var i=t[e];-1!==i.IndexOf("@#GCD#@");)i=i.replace("@#GCD#@","'");for(;-1!==i.IndexOf("@#GCM#@");)i=i.replace("@#GCM#@",'"');i&&(i=i.replace(/@#GCX0D#@/g,"\r").replace(/@#GCX0A#@/g,"\n")),this._items[e]=i}},i.prototype.InitialText=function(t){for(;-1!==t.IndexOf("@#GCD#@");)t=t.replace("@#GCD#@","'");for(;-1!==t.IndexOf("@#GCM#@");)t=t.replace("@#GCM#@",'"');t&&(t=t.replace(/@#GCX0D#@/g,"\r").replace(/@#GCX0A#@/g,"\n")),this.text=t,this.oldText=t,this.undoText=t,this.undoTempText=t},i.prototype.Insert=function(t,e,i){var n={};n.offset=t,n.text=e,n.existInvalid=!1,n.exception=!1;var o=t,r="";-1===this._activeItem&&(o=0),0!==o&&(r=this._items[this._activeItem].toString().Substring(0,o));for(var s=new Array(this._itemCount),a=new Array(this._itemCount),l=new Array(this._itemCount),h=new Array(this._itemCount),d=0;d<this._itemCount;d++)s[d]=o,a[d]=0,l[d]=99999,h[d]=new Array;for(var d=0;d<this._itemCount;d++){var c=this._items[d].toString();if(!(r.GetLength()>0&&c.Substring(0,r.GetLength())!==r))for(;a[d]<e.GetLength()&&!(s[d]>=c.length);){var u=this.JudgeIfValid(c,s[d],e,a[d]);s[d]=u.index1,a[d]=u.index2,u.isValid?99999===l[d]&&(l[d]=a[d]):a[d]++}}for(var p=0,g=0,f=!1,m=s[p],w=0;w<this._itemCount;w++){var c=this._items[w].toString();if(s[w]===e.GetLength()+o&&e.GetLength()===c.length){p=w,m=s[p],f=!0;break}if(99999!==l[w]&&l[p]>=l[w])if(l[p]===l[w]){var y=s[w];y>m?(p=w,m=y,g=1):m===y&&g++}else p=w,m=s[p],g=1}var v;if(f)return 0===a[p]?(v=!0,n.existInvalid=!0,n):(e=e.Substring(a[p]+1,e.GetLength()),t=this._items[p].toString().GetLength(),v=0===h[p].Count?!1:!0,this._activeItem=p,this.text=this._items[p].toString(),this._trueLength=this._items[p].toString().GetLength(),n.offset=t,n.text=e,n.existInvalid=v,n);if(m===o)return i===!1&&-1!==this._activeItem&&t===this._items[this._activeItem].toString().GetLength()?(e=e.Substring(a[p],e.GetLength()),v=!1,n.offset=t,n.text=e,n):(v=!0,n.exception=!0,n.existInvalid=!0,n);for(var _=-1,d=0;d<h[p].Count;d++)_=0;return t=1===g?this._items[p].toString().GetLength():m,-1===_?(e=e.Substring(a[p],e.GetLength()),v=!1):(e=e.Substring(a[p],e.GetLength()),v=!0),this._activeItem=p,this.text=this._items[p].toString(),this._trueLength=this._items[p].toString().GetLength(),n.offset=t,n.text=e,n},i.prototype.Replace=function(t,e,i,n){return this.Insert(t,i,n)},i.prototype.Delete=function(t,e){if(0===e||t>=this.text.GetLength())return t;if(t=0,this._activeItem=-1,this.text="",this._minLength>0)for(var i=0;i<this._minLength;i++)this.text+=this.GetPromptChar();return this._trueLength=0,t},i.prototype.SaveOldState=function(){this._lastActiveItem=this._activeItem,this.oldText=this.text},i.prototype.RollBack=function(){if(this.oldText!==this.text){var t=this._lastActiveItem;if(this._activeItem=t,t>=0&&t<this._itemCount)this.text=this._items[t].toString();else{this.text="";for(var e=0;e<this._minLength;e++)this.text+=this.GetPromptChar()}for(var i=0,e=this.text.GetLength();e>0&&this.text.Substring(e-1,e)===this.GetPromptChar();e--)i++;this._trueLength=this.text.GetLength()-i}},i.prototype.SaveUndoState=function(){this.undoText=this.text,this.undoTempText=this.text,this._undoItem=this._activeItem},i.prototype.Undo=function(){if(this.undoTempText!==this.text){this.undoTempText=this.text;var t=this._activeItem;if(this._activeItem=this._undoItem,this._undoItem=t,this._activeItem>=0&&this._activeItem<this._itemCount)this.text=this._items[this._activeItem].toString();else{this.text="";for(var e=0;e<this._minLength;e++)this.text+=this.GetPromptChar()}for(var i=0,e=this.text.GetLength();e>0&&this.text.Substring(e-1,e)===this.GetPromptChar();e--)i++;this._trueLength=this.text.GetLength()-i}},i.prototype.SetTextInternal=function(t,e,i,n){var o,r=new Array(this._itemCount),s=new Array(this._itemCount),a=new Array(this._itemCount);for(o=0;o<this._itemCount;o++)r[o]=0,s[o]=0,a[o]=!1;for(o=0;o<this._itemCount;o++)for(var l=this._items[o].toString();r[o]<t.GetLength();){var h=this.JudgeIfValid(l,s[o],t,r[o]);if(s[o]=h.index1,r[o]=h.index2,!h.isValid&&i===!0){a[o]=!0;break}if(!h.isValid&&l.GetLength()===r[o])break;if(!h.isValid&&l.GetLength()>r[o]){a[o]=!0;break}if(s[o].toString().GetLength()===l.GetLength()&&r[o].toString().GetLength()<t.GetLength()&&i===!0){a[o]=!0;break}if(r[o].toString().GetLength()===t.GetLength()&&s[o].toString().GetLength()<l.GetLength()){a[o]=!0;break}}var d=this._itemCount;for(o=0;o<this._itemCount;o++)if(a[o]===!1){d===this._itemCount&&(d=o);var l=this._items[o].toString();if(l.GetLength()===this._maxLength&&t.GetLength()>=this._maxLength){d=o;break}}var c=d,u={};if(u.existInvalid=!1,u.exception=!1,c>=this._itemCount){var p="";for(u.exception=!0,o=0;o<this._minLength;o++)p+=this.GetPromptChar();return t.Substring(0,this._minLength)===p?(t=t.Substring(this._minLength,t.GetLength()),u.offset=this._minLength,u.text=t,u.existInvalid=!1,u.exception=!0,this.Clear(),u):(u.text=t,this.text=p,this._activeItem=-1,u.existInvalid=!0,u.exception=!0,u)}return this._activeItem=c,this.text=this._items[c].toString(),this._trueLength=this._items[c].toString().GetLength(),u.offset=this._trueLength,u.text=t.Substring(this._trueLength,t.GetLength()),u},i.prototype.PerformSpin=function(t,e,i){var n=this._itemCount;if(e>n)if(n>1)for(;e>n;)e-=n;else e=1;else if(-e>n)if(n>1)for(;-e>n;)e+=n;else e=-1;if(0===e)return t;var o;-1===this._activeItem?o=e>0?0:n-1:(o=this._activeItem+e,(0>o||o>=n)&&(i?(o=e>0?o-n:o+n,e>0&&o<this._activeItem?o=this._activeItem<n-1?n-1:0:0>e&&o>this._activeItem&&(o=this._activeItem>0?0:n-1)):o=e>0?n-1:0));var r=this._items[o].toString().GetLength();return t=Math.min(t,r),this._activeItem=o,this.text=this._items[o].toString(),this._trueLength=-1===this._activeItem?0:this.text.GetLength(),t},i.prototype.Clear=function(){this._activeItem=-1},i.prototype.JudgeIfValid=function(e,i,n,o){var r=t.CharProcess.CharEx,s={};if(s.index1=i,s.index2=o,s.isValid=!1,i>=e.GetLength())return s;if(e.Substring(i,i+1)===n.Substring(o,o+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;if(this._owner.GetAutoConvert()===!1)return s;if(n.Substring(o,o+1).charCodeAt(0)>=65345&&n.Substring(o,o+1).charCodeAt(0)<=65370){var a=String.fromCharCode(n.Substring(o,o+1).charCodeAt(0)-32);if(a===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var l=r.ToHalfWidth(n.Substring(o,o+1));if(l===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var h=r.ToHalfWidth(a);return h===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}if(n.Substring(o,o+1).charCodeAt(0)>=65313&&n.Substring(o,o+1).charCodeAt(0)<=65338){var d=String.fromCharCode(n.Substring(o,o+1).charCodeAt(0)-32);if(d===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var h=r.ToHalfWidth(n.Substring(o,o+1));if(h===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var l=r.ToHalfWidth(d);return l===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}if(r.IsUpper(n.Substring(o,o+1))){var l=n.Substring(o,o+1).toLowerCase();if(l===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var a=r.ToFullWidth(n.Substring(o,o+1)).text;if(a===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var d=r.ToFullWidth(l).text;return d===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}if(r.IsLower(n.Substring(o,o+1))){var h=n.Substring(o,o+1).toUpperCase();if(h===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var d=r.ToFullWidth(n.Substring(o,o+1)).text;if(d===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var a=r.ToFullWidth(d).text;return a===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}if(r.IsHiragana(n.Substring(o,o+1))){var c=r.ToKatakana(n.Substring(o,o+1));if(c===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var u=r.ToKatakana(c),p=r.ToHalfWidthEx(u);return 1===p.length&&p===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):2===p.length&&p.Substring(0,1)===e.Substring(i,i+1)&&i+1<e.GetLength()&&p.Substring(1,2)===e.Substring(i+1,i+2)?(i+=2,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}if(r.IsKatakana(n.Substring(o,o+1))&&r.IsFullWidth(n.Substring(o,o+1))){var u=r.ToKatakana(n.Substring(o,o+1)),p=r.ToHalfWidthEx(u);if(1===p.length&&p===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;if(2===p.length&&p.Substring(0,1)===e.Substring(i,i+1)&&i+1<e.GetLength()&&p.Substring(1,2)===e.Substring(i+1,i+2))return i+=2,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var g=r.ToHiragana(n.Substring(o,o+1));return"ゔ"===g?s:g===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}if(r.IsKatakana(n.Substring(o,o+1))&&!r.IsFullWidth(n.Substring(o,o+1))){var f;if(f=o+1<n.GetLength()&&r.IsKatakana(n.Substring(o+1,o+2))&&!r.IsFullWidth(n.Substring(o+1,o+2))?n.Substring(o+1,o+2):" "," "===f){var c=r.ToFullWidth(n.Substring(o,o+1)).text;if(c===e.Substring(i,i+1))return i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s;var g=r.ToHiragana(c);return"ゔ"===g?s:g===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}var m=r.ToFullWidth(n.Substring(o,o+2)),c=m.text,w=m.processedAll;if(c===e.Substring(i,i+1))return i++,w?o+=2:o++,s.index1=i,s.index2=o,s.isValid=!0,s;var g=r.ToHiragana(c);return"ゔ"===g?w&&"う゛"===e.Substring(i,i+2)?(i+=2,o+=2,s.index1=i,s.index2=o,s.isValid=!0,s):s:g===e.Substring(i,i+1)?(i++,w?o+=2:o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}if(r.IsFullWidth(n.Substring(o,o+1))){var y=r.ToHalfWidth(n.Substring(o,o+1));return y===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s}var v=r.ToFullWidth(n.Substring(o,o+1)).text;return v===e.Substring(i,i+1)?(i++,o++,s.index1=i,s.index2=o,s.isValid=!0,s):s},i}(v),b=function(){function t(t){this.fieldArray=[],this.fieldCount=0,this.fieldCount=t}return t.prototype.GetLength=function(){for(var t=0,e=0;e<this.fieldCount;e++){var i=this.GetFieldByIndex(e);t+=i.GetLength()}return t},t.prototype.Add=function(t){t&&this.fieldArray.push(t)},t.prototype.AddRange=function(t){if(t&&0!==t.length&&this.fieldCount===t.length){for(var e=new Array,i=0;i<t.length;i++)e[i]=t[i];this.fieldArray=e}},t.prototype.GetFieldByIndex=function(t){return this.fieldArray[t]},t.prototype.GetText=function(){for(var t="",e=0;e<this.fieldCount;e++)t+=this.GetFieldByIndex(e).GetText();return t},t.prototype.GetFillingString=function(t){for(var e="",i=0;i<this.fieldCount;i++){var n=this.fieldArray[i];if("PromptField"===n.fieldLabel)e+=n.GetText();else for(var o=0;o<n._minLength;o++)e+=t}return e},t.prototype.SetText=function(t,e){},t.prototype.Insert=function(t,e,i){},t.prototype.Replace=function(t,e,i,n){},t.prototype.Delete=function(t,e){},t.prototype.PerformSpin=function(t,e,i){},t.prototype.GetFieldIndex=function(t,e){for(var i={},n=0,o=0;o<this.fieldCount;o++){var r=this.fieldArray[o],s=r.GetLength();if(t===n&&0===s||t>=n&&n+s>t)return i.index=o,i.offset=t-n,i;n+=s}if(t>=n){var r=this.fieldArray[this.fieldCount-1];return i.index=this.fieldCount-1,i.offset=r.GetLength(),i}},t.prototype.GetFieldRange=function(t){var e={};e.start=0,e.length=0;for(var i=0,n=0;t>n;n++){var o=this.GetFieldByIndex(n);i+=o.GetLength()}var r=this.GetFieldByIndex(t);return r?(e.start=i,e.length=r.GetLength(),e):e},t}();t.FieldCollection=b;var C=function(){function i(){this.KeyActionList=null,this.Text="",this.Value=null,this.DroppedDown=!1,this.SelectionLength=0,this.SelectionStart=0,this.SelectionEnd=0,this.IsMouseDown=!1,this.OldSelectionStart=0,this.OldSelectionEnd=0,this._acceptCrlf=t.CrLfMode.NoControl,this._clipContent=t.ClipContent.IncludeLiterals,this._editMode=t.EditMode.Insert,this.__editModeInternal=t.EditMode.Insert,this._useClipboard=!0,this._readOnly=!1,this._autoPostBack=!1,this._highlightText=t.HighlightText.None,this._exitOnLeftRightKey=t.ExitOnLeftRightKey.None,this.FocusType=t.FocusType.None,this.IsInUpdatePanelAndAsyncPostBack=!1,this.NeedResetFocus=!1,this.NeedReCalCursorPos=!0,this.SpinBtnPressed=!1,this.DropDownBtnPressed=!1,this.OldValue="",this.ValueBeforeUndo="",this.FocusExit=!1,this.Delay=0,this.SpinOnKeys=!0,this.Wrap=!0,this.SpinEnabled=!0,this.Increment=1,this.Visible=!1,this.MouseButton=t.MouseButton.Default,this.TouchDropDownScale=1,this.UIUpdate=new t.InputUIUpdate(this),this.Format={Fields:null}}return i.prototype.Snap=function(){var t={Text:this.Text,Value:this.Value,SelectionStart:this.SelectionStart,SelectionEnd:this.SelectionEnd};return t},i.prototype.Revert=function(t){this.Text=t.Text,this.Value=t.Value,this.SelectionStart=t.SelectionStart,this.SelectionEnd=t.SelectionEnd},i.prototype.ReLoadData=function(){},i.prototype.GetOverwrite=function(){return this.GetEditMode()===t.EditMode.FixedInsert||this.GetEditMode()===t.EditMode.FixedOverwrite?this.GetEditMode()===t.EditMode.FixedOverwrite:this._getEditModeInternal()!==t.EditMode.Insert&&this._getEditModeInternal()!==t.EditMode.FixedInsert},i.prototype.GetImeMode=function(){return this.InputElement.style.imeMode||"auto"},i.prototype.SetImeMode=function(t){this.GetInputElement().style.imeMode=t},i.prototype.GetEnabled=function(){return this.GetInputElement().disabled},i.prototype.SetEnabled=function(t){t?e(this.GetInputElement()).removeAttr("diabled"):e(this.GetInputElement()).attr("diabled","true")},i.prototype.SetFocus=function(){e(this.GetInputElement()).focus()},i.prototype.GetDroppedDown=function(){return this.DroppedDown},i.prototype.GetSelectionStart=function(){return Math.min(this.SelectionStart,this.SelectionEnd)},i.prototype.SetSelectionStart=function(e){e=t.Utility.CheckInt(e,0,Math.pow(2,31)),e=Math.min(e,this.Text.GetLength()),this.SetInnerSelectionStart(e),this.SetInnerSelectionEnd(e+this.SelectionLength),this.NeedReCalCursorPos=!0},i.prototype.GetSelectionLength=function(){return Math.abs(this.SelectionEnd-this.SelectionStart)},i.prototype.SetSelectionLength=function(e){e=t.Utility.CheckInt(e,0,Math.pow(2,31)),this.SelectionStart+e>this.Text.GetLength()&&(e=this.Text.GetLength()-this.SelectionStart),this.SelectionLength=e,this.SetInnerSelectionEnd(this.SelectionStart+e),this.NeedReCalCursorPos=!0},i.prototype.SetInnerSelectionStart=function(t){this.SelectionStart=t},i.prototype.SetInnerSelectionEnd=function(t){this.SelectionEnd=t},i.prototype.SetDroppedDown=function(t){this.Enabled&&(this.DroppedDown=t)},i.prototype.DoSpinUp=function(t,e){null==e&&(e=this.Increment),this.DoSpin("up",this.SelectionEnd,e)},i.prototype.DoSpinDown=function(t,e){null==e&&(e=this.Increment),this.DoSpin("down",this.SelectionEnd,e)},i.prototype.DoSpin=function(t,e,i){if("down"===t&&(i*=-1),!("number"==typeof e&&isNaN(e)||"number"==typeof i&&isNaN(i))){var n=this.UIProcess.PerformSpin(e,i,this.Wrap);n&&("number"==typeof n.SelectionStart&&!isNaN(n.SelectionStart)&&(this.SelectionStart=n.SelectionStart),"number"==typeof n.SelectionEnd&&!isNaN(n.SelectionEnd)&&(this.SelectionEnd=n.SelectionEnd),(null==n.Text||this.UpdateText(n))&&(this.UpdateDisplayText(this.Text),"up"===t?this.UIProcess.FireEvent(this,this.SpinUpEvent,null,"SpinUp"):"down"===t&&this.UIProcess.FireEvent(this,this.SpinDownEvent,null,"SpinDown")))}},i.prototype.GetExitOnLeftRightKey=function(){return this._exitOnLeftRightKey},i.prototype.SetExitOnLeftRightKey=function(t){this._exitOnLeftRightKey=t},i.prototype.GetAcceptsCrlf=function(){return this._acceptCrlf},i.prototype.SetAcceptsCrlf=function(t){this._acceptCrlf=t},i.prototype.SetInnerFocus=function(){this.FocusType=t.FocusType.ClientEvent,this.UIUpdate.SetFocus(),this.SetSelection(this.SelectionStart,this.SelectionEnd)},i.prototype.UpdateDisplayText=function(t){this.UIUpdate.SetText(t),this.SetHideValue()},i.prototype.SetHideText=function(t){},i.prototype.SetSelection=function(e,i,n){if(null!=e&&null!=i&&!isNaN(e)&&!isNaN(i)){if(n&&t.Utility.IsIE10OrLater()){var o=this;setTimeout(function(){t.Utility.SetSelection(o.InputElement,e,i)},0)}else t.Utility.SetSelection(this.InputElement,e,i);this.SelectionStart=e,this.SelectionEnd=i,e===i&&(this.UIProcess.isMulSelected=!1)}},i.prototype._getAutoPostBack=function(){return this._autoPostBack},i.prototype._setAutoPostBack=function(e){e=t.Utility.CheckBool(e),this._autoPostBack=e},i.prototype.GetUseClipboard=function(){return this._useClipboard},i.prototype.SetUseClipboard=function(t){this._useClipboard=t},i.prototype.GetClipContent=function(){return this._clipContent},i.prototype.SetClipContent=function(t){this._clipContent=t},i.prototype.GetTextHAlign=function(){return this.UIUpdate.GetTextHAlign()},i.prototype.SetTextHAlign=function(t){this.UIUpdate.SetTextHAlign(t)},i.prototype.GetEditMode=function(){return this._editMode},i.prototype.SetEditMode=function(t){if(t!==this._editMode){var e=!1;this._isinsertGroup(t)&&this._isOverwriteGroup(this._editMode)?e=!0:this._isinsertGroup(this._editMode)&&this._isOverwriteGroup(t)&&(e=!0),this._editMode=t,this.__editModeInternal=t,e&&this.UIProcess.FireEvent(this,this.EditStatusChangedEvent,null,"EditStatusChanged")}},i.prototype._getEditModeInternal=function(){return this.__editModeInternal},i.prototype._setEditModeInternal=function(t){if(t!==this.__editModeInternal){var e=!1;this._isinsertGroup(t)&&this._isOverwriteGroup(this.__editModeInternal)?e=!0:this._isinsertGroup(this.__editModeInternal)&&this._isOverwriteGroup(t)&&(e=!0),this.__editModeInternal=t,e&&this.UIProcess.FireEvent(this,this.EditStatusChangedEvent,null,"EditStatusChanged")}},i.prototype._isinsertGroup=function(e){return e===t.EditMode.Insert||e===t.EditMode.FixedInsert},i.prototype._isOverwriteGroup=function(e){return e===t.EditMode.Overwrite||e===t.EditMode.FixedOverwrite},i.prototype.GetHighlightText=function(){return this._highlightText},i.prototype.SetHighlightText=function(t){this._highlightText=t},i.prototype.GetReadOnly=function(){return this._readOnly},i.prototype.SetReadOnly=function(t){this._readOnly=t},i.prototype.GetTextboxValue=function(){return this.UIUpdate.GetText()},i.prototype.GetOldValue=function(){return this.OldValue},i.prototype.CanUndo=function(){return this.GetValue()===this.GetOldValue()?!1:!0},i.prototype.GetValue=function(){return""},i.prototype.DragStart=function(){this.DragStartElementID=this.ID},i.prototype.DragEnd=function(e){return this.DragStartElementID="",t.Utility.PreventDefault(e),!1},i.prototype.MouseOut=function(){if(this.IsMouseDown===!0&&(void 0===this.MouseUpPointerType||4===this.MouseUpPointerType||"mouse"===this.MouseUpPointerType)){var e=Math.min(this.OldSelectionStart,this.OldSelectionEnd),i=Math.max(this.OldSelectionStart,this.OldSelectionEnd),n=this.GetText().Substring(e,i);""!==n&&(this.SetSelection(this.OldSelectionStart,this.OldSelectionEnd),t.Utility.DragDrop(this.InputElement)),this.IsMouseDown=!1}},i.prototype.GetText=function(){return""},i.prototype.Focus=function(e){e.SelectionStart=this.SelectionStart;var i=this.UIProcess.Focus(e);return t.Utility.CurrentActiveControlId=this.ID,i?(null!=i.Text&&(this.Text=i.Text),null!=i.SelectionStart&&(this.SelectionStart=i.SelectionStart),null!=i.SelectionEnd&&(this.SelectionEnd=i.SelectionEnd),this.GetReadOnly()&&this.FocusType===t.FocusType.None&&(this.SelectionStart=0,this.SelectionEnd=this.Text.length),this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd,!0),i):void 0},i.prototype.LoseFocus=function(e){return this.FireKeyExit(),(this.SpinBtnPressed||this.DropDownBtnPressed||this.DropDownObj&&this.DropDownObj.IsMouseOver)&&this.FocusType!==t.FocusType.KeyExit?void 0:(this.DroppedDown&&(this.DropDownBtnPressed=!1,this.CloseDropDown()),this.SetLastClientValues(),this.UIProcess.LoseFocus(e))},i.prototype.FireKeyExit=function(){},i.prototype.SetLastClientValues=function(){},i.prototype.MouseDown=function(e){var i=t.Utility.GetMouseButton(e);if(this.MouseButton=i,this.FocusType=t.FocusType.Click,this.OldSelectionStart=this.SelectionStart,this.OldSelectionEnd=this.SelectionEnd,this.IsMouseDown=!0,this.MouseDownX=e.x,this.MouseButton===t.MouseButton.Left&&(t.Utility.IsIE()||t.Utility.firefox)&&t.Utility.ClearSelection(this.GetInputElement()),this.DroppedDown&&this.CloseDropDown(),!this.IsNullFormat()){var n=this.UIProcess.MouseDown(i);n&&(null!=n.SelectionStart&&(this.SelectionStart=n.SelectionStart),null!=n.SelectionEnd&&(this.SelectionEnd=n.SelectionEnd,this.SetSelection(this.SelectionStart,this.SelectionEnd)))}},i.prototype.GetInputElement=function(){return this.InputElement},i.prototype.MouseUp=function(e){this.IsMouseDown=!1,this.MouseUpX=e.x,this.IsNullFormat();var i=this.UIProcess.MouseUp(this.InputElement,this.SelectionStart,this.SelectionEnd,this.MouseButton);if(i){if(null!=i.SelectionStart&&(this.SelectionStart=i.SelectionStart),null!=i.SelectionEnd&&(this.SelectionEnd=i.SelectionEnd),t.Utility.GetMouseButton(e)===t.MouseButton.Left&&null!=this.MouseDownX&&this.MouseDownX>this.MouseUpX){var n=this.SelectionStart;this.SelectionStart=this.SelectionEnd,this.SelectionEnd=n}this.MouseDownX=null,this.MouseButton=t.MouseButton.Default}},i.prototype.MouseWheel=function(e){if(this.ImeMode===!0)return!1;if(this.GetSpinEnabled()){var i=t.Utility.GetMouseWheelValue(0,e);return i>0?this.PerformSpin("up"):0>i&&this.PerformSpin("down"),t.Utility.PreventDefault(e),!1}},i.prototype.PreProcessContextMenu=function(t){return!1},i.prototype.ProcessReservedKey=function(t){switch(t){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 112:case 114:case 115:case 116:case 117:case 121:case 122:case 123:case 65657:case 131081:case 196617:case 131179:case 131181:case 131120:case 131259:case 131261:case 131146:case 196680:case 196681:case 196682:case 131153:case 131156:case 196689:case 262157:return!0}return!1},i.prototype.IsNullFormat=function(){return!1},i.prototype.SetHideValue=function(){var t="";null!=this.GetValue()&&(t=this.GetValue().toString()),this.SetHideText(t)},i.prototype.KeyDown=function(e){var i={},n=e.FuncKeysPressed,o=e.KeyCode;if(this.PreProcessContextMenu(o))return i.System=!1,i;if(229===o)return i.System=!0,i;if(n.Shift&&(o|=65536),n.Ctrl&&(o|=131072),n.Alt){if(null!=this.AccessKey&&this.AccessKey.toLowerCase()===String.fromCharCode(o).toLowerCase())return this.SelectionStart=0,this.SelectionEnd=this.Text.GetLength(),i.System=!0,i;o|=262144}if(this.ProcessReservedKey(o))return i.System=!0,i;var r=524288|o;if(o!==r){var s=this.UIProcess.GetKeyActionName(r,this.Shortcuts);if(null!=s){var a=!0,l=!1;if(a)return i.System=!1,i}}var h=this.UIProcess.GetKeyActionName(o,this.Shortcuts);switch(h){case"DropDown":return this.GetDropDownEnabled()&&(this.PerformDropDown(),i.System=!1),i;case"SpinUp":return this.GetSpinEnabled()&&this.SpinOnKeys&&(this.PerformSpin("up"),i.System=!1),i;case"SpinDown":return this.GetSpinEnabled()&&this.SpinOnKeys&&(this.PerformSpin("down"),i.System=!1),i}var d=!1;if(this.KeyActionList)for(var c=0;c<this.KeyActionList.length;c++)if(this.KeyActionList[c]===o.toString()){d=!0;break}if(this.DroppedDown&&this.DropDownObj&&262182!=o&&262184!=o&&27!=o&&118!=o&&9!=o&&65545!=o&&(null!=h&&this.DropDownObj.IsShortcut(o)&&(h=null),!h)){if(93===o)return this.CloseDropDown(),!0;if(i.System=!1,!d){var u={keyCode:0,shiftKey:!1,ctrlKey:!1,altKey:!1};return u.keyCode=e.KeyCode,u.shiftKey=n.Shift,u.ctrlKey=n.Ctrl,u.altKey=n.Alt,this.DropDownObj.KeyDown(u),i}}e.KeyAction=h,e.KeyCode=o;var p=this.UIProcess.KeyDown(e);if(!p){switch(o){case 27:return this.DroppedDown&&(this.CloseDropDown(),this.SetInnerFocus()),i.System=!1,i;case 262182:case 262184:return d||(this.PerformDropDown(),i.System=!0),i;case 262152:return i.KeyCode=10,i;case 38:return d||(this.GetSpinEnabled()&&this.SpinOnKeys&&this.PerformSpin("up"),i.System=!1),i;case 40:return d||(this.GetSpinEnabled()&&this.SpinOnKeys&&this.PerformSpin("down"),i.System=!1),i;case 13:return i.System=!0,i}if(this.IsNullFormat()||20===o||n&&(n.Ctrl||n.Alt)||91===o||144===o||145===o||93===o||92===o)return i.System=!0,i;if(n&&n.Shift&&65552===o)return i.System=!0,i;if("Number"===this.Type)return i.System=!0,i;if(120===o||123===o||113===o||118===o||119===o)return i;var g=this.UIProcess.FireEvent(this,this.InvalidInputEvent,null,"InvalidInput");return null!=g&&(this.FocusType=g),i}if(null!=p.Overwrite&&this.GetOverwrite()!==p.Overwrite&&(this._getEditModeInternal()===t.EditMode.Insert?this._setEditModeInternal(t.EditMode.Overwrite):this._getEditModeInternal()===t.EditMode.Overwrite&&this._setEditModeInternal(t.EditMode.Insert)),null!=p.Text&&!this.UpdateText(p))return i.System=!1,i;var f=this.GetSelectionLength();null!=p.SelectionStart&&(this.SelectionStart=p.SelectionStart),null!=p.SelectionEnd&&(this.SelectionEnd=p.SelectionEnd);var m=this.GetSelectionLength();if(p.System||(p.FocusExit?(this.SetHideValue(),p.System=!1):(this.UpdateDisplayText(this.Text),0===f&&0!==m?t.Utility.ShouldFireOnSelectStart=!0:t.Utility.ShouldFireOnSelectStart=!1,this.SetSelection(this.SelectionStart,this.SelectionEnd),t.Utility.ShouldFireOnSelectStart=!1,p.HasSetSelection=!0)),p.EventInfo)if("KeyExit"===p.EventInfo.Type)this.EventInfo=p.EventInfo;else{var g=this.UIProcess.FireEvent(this,p.EventInfo.Name,p.EventInfo.Args,p.EventInfo.Type);null!=g&&(this.FocusType=g)}return null!=p.FocusType&&(this.FocusType=p.FocusType),i=p,i.KeyAction=h,i},i.prototype.GetImeInputText=function(e){var i=this.GetTextboxValue();if(i===this.Text)return"";var n;if(""!==this.Text){var o=Math.min(this.SelectionStart,this.SelectionEnd),r=Math.max(this.SelectionStart,this.SelectionEnd);if(r<this.Text.GetLength()){var s=this.Text.Substring(r,this.GetText().GetLength()),a=i.IndexOf(s);n=-1!==a?i.Substring(o,i.GetLength()-s.GetLength()):""}else n=i.Substring(o,i.GetLength())}else n=i;return"ReInput"===e&&(n=n.Substring(0,n.GetLength())),"Record"===e?n:"LoseFocusInput"===e&&""===n?"":(this.ImeMode=!1,this.ImeSelect=!1,("ReInput"===e||"ClickInput"===e)&&(this.FocusType=t.FocusType.ImeInput,this.InputElement.blur(),this.InputElement.focus()),n)},i.prototype.KeyUp=function(t){},i.prototype.GetVisible=function(){return!0},i.prototype.PerformDropDown=function(){if(this.Enabled&&this.GetDropDownEnabled()&&this.GetVisible())if(this.DroppedDown)this.CloseDropDown();else{if(this.DropDownObj&&void 0!==this.DropDownObj.GetDropDownContainer){var e=this.DropDownObj.GetDropDownContainer();t.Utility.IsTouchMouseDown?t.Utility.SetZoomStyle(e,this.TouchDropDownScale,this.DropDownObj.GetAlign()):t.Utility.SetZoomStyle(e,"")}this.ShowDropDown()}},i.prototype.DropDownBtnMouseDown=function(e){this.DropDownBtnPressed=!0,(e===t.MouseButton.Left||null==e)&&(this.PerformDropDown(),this.SetInnerFocus(),this.DroppedDown&&this.ResetLocation())},i.prototype.DropDownBtnMouseUp=function(){this.DropDownBtnPressed=!1,this.SetInnerFocus()},i.prototype.ResetLocation=function(){},i.prototype.DropDownBtnMouseOut=function(){this.DropDownBtnPressed&&(this.SetInnerFocus(),this.DropDownBtnPressed=!1)},i.prototype.ShowDropDown=function(t){null!=t&&this.UIUpdate.WriteCssStyle(t)},i.prototype.CloseDropDown=function(){this.DroppedDown=!1,this.DropDownObj.Close(),this.UIUpdate.ClearCssStyle();var t=this.UIProcess.FireEvent(this,this.DropDownCloseEvent,null,"DropDownClose");null!=t&&(this.FocusType=t)},i.prototype.PerformSpin=function(e){var i=this.Increment;if(this.IsNullFormat())this.SetSelection(this.SelectionStart,this.SelectionEnd);else if(!this.GetReadOnly()){"down"===e&&(i*=-1);var n=this.UIProcess.PerformSpin(this.SelectionEnd,i,this.Wrap);if(!n)return;if(null!=n.Text&&!this.UpdateText(n))return;null!=n.SelectionStart&&(this.SelectionStart=n.SelectionStart,this.SelectionEnd=n.SelectionStart),this.UpdateDisplayText(this.Text),this.SetInnerFocus(),this.SetSelection(this.SelectionStart,this.SelectionEnd)}var o=t.FocusType.ClientEvent;"up"===e?o=this.UIProcess.FireEvent(this,this.SpinUpEvent,null,"SpinUp"):"down"===e&&(o=this.UIProcess.FireEvent(this,this.SpinDownEvent,null,"SpinDown")),null!=o&&(this.FocusType=o)},i.prototype.SpinBtnMouseDown=function(e,i){if(this.SpinBtnPressed=!0,this.DroppedDown)return this.CloseDropDown(),
void this.SetInnerFocus();if(e==t.MouseButton.Left||null==e){var n=i===!0?"up":"down";if(this.PerformSpin(n),this.SetInnerFocus(),null==t.Utility.SpinTimer){var o=this;t.Utility.SpinTimer=setInterval(function(){o.PerformSpin(n)},this._getRealSpinDelay())}}},i.prototype._getRealSpinDelay=function(){return 0===this.Delay?150:this.Delay},i.prototype.SpinBtnMouseUp=function(){this.SpinBtnPressed&&(this.SetInnerFocus(),this.SpinBtnPressed=!1),null!=t.Utility.SpinTimer&&(clearInterval(t.Utility.SpinTimer),t.Utility.SpinTimer=null)},i.prototype.SelectStart=function(t){if(this.IsNullFormat())return!0;var e=this.UIProcess.SelectStart(this.InputElement,t,this.MouseButton);return null!=e.SelectionStart&&(this.SelectionStart=e.SelectionStart),null!=e.SetFalse?e.SetFalse:void 0},i.prototype.DoubleClick=function(){if(this.IsNullFormat())return!0;var t=this.UIProcess.DoubleClick(this.SelectionStart);null!=t.SelectionStart&&(this.SelectionStart=t.SelectionStart),null!=t.SelectionEnd&&(this.SelectionEnd=t.SelectionEnd,this.SetSelection(this.SelectionStart,this.SelectionEnd))},i.prototype.Undo=function(){if(!this.GetReadOnly()){var t=this.UIProcess.Undo();if(t&&null!=t.Text){if(!this.UpdateText(t))return;this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd)}}},i.prototype.Cut=function(){if(!this.GetReadOnly()){var t=this.UIProcess.Cut(this.GetClipContent(),this.SelectionStart,this.SelectionEnd);t&&(null==t.Text||this.UpdateText(t))&&(null!=t.SelectionStart&&(this.SelectionStart=t.SelectionStart),null!=t.SelectionEnd&&(this.SelectionEnd=t.SelectionEnd),null!=t.Text&&(this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd)),null!==t.Color&&this.UIUpdate.SetForeColor(t.Color))}},i.prototype.Copy=function(){this.UIProcess.Copy(this.GetClipContent(),this.SelectionStart,this.SelectionEnd)},i.prototype.Paste=function(e){if(this.GetReadOnly())return!1;if(this.IsNullFormat())return!1;var i=t.Utility.GetPasteData(this.GetUseClipboard());e&&(i=e);var n=this.UIProcess.Paste(this.SelectionStart,this.SelectionEnd,i);return n&&(null==n.Text||this.UpdateText(n))?(null!=n.SelectionStart&&(this.SelectionStart=n.SelectionStart),null!=n.SelectionEnd&&(this.SelectionEnd=n.SelectionEnd),this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),null!=n.EventInfo&&this.UIProcess.FireEvent(this,n.EventInfo.Name,n.EventInfo.Args,n.EventInfo.Type),null!=n.FocusExit&&(this.FocusExit=n.FocusExit),!0):!1},i.prototype.Delete=function(){if(!this.GetReadOnly()){var t=this.UIProcess.ProcessDelete(this.SelectionStart,this.SelectionEnd);t&&(null==t.Text||this.UpdateText(t))&&(null!=t.SelectionStart&&(this.SelectionStart=t.SelectionStart),null!=t.SelectionEnd&&(this.SelectionEnd=t.SelectionEnd),null!=t.Text&&(this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.DoDeleteExtraWork()))}},i.prototype.DoDeleteExtraWork=function(){},i.prototype.SelectAll=function(){var e=this.UIProcess.SelectAll();null!=e.SelectionStart&&(this.SelectionStart=e.SelectionStart),null!=e.SelectionEnd&&(this.SelectionEnd=e.SelectionEnd),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.FocusType=t.FocusType.ContextMenu},i.prototype.DragDrop=function(e){if(!t.Utility.IsIE()&&this.GetReadOnly())return!1;if(this.DragStartElementID===this.ID)return this.DragStartElementID="",!1;var i=this.UIProcess.Paste(0,0,e);if(i){if(null!=i.Text){if(!this.UpdateText(i))return;t.Utility.IsIE()||this.SetInnerFocus()}null!=i.SelectionStart&&(this.SelectionStart=i.SelectionStart),null!=i.SelectionEnd&&(this.SelectionEnd=i.SelectionEnd),this.SetSelection(this.SelectionStart,this.SelectionEnd),null!=i.EventInfo&&this.UIProcess.FireEvent(this,i.EventInfo.Name,i.EventInfo.Args,i.EventInfo.Type)}},i.prototype.SetInnerText=function(t){this.SetText(t)},i.prototype.SetText=function(t){},i.prototype.GetInnerText=function(){return this.Text},i.prototype.UpdateText=function(t){return null!=t&&null!=t.Text&&(this.Text=t.Text),!0},i.prototype.RollBack=function(){},i.prototype.AddAllEventsHandler=function(){var i=this,n=this.GetInputElement();null!=n&&(e(n).bind("mousedown.wijinput",function(e){t.GlobalEventHandler.OnMouseDown(i,e)}),e(n).bind("mouseup.wijinput",function(e){t.GlobalEventHandler.OnMouseUp(i,e)}),e(n).bind("selectstart.wijinput",function(e){t.GlobalEventHandler.OnSelectStart(i,e)}),e(n).bind("keydown.wijinput",function(e){t.GlobalEventHandler.OnKeyDown(i,e)}),e(n).bind("keypress.wijinput",function(e){t.GlobalEventHandler.OnKeyPress(i,e)}),e(n).bind("keyup.wijinput",function(e){t.GlobalEventHandler.OnKeyUp(i,e)}),e(n).bind("dblclick.wijinput",function(e){t.GlobalEventHandler.OnDblClick(i,e)}),e(n).bind("beforecopy.wijinput",function(e){t.GlobalEventHandler.OnHTML5BeforeCopy(i,e)}),e(n).bind("cut.wijinput",function(e){t.GlobalEventHandler.OnHTML5Cut(i,e)}),e(n).bind("paste.wijinput",function(e){t.GlobalEventHandler.OnHTML5Paste(i,e)}),e(n).bind("focus.wijinput",function(e){t.GlobalEventHandler.OnFocus(i,e)}),e(n).bind("blur.wijinput",function(e){t.GlobalEventHandler.OnLostFocus(i,e)}),e(n).bind("mousewheel.wijinput",function(e){t.GlobalEventHandler.OnMouseWheel(i,e)}),e(n).bind("DOMMouseScroll.wijinput",function(e){t.GlobalEventHandler.OnMouseWheel(i,e)}),e(n).bind("dragstart.wijinput",function(e){t.GlobalEventHandler.OnDragStart(i,e)}),e(n).bind("dragend.wijinput",function(e){t.GlobalEventHandler.OnDragEnd(i,e)}),e(n).bind("mouseout.wijinput",function(e){t.GlobalEventHandler.OnMouseOut(i,e)}),e(n).bind("drop.wijinput",function(e){t.GlobalEventHandler.OnDrop(i,e)}),e(n).bind("touchstart.wijinput",function(e){t.GlobalEventHandler.OnTouchStart(i,e)}),e(n).bind("touchend.wijinput",function(e){t.GlobalEventHandler.OnTouchEnd(i,e)}),e(n).bind("select.wijinput",function(e){t.GlobalEventHandler.OnSelect(i,e)}),t.Utility.safari&&(e(n).bind("dragenter.wijinput",function(t){i._safariDropText=getSelection().toString()}),e(n).bind("dragleave.wijinput",function(t){i._safariDropText=null})),e(n).bind("compositionstart.wijinput",function(e){t.GlobalEventHandler.OnCompositionStart(i,e)}),e(n).bind("compositionupdate.wijinput",function(e){t.GlobalEventHandler.OnCompositionUpdate(i,e)}),e(n).bind("compositionend.wijinput",function(e){t.GlobalEventHandler.OnCompositionEnd(i,e)}),"Android"===t.Utility.GetClientOS()&&e(n).bind("webkitEditableContentChanged.wijinput",function(e){t.GlobalEventHandler.OnWebkitEditableContentChanged(i,e)}))},i.prototype.ResetData=function(t){this.SetText(t.ResetData)},i.prototype._createElementForNoSpinAndNoDropDown=function(t){return t},i.prototype._addControlEventHandler=function(){},i.prototype._reCreate=function(){},i.prototype._onSpinPropertyChanged=function(t){t=t.toLowerCase(),"alignment"===t||"position"===t?this._getRealSpinVisible()&&this._reCreate():"visible"===t?this._reCreate():"enabled"!==t&&("spinupimage"===t||"spindownimage"===t||"pressedspinupimage"===t||"pressedspindownimage"===t)},i.prototype._onDropDownPropertyChanged=function(t){t=t.toLowerCase(),"position"===t?this._getRealDropDownVisible()&&this._reCreate():"visible"===t?this._reCreate():"enabled"!==t&&("buttonimage"===t||"pressedbuttonimage"===t)},i.prototype._isSupportClipBoard=function(){return this.GetUseClipboard()?t.Utility.IsIE()?!0:!1:!0},i.prototype._onpropertyChanged=function(){},i.prototype.GetSpinDelay=function(){return this.Delay},i.prototype.SetSpinDelay=function(t){this.Delay=t},i.prototype.GetSpinEnabled=function(){return this.SpinEnabled&&this.Enabled},i.prototype.SetSpinEnabled=function(t){this.SpinEnabled=t},i.prototype.GetSpinIncrement=function(){return this.Increment},i.prototype.SetSpinIncrement=function(t){this.Increment=t},i.prototype.GetSpinOnKeys=function(){return this.SpinOnKeys},i.prototype.SetSpinOnKeys=function(t){this.SpinOnKeys=t},i.prototype.GetSpinVisible=function(){return this.Visible},i.prototype._getRealSpinVisible=function(){return this.GetSpinVisible()},i.prototype.SetSpinVisible=function(t){this.Visible=t},i.prototype.GetSpinWrap=function(){return this.Wrap},i.prototype.SetSpinWrap=function(t){this.Wrap=t},i.prototype.GetAutoDropDown=function(){return this._dropDown.AutoDropDown},i.prototype.SetAutoDropDown=function(t){this._dropDown.SetAutoDropDown(t)},i.prototype.GetDropDownButtonImageUrl=function(){return this._dropDown.GetButtonImage()},i.prototype.SetDropDownButtonImageUrl=function(t){this._dropDown.SetButtonImage(t)},i.prototype.GetDropDownClosingAnimation=function(){return this._dropDown.ClosingAnimation},i.prototype.SetDropDownClosingAnimation=function(t){this._dropDown.SetClosingAnimation(t)},i.prototype.GetDropDownShadow=function(){return this._dropDown.DropDownShadow},i.prototype.SetDropDownShadow=function(t){this._dropDown.SetDropDownShadow(t)},i.prototype.GetDropDownEnabled=function(){return this._dropDown.GetEnabled()&&this.Enabled},i.prototype.SetDropDownEnabled=function(t){this._dropDown.SetEnabled(t)},i.prototype.GetDropDownOpeningAnimation=function(){return this._dropDown.OpeningAnimation},i.prototype.SetDropDownOpeningAnimation=function(t){this._dropDown.SetOpeningAnimation(t)},i.prototype.GetDropDownPosition=function(){return this._dropDown.Position},i.prototype.SetDropDownPosition=function(t){this._dropDown.SetPosition(t)},i.prototype.GetPressedDropDownButtonImageUrl=function(){return this._dropDown.GetPressedButtonImage()},i.prototype.SetPressedDropDownButtonImageUrl=function(t){this._dropDown.SetPressedButtonImage(t)},i.prototype.GetDropDownVisible=function(){return this._dropDown.Visible},i.prototype._getRealDropDownVisible=function(){return this.GetDropDownVisible()},i.prototype.SetDropDownVisible=function(t){this._dropDown.SetVisible(t)},i}();t.BaseInputControl=C;var D;!function(t){t._map=[],t.OctalAscII=0,t.HexAscII=1,t.HexUnicode=2,t.DefinedCharBase=3,t.DefinedCharAddition=4,t.CharSubset=5,t.EnumGroup=6,t.Quantifier=7,t.PromptChar=8,t.Unknow=9}(D||(D={}));var I=function(){function e(){}return e.DBCS_A=t.CharProcess.CharEx.ToFullWidth("A").text,e.DBCS_a=t.CharProcess.CharEx.ToFullWidth("a").text,e.DBCS_B=t.CharProcess.CharEx.ToFullWidth("B").text,e.DBCS_D=t.CharProcess.CharEx.ToFullWidth("D").text,e.DBCS_J=t.CharProcess.CharEx.ToFullWidth("J").text,e.DBCS_K=t.CharProcess.CharEx.ToFullWidth("K").text,e.DBCS_W=t.CharProcess.CharEx.ToFullWidth("W").text,e.DBCS_X=t.CharProcess.CharEx.ToFullWidth("X").text,e.DBCS_Z=t.CharProcess.CharEx.ToFullWidth("Z").text,e.DBCS_T=t.CharProcess.CharEx.ToFullWidth("T").text,e.DBCS_M=t.CharProcess.CharEx.ToFullWidth("M").text,e.DBCS_I=t.CharProcess.CharEx.ToFullWidth("I").text,e.DBCS_N=t.CharProcess.CharEx.ToFullWidth("N").text,e.DBCS_G=t.CharProcess.CharEx.ToFullWidth("G").text,e.DBCS_E=t.CharProcess.CharEx.ToFullWidth("E").text,e.DBCS_V=t.CharProcess.CharEx.ToFullWidth("V").text,e.DBCS_z=t.CharProcess.CharEx.ToFullWidth("z").text,e.DBCS_0=t.CharProcess.CharEx.ToFullWidth("0").text,e.DBCS_1=t.CharProcess.CharEx.ToFullWidth("1").text,e.DBCS_9=t.CharProcess.CharEx.ToFullWidth("9").text,e.DBCS_F=t.CharProcess.CharEx.ToFullWidth("F").text,e.DBCS_f=t.CharProcess.CharEx.ToFullWidth("f").text,e.DBCS__=t.CharProcess.CharEx.ToFullWidth("_").text,e.ParseFormat=function(i,g){e.Owner=g;var f=new j(e.Owner,0,!1);if(null===i||0===i.length){var m=new S(e.Owner),w=new Array;m._bitState=w;var v=new y(e.Owner,!0),b=new o(e.Owner,!0);v.Add(b);var C=new n(e.Owner,!0);v.Add(C);var I=new c(e.Owner,!0);return v.Add(I),m.FilterField(0,2147483647,v,w),m.InitialText(""),m._trueLength=0,f.PushBack(m),f.formatIsNull=!0,f}for(var T=0,E="",k=D.PromptChar,L=D.CharSubset,P=e.GetKeyWord(i,T),M=P.KeyWord,F=P.KeyType,A=P.KeyLen,B;i.length>T;){switch(F){case D.Unknow:throw"InvalidParameter";case D.CharSubset:var R=e.AnalyseCharSubset(M),v=R.uf;if(!R.Result)throw"Invalid parameter";B=v,k=D.CharSubset;break;case D.DefinedCharAddition:if("\\K"===M)B=new u(e.Owner,!0);else if("\\H"===M)B=new n(e.Owner,!0);else if("\\N"===M)B=new d(e.Owner,!0);else if(M==="\\"+e.DBCS_K)B=new p(e.Owner,!0);else if(M==="\\"+e.DBCS_J)B=new r(e.Owner,!0);else if(M==="\\"+e.DBCS_M)B=new s(e.Owner,!0);else if(M==="\\"+e.DBCS_I)B=new a(e.Owner,!0);else if(M==="\\"+e.DBCS_G)B=new l(e.Owner,!0);else if(M==="\\"+e.DBCS_N)B=new h(e.Owner,!0);else if(M==="\\"+e.DBCS_Z)B=new o(e.Owner,!0);else{if(M!=="\\"+e.DBCS_T)throw"argument null";B=new c(e.Owner,!0)}k=D.CharSubset;break;case D.EnumGroup:var O=[];if(e.AnalyseEnumGroup(M,O)){var G=new x(e.Owner);G.Init(O),f.PushBack(G),k=D.EnumGroup,T+=A;var U=e.GetKeyWord(i,T);M=U.KeyWord,F=U.KeyType,A=U.KeyLen;continue}throw"invalid parameter";case D.OctalAscII:try{var N=M.Substring(1);if(N=parseInt(N,8),0===N)throw"argument exception";var V=String.fromCharCode(N);k===D.PromptChar?E+=V:(E=V,k=D.PromptChar)}catch(H){throw"invalid parameter"}break;case D.HexAscII:case D.HexUnicode:try{var N=M.Substring(2);if(N=parseInt(N,16),0===N)throw"argument exception";var V=String.fromCharCode(N);k===D.PromptChar?E+=V:(E=V,k=D.PromptChar)}catch(H){throw"invalid parameter"}break;case D.PromptChar:k===D.PromptChar?E+=M:(E=M,k=D.PromptChar);break;case D.Quantifier:throw"invalid parameter";default:throw"invalid parameter"}T+=A;var W=1,z=1;if(T<i.length){switch(P=e.GetKeyWord(i,T),M=P.KeyWord,F=P.KeyType,A=P.KeyLen,F){case D.Unknow:throw"invalid parameter";case D.CharSubset:case D.DefinedCharAddition:case D.EnumGroup:L=D.CharSubset;break;case D.Quantifier:var $=e.AnalyseQuantifier(M);if(z=$.Min,W=$.Max,!$.Result)throw"invalid parameter";T+=A,P=e.GetKeyWord(i,T),M=P.KeyWord,F=P.KeyType,A=P.KeyLen,L=D.Quantifier;break;case D.OctalAscII:case D.HexUnicode:case D.HexAscII:case D.PromptChar:L=D.PromptChar}if(k===D.PromptChar){if(L!==D.PromptChar){if(L===D.Quantifier)throw"invalid parameter";f.PushBack(new _(E))}}else{var K=new S(e.Owner);K.FilterField(z,W,B,[!1,!1,!1]),K.InitialText(t.Utility.ToString(K.GetPromptChar(),z)),K._trueLength=0,f.PushBack(K)}}else if(k===D.PromptChar)f.PushBack(new _(E));else{var K=new S(e.Owner);K.FilterField(1,1,B),f.PushBack(K)}}for(var Y=0;Y<f.fieldCount&&f.GetFieldByIndex(Y)instanceof _;Y++);if(Y===f.fieldCount)throw"invalid parameter";return f},e.ParseFillExpression=function(t,i){var n={};if(n.Expression="",n.Result=!0,"{}"===t)return n.Expression="{}",n.Result=!0,n;if(void 0!==t&&null!==t&&t.length>0)try{var o=t,r="\x00",s=e.ParseFillingString(o);if(o=s.Format,r=s.FillingChar,"\x00"!==r){if(!e.NullParse(o))throw"argument exception";void 0!==i&&null!==i&&i.fieldCount>0?n.Expression=i.GetFillingString(r):n.Expression=t}else n.Expression=o}catch(a){throw"argument exception"}else n.Expression=null;return n},e.ParseFillingString=function(t){var i={};if(i.Format=t,i.FillingChar="\x00",i.Result=!1,void 0===t||null===t||0===t.length)return i.Result=!1,i;var n=t.indexOf("{"),o=t.indexOf("}");if(-1===n&&-1===o)return t=e.RemoveEscapeChar(t),i.Format=t,i.Result=!1,i;for(;n>0&&"\\"===t.charAt(n-1);)n=t.indexOf("{",n+1);for(;o>0&&"\\"===t.charAt(o-1);)o=t.indexOf("}",o+1);if(o>n){if(-1===n)return t=e.RemoveEscapeChar(t),i.Format=t,i.Result=!1,i;if(o-n===1)i.Format="";else{if("{"===t.charAt(n+1))throw"argument exception";if("\\"===t.charAt(n+1)){if(!(o>n+2))throw"arugment exception";n++}i.FillingChar=t.charAt(n+1)}return i.Result=!0,i}return t=e.RemoveEscapeChar(t),i.Format=t,i.Result=!1,i},e.RemoveEscapeChar=function(t){if(-1!==t.indexOf("\\")){for(var e="",i=t.length,n=0;i>n;n++)"\\"!==t.charAt(n)?e+=t.charAt(n):i>n+1&&(e+=t.charAt(++n));return e}return t},e.NullParse=function(t){var i=e.FindSpecialCh(t,"{",0),n=e.FindSpecialCh(t,"}",0);if(i>-1&&n>-1&&n>i){if(e.FindSpecialCh(t,"{",i+1)>-1)return!1;if(e.FindSpecialCh(t,"}",n+1)>-1)return!1}return!0},e.FindSpecialCh=function(t,e,i){var n=0,o=i-1;do{if(o=t.indexOf(e,o+1),0===o||-1===o)return o;for(var r=o-1;r>0&&"\\"===t.charAt(r);r--)n++}while("\\"===t.charAt(o-1)&&n%2!==0);return o},e.GetKeyWord=function(t,i){var n={};if(n.KeyLen=0,n.KeyType=D.Unknow,n.KeyWord=null,i>=t.length)return n;var o=t.charAt(i);switch(o){case"\\":var r=e.GetEscapeCharLength(t.Substring(i),n.KeyType,n.KeyLen);if(r.Result)return n.KeyLen=r.KeyLen,n.KeyType=r.KeyType,n.KeyWord=t.substr(i,n.KeyLen),n;var s=t.charAt(i+1);return"A"===s?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="[A-Z]",n):s===e.DBCS_A?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="["+e.DBCS_A+"-"+e.DBCS_Z+"]",n):"a"===s?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="[a-z]",n):s===e.DBCS_a?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="["+e.DBCS_a+"-"+e.DBCS_z+"]",n):"D"===s?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="[0-9]",n):s===e.DBCS_D?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="["+e.DBCS_0+"-"+e.DBCS_9+"]",n):"B"===s?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="[0-1]",n):s===e.DBCS_B?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="["+e.DBCS_0+"-"+e.DBCS_1+"]",n):"X"===s?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="[0-9A-Fa-f]",n):s===e.DBCS_X?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="["+e.DBCS_0+"-"+e.DBCS_9+e.DBCS_A+"-"+e.DBCS_F+e.DBCS_a+"-"+e.DBCS_f+"]",n):"W"===s?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="[a-zA-Z_0-9]",n):s===e.DBCS_W?(n.KeyLen=2,n.KeyType=D.CharSubset,n.KeyWord="["+e.DBCS_a+"-"+e.DBCS_z+e.DBCS_A+"-"+e.DBCS_Z+e.DBCS__+e.DBCS_0+"-"+e.DBCS_9+"]",n):"K"===s||s===e.DBCS_K||s===e.DBCS_J||s===e.DBCS_Z||"H"===s||s===e.DBCS_T||s===e.DBCS_M||s===e.DBCS_I||s===e.DBCS_G||s===e.DBCS_N||"N"===s||s===e.DBCS_E||s===e.DBCS_V?(n.KeyLen=2,n.KeyType=D.DefinedCharAddition,n.KeyWord=t.substr(i,2),n):e.IsSpecialChar(s)?(n.KeyLen=2,n.KeyType=D.PromptChar,n.KeyWord=t.substr(i+1,1),n):(n.KeyWord="",n);case"{":var a=t.indexOf("}",i+1);return-1===a?(n.KeyWord="",n):(n.KeyType=D.Quantifier,n.KeyLen=a+1-i,n.KeyWord=t.substr(i,n.KeyLen),n);case"[":var a=i,l=0;do{if(a=t.indexOf("]",a+1),-1===a)return"";for(var h=a-1;h>0&&"\\"===t.charAt(h);h--)l++}while("\\"===t.charAt(a-1)&&l%2!==0);return n.KeyType=D.CharSubset,n.KeyLen=a+1-i,n.KeyWord=t.substr(i,n.KeyLen),n;case"(":var a=i;do if(a=t.indexOf(")",a+1),-1===a)return"";while("\\"===t.charAt(a-1));return n.KeyType=D.EnumGroup,n.KeyLen=a+1-i,n.KeyWord=t.substr(i,n.KeyLen),n;case"*":return n.KeyLen=1,n.KeyType=D.Quantifier,n.KeyWord="{0,}",n;case"+":return n.KeyLen=1,n.KeyType=D.Quantifier,n.KeyWord="{1,}",n;case"?":return n.KeyLen=1,n.KeyType=D.Quantifier,n.KeyWord="{0,1}",n;default:for(var d=i+1;d<t.length&&!e.IsSpecialChar(t.charAt(d));d++);return n.KeyType=D.PromptChar,n.KeyLen=d-i,n.KeyWord=t.substr(i,n.KeyLen),n}},e.IsSpecialChar=function(t){return"\\"===t||"{"===t||"}"===t||"["===t||"]"===t||"("===t||")"===t||"."===t||"*"===t||"+"===t||"?"===t},e.GetEscapeCharLength=function(t,i,n){var o={};if(o.Result=!1,o.KeyType=i,o.Length=n,"\\"!==t.charAt(0))return o;var r=1,s=t.charAt(1);return"x"===s?t.length<r+3?o:(o.Length=4,o.KeyType=D.HexAscII,o.Result=!0,o):"u"===s?t.length<r+5?o:(o.Length=6,o.KeyType=D.HexUnicode,o.Result=!0,o):e.IsOctalChar(s)?t.length<r+3?o:(o.Length=4,o.KeyType=D.OctalAscII,o.Result=!0,o):o},e.IsOctalChar=function(t){return t>="0"&&"7">=t},e.AnalyseQuantifier=function(t){var e={};e.Min=-1,e.Max=-1,e.Result=!1;var i=t.indexOf(",",1);if(-1===i)try{return e.Min=parseInt(t.substr(1,t.length-2)),e.Max=e.Min,e.Result=e.Max>0,e}catch(n){return e.Result=!1,e}try{return e.Min=parseInt(t.substr(1,i-1)),i===t.length-2?e.Max=Math.pow(2,31):e.Max=parseInt(t.substr(i+1,t.length-i-2)),e.Min<0||e.Min>e.Max||0===e.Max?(e.Result=!1,e):(e.Result=!0,e)}catch(n){return e.Result=!1,e}},e.AnalyseCharSubset=function(t,i){var g={};g.uf=i,g.Result=!1;var f=[],v=1,_=!0,S="";if("[]"===t){if(f.push(new o(e.Owner,!0)),f.push(new n(e.Owner,!0)),f.push(new c(e.Owner,!0)),g.uf&&g.uf.filterArray.length>0)for(var x=0;x<i.filterArray.length;x++)f.push(i.filterArray[x]);return g.uf=new y(e.Owner,!0),g.uf.AddRange(f),g.Result=!0,g}if("[^]"===t){if(f.push(new o(e.Owner,!1)),f.push(new n(e.Owner,!1)),f.push(new c(e.Owner,!1)),g.uf&&g.uf.filterArray.length>0)for(var x=0;x<i.filterArray.length;x++)f.push(i.filterArray[x]);return g.uf=new y(e.Owner,!0),g.uf.AddRange(f),g.uf.filterArray[0]._include=!1,g.uf.filterArray[1]._include=!1,g.uf.filterArray[2]._include=!1,g.Result=!0,g}for("^"===t.charAt(v)&&(_=!1,v++);v<t.length-1;){var b=t.charAt(v),C=D.HexAscII,I=0;switch(b){case"-":return g.Result=!1,g;case"^":if(_===!1)throw"invalid fromat";if(S.length>0){var j=new m(S,"");j._include=_,f.push(j)}if(f.length>0){g.uf=new y(e.Owner,!0),g.uf.AddRange(f);for(var x=0;x<g.uf.filterArray.length;x++)if(!g.uf.filterArray[x]._include)return g.Result=!1,g;var T=e.AnalyseCharSubset("["+t.substr(v,t.length-v),g.uf);return g.uf=T.uf,g.Result=T.Result,g}return g.Result=!1,g;case"\\":var E=e.GetEscapeCharLength(t.substr(v),C,I);if(C=E.KeyType,I=E.Length,E.Result){var k=16,L=null;C===D.OctalAscII?(k=8,L=t.substr(v+1,I-1)):L=t.substr(v+2,I-2),t=t.substring(0,v)+t.substr(v+I);var P=String.fromCharCode(parseInt(L,k));t=t.substring(0,v)+P+t.substr(v);continue}var M=t.charAt(v+1);if("A"===M)f.push(new w("A","Z",e.Owner,!0)),v++;else if(M===e.DBCS_A)f.push(new w(e.DBCS_A,e.DBCS_Z,e.Owner,!0)),v++;else if("a"===M)f.push(new w("a","z",e.Owner,!0)),v++;else if(M===e.DBCS_a)f.push(new w(e.DBCS_a,e.DBCS_z,e.Owner,!0)),v++;else if("D"===M)f.push(new w("0","9",e.Owner,!0)),v++;else if(M===e.DBCS_D)f.push(new w(e.DBCS_0,e.DBCS_9,e.Owner,!0)),v++;else if("B"===M)f.push(new w("0","1",e.Owner,!0)),v++;else if(M===e.DBCS_B)f.push(new w(e.DBCS_0,e.DBCS_1,e.Owner,!0)),v++;else if("X"===M)f.push(new w("0","9",e.Owner,!0)),f.push(new w("A","F",e.Owner,!0)),f.push(new w("a","f",e.Owner,!0)),v++;else if(M===e.DBCS_X)f.push(new w(e.DBCS_0,e.DBCS_9,e.Owner,!0)),f.push(new w(e.DBCS_A,e.DBCS_F,e.Owner,!0)),f.push(new w(e.DBCS_a,e.DBCS_f,e.Owner,!0)),v++;else if("W"===M)f.push(new w("0","9",e.Owner,!0)),f.push(new w("A","Z",e.Owner,!0)),f.push(new w("a","z")),S+="_",v++;else if(M===e.DBCS_W)f.push(new w(e.DBCS_0,e.DBCS_9,e.Owner,!0)),f.push(new w(e.DBCS_A,e.DBCS_Z,e.Owner,!0)),f.push(new w(e.DBCS_a,e.DBCS_z,e.Owner,!0)),S+=e.DBCS__,v++;else if("K"===M)f.push(new u(e.Owner,!0)),v++;else if("H"===M)f.push(new n(e.Owner,_)),v++;else if(M===e.DBCS_K)f.push(new p(e.Owner,!0)),v++;else if(M===e.DBCS_J)f.push(new r(e.Owner,!0)),v++;else if(M===e.DBCS_M)f.push(new s(e.Owner,!0)),v++;else if(M===e.DBCS_I)f.push(new a(e.Owner,!0)),v++;else if("N"===M)f.push(new d(e.Owner,!0)),v++;else if(M===e.DBCS_N)f.push(new h(e.Owner,!0)),v++;else if(M===e.DBCS_G)f.push(new l(e.Owner,!0)),v++;else if(M===e.DBCS_Z)f.push(new o(e.Owner,!0)),v++;else if(M===e.DBCS_T)f.push(new c(e.Owner,!0)),v++;else{if("\\"!==M&&"]"!==M&&"["!==M&&"-"!==M&&"^"!==M)return!1;if(-1!==S.indexOf(M)){v++;continue}S+=M,v++}break;default:if(t.length>v+2&&"-"===t.charAt(v+1)){var F=e.GetEscapeCharLength(t.substr(v+2),C,I);if(C=F.KeyType,I=F.Length,F.Result){var L=null,k=16;C===D.OctalAscII?(k=8,L=t.substr(v+2+1,I-1)):L=t.substr(v+2+2,I-2);var A=v+2;t=t.substring(0,A)+t.substr(A+I);var P=String.fromCharCode(parseInt(L,k));t=t.substring(0,A)+P+t.substr(A)}var B,R;t.charAt(v)>t.charAt(v+2)?(B=t.charAt(v+2),R=t.charAt(v)):(B=t.charAt(v),R=t.charAt(v+2));var O=new w(B,R,e.Owner,!0);f.push(O),v+=2;break}if(-1!==S.indexOf(b)){v++;continue}S+=b}v++}S.length>0&&f.push(new m(S,"",e.Owner,!0));var G=f.length;if(g.uf&&g.uf.filterArray.length>0)for(var x=0;x<g.uf.filterArray.length;x++)f.push(i.filterArray[x]);g.uf=new y(e.Owner,!0),g.uf.AddRange(f);for(var x=0;G>x;x++)g.uf.filterArray[x]._include=_;return g.Result=!0,g},e.AnalyseEnumGroup=function(e,i){e=e.Substring(1,1+e.length-2);for(var n=0,o=0;n<e.length;){var r=t.Utility.IndexOfAny(e,["|",")","\\","("],n);if(-1!==r){if("\\"===e.charAt(r)){var s=e.charAt(r+1);if("\\"===s||")"===s||"|"===s||"("===s){if(e=e.Substring(0,r)+e.Substring(r+1,e.length),n=r+1,n===e.length){var a=e.Substring(o);if(0===a.length)return!1;i.push(a)}continue}return!1}if("|"!==e.charAt(r))return!1;var a=e.Substring(o,r);if(0===a.length)return!1;i.push(a),n=r+1,o=n}else{var a=e.Substring(o);if(0===a.length)return!1;i.push(a),n=e.length}}return!0},e}(),j=function(e){function i(t,i,n){e.call(this,i),this._focusNull="",this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0,this._owner=t,this.formatIsNull=n}return __extends(i,e),i.prototype.GetShowLiterals=function(){return this._owner.GetShowLiterals()},i.prototype.GetFieldByIndex=function(t){return this.fieldArray[t]},i.prototype.GetLength=function(){var t=this.ValueIsNull();if(t&&""!==this._focusNull&&!this.formatIsNull)return this._focusNull.GetLength();if(t===!0&&""!==this._focusNull)return 0;for(var e=this.GetLastVisibleFieldIndex(this.GetShowLiterals()),i=0,n=0;e>=n;n++){var o=this.GetFieldByIndex(n);i+=o.GetLength()}return i},i.prototype.GetInputFieldIndexByPos=function(t){var e=null,i=0,n,o=this.GetFieldIndex(t,i);n=o.index,i=o.offset,0!==n&&0===i&&"PromptField"!==this.fieldArray[n-1].fieldLabel&&(n--,i=this.fieldArray[n].text.GetLength());var r=this.fieldArray[n];if(i===r.text.GetLength()){var s;if(i<r._maxLength){if(e=n,e!==this.fieldCount-1)for(s=n+1;s<this.fieldCount&&"PromptField"===this.fieldArray[s].fieldLabel;s++);}else for(s=n+1;s<this.fieldCount;s++)if("PromptField"!==this.fieldArray[s].fieldLabel){e=s;break}}else e=n;var a={},l={};if(e)for(var h=!1;h===!1;){if(r=this.fieldArray[e],"FilterField"===r.fieldLabel)l.fieldMark=r._filter.filterLabel,h=!0;else if("EnumField"===r.fieldLabel)l.fieldMark="Enum",h=!0;else{if(e===this.fieldCount-1){l=null;break}e++}l.fieldIndex=e}else l=null;return null!=l?(a.currentField=l,a):null},i.prototype.GetCurrentField=function(t){for(var e={},i=0,n=0,o=0;o<this.fieldCount;o++){var r=this.fieldArray[o];"PromptField"===r.fieldLabel&&n++;var s=r.GetLength();if(i+=s,i>=t)return"PromptField"===r.fieldLabel?t===i-s?e.index=o-n:t===i?e.index=o-n+1:e.index=-1:e.index=o-n,e}},i.prototype.GetText=function(){for(var t="",e=0;e<this.fieldCount;e++){var i=this.fieldArray[e];t+=i.text}return t},i.prototype.GetTextSimpleMode=function(t){for(var e="",i=0;i<this.fieldCount;i++){var n=this.fieldArray[i];("PromptField"!==n.fieldLabel||t)&&(e+=n.text)}return e},i.prototype.GetExistLength=function(){var t=this.fieldCount,e,i;for(e=this.fieldCount-1;e>=0;e--)if(i=this.fieldArray[e],"PromptField"!==i.fieldLabel){t=e;break}var n=0;for(e=0;t>=e;e++)i=this.fieldArray[e],e===t?n>=21474e3?n=i._maxLength:n+=i._maxLength:n+=i.text.GetLength();return n},i.prototype.GetNonLiteralsText=function(t,e){var i="",n=0,o,r=this.GetFieldIndex(t,n);o=r.index,n=r.offset;var s=0,a;r=this.GetFieldIndex(t+e,s),a=r.index,s=r.offset,0!==a&&0===s&&(a--,s=this.fieldArray[a].text.GetLength());for(var l=o;a>=l;l++){var h=this.fieldArray[l];"PromptField"!==h.fieldLabel&&(o===a?(i=h.text.Substring(n,s),i.GetLength()>h._trueLength&&(i=i.Substring(0,h._trueLength))):i+=l===o?h.text.Substring(n,h.text.GetLength()):l===a?h.text.Substring(0,s):h.text.Substring(0,h.text.GetLength()))}return i},i.prototype.GetNonPromptText=function(t,e){var i="",n=0,o,r=this.GetFieldIndex(t,n);o=r.index,n=r.offset;var s=0,a;r=this.GetFieldIndex(t+e,s),a=r.index,s=r.offset,0!==a&&0===s&&(a--,s=this.fieldArray[a].text.GetLength());for(var l=o;a>=l;l++){var h=this.fieldArray[l];"PromptField"!==h.fieldLabel&&(o===a?i=h.text.Substring(n,s):i+=l===o?h.text.Substring(n,h.text.GetLength()):l===a?h.text.Substring(0,s):h.text)}return i},i.prototype.ValueIsNull=function(){for(var t=0;t<this.fieldCount;t++){var e=this.fieldArray[t];if("PromptField"!==e.fieldLabel&&0!==e.GetFieldStatus())return!1}return!0},i.prototype.ValueIsFull=function(t){t=t?t:0;var e,i;if(null!=t&&1===t)for(e=0;e<this.fieldCount;e++){if(i=this.fieldArray[e],1===this.fieldCount&&0===i._minLength)return!0;if("PromptField"!==i.fieldLabel&&!i.GetFieldIsFull())return!1}else for(e=0;e<this.fieldCount;e++)if(i=this.fieldArray[e],"PromptField"!==i.fieldLabel&&2!==i.GetFieldStatus())return!1;return!0},i.prototype.GetShowText=function(e,i,n){if(!n){var o=this.ValueIsNull();if(o===!0&&""!==this._focusNull&&""==i)return this._focusNull;if(o===!0&&""!==this._focusNull&&null==i)return"";if(o===!0&&"LoseFocus"===i)return null!==this._owner._getDisplayNullExpression()?this._owner._getDisplayNullExpression():this.GetText()}var r=this.GetLastVisibleFieldIndex(e);if(0>r)return"";for(var s="",a=0;r>a;a++)s+=this.fieldArray[a].text;if(r<this.fieldCount){var l=this.fieldArray[r];s+="PromptField"===l.fieldLabel||e===t.ShowLiterals.Always?this.fieldArray[r].text:l.text.Substring(0,l._trueLength)}return s},i.prototype.GetLastVisibleFieldIndex=function(e){var i=this.fieldCount-1;if(e!==t.ShowLiterals.Always){var n=this.fieldCount-1,o=!0;for(i=n;i>=0;i--){var r=this.fieldArray[i];if("PromptField"!==r.fieldLabel){if(0!==r._trueLength){if(r._trueLength>0&&r._trueLength<r._minLength)break;if(e===t.ShowLiterals.PostDisplay){o&&(i=n);break}for(;n>i&&"PromptField"===this.fieldArray[i+1].fieldLabel;)i++;break}o=!1}}}return i},i.prototype.GetValue=function(){for(var t=this.fieldCount-1,e;t>=0&&(e=this.fieldArray[t],"PromptField"===e.fieldLabel||0===e._trueLength);t--);if(0>t)return"";for(var i="",n=0;t>=n;n++)if(e=this.fieldArray[n],"PromptField"!==e.fieldLabel){var o=e._trueLength,r=e.text,s=r;if("FilterField"===e.fieldLabel){s=s.Substring(0,o);for(var a=0;o>a;a++)e._bitState[a]===!1&&(s=s.Substring(0,a)+" "+s.Substring(a+1,s.GetLength()));var l=r.GetLength(),h=s.GetLength();if(0===o&&0!==l){if(n!==t){for(var d="",c=0;l>c;c++)d+=" ";s=d}}else if(l>h&&n!==t){for(var d="",c=0;l-h>c;c++)d+=" ";s+=d}}else-1===e._activeItem&&(s=" ");i+=s}return i},i.prototype.GetOldValue=function(){for(var t="",e,i=0;i<this.fieldCount;i++)if(e=this.fieldArray[i],"PromptField"!==e.fieldLabel){var n;if("FilterField"===e.fieldLabel)if(n=e.undoText,e._undoBitState&&e._undoBitState.length>0)for(var o=!0,r=e._undoBitState.length-1;r>=0;r--)e._undoBitState[r]===!1?n=o?n.Substring(0,n.GetLength()-1):n.Substring(0,r)+" "+n.Substring(r+1,n.GetLength()):o=!1;else n="";else n=-1!==e._undoItem?e.undoText:"";t+=n}return t},i.prototype.SetValue=function(t,e){if(!t)return this.ClearContent(),!0;var i=!1;return null!=e&&(i=e),this.SetFieldCollectionValue(t,i)?!0:(this.RollBack(),!1)},i.prototype.SetFieldCollectionValue=function(t,e){this.ClearContent();var i=!1;return null!=e&&(i=e),0!==t.GetLength()&&this.Insert(0,t,i,!1),!0},i.prototype.ClearContent=function(){if(this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0,this.formatIsNull&&this.SaveUndoState(),this.fieldCount>0)for(var t=0;t<this.fieldCount;t++){var e=this.fieldArray[t];e.oldText=e.text,e.Delete(0,e.text.GetLength())}},i.prototype.RollBack=function(){if(this.fieldCount>0)for(var t=0;t<this.fieldCount;t++){var e=this.fieldArray[t];e.RollBack()}},i.prototype.SaveOldState=function(){if(this.fieldCount>0)for(var t=0;t<this.fieldCount;t++){var e=this.fieldArray[t];"PromptField"!==e.fieldLabel&&e.SaveOldState()}},i.prototype.SaveUndoState=function(){if(this.formatIsNull){var t=this.fieldArray[0],e=-1;if(-1===this.oldStart)t.SaveUndoState(),e=this.newStart;else{var i=t.text.substr(this.newStart,this.newLength);e=t.undoText.IndexOf(i,this.oldStart),e!==this.oldStart+this.oldLength&&(e=this.newStart,e+this.newLength!==this.oldStart&&t.SaveUndoState())}this.oldStart>0?this.oldStart=Math.min(this.oldStart,e):this.oldStart=e,this.oldLength+=this.newLength}else if(this.fieldCount>0)for(var n=0;n<this.fieldCount;n++){var t=this.fieldArray[n];"PromptField"!==t.fieldLabel&&t.SaveUndoState()}},i.prototype.Undo=function(){if(this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0,this.fieldCount>0)for(var t=0;t<this.fieldCount;t++){var e=this.fieldArray[t];"PromptField"!==e.fieldLabel&&e.Undo()}},i.prototype.PerformSpin=function(t,e,i){var n,o=this.GetFieldIndex(t,n),r=o.index;if(n=o.offset,this.SaveOldState(),n>0||"EnumField"===this.fieldArray[r].fieldLabel){n=this.fieldArray[r].PerformSpin(n,e,i);for(var s=0,a=0;r>a;a++)s+=this.fieldArray[a].text.GetLength();t=s+n}else{for(var l=r,h;l<this.fieldCount;l++){if(h=this.fieldArray[l],0===h._minLength){if(0===h.text.GetLength())continue;break}if("EnumField"===h.fieldLabel){n=h.PerformSpin(n,e,i);for(var s=0,a=0;r>a;a++)s+=this.fieldArray[a].text.GetLength();
return t=s+n}break}if(r>0&&(h=this.fieldArray[r-1],n=h.text.GetLength(),n<h._minLength&&(n=h._minLength),n=h.PerformSpin(n,e,i),"EnumField"===h.fieldLabel)){for(var s=0,a=0;r-1>a;a++)s+=this.fieldArray[a].text.GetLength();t=s+n}}return t},i.prototype.Delete=function(t,e){if(0===this.fieldCount)return t;var i=0;this.SaveOldState();var n=this.GetFieldIndex(t,i),o=n.index;i=n.offset,"PromptField"===this.fieldArray[o].fieldLabel&&e>this.fieldArray[o].text.GetLength()-i&&(t+=this.fieldArray[o].text.GetLength()-i,e-=this.fieldArray[o].text.GetLength()-i,o++,i=0),this.newStart=t,this.newLength=e,this.formatIsNull&&this.SaveUndoState();var r=0;n=this.GetFieldIndex(t+e,r);var s=n.index;for(r=n.offset;0!==s&&0===r;){var a=this.fieldArray[s-1];if("PromptField"===a.fieldLabel)break;s--,r=this.fieldArray[s].text.GetLength()>this.fieldArray[s]._minLength?this.fieldArray[s].text.GetLength():this.fieldArray[s]._minLength}for(var l=o;s>=l;l++){var a=this.fieldArray[l],h=i;if(o===s)r>i?i=a.Delete(i,r-i):i-=i-r;else if(l===o){var d=a.text.GetLength()-i;d>0&&(i=a.Delete(i,a.text.GetLength()-i))}else i=l===s?a.Delete(i,r):a.Delete(i,a.text.GetLength());null!=i&&(t+=i-h),i=0}return t},i.prototype.Replace=function(t,e,i,n){var o={};o.cursorPos=t,o.text=i;var r=this.GetFieldIndex(t,s),s=0,r=0,a={};a=this.GetFieldIndex(t,s),r=a.index,s=a.offset,this.SaveOldState();for(var l;r<this.fieldCount&&(l=this.fieldArray[r],!(l._minLength>0||l.text.GetLength()>0));r++);for(;0!==r&&0===s&&"PromptField"===this.fieldArray[r].fieldLabel;)r--,l=this.fieldArray[r],s=l.text.GetLength(),s<l._minLength&&(s=l._minLength);this.newStart=t,this.newLength=e;var h=0,d;a=this.GetFieldIndex(t+e,h),d=a.index,h=a.offset;for(var c=0,u=r;d>u;u++)l=this.fieldArray[d-1],c+=l.text.GetLength();for(c+=h,-_;0!==d&&0===h&&(l=this.fieldArray[d-1],"PromptField"!==l.fieldLabel&&l.text.GetLength()<l._maxLength);)d--,h=this.fieldArray[d].text.GetLength();for(var p=i,g=!1,f=t-s,m=r;m<=this.fieldCount-1;m++){g=!1,l=this.fieldArray[m];var w=l.text.GetLength()>l._minLength?l.text.GetLength():l._minLength;if("PromptField"===l.fieldLabel){if(w=l.GetLength(),n){var y=l.text.Substring(s,l.text.GetLength()),v=i.GetLength();if(i.GetLength()>=y.GetLength()?(i.Substring(0,y.GetLength())!==y&&(g=!0),i=i.Substring(y.GetLength(),i.GetLength()),t+=y.GetLength()):(i.Substring(0,y.GetLength())!==y&&(g=!0),i="",t+=i.GetLength()),g&&v===i.GetLength())break}else f+s===t&&(t+=w-s);f+=l.text.GetLength()-s}else{var _=s,S=m===this.fieldCount-1;if(m>d){var x={},S=m===this.fieldCount-1;x=l.Insert(s,i,S),s=x.offset,i=x.text,g=x.existInvalid}else if(r===d){var b={};b=l.Replace(s,h-s,i,S),s=b.offset,i=b.text,g=b.existInvalid}else if(m===r){var b={};b=l.Replace(s,w-s,i,S),s=b.offset,i=b.text,g=b.existInvalid}else if(m===d){var b={};h-s>0?b=l.Replace(s,h-s,i,S):e>0&&(b=l.Replace(s,e,i,S)),s=b.offset,i=b.text,g=b.existInvalid}else{var b={};b=l.Replace(s,w,i),s=b.offset,i=b.text,g=b.existInvalid}var C=2!==l.GetFieldStatus();if(C&&g)break;t+=s-_,f+=l._minLength>l.text.GetLength()?l._minLength:l.text.GetLength()}if(s=0,""===i){if(d>m){m++;for(var u=m,D=0;d>m;m++)"PromptField"!==this.fieldArray[m].fieldLabel&&this.fieldArray[m].Delete(s,this.fieldArray[m].text.GetLength());for(var I=0;u>I;I++){var l=this.fieldArray[I],w=l.GetLength();D+=w}if(t===D&&l._trueLength===l._maxLength)for(;d>=u&&("PromptField"===this.fieldArray[u].fieldLabel&&u!==this.fieldCount-1);u++)t+=this.fieldArray[u].text.GetLength();if(0===h)break;"PromptField"!==this.fieldArray[d].fieldLabel&&this.fieldArray[d].Delete(s,h)}break}}return p===i?(this.RollBack(),o.success=!1):o.success=!0,o.cursorPos=t,o.text=i,o},i.prototype.SetText=function(t,e){var i=0,n={};if(n.cursorPos=i,n.text=t,0===this.fieldCount||!t||0>i)return n;var o=0,r=0,s={};if(s=this.GetFieldIndex(i,o),r=s.index,o=s.offset,o===this.fieldArray[r]._maxLength)return n;for(;0!==r&&0===o;){var a=this.fieldArray[r-1];if(!("PromptField"!==a.fieldLabel&&a.text.GetLength()<a._maxLength))break;r--,o=this.fieldArray[r]._trueLength,o<this.fieldArray[r]._minLength&&(o=this.fieldArray[r]._minLength)}for(var l=!1,h=r,d=i-o;h<this.fieldCount;h++){l=!1;var a=this.fieldArray[h];if("PromptField"===a.fieldLabel){if(e){var c=a.text.Substring(o,a.text.GetLength()),u=t.GetLength();if(t.GetLength()>=c.GetLength()?t.Substring(0,c.GetLength())!==c?l=!0:(t=t.Substring(c.GetLength(),t.GetLength()),i+=c.GetLength()):(c.Substring(0,t.GetLength())!==t&&(l=!0),t="",i+=t.GetLength()),l&&t.GetLength()===u)return n.isValid=!1,n}else d+o===i&&(i+=a.maxLength-o);d+=a.maxLength-o}else{var p=o,g={},f=h===this.fieldCount-1;g=a.SetTextInternal(t,o,f),this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0,this.formatIsNull&&this.SaveUndoState(),o=g.offset,t=g.text,l=g.existInvalid;var m=g.exception;if(l&&m)return n.isValid=!1,n;i+=o-p,d+=a._minLength<a._trueLength?a._trueLength:a._minLength}if(o=0,0===t.GetLength()&&(l||m)){if(!e)break;if(l)return n.isValid=!1,n}}if(h>=this.fieldCount&&""!==t&&t.GetLength()>0)return n.isValid=!1,n;var w=this.GetFieldIndex(i,o),y=w.index,v=w.offset;return h<this.fieldCount&&y===h+1&&0===v&&this.fieldArray[h].text.GetLength()===this.fieldArray[h]._maxLength&&"PromptField"===this.fieldArray[h+1].fieldLabel&&(i+=this.fieldArray[h+1].GetLength()),n.isValid=!0,n.cursorPos=i,n.text=t,n},i.prototype.Insert=function(t,e,i,n){var o={};if(o.cursorPos=t,o.text=e,0===this.fieldCount||!e||0>t)return o;var r=0,s=this.GetFieldIndex(t,r),a=s.index;if(r=s.offset,r===this.fieldArray[a]._maxLength)return o;for(;0!==a&&0===r;){var l=this.fieldArray[a-1];if(!("PromptField"!==l.fieldLabel&&l.text.GetLength()<l._maxLength))break;if(a--,r=this.fieldArray[a]._trueLength,r<this.fieldArray[a]._minLength){if(r=this.fieldArray[a]._minLength,o=this.InsertProcess(a,r,t,e,i),""===o.text)return o;if(t===r){a++,r=0;break}}}return this.InsertProcess(a,r,t,e,i,n)},i.prototype.InsertProcess=function(e,i,n,o,r,s){var a={},l=!1,h=e,d=n-i;for(this.SaveOldState();h<this.fieldCount;h++){l=!1;var c=this.fieldArray[h];if("PromptField"===c.fieldLabel){if(r){var u=c.text.Substring(i,c.text.GetLength()),p=o.GetLength();if(o.GetLength()>=u.GetLength()?(o.Substring(0,u.GetLength())!==u&&(l=!0),o=o.Substring(u.GetLength(),o.GetLength()),n+=u.GetLength()):(u.Substring(0,o.GetLength())!==o&&(l=!0),o="",n+=o.GetLength()),l&&o.GetLength()===p)break}else n+=c.maxLength-i;d+=c.maxLength-i}else{var g=i,f=h===this.fieldCount-1,m=c.Insert(i,o,f,s);i=m.offset,o=m.text,l=m.existInvalid;var w=m.exception;if(l&&w){if(o===a.text)return a;break}n+=i-g,d+=c._minLength<c._trueLength?c._trueLength:c._minLength}if(i=0,0===o.GetLength())break}if(h>=this.fieldCount&&""!==o&&o.GetLength()>0&&o===a.text)return a;var y=this.GetFieldIndex(n,i),v=y.index,_=y.offset;return h<this.fieldCount&&v===h+1&&0===_&&this.fieldArray[h].text.GetLength()===this.fieldArray[h]._maxLength&&this.GetShowLiterals()!==t.ShowLiterals.PostDisplay&&"PromptField"===this.fieldArray[h+1].fieldLabel&&h+1!==this.fieldCount-1&&(n+=this.fieldArray[h+1].GetLength()),a.cursorPos=n,a.text=o,a},i.prototype.MoveField=function(t,e){var i=this.GetFieldIndex(t),n=i.index,o=i.offset;if(-1===n)return-1;if(e){if(n===this.fieldCount-1)return-1;for(;0===this.GetFieldByIndex(n).text.GetLength()&&n<this.fieldCount;)n++;if(n===this.fieldCount-1)return-1;if(n++,"PromptField"===this.GetFieldByIndex(n).fieldLabel){if(n===this.fieldCount-1)return-1;n++}for(var r=0,s=0;n>s;s++)r+=this.GetFieldByIndex(s).GetLength();return r}if(0===n||1===n&&0===o)return-1;for(;0===this.GetFieldByIndex(n).text.GetLength()&&n>0;)n--;if(0===n)return-1;if(n--,"PromptField"===this.GetFieldByIndex(n).fieldLabel){if(0===n)return-1;n--}for(var r=0,s=0;n>s;s++)r+=this.GetFieldByIndex(s).GetLength();return r},i.prototype.GetPosByCurrentField=function(t){if(!t)return null;for(var e=0,i=-1,n=!1;e<this.fieldCount;e++){var o=this.fieldArray[e];if("PromptField"!==o.fieldLabel&&i++,i===t){n=!0;break}}if(n)return this.GetFieldRange(e);if(-1===i)return null;for(e>=this.fieldCount&&(e=this.fieldCount-1);"PromptField"===this.fieldArray[e].fieldLabel;)e--;return this.GetFieldRange(e)},i.prototype.GetFirstInputPosition=function(){var t=this.ValueIsNull();return t&&""!==this._focusNull&&!this.formatIsNull?0:"PromptField"===this.fieldArray[0].fieldLabel?this.GetFieldRange(1).start:0},i.prototype.GetTotalInputFieldCount=function(){var t=0;if(this.fieldCount>0)for(var e=0;e<this.fieldCount;e++){var i=this.fieldArray[e];"PromptField"!==i.fieldLabel&&t++}return t},i.prototype.GetFieldIndexByPos=function(t){return this.GetFieldIndex(t)},i.prototype.CanUndo=function(){if(this.fieldCount>0)for(var t=0;t<this.fieldCount;t++){var e=this.fieldArray[t];if("PromptField"!==e.fieldLabel&&e.undoTempText!==e.text)return!0}return!1},i.prototype.GetRealFieldRange=function(t){var e={};e.start=0,e.length=0;for(var i=0,n=-1,o=-1,r=0;r<this.fieldCount;r++)if("PromptField"!==this.fieldArray[r].fieldLabel&&n++,n===t){o=r;break}for(var r=0;o>r;r++){var s=this.GetFieldByIndex(r);i+=s.GetLength()}var a=this.GetFieldByIndex(o);return a?(e.start=i,e.length=a.GetLength(),e):e},i.prototype.PushBack=function(t){this.Add(t),this.fieldCount++},i}(b);t.MaskFieldCollection=j;var T=function(e){function i(t){e.call(this),this.OldPosition=0,this.IsFocus=!1,this.isSelectionDeterminedByHighlightText=!1,this.Format=null,null!=t.HelpID&&(this.HelpID=t.HelpID),t.Owner&&(this.Owner=t.Owner)}return __extends(i,e),i.prototype.GetCurrentField=function(t){var e=this.GetShowText(this.GetShowLiterals());if(this.Format.Fields.ValueIsNull()&&null!=e&&(""!==this.Format.Fields._focusNull&&e===this.Format.Fields._focusNull||null!=e&&""==e)){var i={};return i.index=-1,i}return this.Format.Fields.GetCurrentField(t)},i.prototype.FocusInternal=function(e,i,n,o,r){var s={},a=this.GetShowText(this.GetShowLiterals());this.OldValue=this.Format.Fields.GetText(),this.isMulSelected=!1,this.isDblClick=!1,this.isTriClick=!1,s.SelectionStart=r,e===t.FocusType.Click&&(s.SelectionStart=t.Utility.GetCursorPosition(i),s.SelectionEnd=s.SelectionStart),s.Text=a,this.Format.Fields.ValueIsNull()&&null!=s.Text&&""!==this.Format.Fields._focusNull&&s.Text===this.Format.Fields._focusNull&&(s.SelectionStart=0,s.SelectionEnd=0),this.Format.Fields.ValueIsNull()&&null!==this.Format.Fields._owner._getDisplayNullExpression()&&(s.SelectionStart=0,s.SelectionEnd=0),(-1===s.SelectionStart||s.SelectionStart>s.Text.GetLength())&&(s.SelectionStart=0,s.SelectionEnd=0),e===t.FocusType.Left?(s.SelectionStart=0,s.SelectionEnd=0):e===t.FocusType.Right&&(s.SelectionStart=s.Text.GetLength(),s.SelectionEnd=s.Text.GetLength());var l=s.SelectionStart;if(e!==t.FocusType.SpinButton&&e!==t.FocusType.ContextMenu&&e!==t.FocusType.ClientEvent&&e!==t.FocusType.ImeInput&&(n!==t.HighlightText.None||-1!==o))if(this.Format.Fields.ValueIsNull()&&null!=s.Text&&""!=this.Format.Fields._focusNull&&s.Text===this.Format.Fields._focusNull)s.SelectionEnd=s.Text.GetLength();else{var h=this.SetCursorPositionAndSelection(n,"",o,l);null!=h&&(s.SelectionStart=h.SelectionStart,s.SelectionEnd=h.SelectionEnd)}return null!=s.SelectionStart&&(this.OldPosition=s.SelectionStart),this.IsFocus=!0,s},i.prototype.SetCursorPositionAndSelection=function(e,i,n,o){var r;if(e===t.HighlightText.All)this.isSelectionDeterminedByHighlightText=!0,r=this.SelectAll();else if(e===t.HighlightText.Field)if(this.isSelectionDeterminedByHighlightText=!0,-1>=n)if(o>0){var s=this.Format.Fields.GetFieldIndex(o).index,a=this.Format.Fields.fieldArray[s];"PromptField"===a.fieldLabel&&(s===this.Format.Fields.fieldCount-1?s--:s++);var l=this.Format.Fields.GetFieldRange(s);r={},r.SelectionStart=l.start,r.SelectionEnd=l.length+l.start}else r=this.GetPosByCurrentField(o);else r=this.GetPosByCurrentField(n);else r=this.GetPosByCurrentField(n),null!=r&&(r.SelectionStart=r.SelectionStart,r.SelectionEnd=r.SelectionStart);return r},i.prototype.GetPosByCurrentField=function(t){var e={},i=this.Format.Fields.GetPosByCurrentField(t);return null!=i&&-1!=i?(e.SelectionStart=i.start,e.SelectionEnd=i.start+i.length,e):null},i.prototype.LoseFocus=function(){var t={};return 1!=this.Owner._getFormatIsNull()&&this.Format.Fields.SaveUndoState(),t.Text=this.GetShowText(this.GetShowLiterals(),"LoseFocus"),t.Value=this.Format.Fields.GetValue(),this.IsFocus=!1,t},i.prototype.GetSepText=function(){if(this.Owner._getFormatIsNull())return this.Format.Fields.GetText();for(var e="",i=this.Format.Fields.fieldCount-1,n=0;i>=n;n++){var o=this.Format.Fields.fieldArray[n];if("PromptField"!==o.fieldLabel){var r=o._trueLength,s=o.text;if("FilterField"===o.fieldLabel)for(var a=0;r>a;a++)o._bitState[a]===!1&&(s=s.Substring(0,a)+" "+s.Substring(a+1,s.GetLength()));else-1===o._activeItem&&(s="");if(n!=i){var l=s.Substring(0,r);if(l=l.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\"),"FilterField"===o.fieldLabel&&!this.Owner._getFormatIsNull()){for(var h=s.Substring(0,r),a=0;r>a;a++)o._bitState[a]===!1&&(h=h.Substring(0,a)+t.Utility.MaskValChar+h.Substring(a+1,h.GetLength()));l+=t.Utility.Hold+","+h.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\")}e+=l+t.Utility.Hold+";"}else{var l=s.Substring(0,r);if(l=l.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\"),"FilterField"===o.fieldLabel&&!this.Owner._getFormatIsNull()){for(var h=s.Substring(0,r),a=0;r>a;a++)o._bitState[a]===!1&&(h=h.Substring(0,a)+t.Utility.MaskValChar+h.Substring(a+1,h.GetLength()));l+=t.Utility.Hold+","+h.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\")}e+=l}}}return e},i.prototype.SetSepText=function(e){if(!e){for(var i=0;i<this.Format.Fields.fieldCount;i++){var n=this.Format.Fields.fieldArray[i];"PromptField"!==n.fieldLabel&&n.Clear()}return!0}for(var o=t.Utility.Hold+";",r=e.split(o),s=0;s<r.length;s++)r[s]=r[s].replace(/@#GCC#@/g,",").replace(/@#GCD#@/g,"'").replace(/@#GCM#@/g,'"');for(var a=!1,l=0,i=0;i<this.Format.Fields.fieldCount;i++){var n=this.Format.Fields.fieldArray[i];if("PromptField"!==n.fieldLabel)if(l<r.length){var h=r[l].split(t.Utility.Hold+","),d=h[0],c="";if(h.length>1&&(c=h[1],c&&""!=c&&d!=c))for(var u=0,p=d.IndexOf(" ",u);-1!=p;)c.Substring(p,p+1)===t.Utility.MaskValChar&&(d=d.Substring(0,p)+this.Owner.GetPromptChar()+d.Substring(p+1,d.GetLength())),u=p,p=d.IndexOf(" ",u);a=l===this.Format.Fields.fieldCount-1;var g=d.GetLength();if(g<n._minLength)for(var s=0;s<n._minLength-g;s++)d+=this.Owner.GetPromptChar(),c+=t.Utility.MaskValChar;var f;if(f="FilterField"===n.fieldLabel?n.SetTextInternal(d,0,a,c):n.SetTextInternal(d,0,a),f.existInvalid&&f.exception)return!1;l++}else n.Clear()}return!0},i.prototype.ProcessShortcutKey=function(t,i,n){var o={};switch(t){case"Clear":return i||this.Format.Fields.ClearContent(),o.SelectionStart=this.Format.Fields.GetFirstInputPosition(),o.SelectionEnd=o.SelectionStart,o.Text=this.GetShowText(this.GetShowLiterals()),o;case"NextField":if(this.IsLastInputField(n,!0))return!0;break;case"PreviousField":if(this.IsLastInputField(n,!1))return!0}return o=e.prototype.ProcessShortcutKey.call(this,t,i,n)},i.prototype.KeyDown=function(i){var n=i.KeyCode,o=e.prototype.KeyDown.call(this,i);if(27===n&&this.Owner.Clear(),null!=i.KeyAction)return o;if(i.ReadOnly===!0)return o;if(void 0!=n&&null!=n){if(n>=48&&57>=n||n>=65&&90>=n||n>=96&&105>=n||0===n||229===n||231===n)return o||(o={}),E.Mask_ImeResponse=!0,o.inputChar=!0,o;if(32===n||106===n||107===n||109===n||110===n||111===n||219===n||220===n||221===n||222===n||n>=186&&192>=n||226===n)return o||(o={}),E.Mask_ImeResponse=!0,o.inputChar=!0,o;if(!t.Utility.IsIE()&&(61===n||59===n))return o||(o={}),E.Mask_ImeResponse=!0,o.inputChar=!0,o;var r=n;if(i.FuncKeysPressed.Shift&&65552!=n&&(r=n-65536),n>65600&&65627>n&&(r=n-65536),r>=48&&57>=r||r>=65&&90>=r||r>=96&&105>=r||229===r||0===r||231===r)return o||(o={}),E.Mask_ImeResponse=!0,o.inputChar=!0,o;if(32===r||106===r||107===r||109===r||110===r||111===r||219===r||220===r||221===r||222===r||r>=186&&192>=r||226===r)return o||(o={}),E.Mask_ImeResponse=!0,o.inputChar=!0,o;if(!t.Utility.IsIE()&&(61===r||59===r))return o||(o={}),E.Mask_ImeResponse=!0,o.inputChar=!0,o}return o},i.prototype.KeyPressInternal=function(t,e,i,n,o){if(E.Mask_ImeResponse===!0){E.Mask_ImeResponse=!1;var r={};this.Format.Fields.ValueIsNull()&&""!=this.Format.Fields._focusNull&&(e=0,i=0);var s=this.ProcessCharKey(e,i,o,n);if(s.success){if(r.SelectionStart=s.start,r.SelectionEnd=r.SelectionStart,r.Text=this.GetShowText(this.GetShowLiterals()),this.isMulSelected=!1,this.moveFocusExitOnLastChar){var a=this.MoveControl(this.GetElementId(),!0,!1,"CharInput");null!=a&&(r.EventInfo=a.EventInfo,r.FocusType=a.FocusType,r.FocusExit=!0),this.moveFocusExitOnLastChar=!1}}else r.SelectionStart=s.start,r.SelectionEnd=Math.max(e,i),r.Text=this.GetShowText(this.GetShowLiterals()),r.EventInfo=s.EventInfo,r.exception=!0,this.moveFocusExitOnLastChar&&(r.FocusExit=!0,this.moveFocusExitOnLastChar=!1);return r}return!1},i.prototype.ProcessCharKey=function(t,i,n,o){var r=e.prototype.ProcessCharKey.call(this,t,i,n,o),s=Math.min(t,i);return r.success&&(s=r.start),o&&(this.moveFocusExitOnLastChar=!1,s===this.Format.Fields.GetExistLength()&&(this.moveFocusExitOnLastChar=!0)),r},i.prototype.ContextMenu=function(){},i.prototype.Click=function(){},i.prototype.Undo=function(t){var e={};return this.Format.Fields.Undo(),e.SelectionStart=this.OldPosition,e.SelectionEnd=this.OldPosition,this.OldPosition=t,e.Value=this.Format.Fields.GetText(),e.Text=this.GetShowText(this.GetShowLiterals()),e},i.prototype.Paste=function(e,i,n,o,r){var s={};s.SelectionStart=e,s.SelectionEnd=i;var a;null!=r&&r===!0?a=n:this.Owner?(a=t.Utility.GetPasteData(this.Owner.GetUseClipboard()),a=this.UpdateCrLfString(a,this.Owner.GetAcceptsCrlf())):a=t.Utility.GetPasteData(!0);var l=null;if(null!=a&&(-1!=a.IndexOf("\r")&&(a=a.Substring(0,a.IndexOf("\r"))),-1!=a.IndexOf("\n")&&(a=a.Substring(0,a.IndexOf("\n")))),!a)return s;this.FireClientEvent("OnBeforePaste");var h=Math.min(e,i),d=Math.max(e,i),c=d-h;if(h===d)s.SelectionStart=this.Format.Fields.Insert(h,a,!1).cursorPos,s.Text=this.GetShowText(this.GetShowLiterals()),s.SelectionEnd=s.SelectionStart;else{var u=this.GetShowText(this.GetShowLiterals());l=null!=u&&""!=this.Format.Fields._focusNull&&u===this.Format.Fields._focusNull&&this.Format.Fields.fieldArray[0].text!=u?this.Format.Fields.Insert(0,a,!1):this.Format.Fields.Replace(h,c,a,!1),s.SelectionStart=l.cursorPos,s.Text=this.GetShowText(this.GetShowLiterals()),u===s.Text&&l.success===!1?(s.SelectionStart=h,s.SelectionEnd=d):s.SelectionEnd=s.SelectionStart}if(s.Text.Substring(h,h+a.GetLength())!=a&&s.SelectionStart-h<a.GetLength()&&""!=this.InvalidInput){var p={};p.Name=this.InvalidInput,p.Args=null,p.Type="InvalidInput",s.EventInfo=p}if(o)if(s.SelectionStart===this.Format.Fields.GetExistLength())this.moveFocusExitOnLastChar=!0;else{var g=this.Format.Fields.GetFieldIndex(s.SelectionStart),f=g.index,m=g.offset;f===this.Format.Fields.fieldCount-1&&0===m&&"PromptField"===this.Format.Fields.GetFieldByIndex(f).fieldLabel&&(this.moveFocusExitOnLastChar=!0)}if(this.moveFocusExitOnLastChar){var w=this.MoveControl(this.GetElementId(),!0,!1,"CharInput");null!=w&&(s.EventInfo=w.EventInfo,s.FocusType=w.FocusType,s.FocusExit=!0),this.moveFocusExitOnLastChar=!1}return s.SelectionStart!=h&&this.FireClientEvent("OnPaste"),s},i.prototype.UpdateCrLfString=function(e,i){return i!==t.CrLfMode.NoControl?t.BaseUIProcess.UpdateCrLfString(e,i):t.BaseUIProcess.UpdateCrLfString(e,t.CrLfMode.Cut)},i.prototype.DragStart=function(){},i.prototype.DragEnd=function(){},i.prototype.DragOver=function(){},i.prototype.DragInit=function(){},i.prototype.SetValue=function(t){this.Format.Fields.SetValue(t)},i.prototype.GetShowText=function(t,e,i){var n="";return e?"LoseFocus"===e&&(n=this.Format.Fields.GetShowText(t,"LoseFocus",i)):n=this.Format.Fields.GetShowText(t,"",i),n},i.prototype.ProcessBackSpaceKey=function(t,e){var i=Math.min(t,e),n=Math.abs(t-e),o={};if(o.SelectionStart=i,o.SelectionEnd=i+n,0===i&&0===n)return o;var r,s,a=this.Format.Fields.GetFieldIndex(i);if(r=a.index,s=a.offset,-1===r)return o;if(0===n){var l=this.Format.Fields.GetFieldByIndex(r);if(0===r&&0===s)return o;for(;(0===s||"PromptField"===l.fieldLabel)&&r>0;)r--,n+=s,l=this.Format.Fields.GetFieldByIndex(r),s=l.GetLength(),"PromptField"===l.fieldLabel&&(n+=s,s=0);if(0===r){if("PromptField"===this.Format.Fields.GetFieldByIndex(r).fieldLabel)return o;if(0===this.Format.Fields.GetFieldByIndex(r).GetLength())return o}if("FilterField"===this.Format.Fields.GetFieldByIndex(r).fieldLabel)n+=1,i-=n,n=1;else{if("EnumField"!==this.Format.Fields.GetFieldByIndex(r).fieldLabel)return o;n+=this.Format.Fields.GetFieldByIndex(r).GetLength(),i-=n,i=i>0?i:0}i=this.Format.Fields.Delete(i,n),o.SelectionStart=i,o.SelectionEnd=o.SelectionStart}else{var h;if(a=this.Format.Fields.GetFieldIndex(i+n),h=a.index,-1===h)return o;if(0===s&&0!=r&&r--,r===h&&"PromptField"===this.Format.Fields.GetFieldByIndex(h).fieldLabel)return o;o.SelectionStart=this.Format.Fields.Delete(i,n),o.SelectionEnd=o.SelectionStart}return o},i.prototype.PerformSpinInternal=function(t,e,i,n,o){if(this.Format.Fields.fieldCount<=0)return null;var r={};r.SelectionStart=t,r.SelectionEnd=e,r.Text=this.GetShowText(this.GetShowLiterals());var s=this.Format.Fields.GetFieldIndex(e),a=s.index,l=s.offset;if(0!=a&&0===l&&(t===e?"EnumField"!=this.Format.Fields.fieldArray[a].fieldLabel&&a--:e>t&&a--),("EnumField"==this.Format.Fields.fieldArray[a].fieldLabel||0==this.Format.Fields.fieldArray[a].text.GetLength())&&(o?r.SelectionStart=this.Format.Fields.PerformSpin(e,i,n):r.SelectionStart=this.Format.Fields.PerformSpin(e,-i,n),r.SelectionEnd=r.SelectionStart,r.Text=this.GetShowText(this.GetShowLiterals())),o){if(""!=this.SpinUp){var h={};h.Name=this.SpinUp,h.Args=null,h.Type="SpinUp",r.EventInfo=h}}else if(""!=this.SpinDown){var h={};h.Name=this.SpinDown,h.Args=null,h.Type="SpinDown",r.EventInfo=h}return r},i.prototype.ProcessBackSpace=function(t,e){var i=this.ProcessBackSpaceKey(t,e);return i.Text=this.GetShowText(this.GetShowLiterals()),this.isMulSelected=!1,i},i.prototype.ProcessDeleteKey=function(t,e){var i=Math.min(t,e),n=Math.abs(t-e),o={};if(o.SelectionStart=i,o.SelectionEnd=i+n,i===this.Format.Fields.GetLength()&&0===n)return o;var r,s=this.Format.Fields.GetFieldIndex(i);if(r=s.index,-1===r)return o;if(0===n){if("PromptField"===this.Format.Fields.GetFieldByIndex(r).fieldLabel)return o;i=this.Format.Fields.Delete(i,1),o.SelectionStart=i,o.SelectionEnd=o.SelectionStart}else{var a,l;if(s=this.Format.Fields.GetFieldIndex(i+n),a=s.offset,l=s.index,-1===l)return o;if(0===a&&l--,r===l&&"PromptField"===this.Format.Fields.GetFieldByIndex(r).fieldLabel)return o;o.SelectionStart=this.Format.Fields.Delete(i,n),o.SelectionEnd=o.SelectionStart}return o},i.prototype.ProcessDelete=function(t,e){var i=this.ProcessDeleteKey(t,e);return i.Text=this.GetShowText(this.GetShowLiterals()),this.isMulSelected=!1,i},i.prototype.GetNullCasePosition=function(t,e){var i=this.Format.Fields;switch(e){case 36:case 65572:case 131109:case 196645:case 196644:case 131108:t=0;break;case 35:case 65571:t=i.GetLength();break;case 65573:case 37:0!=t&&t--;break;case 39:case 65575:t!=i.GetLength()&&t++;break;case 131111:case 196647:case 196643:case 131107:t=i.GetLength();break;case 131118:case 131080:case 196616:return t}return t},i.prototype.GetCaretPosition=function(i,n){if(this.Format.Fields.ValueIsNull()&&""!=this.Format.Fields._focusNull)return this.GetNullCasePosition(i,n);var o=this.Format.Fields,r=o.GetFieldIndex(i),s=r.index,a,l,h=0,d=0;for(d=0;d<o.fieldCount;d++)if("PromptField"!=o.GetFieldByIndex(d).fieldLabel){l=o.GetFieldRange(d).start;break}var c=o.GetLastVisibleFieldIndex(this.GetShowLiterals());if(this.ShowLiterals===t.ShowLiterals.PreDisplay)for(d=c;d>=0;d--)"PromptField"!=o.GetFieldByIndex(d).fieldLabel&&(h+=o.GetFieldByIndex(d)._trueLength);else for(d=c;d>=0;d--)if("PromptField"!=o.GetFieldByIndex(d).fieldLabel){a=o.GetFieldRange(d),h=a.start+a.length;break}var u=i;i=e.prototype.GetCaretPosition.call(this,i,n,l,h,"PromptField");var r=o.GetFieldIndexByPos(u),s=r.index,a;if(196647===n&&i===u){for(;c>s&&(a=o.GetFieldRange(s+1),i=a.start,!(i>l));s++);s===c&&(i+=a.length)}if(131111===n&&"PromptField"!=o.GetFieldByIndex(s).fieldLabel&&0===o.GetFieldRange(s).length){for(;0===o.GetFieldRange(s).length&&s<o.fieldCount-1;)s++;for(d=s+1;d<o.fieldCount;d++)if("PromptField"!=o.GetFieldByIndex(d).fieldLabel)return a=o.GetFieldRange(d),a.start}return i},i.prototype.ProcessTabKey=function(i,n,o){var r;return r=o!==t.TabAction.Field||this.Format.Fields.ValueIsNull()&&""!=this.Format.Fields._focusNull&&this.GetShowText(this.GetShowLiterals())===this.Format.Fields._focusNull?e.prototype.ProcessTabKey.call(this,i,n,o):this.MoveFieldAndControl(i,n)},i.prototype.ProcessLeftDirection=function(t,e,i){var n={};if(this.isMulSelected&&36!==i&&131108!==i?(n.SelectionStart=Math.min(t,e),n.SelectionEnd=n.SelectionStart):(n.SelectionStart=this.GetCaretPosition(e,i),n.SelectionEnd=n.SelectionStart),37===i||131109===i){if((!this.Format.Fields.ValueIsNull()||""==this.Format.Fields._focusNull)&&n.SelectionStart>0){var o=this.Format.Fields.GetFieldIndex(n.SelectionStart),r=o.index,s=o.offset;"PromptField"===this.Format.Fields.GetFieldByIndex(r).fieldLabel&&this.isMulSelected===!1&&(n.SelectionStart-=s),n.SelectionEnd=n.SelectionStart}return this.isMulSelected=!1,n}if(this.isMulSelected=!1,this.isMulSelected&&36!==i&&131108!==i){n.SelectionStart=Math.min(t,e);var o=this.Format.Fields.GetFieldIndex(n.SelectionStart),r=o.index,s=o.offset;"PromptField"===this.Format.Fields.GetFieldByIndex(r).fieldLabel&&(n.SelectionStart-=s),n.SelectionEnd=n.SelectionStart}else n.SelectionStart=this.GetCaretPosition(e,i),n.SelectionEnd=n.SelectionStart;return n},i.prototype.ProcessRightDirection=function(t,e,i){var n={};if(!this.isMulSelected||35===i||131107===i)return n.SelectionStart=this.GetCaretPosition(e,i),n.SelectionEnd=n.SelectionStart,this.isMulSelected=!1,n;if(n.SelectionStart=Math.max(t,e),this.Format.Fields.ValueIsNull()===!0&&""!=this.Format.Fields._focusNull)return n.SelectionEnd=n.SelectionStart,this.isMulSelected=!1,n;var o,r,s=this.Format.Fields.GetFieldIndex(n.SelectionStart);if(o=s.index,r=s.offset,"PromptField"===this.Format.Fields.GetFieldByIndex(o).fieldLabel&&this.isMulSelected===!1){var a=this.Format.Fields.fieldArray[o];n.SelectionStart+=a.text.GetLength()-r}return n.SelectionEnd=n.SelectionStart,this.isMulSelected=!1,n},i.prototype.IsLastInputField=function(t,e){var i=this.Format.Fields.GetFieldIndex(t,0),n=i.index;if(e){for(;n<this.Format.Fields.fieldCount-1&&"PromptField"!=this.Format.Fields.fieldArray[n+1].fieldLabel&&0===this.Format.Fields.fieldArray[n+1].text.GetLength();)n++;for(var o=this.Format.Fields.fieldCount-1;o>n&&"PromptField"==this.Format.Fields.fieldArray[o].fieldLabel;o--);return o===n?!0:!1}for(;n>0&&"PromptField"!=this.Format.Fields.fieldArray[n-1].fieldLabel&&0===this.Format.Fields.fieldArray[n-1].text.GetLength();)n--;for(var o=0;n>o&&"PromptField"==this.Format.Fields.fieldArray[o].fieldLabel;o++);return o===n?!0:!1},i.prototype.DoubleClick=function(t){var i={},n=this.GetShowText(this.GetShowLiterals());if(this.Format.Fields.ValueIsNull()&&null!=n&&(""!=this.Format.Fields._focusNull&&n===this.Format.Fields._focusNull||null!=n&&""==n)){var n=this.GetShowText(this.GetShowLiterals());i.SelectionStart=0,i.SelectionEnd=n.GetLength()}else i=e.prototype.DoubleClick.call(this,t);return i},i}(t.BaseUIProcess);t.MaskUIProcess=T;var E=function(i){function n(){i.call(this),this.IMControlType="Mask",this._promptChar="_",this._autoConvert=!0,this._displayNull=null,this._null="",this._formatPattern="",this._exitOnLastChar=!1,this._displayNullExpresson=null,this._showLiterals=t.ShowLiterals.Always,this._tabAction=t.TabAction.Control,this._hideEnter=!1,this._hidePromptOnLeave=!1,this._textWithPromptChar=null,this.PerformSpin=function(t){var e=this.Spin.Increment,i=!0;"down"===t&&(i=!1),this.PerformSpinProcess(this.SelectionStart,this.SelectionEnd,e,this.Spin.Wrap,i,!0),this.UIUpdate.SetFocus(),this.SetSelection(this.SelectionStart,this.SelectionEnd)},this.Init()}return __extends(n,i),n.Mask_ImeResponse=!1,n.prototype.AttachInput=function(t){this.InputElement=t,this.AddAllEventsHandler()},n.prototype.DetachInput=function(){e(this.InputElement).unbind(".wijinput"),this.InputElement=null},n.prototype.GetAutoConvert=function(){return this._autoConvert},n.prototype.SetAutoConvert=function(t){this._autoConvert=t},n.prototype.GetExitOnLastChar=function(){return this._exitOnLastChar},n.prototype.SetExitOnLastChar=function(e){e=t.Utility.CheckBool(e),this._exitOnLastChar=e},n.prototype.GetNull=function(){return this._null},n.prototype.SetNull=function(t){if(t!==this._null){var e=I.ParseFillExpression(t,this.Format.Fields);null===e.Expression?this.Format.Fields._focusNull=t:this.Format.Fields._focusNull=e.Expression,this._null=t}},n.prototype._getDisplayNullExpression=function(){return null!==this._displayNullExpresson?this._displayNullExpresson:this._displayNull},n.prototype.GetDisplayNull=function(){return this._displayNull},n.prototype.SetDisplayNull=function(e){if(void 0===e&&(e=null),null!==e&&(e=t.Utility.CheckString(e)),e!==this._displayNull){var i=I.ParseFillExpression(e,this.Format.Fields);this._displayNullExpresson=i.Expression,this._displayNull=e;var n=this.GetValue();this.SetValue(n)}},n.prototype.GetFormatPattern=function(){return this._formatPattern},n.prototype.SetFormatPattern=function(e){if(e=t.BaseUIProcess.UpdateCrLfString(e,t.CrLfMode.Filter),e!==this._formatPattern)try{var i=I.ParseFormat(e,this);this.Clear(),this.Format.Fields=i,this.ResetNullAndDispalyNull(),this.FormatIsNull=this.Format.Fields.formatIsNull,this.Clear(),this.SetSelectionStart(0),this._formatPattern=e;var n=this.GetDisplayText();this.UpdateDisplayText(n)}catch(o){throw"Format pattern is invalid"}},n.prototype.ResetNullAndDispalyNull=function(){var t=I.ParseFillExpression(this.GetNull(),this.Format.Fields);null===t.Expression?this.Format.Fields._focusNull=this.GetNull():this.Format.Fields._focusNull=t.Expression,t=I.ParseFillExpression(this.GetDisplayNull(),this.Format.Fields),this._displayNullExpresson=t.Expression},n.prototype.GetPromptChar=function(){return this._promptChar},n.prototype.SetPromptChar=function(t){if(t||(t="_"),t.length>1&&(t=t.charAt(0)),t!==this._promptChar){this._promptChar=t;var e=this.GetValue();this.SetValue(e)}},n.prototype.GetShowLiterals=function(){return this._showLiterals},n.prototype.SetShowLiterals=function(t){if(t!=this._showLiterals){this._showLiterals=t;var e=this.GetValue();this.SetValue(e)}},n.prototype.GetTabAction=function(){return this._tabAction},n.prototype.SetTabAction=function(t){this._tabAction=t},n.prototype.GetCursorPosition=function(){return this.CursorPosition},n.prototype.SetCursorPosition=function(e){e=t.Utility.CheckInt(e,-1,Math.pow(2,31)),e=Math.min(e,this.Format.Fields.GetTotalInputFieldCount()-1),e!==this.CursorPosition&&(this.CursorPosition=e)},n.prototype.Init=function(){this._autoConvert=!0,this.FormatIsNull=!0,this.CursorPosition=-1,this.truePosition=-1,this.japInput=!1,this.ImeMode=!1,this.IsImplementImeInput=!1,this.IsJapanConvertKeyPress=!1,this.HelpID="__"+this.ID+"_State",this.IsDragDrop=!1;var e={};if(e.ID=this.ID,e.HelpID=this.HelpID,e.Owner=this,this.UIProcess=this._createUIProcess(e),this.Format.Fields=I.ParseFormat("",this),this.FormatIsNull=this.Format.Fields.formatIsNull,this.UIProcess.Format=this.Format,this.NewSelectionStart=0,this.NewSelectionEnd=0,this.IsInUpdatePanelAndAsyncPostBack||this.UIUpdate&&(this.UIProcess.Format.Fields.ClearContent(),this.UIProcess.Format.Fields.SetText(this.UIUpdate.GetText(),!0)),this.Text=this.UIProcess.Format.Fields.GetText(),this.Value=this.UIProcess.Format.Fields.GetValue(),this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText(),
this.MouseButton=t.MouseButton.Default,this.FocusType=t.FocusType.None,this.IsInUpdatePanelAndAsyncPostBack){var i=this.UIUpdate.GetText();if(i!=this.UIProcess.GetShowText(this.GetShowLiterals(),null,!0)&&i!=this.UIProcess.GetShowText(this.GetShowLiterals(),"LoseFocus",!1))if(this.ShowLiterals===t.ShowLiterals.Always)this.UIProcess.Format.Fields.ClearContent(),this.UIProcess.Format.Fields.SetText(i,!0),this.SetHideValue();else{this.UIProcess.Format.Fields.ClearContent();var n=this.UIProcess.GetShowText("Always",null,!0);i.GetLength()<n.GetLength()&&(i+=n.Substring(i.GetLength(),n.GetLength())),this.UIProcess.Format.Fields.SetText(i,!0),this.SetHideValue()}this.Text=this.UIProcess.Format.Fields.GetText(),this.Value=this.UIProcess.Format.Fields.GetValue(),this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText()}this.UIUpdate&&(this.DisplayText=this.GetTextboxValue()),this.LastStart=0,this.LastEnd=0,this.OrientText="",this.ImeSelect=!1,this.ImeSelectTimes=0,this.Type="Mask",this.UIUpdate&&this.ReLoadData()},n.prototype._createUIProcess=function(t){return new T(t)},n.prototype.Clear=function(){this.SetValue(""),this.SelectionStart=this.SelectionEnd=this.Format.Fields.GetFirstInputPosition()},n.prototype.SetValue=function(e){e&&("string"!=typeof e&&(e=e.toString()),this.FormatIsNull&&(e=e.replace(/[\r\n]/g,"")),e=t.BaseUIProcess.UpdateCrLfString(e,t.CrLfMode.Filter)),this.UIProcess.Format.Fields.SetValue(e,!1)&&this.AfterSetTextValue()},n.prototype.GetValue=function(){return this.Value},n.prototype.GetSelectedText=function(){var e=Math.min(this.SelectionStart,this.SelectionEnd),i=Math.max(this.SelectionStart,this.SelectionEnd),n=this.Text.Substring(e,i);if(this.GetClipContent()===t.ClipContent.ExcludeLiterals){var o=Math.min(this.SelectionStart,this.SelectionEnd),r=this.GetSelectionLength();n=this.UIProcess.Format.Fields.GetNonPromptText(o,r)}return n},n.prototype.SetSelectedText=function(t){if(t){var e=this.Value,i=this.Text;this.UIProcess.Paste(this.SelectionStart,this.SelectionEnd,t,!1,!0);var n={};n.Text=this.GetDisplayText("Focus"),this.UpdateText(n)&&(this.UpdateDisplayText(this.Text),this.Value=this.UIProcess.Format.Fields.GetValue(),this.Text!=i&&this.FireClientEvent("TextChanged",null),this.Value!=e&&this.FireClientEvent("ValueChanged",null))}},n.prototype.SetText=function(e){try{if(this.ShowPromptChar(),this.Value=this.UIProcess.Format.Fields.GetValue(),!e)return void this.SetValue("");if(e===this.UIProcess.Format.Fields._focusNull&&!this.UIProcess.Format.Fields.formatIsNull)return void this.SetValue("");this.UIProcess.Format.Fields.ClearContent(),this.FormatIsNull&&(e=e.replace(/[\r\n]/g,"")),e=t.BaseUIProcess.UpdateCrLfString(e,t.CrLfMode.Filter),this.UIProcess.Format.Fields.SetText(e,!0).isValid===!1?this.UIProcess.Format.Fields.RollBack():this.AfterSetTextValue()}finally{this.HidePromptChar()}},n.prototype.AfterSetTextValue=function(){var t=this.Value,e=this.Text,i={};i.Text=this.GetDisplayText("Focus"),this.UpdateText(i)&&(this.Value=this.UIProcess.Format.Fields.GetValue(),this.UpdateDisplayText(this.GetDisplayText()),this.Text!=e&&(this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText(),this.FireClientEvent("TextChanged",null)),this.Value!=t&&this.FireClientEvent("ValueChanged",null))},n.prototype.GetText=function(){return this.GetDisplayText("Focus")},n.prototype.GetDisplayText=function(t){return t?"Focus"===t?this.UIProcess.GetShowText(this.GetShowLiterals()):"":this.UIProcess.GetShowText(this.GetShowLiterals(),"LoseFocus")},n.prototype.GetCurrentField=function(){return null!=this.UIProcess.GetCurrentField(this.SelectionEnd)?this.UIProcess.GetCurrentField(this.SelectionEnd).index:0},n.prototype.GetValueIsFull=function(){return this.UIProcess.Format.Fields.ValueIsFull(1)},n.prototype._getFormatIsNull=function(){return this.FormatIsNull},n.prototype.FireClientEvent=function(t,e){var i="";switch(t){case"TextChanged":""!=this.TextChanged&&(i=this.TextChanged);break;case"ValueChanged":""!=this.ValueChanged&&(i=this.ValueChanged);break;default:return}return this.UIProcess.FireEvent(this,i,e,t)},n.prototype.Focus=function(){if(this.ShowPromptChar(),!this.IsDragDrop&&this.FocusType!=t.FocusType.ClientEvent&&this.FocusType!=t.FocusType.SpinButton&&(this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText()),this.UIProcess.Format.Fields.fieldCount>0){var e=this.UIProcess.FocusInternal(this.FocusType,this.InputElement,this.GetHighlightText(),this.CursorPosition,this.SelectionStart);if(!e)return;null!=e.Text&&(this.Text=e.Text),null!=e.SelectionStart&&this.NeedReCalCursorPos&&(this.SelectionStart=e.SelectionStart),null!=e.SelectionEnd&&this.NeedReCalCursorPos&&(this.SelectionEnd=e.SelectionEnd,this.SelectionLength=this.GetSelectionLength()),this.NeedReCalCursorPos||(this.NeedReCalCursorPos=!0),this.japInput===!0&&(-1!=this.truePosition&&(this.SelectionStart=this.truePosition,this.SelectionEnd=this.truePosition),this.japInput=!1),this.GetReadOnly()===!0&&this.FocusType===t.FocusType.None&&(this.SelectionStart=0,this.SelectionEnd=this.Text.length),this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd,!0),!this.IsDragDrop&&this.FocusType!=t.FocusType.ClientEvent&&this.FocusType!=t.FocusType.SpinButton&&this.FocusType!=t.FocusType.DropDown&&(this.OldValue=this.Value)}else this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.OldValue=this.Value;this.IsDragDrop=!1},n.prototype._shouldFireValueChangedEvent=function(){return this.OldText!=this.Text},n.prototype.LoseFocus=function(){this.FireKeyExit();var e=this.ImeMode;if(t.Utility.IsIE()?this.ImeInput("LoseFocusInput"):this.ImeInput("ReInput",!0),!this.SpinBtnPressed){this.SetLastClientValues();var i=this.UIProcess.LoseFocus();this.DisplayText=i.Text,this.Value=i.Value,this.Text=this.UIProcess.Format.Fields.GetText(),(t.Utility.IsIE()||!e)&&this.UpdateDisplayText(this.DisplayText),!t.Utility.IsIE()&&e&&this.UpdateDisplayText(this.DisplayText),this.FocusType=t.FocusType.None;var n;null!=i.EventInfo&&(n=this.UIProcess.FireEvent(this,i.EventInfo.Name,i.EventInfo.Args,i.EventInfo.Type),null!=n&&(this.FocusType=n));var o=this;!t.Utility.IsIE()&&this.DisplayText!=this.UIUpdate.GetText()&&e&&window.setTimeout(function(){o.UpdateDisplayText(o.DisplayText)},0),this.GetHighlightText()===t.HighlightText.All&&(this.SelectionStart=0),this._shouldFireValueChangedEvent()&&(n=this.FireClientEvent("TextChanged",null),null!=n&&(this.FocusType=n),n=this.FireClientEvent("ValueChanged",null),null!=n&&(this.FocusType=n),this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText(),t.Utility.FireSystemEvent(this.InputElement,"onchange"),this._getAutoPostBack()),window.setTimeout(function(){o.HidePromptChar()},50)}},n.prototype.shouldFireValueChangedEvent=function(){return this.OldText!=this.Text},n.prototype.MouseDown=function(e){var n=t.Utility.GetMouseButton(e);this.FocusedWhenMouseDown=document.activeElement===(e.srcElement||e.target),this.MouseDownOnClearButton=t.Utility.IsMouseDownOnClearButton(e),i.prototype.MouseDown.call(this,e),this.MouseButton===t.MouseButton.Right?this.FocusType=t.FocusType.ContextMenu:this.MouseButton=t.MouseButton.Left,this.UIProcess.isDblClick=!1,this.SelectionLength=this.GetSelectionLength(),!t.Utility.IsIE()&&this.ImeMode&&n===t.MouseButton.Left&&(this.IsImplementImeInput=!0)},n.prototype.MouseUp=function(e){if(!t.Utility.IsIE()&&this.ImeMode){if(!this.IsImplementImeInput)return;this.IsImplementImeInput=!1}if(this.LastStart=this.SelectionStart,this.LastEnd=this.SelectionEnd,i.prototype.MouseUp.call(this,e),this.ImeMode){if(this.SelectionStart=this.LastStart,this.SelectionEnd=this.LastEnd,this.SelectionLength=this.GetSelectionLength(),t.Utility.IsIE()?this.ImeInput("ClickInput"):this.ImeInput("ReInput",!0),!t.Utility.IsIE()&&this.Text!=this.UIUpdate.GetText()){var n=this;window.setTimeout(function(){n.UpdateDisplayText(n.Text)},0)}}else this.SelectionLength=this.GetSelectionLength();void 0==this.MouseUpPointerType&&(this.MouseUpHasValue=this.GetInputElement().value.length>0),this.HandleClearButton(e)},n.prototype.KeyDown=function(e){var n=e.keyCode,o={};o.Shift=!1,o.Ctrl=!1,o.Alt=!1,e.shiftKey&&(o.Shift=!0),e.ctrlKey&&(o.Ctrl=!0),e.altKey&&(o.Alt=!0);var r={},s=this.ImeMode;if(this.ImeMode=!1,229===n)return t.Utility.IsIE8OrBelow()&&(this.ImeMode=!0),!0;!this.ImeMode&&s&&!o.Shift&&!o.Ctrl&&9!=n&&65545!=n&&(this.ImeInput("ReInput",!0),this.ImeSelectTimes=0),r.KeyCode=n,r.Text=this.Text,r.FuncKeysPressed=o,r.SelectionStart=this.SelectionStart,r.SelectionEnd=this.SelectionEnd,r.EditMode=this._getEditModeInternal(),r.ReadOnly=this.GetReadOnly(),r.ClipContent=this.GetClipContent(),r.ExitOnLastChar=this.GetExitOnLastChar(),r.ExitOnLeftRightKey=this.GetExitOnLeftRightKey(),r.TabAction=this.GetTabAction();var a=i.prototype.KeyDown.call(this,r);return null!=a.inputChar?!0:(o.Shift||o.Ctrl||o.Alt)&&!a?!0:this.GetHideEnter()&&13===n?!1:a.System},n.prototype.KeyPress=function(e,i){var n=i.keyCode||i.charCode,o=192===n&&i.altKey;if(!t.Utility.IsIE()&&this.ImeMode&&o)return this.ImeInput("ReInput",!0),!1;if(!t.Utility.IsIE()&&(229===n||o))return!1;var r=e,s=this.UIProcess.KeyPressInternal(this.InputElement,this.SelectionStart,this.SelectionEnd,this.GetExitOnLastChar(),r);if(1!=this.japInput){if(null!=s.SelectionStart&&(this.NewSelectionStart=s.SelectionStart),null!=s.SelectionEnd&&(this.NewSelectionEnd=s.SelectionEnd),null!=s.Text){if(!this.UpdateText(s))return!1;this.UpdateDisplayText(this.Text)}var a=this._doExtraWorkForKeyPress(e);if(a===!0)return;if(null!=s.SelectionStart&&(this.SelectionStart=s.SelectionStart),null!=s.SelectionEnd&&(this.SelectionEnd=s.SelectionEnd,this.SelectionLength=this.GetSelectionLength(),1!=s.FocusExit&&this.SetSelection(this.SelectionStart,this.SelectionEnd)),null!=s.exception&&(this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd)),null!=s.EventInfo&&(this.UIProcess.FireEvent(this,s.EventInfo.Name,s.EventInfo.Args,s.EventInfo.Type),this.FocusType=t.FocusType.ClientEvent),13===i.keyCode)return!0}else{if(13===i.keyCode)return!0;null!=s.SelectionStart&&(this.truePosition=s.SelectionStart),null!=s.EventInfo&&this.UIProcess.FireEvent(this,s.EventInfo.Name,s.EventInfo.Args,s.EventInfo.Type)}},n.prototype._doExtraWorkForKeyPress=function(t){return!1},n.prototype.innerKeyPress=function(e,i,n){var o=e;i=!!i;var r=this.UIProcess.KeyPressInternal(this.InputElement,this.SelectionStart,this.SelectionEnd,this.GetExitOnLastChar(),o);if(1!=this.japInput){if(null!=r.Text){if(!this.UpdateText(r))return!1;n||this.UpdateDisplayText(this.Text)}if(null!=r.SelectionStart&&(this.SelectionStart=r.SelectionStart),null!=r.SelectionEnd&&(this.SelectionEnd=r.SelectionEnd,this.SelectionLength=this.GetSelectionLength(),1!=r.FocusExit&&!i&&!n&&1!=r.FocusExit&&this.SetSelection(this.SelectionStart,this.SelectionEnd)),null!=r.exception&&(n||this.UpdateDisplayText(this.Text),1!=r.FocusExit&&this.SetSelection(this.SelectionStart,this.SelectionEnd)),null!=r.EventInfo&&(this.UIProcess.FireEvent(this,r.EventInfo.Name,r.EventInfo.Args,r.EventInfo.Type),this.FocusType=t.FocusType.ClientEvent),null!=window.event&&13===event.keyCode)return!0}else{if(null!=window.event&&13===event.keyCode)return!0;null!=r.SelectionStart&&(this.truePosition=r.SelectionStart),null!=r.EventInfo&&this.UIProcess.FireEvent(this,r.EventInfo.Name,r.EventInfo.Args,r.EventInfo.Type)}},n.prototype.KeyUp=function(e){if(this.ImeMode===!0&&t.Utility.IsIE8OrBelow()){var i=e.keyCode,n=t.CharProcess.CharEx,o=this.GetTextboxValue(),r=o;if(this.SelectionEnd<this.Text.GetLength()){var s=this.Text.GetLength()-this.SelectionEnd;r=o.Substring(0,o.GetLength()-s)}if(r=r.Substring(r.GetLength()-1,r.GetLength()),13===i)this.ImeInput("DirectInput");else if(i>=48&&57>=i||i>=96&&105>=i)i>=96&&(i-=48),r=n.ToHalfWidth(r),r==String.fromCharCode(i)&&(r===String.fromCharCode(i)&&this.ImeSelectTimes<1||this.ImeSelect||this.ImeInput("ReInput")),this.ImeSelectTimes=0;else if(32===i){if(this.ImeSelect===!1)if(1===this.ImeSelectTimes)this.ImeSelect=!0;else if(n.ToHalfWidth(r)!=String.fromCharCode(i))this.ImeSelectTimes++;else{var a=o.Substring(this.SelectionStart,o.GetLength()-s);n.ToHalfWidth(a)===String.fromCharCode(i)&&this.ImeInput("DirectInput")}}else i>=65&&90>=i?this.ImeSelectTimes=0:32===i||106===i||107===i||109===i||110===i||111===i||219===i||220===i||221===i||222===i||i>=186&&192>=i?(this.ImeSelectTimes>=1&&this.ImeInput("ReInput"),this.ImeSelectTimes=0):40===i||38===i?this.ImeSelect===!1&&1===this.ImeSelectTimes&&(this.ImeSelect=!0):8===i||46===i||27===i?this.ImeSelectTimes=0:244===i&&(this.IsJapanConvertKeyPress=!0)}return 13!==e.keyCode?!1:void 0},n.prototype.PerformSpinProcess=function(e,i,n,o,r,s){if(!this.GetReadOnly()||!s){var a=this.UIProcess.PerformSpinInternal(e,i,n,o,r);if(this.FocusType=t.FocusType.SpinButton,!a)return void this.UIUpdate.SetFocus();if(null==a.Text||this.UpdateText(a)){if(null!=a.SelectionStart&&(this.SelectionStart=a.SelectionStart),null!=a.SelectionEnd&&(this.SelectionEnd=a.SelectionEnd,this.SelectionLength=this.GetSelectionLength()),a.EventInfo){var l=this.UIProcess.FireEvent(this,a.EventInfo.Name,a.EventInfo.Args,a.EventInfo.Type);null!=l&&(this.FocusType=l)}if(this.Text!==this.GetTextboxValue()){for(var h=this.Format.Fields.fieldArray,d=0;d<h.length&&"EnumField"!==h[d].fieldLabel;d++);if(d===h.length)return;this.UpdateDisplayText(this.Text)}}}},n.prototype.SelectStart=function(t){return this.ImeMode?!1:void i.prototype.SelectStart.call(this,t)},n.prototype.Click=function(){},n.prototype.DragDrop=function(e){return!t.Utility.IsIE()&&this.GetReadOnly()?!1:(this.IsDragDrop=!0,this.Paste(e,!0,0,0),!1)},n.prototype.DragOver=function(){},n.prototype.DragInit=function(){},n.prototype.ImeInput=function(e,i){var o=this.UIUpdate.GetText();if(o===this.Text)return window.event&&t.Utility.PreventDefault(window.event),this.ImeMode=!1,!1;var r;if(""!==this.Text){var s=Math.min(this.SelectionStart,this.SelectionEnd),a=Math.max(this.SelectionStart,this.SelectionEnd);if(a<this.Text.GetLength()){var l=this.Text.Substring(a,this.Text.GetLength()),h=o.IndexOf(l);r=-1!==h?o.Substring(s,o.GetLength()-l.GetLength()):""}else r=o.Substring(s,o.GetLength())}else r=o;if("ReInput"===e&&(r=i?r.Substring(0,r.GetLength()):r.Substring(0,r.GetLength()-1)),"Record"===e)return r;var d=!1;if("LoseFocusInput"===e){if(""===r)return;n.Mask_ImeResponse=!0,d=!0}for(var c=0;c<r.GetLength();c++)if(c===r.GetLength()-1&&"LoseFocusInput"===e&&(this.japInput=!0),n.Mask_ImeResponse=!0,r.GetLength()>c+1){var u=r.Substring(c+1,c+2),p=new t.CharCategory,g=u.charCodeAt(0)-(p.KATAKANA_VOICED.charCodeAt(0)-1);1===g||2===g?(this.innerKeyPress(r.Substring(c,c+2),d),c++):"ReInput"===e?this.innerKeyPress(r.Substring(c,c+1),d,!0):this.innerKeyPress(r.Substring(c,c+1),d)}else"ReInput"===e?this.innerKeyPress(r.Substring(c,c+1),d,!0):this.innerKeyPress(r.Substring(c,c+1),d);this.japInput=!1,this.ImeMode=!1,this.ImeSelect=!1,("ReInput"===e||"ClickInput"===e)&&(this.truePosition=this.SelectionStart,this.FocusType=t.FocusType.ImeInput)},n.prototype.SetInnerText=function(t){this.Clear(),this.UIProcess.Format.Fields.SetText(t,!0).isValid===!1?this.UIProcess.Format.Fields.RollBack():this.UIProcess.Format.Fields.SaveOldState();var e={};e.Text=this.GetDisplayText("Focus"),this.UpdateText(e)&&this.UpdateDisplayText(this.Text)},n.prototype.Copy=function(){this.SetSelection(this.SelectionStart,this.SelectionEnd),i.prototype.Copy.call(this)},n.prototype.Cut=function(){this.SetSelection(this.SelectionStart,this.SelectionEnd),i.prototype.Cut.call(this)},n.prototype.Paste=function(e,i,n,o){var r="";null!=e&&(r=e),n||(n=this.SelectionStart),o||(o=this.SelectionEnd);var s=this.UIProcess.Paste(n,o,r,this.GetExitOnLastChar(),i);if(!s)return!1;if(null!=s.Value&&(this.Value=s.Value),null!=s.Text){if(!this.UpdateText(s))return!1;this.UpdateDisplayText(this.Text),t.Utility.IsIE()||this.SetInnerFocus()}return null!=s.SelectionStart&&(this.SelectionStart=s.SelectionStart),null!=s.SelectionEnd&&(this.SelectionEnd=s.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart)),(!s||null==s.FocusExit||!s.FocusExit)&&this.SetSelection(this.SelectionStart,this.SelectionEnd),s.EventInfo&&this.UIProcess.FireEvent(this,s.EventInfo.Name,s.EventInfo.Args,s.EventInfo.Type),!0},n.prototype.SetHideValue=function(){},n.prototype.GetHideValue=function(){},n.prototype.CanUndo=function(){return this.Format.Fields.CanUndo()?!0:!1},n.prototype.DoSpinUp=function(t,e){1===arguments.length&&(e=t,t=void 0),this.DoSpin("up",t,e)},n.prototype.DoSpinDown=function(t,e){1===arguments.length&&(e=t,t=void 0),this.DoSpin("down",t,e)},n.prototype.DoSpin=function(e,i,n){if(!("number"==typeof i&&isNaN(i)||"number"==typeof n&&isNaN(n))){var o=this.SelectionStart,r=this.SelectionEnd,s=this.Increment;if(void 0!=i){i=t.Utility.CheckInt(i,0,Math.pow(2,31));var a={};a.start=0,a.length=0,a=this.Format.Fields.GetRealFieldRange(i),o=a.start,r=a.start+a.length}void 0!=n&&(s=n),s=t.Utility.CheckInt(s,-Math.pow(2,31),Math.pow(2,31)),"up"===e?this.PerformSpinProcess(o,r,s,this.Wrap,!0,!1):this.PerformSpinProcess(o,r,s,this.Wrap,!1,!1)}},n.prototype.UpdateText=function(t){if(!t)return!1;var e="";if(null!=t.Text&&(e=t.Text),e!==this.Text&&null!=this.TextChanging&&""!=this.TextChanging){var i={},n={};n.Result=e,n.Cancel=!1,i.Name=this.TextChanging,i.Args=n,null!=t.SelectionStart&&(this.NewSelectionStart=t.SelectionStart),null!=t.SelectionEnd&&(this.NewSelectionEnd=t.SelectionEnd);var o=this.UIProcess.GetSepText();this.RollBack(),"undefined"==typeof this.NeedSetHideValue&&(this.NeedSetHideValue=!0),this.NeedSetHideValue&&this.SetHideValue(),i.Name.IndexOf&&i.Name.IndexOf("gcsh_InputManWeb_AjaxServerEventHandler")>-1&&(this.UIProcess.Format.Fields.ClearContent(),this.FormatIsNull?this.UIProcess.Format.Fields.SetText(o,!0):this.UIProcess.SetSepText(o));var r=this.UIProcess.FireEvent(this,i.Name,i.Args,"TextChanging");if(i.Name.IndexOf&&i.Name.IndexOf("gcsh_InputManWeb_AjaxServerEventHandler")>-1,null!=r&&(this.FocusType=r),"undefined"!=typeof this.TextChanging&&(this.NeedSetHideValue=!1),n.Cancel)return this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),!1;this.UIProcess.Format.Fields.ClearContent(),this.FormatIsNull?this.UIProcess.Format.Fields.SetText(o,!0):this.UIProcess.SetSepText(o)}return this.Text=e,this.Value=this.UIProcess.Format.Fields.GetValue(),!0},n.prototype.UpdateDisplayText=function(t){"undefined"==typeof this.NeedSetHideValue&&(this.NeedSetHideValue=!0),this.NeedSetHideValue&&(i.prototype.UpdateDisplayText.call(this,t),this.EditingTextChanged&&this.EditingTextChanged.call(this))},n.prototype.RollBack=function(){this.UIProcess.Format.Fields.RollBack()},n.prototype.ProcessReservedKey=function(t){var e=i.prototype.ProcessReservedKey.call(this,t);if(!e){switch(t){case 118:case 119:return!0}return!1}return!0},n.prototype.AddAllEventsHandler=function(){i.prototype.AddAllEventsHandler.call(this);var n=this;t.Utility.IsIE10OrLater()&&e(this.GetInputElement()).bind("MSPointerUp.wijinput",function(e){t.GlobalEventHandler.OnMSPointerUp(n,e)},!1)},n.prototype.CompositionStart=function(t){this.ImeMode=!0},n.prototype.CompositionUpdate=function(t){},n.prototype.CompositionEnd=function(e){var i=this,n=function(){try{i.ImeInput("DirectInput")}finally{i.ImeMode=!1}};t.Utility.IsIE9OrLater()?n():window.setTimeout(n,0)},n.prototype.Select=function(){this.ImeMode||(this.SelectionStart=t.Utility.GetSelectionStartPosition(this.GetInputElement()),this.SelectionEnd=this.SelectionStart+t.Utility.GetSelectionText(this.GetInputElement()).GetLength())},n.prototype.MSPointerUp=function(t){t&&(this.MouseUpPointerType=t.pointerType,this.MouseUpHasValue=(t.srcElement||t.target).value.length>0)},n.prototype.HandleClearButton=function(e){if(t.Utility.IsIE10OrLater()&&this.FocusedWhenMouseDown&&this.MouseDownOnClearButton&&(e.srcElement||e.target)===this.InputElement){var i=document.activeElement===(e.srcElement||e.target),n=t.Utility.IsMouseDownOnClearButton(e);if(this.MouseUpHasValue&&i&&n){this.Clear();var o=this.GetText(),r=this;window.setTimeout(function(){r.UpdateDisplayText(o),r.SelectionStart=r.SelectionEnd=r.Format.Fields.GetFirstInputPosition(),r.SetSelection(r.SelectionStart,r.SelectionEnd)},0)}}},n.prototype.HidePromptChar=function(){if(this.GetHidePromptOnLeave()){var t=this.GetInputElement().value;this._textWithPromptChar=t,t=t.replace(new RegExp(this.GetPromptChar(),"g")," "),this.GetInputElement().value=t}},n.prototype.ShowPromptChar=function(){null!==this._textWithPromptChar&&(this.GetInputElement().value=this._textWithPromptChar,this._textWithPromptChar=null)},n.prototype.GetHideEnter=function(){return this._hideEnter},n.prototype.SetHideEnter=function(t){this._hideEnter=t},n.prototype.GetHidePromptOnLeave=function(){return this._hidePromptOnLeave},n.prototype.SetHidePromptOnLeave=function(t){t!==this._hidePromptOnLeave&&(this._hidePromptOnLeave=t,t&&document.activeElement!==this.GetInputElement()&&this.HidePromptChar(),!t&&document.activeElement!==this.GetInputElement()&&this.ShowPromptChar())},n.prototype.OnEditStatusChanged=function(e){e=t.Utility.CheckFunction(e),this.EditStatusChangedEvent=e},n.prototype.OnInvalidInput=function(e){e=t.Utility.CheckFunction(e),this.InvalidInputEvent=e},n.prototype.OnKeyExit=function(e){e=t.Utility.CheckFunction(e),this.KeyExit=e},n.prototype.OnSpinDown=function(e){e=t.Utility.CheckFunction(e),this.SpinDown=e},n.prototype.OnSpinUp=function(e){e=t.Utility.CheckFunction(e),this.SpinUp=e},n.prototype.OnTextChanged=function(e){e=t.Utility.CheckFunction(e),this.TextChanged=e},n.prototype.OnTextChanging=function(e){e=t.Utility.CheckFunction(e),this.TextChanging=e},n.prototype.OnValueChanged=function(e){e=t.Utility.CheckFunction(e),this.ValueChanged=e},n.prototype.OnMouseDownCallBack=function(e){e=t.Utility.CheckFunction(e),this.MouseDownEvent=e},n.prototype.OnMouseUpCallBack=function(e){e=t.Utility.CheckFunction(e),this.MouseUpEvent=e},n.prototype.OnEditingTextChanged=function(e){e=t.Utility.CheckFunction(e),this.EditingTextChanged=e},n.prototype.IsFocused=function(){try{return document.activeElement===this.GetInputElement()}catch(t){return!1}},n.prototype.GetTextOnSimpleMode=function(){if(!this.IsFocused()&&this.Format.Fields.ValueIsNull()&&null!==this._getDisplayNullExpression())return this.GetTextboxValue();var t=this.Format.Fields.GetTextSimpleMode(!1),e=new RegExp("\\"+this.GetPromptChar(),"g");return t=t.replace(e," ")},n.prototype.GetPostValueOnSimpleMode=function(){if(!this.IsFocused()&&this.Format.Fields.ValueIsNull()&&null!==this._getDisplayNullExpression())return this.GetTextboxValue();var t=this.Format.Fields.GetTextSimpleMode(!0),e=new RegExp("\\"+this.GetPromptChar(),"g");return t=t.replace(e," ")},n}(C);t.MaskControl=E}(t.input||(t.input={}));var e=t.input}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery;!function(t){t._map=[],t.editOptional=1,t.editRequired=2,t.separator=4,t.literal=8}(e.wijchartype||(e.wijchartype={}));var n=e.wijchartype,o=function(t){function n(){t.apply(this,arguments),this._imMask=null,this._advanceMode=!1}return __extends(n,t),n._imMaskAssociatedoptions=["disabled","disableUserInput","blurOnLastChar","imeMode","blurOnLeftRightKey","tabAction","nullText","placeholder","readonly","promptChar","autoConvert","showNullText","hideEnter","hidePromptOnLeave"],n.prototype._createTextProvider=function(){this._textProvider=new s(this,this.options.mask,!1)},n.prototype._checkMaskAndPassword=function(){var t=!this.options.mask||this.options.mask.length<0;if(t&&this._isPassword())throw'Option "passwordChar" requires a mask'},n.prototype._updateIsPassword=function(){var t=this.options.passwordChar.length>0&&"password"!==this.element.attr("type");this.element.data("isPassword",t),this._checkMaskAndPassword()},n.prototype._beginUpdate=function(){this.element.addClass(this.options.wijCSS.wijinputmask),this._updateIsPassword(),this.element.data("defaultText",this.options.text)},n.prototype._setOption=function(e,i){switch(e){case"maskFormat":this._super(e,i),e="mask"}if(t.prototype._setOption.call(this,e,i),this._advanceMode)if(n._imMaskAssociatedoptions.indexOf)-1!==n._imMaskAssociatedoptions.indexOf(e)&&this._syncProperties();else for(var o=0;o<n._imMaskAssociatedoptions.length;o++)if(n._imMaskAssociatedoptions[o]===e){this._syncProperties();break}switch(e){case"text":this.setText(i);break;case"mask":case"culture":("undefined"==typeof i||i.length<=0)&&(i=""),this._checkMaskAndPassword();var r=this.getText();"mask"===e&&(this._textProvider.mask=i),this._checkFormatPattern(i),this._advanceMode?this._imMask.SetText(r):(this._textProvider.initialize(),this._textProvider.setText(r),this._updateText());break;case"promptChar":case"nullText":this._textProvider&&(this._textProvider.updatePromptChar(),this._updateText());break;case"hidePromptOnLeave":case"resetOnPrompt":this._updateText();break;case"passwordChar":this._updateIsPassword(),this._updateText()}},n.prototype._checkFormatPattern=function(i){if(i instanceof RegExp||"advanced"===this.options.formatMode){if(this._advanceMode||(this._detachInputEvent(),this._imMask||(this._imMask=new e.MaskControl,this._addimMaskCustomEvent()),this._imMask.AttachInput(this.element.get(0)),this._attachKeyEventForDropDownList(),this._advanceMode=!0),i instanceof RegExp){var n=i;this._imMask.SetFormatPattern(n.source)}else this._imMask.SetFormatPattern(i);this._syncProperties()}else this._advanceMode&&(this._imMask.DetachInput(),this._detachEventForDropDownList(),t.prototype._attachInputEvent.call(this)),this._advanceMode=!1},n.prototype._attachKeyEventForDropDownList=function(){this.element.bind({"keydown.wijinput":i.proxy(this._onKeyDownForDropDownList,this)})},n.prototype._detachEventForDropDownList=function(){this.element.unbind(".wijinput")},n.prototype._onKeyDownForDropDownList=function(e){t.prototype._processKeyForDropDownList.call(this,e)},n.prototype._syncProperties=function(){this._imMask.SetEnabled(!this.options.disabled),this._imMask.SetReadOnly(!!this.options.disableUserInput),this._imMask.SetExitOnLastChar(!!this.options.blurOnLastChar),this._imMask.SetImeMode(this.options.imeMode),this._imMask.SetExitOnLeftRightKey(this._convertExistOnLeftRightKey(this.options.blurOnLeftRightKey)),this._imMask.SetTabAction(this._convertTabAction(this.options.tabAction)),this._imMask.SetDisplayNull(this.options.nullText),this._imMask.SetHideEnter(!!this.options.hideEnter),this._imMask.SetPromptChar(this.options.promptChar),this._imMask.SetAutoConvert(!!this.options.autoConvert),this._imMask.SetHidePromptOnLeave(!!this.options.hidePromptOnLeave)},n.prototype._convertExistOnLeftRightKey=function(t){return t||(t="none"),t=t.toLowerCase(),"none"===t?e.ExitOnLeftRightKey.None:"left"===t?e.ExitOnLeftRightKey.Left:"right"===t?e.ExitOnLeftRightKey.Right:"both"===t?e.ExitOnLeftRightKey.Both:void 0},n.prototype._convertTabAction=function(t){return t||(t="control"),t=t.toLowerCase(),"control"===t?e.TabAction.Control:e.TabAction.Field},n.prototype._addimMaskCustomEvent=function(){var t=this;this._imMask.OnInvalidInput(function(e){t._fireIvalidInputEvent("")}),this._imMask.OnTextChanged(function(e){t._raiseTextChanged()}),this._imMask.OnEditingTextChanged(function(e){t._updateText(!0)})},n.prototype._processClearButton=function(){this._textProvider.clear(new e.wijInputResult),this._updateText();var t=this._textProvider.findEditPositionFrom(0,!0);this.selectText(t,t)},n.prototype._resetData=function(){var t=this.element.data("defaultText");(void 0===t||null===t)&&(t=this.element.data("elementValue")),(void 0===t||null===t)&&(t=""),this.setText(t)},n.prototype._isPassword=function(){return!!this.element.data("isPassword")},n.prototype._getTextWithPrompts=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!1):this.element.val()},n.prototype._getTextWithLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!0):this.element.val()},n.prototype._getTextWithPromptAndLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!0):this.element.val()},n.prototype._getTextWithPromptAndLiteralsAndPassword=function(){return this._isInitialized()?this._textProvider.toString(!1,!0,!0):this.element.val()},n.prototype._onChange=function(){if(this.element){var t=this.element.val();this.getText()!==t&&this._getTextWithPrompts()!==t&&this._getTextWithPromptAndLiterals()!==t&&(""!==this._textProvider.getPasswordChar()?this._getTextWithPromptAndLiteralsAndPassword()!==t&&this.setText(t):this.setText(t))}},n.prototype._afterFocused=function(){(this._isNullText()||!!this.options.hidePromptOnLeave)&&this._doFocus()},n.prototype._processTabKey=function(t){var e=this.options.tabAction;return e=e?e.toLowerCase():"control","control"===e?!1:this._moveField(!t.shiftKey)},n.prototype._moveField=function(t){var e=this._textProvider._getFieldList(),i=this.element.wijtextselection(),n=i.start,o=-1;if(e.length>0&&n>e[e.length-1].end&&(o=e.length),-1===o)for(var r=0;r<e.length;r++){if(n>=e[r].start&&n<=e[r].end){o=r;break}if(n<e[r].start){o=0!=r?r:-1;break}}if(t){if(o===e.length-1)return!1;this.element.wijtextselection(e[o+1].start,e[o+1].start)}else{if(0>=o)return!1;this.element.wijtextselection(e[o-1].start,e[o-1].start)}return!0},n.prototype._processLeftRightKey=function(t){var e=this.element.wijtextselection(),i=this.options.blurOnLeftRightKey?this.options.blurOnLeftRightKey.toLowerCase():"none";if(t&&0===e.start){if("both"===i||"left"===i)return this._moveControl(this.element.get(0),!1,!0),!0}else{var n="both"===i||"right"===i,o=!1;if(this._textProvider.noMask&&e.start===this.options.text.length?o=!0:!this._textProvider.noMask&&e.start===this._textProvider.testString.length&&(o=!0),!t&&n&&o)return this._moveControl(this.element.get(0),!0,!0),!0}return!1},n.prototype._onKeyPress=function(e){if(!this._textProvider.noMask&&this.options.blurOnLastChar)var i=this._textProvider._isLastCharAssigned();if(t.prototype._onKeyPress.call(this,e),!this._textProvider.noMask&&this.options.blurOnLastChar){var n=this._textProvider._isLastCharAssigned();!i&&n&&this._moveControl(this.element.get(0),!0,!0)}},n.prototype.setText=function(e){void 0!==e&&(this._advanceMode?this._imMask.SetValue(e):t.prototype.setText.call(this,e))},n.prototype.getText=function(){return this._advanceMode?this._imMask.GetTextOnSimpleMode():t.prototype.getText.call(this)},n.prototype.selectText=function(e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=this.getText().length),isNaN(e)&&(e=0),isNaN(i)&&(i=0),this._advanceMode?(this._imMask.SetSelectionStart(e),this._imMask.SetSelectionLength(Math.abs(i-e)),this._imMask.SetFocus()):t.prototype.selectText.call(this,e,i)},n.prototype._attachInputEvent=function(){this._advanceMode?this._imMask.AttachInput(this.element.get(0)):t.prototype._attachInputEvent.call(this)},n.prototype._detachInputEvent=function(){this._advanceMode?this._imMask.DetachInput():t.prototype._detachInputEvent.call(this)},n.prototype.getPostValue=function(){return this._advanceMode?this._imMask.GetPostValueOnSimpleMode():t.prototype.getPostValue.call(this)},n.prototype._initialize=function(){this.options.maskFormat&&(this.options.mask=this.options.maskFormat),t.prototype._initialize.call(this)},n.prototype._init=function(){t.prototype._init.call(this);var e=this.options.text||this.element.val();this.options.mask&&this._setOption("mask",this.options.mask),e&&this._setOption("text",e)},n.prototype._updateText=function(e){if("undefined"==typeof e&&(e=!1),this.element.data("initialized")||!(this.options.mask instanceof RegExp||"advanced"===this.options.formatMode))if(this._advanceMode){
if(!this._isInitialized())return;if(this.element.is(":disabled"))return;var i=this._imMask.GetTextOnSimpleMode();i!==this.options.text&&(this.options.text=i,this._raiseTextChanged())}else t.prototype._updateText.call(this,e)},n.prototype.isFocused=function(){return this._advanceMode?this._imMask.IsFocused():t.prototype.isFocused.call(this)},n}(e.wijinputcore);e.wijinputmask=o;var r=function(){function t(){this.wijCSS={wijinputmask:e.wijinputcore.prototype.options.wijCSS.wijinput+"-mask"},this.autoConvert=!0,this.text=null,this.mask="",this.maskFormat="",this.promptChar="_",this.hidePromptOnLeave=!1,this.resetOnPrompt=!0,this.allowPromptAsInput=!1,this.passwordChar="",this.resetOnSpace=!0,this.skipLiterals=!0,this.blurOnLastChar=!1,this.tabAction="control",this.imeMode="auto"}return t}();o.prototype.options=i.extend(!0,{},e.wijinputcore.prototype.options,new r),i.wijmo.registerWidget("wijinputmask",o.prototype);var s=function(o){function r(t,e,i){o.call(this),this.inputWidget=t,this.mask=e,this.asciiOnly=i,this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.noMask=!1,this._autoConvertPosition=0,this._needCheckNextChar=!1,this.descriptors=[],this.initialize()}return __extends(r,o),r.FK_K="K",r.FK_H="H",r.FK_DB_9=e.CharProcess.CharEx.ToFullWidth("9").text,r.FK_DB_K=e.CharProcess.CharEx.ToFullWidth("K").text,r.FK_DB_J=e.CharProcess.CharEx.ToFullWidth("J").text,r.FK_DB_Z=e.CharProcess.CharEx.ToFullWidth("Z").text,r.DBCS_0=e.CharProcess.CharEx.ToFullWidth("0").text,r.DBCS_9=e.CharProcess.CharEx.ToFullWidth("9").text,r.DBCS_A=e.CharProcess.CharEx.ToFullWidth("A").text,r.DBCS_a=e.CharProcess.CharEx.ToFullWidth("a").text,r.DBCS_Z=e.CharProcess.CharEx.ToFullWidth("Z").text,r.DBCS_z=e.CharProcess.CharEx.ToFullWidth("z").text,r.prototype.initialize=function(){if(this.noMask=!this.mask||this.mask.length<=0,!this.noMask){this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.descriptors=[];for(var t="none",e=!1,i=n.literal,o="",s=this.inputWidget._getCulture(),l=0;l<this.mask.length;l++){var h=!1,d=this.mask.charAt(l);if(e&&(e=!1,h=!0),!h){var c=d;if("C">=c){switch(c){case"#":case"9":case"?":case"C":d=this.getPromtChar(),i=n.editOptional,h=!0;break;case"$":o=s.numberFormat.currency.symbol,i=n.separator,h=!0;break;case"%":case"-":case";":case"=":case"@":i=n.literal,h=!0;break;case"&":case"0":case"A":d=this.getPromtChar(),i=n.editRequired,h=!0;break;case",":o=s.numberFormat[","],i=n.separator,h=!0;break;case".":o=s.numberFormat["."],i=n.separator,h=!0;break;case"/":o=s.calendars.standard["/"],i=n.separator,h=!0;break;case":":o=s.calendars.standard[":"],i=n.separator,h=!0;break;case"<":t="lower";continue;case">":t="upper";continue}h||(i=n.literal,h=!0)}if(!h){if("\\">=c){switch(c){case r.FK_K:case r.FK_H:case"L":d=this.getPromtChar(),i=n.editRequired,h=!0;break;case"\\":e=!0,i=n.literal;continue}h||(i=n.literal,h=!0)}if(!h){switch("a"===c&&(d=this.getPromtChar(),i=n.editOptional,h=!0),c){case r.FK_DB_K:case r.FK_DB_J:case r.FK_DB_9:case r.FK_DB_Z:d=this.getPromtChar(),i=n.editRequired,h=!0}if(!h&&("|"!==c&&(i=n.literal,h=!0),!h)){t="none";continue}}}}if(h){var u=new a(l,i);this.isEditDesc(u)&&(u.caseConversion=t),i!==n.separator&&(o=d);for(var p=0;p<o.length;p++)this.testString=this.testString+o.charAt(p),this.descriptors[this.descriptors.length]=u}}}},r.prototype.getAllowPromptAsInput=function(){return this.inputWidget?this.inputWidget.options.allowPromptAsInput:!1},r.prototype.getPasswordChar=function(){var t=this.inputWidget?this.inputWidget.options.passwordChar:"*";return""===t&&(t="*"),t.length>1?t.charAt(0):t},r.prototype.isPassword=function(){return this.inputWidget?this.inputWidget._isPassword():!1},r.prototype.getResetOnPrompt=function(){return this.inputWidget?this.inputWidget.options.resetOnPrompt:!0},r.prototype.getResetOnSpace=function(){return this.inputWidget?this.inputWidget.options.resetOnSpace:!0},r.prototype.getSkipLiterals=function(){return this.inputWidget?this.inputWidget.options.skipLiterals:!0},r.prototype.getHidePromptOnLeave=function(){return this.inputWidget?this.inputWidget.options.hidePromptOnLeave:!1},r.prototype._trueOR=function(t,e){return 2*(t>>>1|e>>>1)+(1&t|1&e)},r.prototype.setValue=function(t){return!1},r.prototype.getValue=function(){return null},r.prototype.getPromtChar=function(){var t=this.inputWidget?this.inputWidget.options.promptChar:"_";return""===t&&(t="_"),t.length>1?t.charAt(0):t},r.prototype.getAutoConvert=function(){return this.inputWidget?this.inputWidget.options.autoConvert:!0},r.prototype.updatePromptChar=function(){if(!this.noMask)for(var t=0;t<this.descriptors.length;t++){var e=this.descriptors[t];(e.charType===n.editOptional||e.charType===n.editRequired)&&(e.isAssigned||(this.testString=i.wij.charValidator.setChar(this.testString,this.getPromtChar(),t)))}},r.prototype.resetChar=function(t){var e=this.descriptors[t];this.isEditPos(t)&&e.isAssigned&&(e.isAssigned=!1,this.testString=i.wij.charValidator.setChar(this.testString,this.getPromtChar(),t),this.assignedCharCount--,e.charType===n.editRequired&&this.requiredCharCount--)},r.prototype.getAdjustedPos=function(t){return this.noMask?t=Math.min(t,this.testString.length-1):t>=this.descriptors.length&&t--,Math.max(0,t)},r.prototype.findNonEditPositionInRange=function(t,e,i){var o=this._trueOR(n.literal,n.separator);return this.findPositionInRange(t,e,i,o)},r.prototype.findPositionInRange=function(t,e,i,n){if(t=Math.max(0,t),e=Math.min(e,this.testString.length-1),e>=t)for(;e>=t;){var o=i?t++:e--,r=this.descriptors[o];if((4294967295&r.charType&(4294967295&n))===r.charType)return o}return-1},r.prototype.findAssignedEditPositionInRange=function(t,e,i){return 0===this.assignedCharCount?-1:this.findEditPositionInRange(t,e,i,n.editRequired)},r.prototype.findEditPositionInRange=function(t,e,i,o){do{var r=this._trueOR(n.editRequired,n.editOptional),s=this.findPositionInRange(t,e,i,r);if(-1===s)break;var a=this.descriptors[s];switch(o){case n.editOptional:if(!a.isAssigned)return s;break;case n.editRequired:if(a.isAssigned)return s;break;default:return s}i?t++:e--}while(e>=t);return-1},r.prototype.findAssignedEditPositionFrom=function(t,e){if(!this.assignedCharCount)return-1;var i,n;return e?(i=t,n=this.testString.length-1):(i=0,n=t),this.findAssignedEditPositionInRange(i,n,e)},r.prototype.findEditPositionFrom=function(t,e){var i,n;return e?(i=t,n=this.testString.length-1):(i=0,n=t),this.findEditPositionInRange(i,n,e,0)},r.prototype.setChar=function(e,o,r){if(this.getAutoConvert()){var s=new t.input.wijInputResult,a=this.testInternal(e,o,s);if(!a){var l=this._convert(e,0);0===e.length,e=l.strValue.charAt(0),l.strValue.length>1&&this.inputWidget.element.data("appendChar",l.strValue.charAt(1)),2===l.index&&this.inputWidget.element.data("skipNextChar",!0)}}o=Math.max(0,o),r||(r=this.descriptors[o]),this.testEscapeChar(e,o,r)?this.resetChar(o):(i.wij.charValidator.isLetter(e)&&(i.wij.charValidator.isUpper(e)?"lower"===r.caseConversion&&(e=e.toLowerCase()):"upper"===r.caseConversion&&(e=e.toUpperCase())),this.testString=i.wij.charValidator.setChar(this.testString,e,o),r.isAssigned||(r.isAssigned=!0,this.assignedCharCount++,r.charType===n.editRequired&&this.requiredCharCount++))},r.prototype.internalInsertAt=function(t,i,n,o){if(0===t.length)return n.testPosition=i,n.hint=n.noEffect,!0;if(!this._testString(t,i,n))return!1;var r=this.findEditPositionFrom(i,!0),s=-1!==this.findAssignedEditPositionInRange(r,n.testPosition,!0);if(s&&n.testPosition===this.testString.length-1)return n.hint=n.unavailableEditPosition,n.testPosition=this.testString.length,!1;var a=this.findEditPositionFrom(n.testPosition+1,!0);if(s){var l=new e.wijInputResult;l.hint=l.unknown;for(var h=!0,d=this.findAssignedEditPositionFrom(this.testString.length-1,!1);h;){if(h=!1,-1===a)return n.hint=n.unavailableEditPosition,n.testPosition=this.testString.length,!1;var c=this.testChar(this.testString.charAt(r),a,l);if(this.descriptors[r].isAssigned&&!c)return n.hint=l.hint,n.testPosition=a,!1;r===d||(r=this.findEditPositionFrom(r+1,!0),a=this.findEditPositionFrom(a+1,!0),h=!0)}n.hint=Math.max(n.hint,l.hint)}if(!o){if(s)for(;r>=i;)this.descriptors[r].isAssigned?this.setChar(this.testString.charAt(r),a):this.resetChar(a),a=this.findEditPositionFrom(a-1,!1),r=this.findEditPositionFrom(r-1,!1);this.setString(t,i)}return!0},r.prototype.insertAt=function(t,i,n){if("undefined"==typeof n&&(n=new e.wijInputResult),void 0===t)throw"InsertAt: input";return this.noMask?(this.testString=this.testString.substring(0,i)+t+this.testString.substring(i,this.testString.length),n.testPosition=i+t.length-1,!0):i>=0&&i<this.testString.length?this.internalInsertAt(t,i,n,!1):(n.testPosition=i,n.hint=n.positionOutOfRange,!1)},r.prototype.clear=function(t){if(this.noMask)return this.testString="",void(t.hint=t.success);if(this.assignedCharCount){t.hint=t.success;for(var e=0;e<this.testString.length;e++)this.resetChar(e)}else t.hint=t.noEffect},r.prototype.isLiteral=function(t){return t?t.charType===n.literal||t.charType===n.separator:!1},r.prototype.testEscapeChar=function(t,e,i){if(e=Math.max(0,e),i||(i=this.descriptors[e]),this.isLiteral(i))return this.getSkipLiterals()?t===this.testString.charAt(e):!1;var n=this.getResetOnPrompt()&&t===this.getPromtChar(),o=this.getResetOnSpace()&&" "===t;return n||o},r.prototype.testChar=function(t,e,i){var n=this.testInternal(t,e,i);if(!n&&this.getAutoConvert()){this._autoConvertPosition=e;var o=this._convert(t,0);n=o.strValue.length>0,o.strValue.length>1&&this.inputWidget.element.data("appendChar",o.strValue.charAt(1)),2===o.index&&this.inputWidget.element.data("skipNextChar",!0)}return n},r.prototype.testInternal=function(t,n,o){if(!i.wij.charValidator.isPrintableChar(t))return o.hint=o.invalidInput,!1;var s=this.descriptors[n];if(!s)return!1;if(this.isLiteral(s))return this.getSkipLiterals()&&t===this.testString.charAt(n)?(o.hint=o.characterEscaped,!0):(o.hint=o.nonEditPosition,!1);if(t===this.getPromtChar()){if(this.getResetOnPrompt())return this.isEditDesc(s)&&s.isAssigned?o.hint=o.sideEffect:o.hint=o.characterEscaped,!0;if(!this.getAllowPromptAsInput())return o.hint=o.promptCharNotAllowed,!1}if(" "===t&&this.getResetOnSpace())return this.isEditDesc(s)&&s.isAssigned?o.hint=o.sideEffect:o.hint=o.characterEscaped,!0;switch(this.mask.charAt(s.maskPosition)){case"L":if(!i.wij.charValidator.isLetter(t))return o.hint=o.letterExpected,!1;if(!i.wij.charValidator.isAsciiLetter(t)&&this.asciiOnly)return o.hint=o.asciiCharacterExpected,!1;break;case"?":if(!i.wij.charValidator.isLetter(t)&&" "!==t)return o.hint=o.letterExpected,!1;if(!i.wij.charValidator.isAsciiLetter(t)&&this.asciiOnly)return o.hint=o.asciiCharacterExpected,!1;break;case"A":if(!i.wij.charValidator.isAlphanumeric(t))return o.hint=o.alphanumericCharacterExpected,!1;if(!i.wij.charValidator.isAciiAlphanumeric(t)&&this.asciiOnly)return o.hint=o.asciiCharacterExpected,!1;break;case"a":if(!i.wij.charValidator.isAlphanumeric(t)&&" "!==t)return o.hint=o.alphanumericCharacterExpected,!1;if(!i.wij.charValidator.isAciiAlphanumeric(t)&&this.asciiOnly)return o.hint=o.asciiCharacterExpected,!1;break;case"&":if(!i.wij.charValidator.isAscii(t)&&this.asciiOnly)return o.hint=o.asciiCharacterExpected,!1;break;case"C":if(!i.wij.charValidator.isAscii(t)&&this.asciiOnly&&" "!==t)return o.hint=o.asciiCharacterExpected,!1;break;case"0":if(!i.wij.charValidator.isDigit(t))return o.hint=o.digitExpected,!1;break;case"9":if(!i.wij.charValidator.isDigit(t)&&" "!==t)return o.hint=o.digitExpected,!1;break;case r.FK_DB_9:if(!(t>=r.DBCS_0&&t<=r.DBCS_9)&&" "!==t)return!1;break;case"#":if(!i.wij.charValidator.isDigit(t)&&"-"!==t&&"+"!==t&&" "!==t)return o.hint=o.digitExpected,!1;break;case r.FK_K:if(e.CharProcess.CharEx.IsFullWidth(t)||!e.CharProcess.CharEx.IsKatakana(t))return!1;break;case r.FK_H:if(e.CharProcess.CharEx.IsFullWidth(t))return!1;break;case r.FK_DB_K:if(!e.CharProcess.CharEx.IsFullWidth(t)||!e.CharProcess.CharEx.IsKatakana(t))return!1;break;case r.FK_DB_J:if(!e.CharProcess.CharEx.IsHiragana(t))return!1;break;case r.FK_DB_Z:if(!e.CharProcess.CharEx.IsFullWidth(t))return!1}return t===this.testString.charAt(n)&&s.isAssigned?o.hint=o.noEffect:o.hint=o.success,!0},r.prototype._convert=function(t,i){var n={};n.success=!0,n.strValue="",n.index=i;var o=t.Substring(i,i+1),r,s=e.CharProcess.CharEx,a=!0;if(s.IsAlphabet(o)){var l=s.IsLower(o)?o.toUpperCase():o.toLowerCase();return r=this._isValid(l),r&&a||!r&&!a?(i++,n.index=i,n.strValue=l,n):(o=s.IsFullWidth(o)?s.ToHalfWidth(o):s.ToFullWidth(o).text,r=this._isValid(o),r&&a||!r&&!a?(i++,n.index=i,n.strValue=o,n):(l=s.IsFullWidth(l)?s.ToHalfWidth(l):s.ToFullWidth(l).text,r=this._isValid(l),r&&a||!r&&!a?(i++,n.index=i,n.strValue=l,n):(n.success=!1,n)))}if(s.IsHiragana(o)){if(s.IsLowerKana(o)){var h=s.ToUpperKana(o);if(r=this._isValid(h),r&&a||!r&&!a)return i++,n.index=i,n.strValue=h,n}else if(s.HasLowerKana(o)){var d=s.ToLowerKana(o);if(r=this._isValid(d),r&&a||!r&&!a)return i++,n.index=i,n.strValue=d,n}if(o=s.ToKatakana(o),r=this._isValid(o),r&&a||!r&&!a)return i++,n.index=i,n.strValue=o,n;if(s.IsLowerKana(o)){var h=s.ToUpperKana(o);if(r=this._isValid(h),r&&a||!r&&!a)return i++,n.index=i,n.strValue=h,n}else if(s.HasLowerKana(o)){var d=s.ToLowerKana(o);if(r=this._isValid(d),r&&a||!r&&!a)return i++,n.index=i,n.strValue=d,n}var c=s.ToHalfWidthEx(o);if(r=this._isValid(c),r&&a||!r&&!a)return i++,n.index=i,n.strValue=c,n;if(s.IsLowerKana(c)){if(c=s.ToUpperKana(c),r=this._isValid(c),r&&a||!r&&!a)return i++,n.index=i,n.strValue=c,n}else if(s.HasLowerKana(c)&&(c=s.ToLowerKana(c),r=this._isValid(c),r&&a||!r&&!a))return i++,n.index=i,n.strValue=c,n;return n.success=!1,n}if(s.IsKatakana(o)){if(s.IsLowerKana(o)){var h=s.ToUpperKana(o);if(r=this._isValid(h),r&&a||!r&&!a)return i++,n.index=i,n.strValue=h,n}else if(s.HasLowerKana(o)){var d=s.ToLowerKana(o);if(r=this._isValid(d),r&&a||!r&&!a)return i++,n.index=i,n.strValue=d,n}var l=o,u=!1;if(s.IsFullWidth(o)){var p=s.ToHalfWidthEx(o);if(p.GetLength()>0&&(r=this._isValid(p),r&&a||!r&&!a))return i++,n.index=i,n.strValue=p,n;if(s.IsLowerKana(p)){if(p=s.ToUpperKana(p),r=this._isValid(p),r&&a||!r&&!a)return i++,n.index=i,n.strValue=p,n}else if(s.HasLowerKana(p)&&(p=s.ToLowerKana(p),r=this._isValid(p),r&&a||!r&&!a))return i++,n.index=i,n.strValue=p,n}else{if(null==i){if(l=s.ToFullWidth(o).text,!s.IsKatakana(l))return n;if(r=this._isValid(l),r&&a||!r&&!a)return i++,n.index=i,n.strValue=l,n}else{var g=this.inputWidget.element.data("nextChar");if(this._needCheckNextChar&&g&&g.length>0){var f=s.ToFullWidth(t+g);l=f.text,u=f.processedAll}else l=s.ToFullWidth(o).text;if(!s.IsKatakana(l))return n;if(r=this._isValid(l),r&&a||!r&&!a)return i++,u&&i++,n.index=i,n.strValue=l,n}if(s.IsLowerKana(l)){var h=s.ToUpperKana(l);if(r=this._isValid(h),r&&a||!r&&!a)return i++,n.index=i,n.strValue=h,n}else if(s.HasLowerKana(l)){var d=s.ToLowerKana(l);if(r=this._isValid(d),r&&a||!r&&!a)return i++,n.index=i,n.strValue=d,n}}if(l=s.ToHiragana(l),r=this._isValid(l),r&&a||!r&&!a)return i++,u&&i++,n.index=i,n.strValue=l,"ゔ"==l&&(u?n.strValue="う゛":(i--,n.index=i,n.strValue="",n.success=!1)),n;if(s.IsLowerKana(l)){var h=s.ToUpperKana(l);if(r=this._isValid(h),r&&a||!r&&!a)return i++,n.index=i,n.strValue=h,n}else if(s.HasLowerKana(l)){var d=s.ToLowerKana(l);if(r=this._isValid(d),r&&a||!r&&!a)return i++,n.index=i,n.strValue=d,n}}return o=s.IsFullWidth(o)?s.ToHalfWidth(o):s.ToFullWidth(o).text,r=this._isValid(o),r&&a||!r&&!a?(i++,n.index=i,n.strValue=o,n):(n.success=!1,n)},r.prototype._isValid=function(e){var i=new t.input.wijInputResult;return this.testInternal(e,this._autoConvertPosition,i)},r.prototype._testString=function(t,i,n){if(n.hint=n.unknown,n.testPosition=i,t.length){var o=new e.wijInputResult;o.testPosition=n.testPosition,o.hint=n.hint;for(var r=0;r<t.length;r++){if(n.testPosition>this.testString.length)return n.hint=n.unavailableEditPosition,!1;var s=t.charAt(r);if(!this.testEscapeChar(s,n.testPosition)&&(n.testPosition=this.findEditPositionFrom(n.testPosition,!0),-1===n.testPosition))return n.testPosition=this.testString.length,n.hint=n.unavailableEditPosition,!1;if(this._needCheckNextChar=!0,this.inputWidget.element.data("batchKeyPress")||this.inputWidget.element.data("nextChar",r===t.length-1?"":t.charAt(r+1)),!this.testChar(s,n.testPosition,o))return n.hint=o.hint,this._needCheckNextChar=!1,this.inputWidget.element.data("batchKeyPress")||this.inputWidget.element.data("nextChar",""),!1;if(this._needCheckNextChar=!1,!this.inputWidget.element.data("batchKeyPress")){this.inputWidget.element.data("nextChar","");var a=this.inputWidget.element.data("appendChar");if(a&&a.length>0&&(this.inputWidget.element.data("appendChar",""),n.testPosition++,!this.testChar(a,n.testPosition,o)))return n.hint=o.hint,this._needCheckNextChar=!1,!1;this.inputWidget.element.data("skipNextChar")&&(r++,this.inputWidget.element.data("skipNextChar",!1))}if(n.hint=Math.max(o.hint,n.hint),n.testPosition++,n.testPosition===this.testString.length)break}n.testPosition--}return!0},r.prototype.setText=function(t,i){if("undefined"==typeof i&&(i=new e.wijInputResult),void 0===t)throw"SetFromPos: input parameter is null or undefined.";if(i.hint=i.unknown,i.testPosition=0,!t.length)return this.clear(i),!0;if(this.noMask)return this.testString=t,!0;if(!this.testSetString(t,i.testPosition,i))return!1;var n=this.findAssignedEditPositionFrom(i.testPosition+1,!0);return-1!==n&&this.resetString(n,this.testString.length-1),!0},r.prototype.resetString=function(t,e){if(this.noMask)return void(this.testString="");if(t=this.findAssignedEditPositionFrom(t,!0),-1!==t)for(e=this.findAssignedEditPositionFrom(e,!1);e>=t;)t=this.findAssignedEditPositionFrom(t,!0),this.resetChar(t),t++},r.prototype.setString=function(t,e){for(var i=0;i<t.length;i++){var n=t.charAt(i);if(this.testEscapeChar(n,e)||(e=this.findEditPositionFrom(e,!0)),0>e||e>=this.testString.length)return;if(this.inputWidget.element.data("batchKeyPress")||this.inputWidget.element.data("nextChar",i===t.length-1?"":t.charAt(i+1)),this._needCheckNextChar=!0,this.setChar(n,e),e++,this._needCheckNextChar=!1,!this.inputWidget.element.data("batchKeyPress")){this.inputWidget.element.data("nextChar","");var o=this.inputWidget.element.data("appendChar");o&&o.length>0&&(this.inputWidget.element.data("appendChar",""),this.inputWidget.element.data("nextChar",""),this.testEscapeChar(o,e)||(e=this.findEditPositionFrom(e,!0)),this.setChar(o,e),e++),this.inputWidget.element.data("skipNextChar")&&(i++,this.inputWidget.element.data("skipNextChar",!1))}}},r.prototype.testSetString=function(t,e,i){return t.length>this.testString.length&&(t=t.substring(0,this.testString.length)),this._testString(t,e,i)?(this.setString(t,e),!0):!1},r.prototype.isAllDecriptorUnAssigned=function(){for(var t=0;t<this.testString.length;t++){var e=this.descriptors[t];if(e&&(e.charType===n.editOptional||e.charType===n.editRequired)&&e.isAssigned)return!1}return!0},r.prototype.toString=function(t,e,i,o,r){var s=this.inputWidget._showNullText(),a=!this.inputWidget.isFocused(),l=this.isAllDecriptorUnAssigned();if(s&&a&&l)return this.inputWidget.options.nullText;t=void 0===t?!this.isPassword():t;var h=this.getHidePromptOnLeave()?this.inputWidget.isFocused():!0;if(e=void 0===e?h:e,i=void 0===i?!0:i,this.noMask){if(!t){for(var d="",c=0;c<this.testString.length;c++)d+=this.getPasswordChar();return d}return this.testString}if(o=void 0===o?0:o,r=void 0===r?this.testString.length:r,0>=r)return"";if(o=Math.max(0,o),o>=this.testString.length)return"";var u=this.testString.length-o;if(r=Math.min(r,u),s=!this.isPassword()||t,a=e&&i,s&&a)return this.testString.substring(o,r-o);for(var p="",g=o+r-1,f=o;g>=f;f++){var m=this.testString.charAt(f),w=this.descriptors[f];switch(w.charType){case n.editOptional:case n.editRequired:if(!w.isAssigned)break;if(!this.isPassword()||t){p+=m;continue}p+=this.getPasswordChar();continue;case n.editRequired|n.editOptional:p+=m;continue;case n.separator:case n.literal:if(!i)continue;p+=m;continue;default:p+=m;continue}{if(!e){p+=" ";continue}p+=m}}return p},r.prototype.isEditDesc=function(t){return this.noMask?!0:t.charType===n.editRequired||t.charType===n.editOptional},r.prototype.isEditPos=function(t){if(this.noMask)return!0;if(0>t||t>=this.testString.length)return!1;var e=this.descriptors[t];return this.isEditDesc(e)},r.prototype.internalRemoveAt=function(t,i,n,o){if("undefined"==typeof o&&(o=!1),this.noMask){try{this.testString=this.testString.substring(0,t)+this.testString.substring(i+1,this.testString.length),n.testPosition=t}catch(r){}return!0}var s=this.findAssignedEditPositionFrom(this.testString.length-1,!1),a=this.findEditPositionInRange(t,i,!0,0);if(n.hint=n.noEffect,-1===a||a>s)return n.testPosition=t,!0;if(n.testPosition=t,-1!==this.findAssignedEditPositionInRange(t,i,!0)&&(n.hint=n.success),s>i){var l=this.findEditPositionFrom(i+1,!0),h=l;t=a;for(var d=!0,c=new e.wijInputResult;d;){d=!1;var u=this.testString.charAt(l),p=this.descriptors[l],g=u!==this.getPromtChar()||p.isAssigned,f=!this.testChar(u,a,c);if(g&&f)return n.hint=c.hint,n.testPosition=a,!1;l===s||(l=this.findEditPositionFrom(l+1,!0),a=this.findEditPositionFrom(a+1,!0),d=!0)}if(n.sideEffect>n.hint&&(n.hint=n.sideEffect),o)return!0;for(l=h,a=t,d=!0;d;){d=!1;var m=this.testString.charAt(l),w=this.descriptors[l];m!==this.getPromtChar()||w.isAssigned?(this.setChar(m,a),this.resetChar(l)):this.resetChar(a),l===s||(l=this.findEditPositionFrom(l+1,!0),a=this.findEditPositionFrom(a+1,!0),d=!0)}t=a+1}return i>=t&&this.resetString(t,i),!0},r.prototype.removeAt=function(t,i,n){return"undefined"==typeof i&&(i=t),"undefined"==typeof n&&(n=new e.wijInputResult),i>=this.testString.length?(n.testPosition=i,n.hint=n.positionOutOfRange,!1):t>=0&&i>=t?this.internalRemoveAt(t,i,n,!1):(n.testPosition=t,n.hint=n.positionOutOfRange,!1)},r.prototype._isLastCharAssigned=function(){var t=this.findEditPositionFrom(this.testString.length,!1);return t>=0&&t<this.testString.length?this.descriptors[t].isAssigned:!1},r.prototype._getFieldList=function(){for(var t=[],e=this.findEditPositionFrom(0,!0);e>=0&&e<this.testString.length;)t.push(e),e=this.findEditPositionFrom(e+1,!0);var i=[];if(t.length>0){for(var n=t[0],o=1,r=n;o<t.length;)t[o]-n!=1&&(i.push({start:r,end:n}),r=t[o]),n=t[o],o++;i.push({start:r,end:n})}return i},r}(e.wijTextProvider);e.wijMaskedTextProvider=s;var a=function(){function t(t,e){this.maskPos=t,this.charType=e,this.caseConversion="none",this.isAssigned=!1,this.maskPosition=0,this.maskPosition=t,this.charType=e}return t}();e.wijCharDescriptor=a}(t.input||(t.input={}));var e=t.input}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=t.getKeyCodeEnum(),o=function(t){function o(){t.apply(this,arguments),this._initialValue=0}return __extends(o,t),o.prototype._init=function(){t.prototype._init.call(this),this._initUserCultureOptions(),this._updateCultureRelatedOptions(),this._updateText()},o.prototype._initUserCultureOptions=function(){null!==this.options.negativePrefix&&(this._userNegativePrefix=this.options.negativePrefix),null!==this.options.negativeSuffix&&(this._userNegativeSuffix=this.options.negativeSuffix),null!==this.options.positivePrefix&&(this._userPositivePrefix=this.options.positivePrefix),null!==this.options.positiveSuffix&&(this._userPositiveSuffix=this.options.positiveSuffix),null!==this.options.currencySymbol&&(this._userCurrencySymbol=this.options.currencySymbol)},o.prototype._updateCultureRelatedOptions=function(){var t=this._getCulture().numberFormat,e=t[this.options.type]||t,i=e.pattern[0],n=e.pattern[1]||"n",o=i.split("n"),r=n.split("n"),s=this._getPercentSymbol(),a=this._getCulture().numberFormat.currency.symbol;void 0===this._userNegativePrefix&&(this.options.negativePrefix=o[0].replace(/%/g,s).replace(/\$/g,a)),void 0===this._userNegativeSuffix&&(this.options.negativeSuffix=o[1].replace(/%/g,s).replace(/\$/g,a)),void 0===this._userPositivePrefix&&(this.options.positivePrefix=r[0].replace(/%/g,s).replace(/\$/g,a)),void 0===this._userPositiveSuffix&&(this.options.positiveSuffix=r[1].replace(/%/g,s).replace(/\$/g,a)),void 0===this._userCurrencySymbol&&(this.options.currencySymbol=t.currency.symbol)},o.prototype._createTextProvider=function(){return this._textProvider?this._textProvider:(this._textProvider=new s(this,this.options.type),void this._textProvider.setNullValue(""===this.element.val()&&null===this.options.value))},o.prototype._beginUpdate=function(){this._initialValue=0;var t=this.options;this.element.addClass(t.wijCSS.wijinputnumber),this.element.data({defaultValue:t.value,preValue:t.value}).attr({"aria-valuemin":t.minValue,"aria-valuemax":t.maxValue,"aria-valuenow":t.value||this._initialValue})},o.prototype.focus=function(){t.prototype.focus.call(this);var e=this.element.data("prevCursorPos");this.element.wijtextselection(e,e)},o.prototype._setOption=function(e,i){switch(t.prototype._setOption.call(this,e,i),e){case"minValue":this.element.attr("aria-valuemin",i),this._updateText();break;case"maxValue":this.element.attr("aria-valuemax",i),this._updateText();break;case"value":this.setValue(i),this._updateText();break;case"showGroup":case"decimalPlaces":case"culture":this._updateCultureRelatedOptions(),this._updateText();break;case"positivePrefix":this._userPositivePrefix=i,this._updateText();break;case"negativePrefix":this._userNegativePrefix=i,this._updateText();break;case"positiveSuffix":this._userPositiveSuffix=i,this._updateText();break;case"negativeSuffix":this._userNegativeSuffix=i,this._updateText();break;case"currencySymbol":this._userCurrencySymbol=i,this._updateCultureRelatedOptions(),this._updateText();break;case"type":this._updateCultureRelatedOptions(),this._updateText()}},o.prototype._setData=function(t){this.setValue(t)},o.prototype._resetData=function(){var t=this.element.data("defaultValue");if(0===t){var e=this.element.data("elementValue");void 0!==e&&null!==e&&""!==e&&(t=e)}(t!==this._textProvider.getValue()||this._textProvider._nullvalue&&0===t)&&this.setValue(t)},o.prototype._validateData=function(){!this._textProvider.checkAndRepairBounds(!0,!1)&&null!==this.options.value&&this._updateText()},o.prototype._raiseDataChanged=function(){var t=this.options.value,e=this.element.data("preValue");this.element.data("preValue",t),e!==t&&(this.element.attr("aria-valuenow",t),this._trigger("valueChanged",null,{value:t}))},o.prototype._onChange=function(){},o.prototype._getPrefix=function(){return this._textProvider._stringFormat.isNegative()?void 0!==this._userNegativePrefix?this._userNegativePrefix:this.options.negativePrefix:void 0!==this._userPositivePrefix?this._userPositivePrefix:this.options.positivePrefix},o.prototype._getInvertPrefix=function(){return this._textProvider._stringFormat.isNegative()?void 0!==this._userPositivePrefix?this._userPositivePrefix:this.options.positivePrefix:void 0!==this._userNegativePrefix?this._userNegativePrefix:this.options.negativePrefix},o.prototype._getSuffix=function(){return this._textProvider._stringFormat.isNegative()?void 0!==this._userNegativeSuffix?this._userNegativeSuffix:this.options.negativeSuffix:void 0!==this._userPositiveSuffix?this._userPositiveSuffix:this.options.positiveSuffix},o.prototype._getCurrencySymbol=function(){return void 0!==this._userCurrencySymbol?this._userCurrencySymbol:this._getCulture().numberFormat.currency.symbol},o.prototype._getPercentSymbol=function(){return this._getCulture().numberFormat.percent.symbol},o.prototype.getValue=function(){if(this._textProvider._nullvalue)return null;var t=this._textProvider.getValue();return(void 0===t||null===t)&&(t=this.getText()),t},o.prototype.setValue=function(t,e){"undefined"==typeof e&&(e=!1);try{if(e=!!e,null===t||"undefined"==typeof t||isNaN(t)?t=null:"boolean"==typeof t?t=t?1:0:"string"==typeof t&&(t=this._textProvider.tryParseValue(t)),this._textProvider.setValue(t))this._updateText();else if(e){var i=this.getText();this.setText(t);var n=this.getText().trim();t=t.trim(),n!==t&&this.setText(i)}else this.setText(t);return!0}catch(o){return!1}},o.prototype._isLastValueNull=function(){return t.prototype._isLastValueNull.call(this)&&!this._textProvider._nullvalue},o.prototype.isValueNull=function(){try{return this._textProvider.isValueNull()}catch(t){return!0}},o.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(t.prototype._showNullText.call(this)&&this.isValueNull())return"0";var e=this.options.value?this.options.value:0;return"percent"===this.options.type&&(e=(e/100).toFixed(10)),e.toString()},o.prototype._updateText=function(e){"undefined"==typeof e&&(e=!1),this._isInitialized()&&(this._textProvider._stringFormat.isNegative()?this.element.addClass(this.options.negativeClass):this.element.removeClass(this.options.negativeClass),this._textProvider._nullvalue?this.options.value=null:this.options.value=this._textProvider.getValue(),t.prototype._updateText.call(this,e),this._textProvider.checkAndRepairBounds(!0,!1)||(this._trigger("valueBoundsExceeded"),this.isFocused()||(this._textProvider.setNullValue(!1),t.prototype._updateText.call(this,e))))},o.prototype._doSpin=function(t,n,o){if(!this._allowEdit())return!1;if(n&&this.element.data("breakSpinner"))return!1;var r=this.element.wijtextselection(),s=new e.wijInputResult;if(-9!==this.element.data("focusNotCalledFirstTime")&&(new Date).getTime()-this.element.data("focusNotCalledFirstTime")<600&&(this.element.data("focusNotCalledFirstTime",-9),this.element.data("prevCursorPos",0)),-1===this.element.data("prevCursorPos")?this.element.data("prevCursorPos",r.start):r.start=this.element.data("prevCursorPos"),s.testPosition=r.start,this._textProvider.spinEnumPart(r.start,s,this.options.increment,t),t?this._trigger("spinUp",null):this._trigger("spinDown",null),this._updateText(),this.element.data("prevCursorPos",s.testPosition),o||this.selectText(s.testPosition,s.testPosition),n&&!this.element.data("breakSpinner")){var a=window.setTimeout(i.proxy(function(){this._doSpin(t,!0)},this),this._calcSpinInterval());this.element.data("spintimer",a)}return!0},o.prototype._deleteSelText=function(e){"undefined"==typeof e&&(e=!1);var i=this.element.wijtextselection(),n=0===i.start&&i.end===this.element.val().length,o;if(i.start===i.end&&!e&&(o=this._textProvider._stringFormat._currentText,o.charAt(i.end)===this._textProvider.getGroupSeparator()||o.charAt(i.end)===this._textProvider.getDecimalSeparator()))return i.start++,i.end++,this.element.wijtextselection(i),void 0;var r=this._textProvider.getEditingValue();t.prototype._deleteSelText.call(this,e),0===r&&(n||0===this._textProvider.getEditingValue())&&(this._textProvider.setNullValue(!0),this._updateText(!0),this.options.value=null)},o.prototype._processClearButton=function(){this._setOption("value",null)},o.prototype._processLeftRightKey=function(t){if(t){if(0===this.element.wijtextselection().start&&("left"===this.options.blurOnLeftRightKey.toLowerCase()||"both"===this.options.blurOnLeftRightKey.toLowerCase()))return e.Utility.MoveFocus(this.element.get(0),!1),!0}else if(this.element.wijtextselection().start===this.element.val().length&&("right"===this.options.blurOnLeftRightKey.toLowerCase()||"both"===this.options.blurOnLeftRightKey.toLowerCase()))return e.Utility.MoveFocus(this.element.get(0),!0),!0;return!1},o.prototype._processTabKey=function(t){var e=t.keyCode||t.which;switch(e){case n.TAB:if("field"!==this.options.tabAction)break;var i=this.element.val().indexOf(".");-1===i&&(i=this.element.val().length);var o=this.element.wijtextselection();return t.shiftKey?o.start>i&&this._toPrevField():o.start<i&&this._toNextField(),!0}return!1},o.prototype._toPrevField=function(){var t=this._getPrefix();this.element.wijtextselection(t.length,t.length)},o.prototype._toNextField=function(){var t=this.element.val().indexOf(".");-1===t?this._toPrevField():this.element.wijtextselection(t+1,t+1);
},o.prototype.spinUp=function(){this._doSpin(!0,!1,!0)},o.prototype.spinDown=function(){this._doSpin(!1,!1,!0)},o}(e.wijinputcore);e.wijinputnumber=o;var r=function(){function t(){this.wijCSS={wijinputnumber:e.wijinputcore.prototype.options.wijCSS.wijinput+"-numeric",wijinputnumberNegative:"ui-state-negative"},this.type="numeric",this.value=0,this.minValue=-1e9,this.maxValue=1e9,this.showGroup=!1,this.decimalPlaces=2,this.increment=1,this.currencySymbol=null,this.negativePrefix=null,this.negativeSuffix=null,this.positivePrefix=null,this.positiveSuffix=null,this.valueChanged=null,this.spinUp=null,this.spinDown=null,this.valueBoundsExceeded=null,this.negativeClass=this.wijCSS.wijinputnumberNegative}return t}();o.prototype.options=i.extend(!0,{},e.wijinputcore.prototype.options,new r),i.wijmo.registerWidget("wijinputnumber",o.prototype);var s=function(t){function n(e,i){t.call(this),this._type="numeric",this._stringFormat=null,this._nullvalue=!1,this.inputWidget=e,this._type=i,this._stringFormat=new a(this.inputWidget),this._stringFormat.setValueFromJSFloat(this.getValue())}return __extends(n,t),n.prototype.getEditingValue=function(){return this._stringFormat.tryParseValue(this._stringFormat._strippedText)},n.prototype._getCulture=function(){return this.inputWidget._getCulture()},n.prototype.getDecimalSeparator=function(){return this._getCulture().numberFormat["."]},n.prototype.getGroupSeparator=function(){return this._getCulture().numberFormat[","]},n.prototype.tryParseValue=function(t){return this._stringFormat.tryParseValue(t)},n.prototype.toString=function(){return this.inputWidget._showNullText()&&!this.inputWidget.isFocused()&&this.isValueNull()?this.inputWidget.options.nullText:this.isValueNull()?"":this._stringFormat.getFormattedValue()},n.prototype.isValueNull=function(){var t=this.inputWidget.options;return null===t.value||void 0===t.value||this._nullvalue},n.prototype.setText=function(t,e){return this.clear(),this.insertAt(t,0,e),!0},n.prototype.clear=function(){this._stringFormat.clear()},n.prototype.checkAndRepairBounds=function(t,e,i){if("undefined"==typeof i&&(i=!1),this._nullvalue)return!0;var n=!0,o,r;if("undefined"==typeof t&&(t=!1),o=this.inputWidget.options.minValue,r=this.inputWidget.options.maxValue,"undefined"!=typeof e&&e)return this._stringFormat.checkMinValue(o,!1,!0);var s=!0;return this._stringFormat.checkMinValue(o,t,!1)||(n=!1,i&&(s=!1,this._stringFormat._currentValueInString=r.toString())),s&&!this._stringFormat.checkMaxValue(r,t)&&(n=!1,i&&(this._stringFormat._currentValueInString=o.toString())),this.inputWidget.options.decimalPlaces>=0&&this._stringFormat.checkDigitsLimits(this.inputWidget.options.decimalPlaces),n},n.prototype._countSubstring=function(t,e){for(var i=0,n=t.indexOf(e);-1!==n;)i++,n=t.indexOf(e,n+1);return i},n.prototype._getAdjustedPositionFromLeft=function(t){var e=this._stringFormat._strippedText,n,o;for(n=0;n<e.length&&(o=e.charAt(n),!i.wij.charValidator.isDigit(o)&&o!==this.getGroupSeparator()&&o!==this.getDecimalSeparator()||"0"===o);n++)this._stringFormat.isZero()?n>t&&t++:n>=t&&t++;return t},n.prototype._getDecimalSeparatorPos=function(){var t=this._stringFormat._strippedText;return t.indexOf(this.getDecimalSeparator())},n.prototype._removeLeadingZero=function(t){var e=0;for((" "===t.charAt(e)||t.charAt(e)===this.inputWidget.options.currencySymbol)&&e++;"0"===t.charAt(e)&&"."!==t.charAt(e+1);)t=t.substr(0,e)+t.substr(e+1);return t},n.prototype.insertAt=function(t,n,o){var r=this._getCulture().numberFormat,s,a,l,h,d,c,u,p,g,f=this._stringFormat._strippedText,m=this.inputWidget._getPrefix(),w=this.inputWidget._getInvertPrefix();if(n<m.length?n=m.length:n>m.length+f.length&&(n=m.length+f.length),n-=m.length,o||(o=new e.wijInputResult),this.setNullValue(!1),1===t.length){if("+"===t){var y=this._stringFormat.isNegative();this._stringFormat.setPositiveSign(),this.checkAndRepairBounds(!0,!1);var v=y!==this._stringFormat.isNegative();return v?o.testPosition=w.length+n-1:o.testPosition=m.length+n-1,!0}if("-"===t||")"===t||"("===t){var _=this._stringFormat.isNegative();return this._stringFormat.invertSign(),this.checkAndRepairBounds(!0,!1),this._stringFormat.isNegative()===_?(o.testPosition=m.length+n-1,!0):(o.testPosition=w.length+n-1,!0)}if(!i.wij.charValidator.isDigit(t)){if(t===this.getDecimalSeparator()&&(s=this._getDecimalSeparatorPos()+m.length,s>=0))return o.testPosition=s,!0;if(t!==this.getGroupSeparator()&&t!==this.getDecimalSeparator()&&")"!==t&&"+"!==t&&"-"!==t&&"("!==t&&t!==this.getDecimalSeparator())return"percent"===this._type&&t===r.percent.symbol?(o.testPosition=n,!0):"currency"===this._type&&t===this.inputWidget.options.currencySymbol?(o.testPosition=n,!0):!1}}n=this._getAdjustedPositionFromLeft(n),a=n,a>f.length&&(a=f.length-1),l=this._removeLeadingZero(f.substring(0,a)),h=f.substring(a,f.length),this._stringFormat.isZero()&&(h=h.replace(/0/,""));for(var S=t,x="";"+"===S.charAt(0)||"-"===S.charAt(0)||")"===S.charAt(0)||"("===S.charAt(0);)x=S.charAt(0),S=S.substring(1);S=S.replace(/[^0-9\.]/gi,"");var b=S.indexOf(".");if(-1!==b){var C=S.split("."),D,I;D=C.shift();var j=C;I=j.join(""),S=D+"."+I}else S=S;"+"===x&&(this._stringFormat.setPositiveSign(),this.checkAndRepairBounds(!0,!1)),("-"===x||")"===x||"("===x)&&(this._stringFormat.invertSign(),this.checkAndRepairBounds(!0,!1)),o.testPosition=m.length+l.length+S.length-1,this._stringFormat.deFormatValue((this._stringFormat.isNegative()?"-":"")+l+S+h),d=this._stringFormat._strippedText;try{this.inputWidget.options.showGroup?(c=this._countSubstring(l,this._stringFormat._groupSeparator),u=this._countSubstring(d.substring(0,l.length+S.length),this._stringFormat._groupSeparator),o.testPosition+=u-c):1===S.length&&(p=l.charAt(l.length-1),g=d.charAt(l.length-1),g!==p&&o.testPosition--)}catch(T){}return!0},n.prototype.removeAt=function(t,i,n,o){"undefined"==typeof n&&(n=new e.wijInputResult),"undefined"==typeof o&&(o=!1);var r=this._getCulture().numberFormat,s,a,l,h,d,c;n.testPosition=t;try{if(s=this._stringFormat._currentText,t===i&&s.substring(t,i+1)===this.getDecimalSeparator())return!1;if(a=s.slice(0,t),l=a,h=s.slice(t,i+1).indexOf(this.getDecimalSeparator())>=0,h&&(l+=this.getDecimalSeparator()),l+=s.slice(i+1),l=l||"0",this._stringFormat.deFormatValue(l),l=this._stringFormat._currentText,this.setNullValue(!1),this.inputWidget.options.showGroup)if(h)n.testPosition=l.indexOf(this.getDecimalSeparator());else try{d=this._countSubstring(a,this._stringFormat._groupSeparator),c=this._countSubstring(l.substring(0,Math.max(0,t-1)),this._stringFormat._groupSeparator),n.testPosition-=d-c,(s.indexOf(this.inputWidget.options.currencySymbol)===n.testPosition||s.indexOf(r.percent.symbol)===n.testPosition)&&n.testPosition++}catch(u){}return!0}catch(p){}return!0},n.prototype.replaceWith=function(e,i){var n=!1;this._stringFormat.isNegative()&&"-"===i&&e.text.length===this._stringFormat._currentText.length&&(n=!0);var o=t.prototype.replaceWith.call(this,e,i);return n&&this.insertAt("-",this.inputWidget.element.wijtextselection().start,o),o},n.prototype.spinEnumPart=function(t,i,n,o){i||(i=new e.wijInputResult),n=parseInt(n.toString());var r=this.inputWidget._getPrefix(),s=this._stringFormat._currentText.indexOf(this._getCulture().numberFormat["."]),a=this._stringFormat._currentValueInString.replace("-",""),l=a.indexOf("."),h=!0;-1===s&&(h=!1,s=this._stringFormat._currentText.length),0===l?l=1:-1===l&&(l=s);var d=Math.pow(10,this.inputWidget.options.decimalPlaces);if(i.testPosition>s&&h){var c=n;n/=d,Math.abs(n)>=1&&(o?this._stringFormat.spinUp(parseInt(n),this._nullvalue):this._stringFormat.spinDown(parseInt(n),this._nullvalue),n=(c-parseInt(n)*d)/d)}o?this._stringFormat.spinUp(n,this._nullvalue):this._stringFormat.spinDown(n,this._nullvalue),this.setNullValue(!1);var u=this.inputWidget.options.allowSpinLoop;this.checkAndRepairBounds(!0,!1,u);var p=this._stringFormat._currentValueInString.replace("-",""),g=p.indexOf(".");-1===g&&(h=!1,g=p.length);var f=this.inputWidget._getPrefix();g!==l&&h?i.testPosition=i.testPosition-r.length+f.length+g-l:i.testPosition=i.testPosition-r.length+f.length},n.prototype.getValue=function(){return this._stringFormat.getJSFloatValue()},n.prototype.setValue=function(t){try{return null===t?(this.setNullValue(!0),t=this.inputWidget._initialValue):this.setNullValue(!1),this._stringFormat.setValueFromJSFloat(t),this.checkAndRepairBounds(!0,!1),!0}catch(e){return!1}},n.prototype.setNullValue=function(t){this._nullvalue=t},n}(e.wijTextProvider);e.wijNumberTextProvider=s;var a=function(){function t(t){this.inputWidget=t,this._currentValueInString="0",this._currentText="0",this._strippedText="0",this._groupSeparator=" "}return t.prototype._isNegtive=function(t){return-1!==t.indexOf("-")||-1!==t.indexOf("(")},t.prototype._stripValue=function(t){var e=this.inputWidget._getCulture().numberFormat,i=e[this.inputWidget.options.type]||e,n=this._isNegtive(t),o=i[","],r=i["."],s=new RegExp("["+o+e.percent.symbol+this.inputWidget.options.currencySymbol+" ]","g"),a;return this._groupSeparator=o,t=this._removeNegativeSign(t),t=t.replace(s,""),t=t.replace(r,"."),a=/([\d\.])+/.exec(t),a&&(t=a[0]),n&&(t="-"+t),t},t.prototype.tryParseValue=function(t){try{var e=parseFloat(this._stripValue(t));return isNaN(e)&&(e=null),e}catch(i){return null}},t.prototype.deFormatValue=function(t){t=this._stripValue(t),this._currentValueInString=t,this._currentText=this._formatValue(t)},t.prototype._formatValue=function(t){var e=this.inputWidget.options,i=this.inputWidget._getCulture().numberFormat,n=i[e.type]||i,o=e.decimalPlaces,r=n[","],s=n["."],a=-2!==o?o:n.decimals,l=e.showGroup?n.groupSizes:[0],h;return t=this._removeLeadingZero(t),h=this._formatDigit(t,r,s,a,l),h=this._removeLeadingZero(h,e.showGroup?r:""),0===h.indexOf(s)&&(h="0"+h),""===h&&(h="0"),this._currentValueInString=t,this._strippedText=h,this._currentText=this._getPrefix()+h+this._getSuffix(),this._currentText},t.prototype._getPrefix=function(){return this.isNegative()?void 0!==this.inputWidget._userNegativePrefix?this.inputWidget._userNegativePrefix.replace(/\$/g,this.inputWidget.options.currencySymbol):null===this.inputWidget.options.negativePrefix?"":this.inputWidget.options.negativePrefix.replace(/\$/g,this.inputWidget.options.currencySymbol):void 0!==this.inputWidget._userPositivePrefix?this.inputWidget._userPositivePrefix.replace(/\$/g,this.inputWidget.options.currencySymbol):null===this.inputWidget.options.positivePrefix?"":this.inputWidget.options.positivePrefix.replace(/\$/g,this.inputWidget.options.currencySymbol)},t.prototype._getSuffix=function(){return this.isNegative()?void 0!==this.inputWidget._userNegativeSuffix?this.inputWidget._userNegativeSuffix.replace(/\$/g,this.inputWidget.options.currencySymbol):null===this.inputWidget.options.negativeSuffix?"":this.inputWidget.options.negativeSuffix.replace(/\$/g,this.inputWidget.options.currencySymbol):void 0!==this.inputWidget._userPositiveSuffix?this.inputWidget._userPositiveSuffix.replace(/\$/g,this.inputWidget.options.currencySymbol):null===this.inputWidget.options.positiveSuffix?"":this.inputWidget.options.positiveSuffix.replace(/\$/g,this.inputWidget.options.currencySymbol)},t.prototype.getFormattedValue=function(){return!this.inputWidget._showNullText()&&this.inputWidget.isValueNull()&&(this._currentValueInString=this.inputWidget._initialValue+""),this._formatValue(this._currentValueInString)},t.prototype.getJSFloatValue=function(){try{return""===this._currentValueInString||"."===this._currentValueInString?0:parseFloat(this._currentValueInString)}catch(t){return Number.NaN}},t.prototype.clear=function(){this._currentValueInString="0",this._currentText="0",this._strippedText="0"},t.prototype.setValueFromJSFloat=function(t){var e=t.toFixed(this.inputWidget.options.decimalPlaces+1);try{return this._currentValueInString=e,this._formatValue(e),!0}catch(i){return!1}},t.prototype.isZero=function(t){"undefined"==typeof t&&(t=this._currentValueInString);var e=this._removeNegativeSign(t),i;return e?(i=parseFloat(e),!isNaN(i)&&!i):!0},t.prototype.setPositiveSign=function(){this._currentValueInString=this._removeNegativeSign(this._currentValueInString)},t.prototype._removeNegativeSign=function(t){return t.replace(/[()\-]/g,"")},t.prototype._removeLeadingZero=function(t,e){"undefined"==typeof e&&(e="");for(var t=t.replace(/^0+/,"");e.length>0&&0===t.indexOf(e);){t=t.substr(e.length);var t=t.replace(/^0+/,"")}return t},t.prototype.isNegative=function(){return-1!==this._currentValueInString.indexOf("-")||-1!==this._currentValueInString.indexOf("(")},t.prototype.invertSign=function(){var t=this.isNegative();t?this.setPositiveSign():this._currentValueInString=this._currentValueInString.length?"-"+this._currentValueInString:"0",this.isZero()&&(this._currentValueInString=t?"0":"-0"),this._formatValue(this._currentValueInString)},t.prototype._parseNumber=function(t){"undefined"==typeof t&&(t=this._currentValueInString);var e=t.split(".",2),i={integer:parseInt(e[0],10)||0,fraction:(e.length>1?parseInt(e[1],10):0)||0,isNegative:-1!==e[0].indexOf("-")};return 0===i.integer&&0===i.fraction&&(i.isNegative=!1),i},t.prototype._doSpin=function(t,e){var i=this._parseNumber(),n=t>=0?1:-1,o=Math.abs(t)>=1?"integer":"decimal",r=this.inputWidget.options.increment;r>=Math.pow(10,this.inputWidget.options.decimalPlaces)&&(r="integer"===o?Math.abs(t):Math.abs(t)*Math.pow(10,this.inputWidget.options.decimalPlaces));var s=n*r,a="",l,h,d=i.integer,c=i.fraction;if("integer"===o)d=i.integer+s,0>d&&(a="-",d=-d);else if("decimal"===o){var u=i.isNegative?-i.fraction:i.fraction;d=i.integer,0>u?(c=-Math.abs(u+s),0>u*(u+s)&&(d=Math.abs(d),a="-")):c=u+s,0===u&&i.isNegative&&(c=-Math.abs(c),a="-",1===n&&(d=Math.abs(d))),0>=c&&(d>0?(d-=1,c=Math.pow(10,this.inputWidget.options.decimalPlaces)+c):(d=Math.abs(i.integer),c=Math.abs(c),a="-"))}for(l=d.toString(),h=c.toString(),parseInt(this.inputWidget.options.decimalPlaces)>0&&h.length>parseInt(this.inputWidget.options.decimalPlaces)&&(d++,h=h.substring(1),l=d.toString());h.length<this.inputWidget.options.decimalPlaces;)h="0"+h;-1!==l.indexOf("-")&&(a=""),0===parseInt(l)&&0===parseInt(h)&&(a=""),e?t>=0?this._currentValueInString=this.inputWidget.options.minValue.toString():this._currentValueInString=this.inputWidget.options.maxValue.toString():this._currentValueInString=a+l+"."+h},t.prototype.spinUp=function(t,e){(null===t||void 0===t)&&(t=1),this._doSpin(t,e)},t.prototype.spinDown=function(t,e){(null===t||void 0===t)&&(t=1),this._doSpin(-t,e)},t.prototype.checkDigitsLimits=function(t){var e=this._currentValueInString.split("."),i="";if(e.length&&(1!==e.length||""!==e[0])){for(e.length>1&&(i=e[1]),i=i.substring(0,t);i.length<t;)i+="0";this._currentValueInString=e[0],i&&(this._currentValueInString+="."+i)}},t.prototype.checkMinValue=function(t,e,i){"undefined"==typeof i&&(i=!1);var n=!0,o,r,s,a,l;try{if(o=this._currentValueInString.split("."),r=parseFloat(""===o[0]||"-"===o[0]?"0":o[0]),s=0,o.length>1&&parseFloat(o[1])>=0&&(s=parseFloat("1."+o[1])),(0>r||"-"===o[0]||o[0].length>0&&"-"===o[0][0])&&(s*=-1),t=""+t.toFixed(12),o=t.split("."),a=parseFloat(""===o[0]||"-"===o[0]?"0":o[0]),l=0,o.length>1&&parseFloat(o[1])>=0&&(l=parseFloat("1."+o[1])),(0>a||"-"===o[0]||o[0].length>0&&"-"===o[0][0])&&(l*=-1),r>a)return!0;a>r||i&&r===a&&l>=s?n=!1:r===a&&0>r&&l>s?n=!1:r===a&&r>=0&&l>s&&(n=!1),!n&&e&&(this._currentValueInString=""+t)}catch(h){}return n},t.prototype.checkMaxValue=function(t,e){var i=!0,n,o,r,s,a;try{if(n=this._currentValueInString.split("."),o=parseFloat(""===n[0]||"-"===n[0]?"0":n[0]),r=0,n.length>1&&parseFloat(n[1])>=0&&(r=parseFloat("1."+n[1])),(0>o||"-"===n[0]||n[0].length>0&&"-"===n[0][0])&&(r*=-1),t=""+t.toFixed(12),n=t.split("."),s=parseFloat(""===n[0]||"-"===n[0]?"0":n[0]),a=0,n.length>1&&parseFloat(n[1])>=0&&(a=parseFloat("1."+n[1])),(0>s||"-"===n[0]||n[0].length>0&&"-"===n[0][0])&&(a*=-1),s>o)return!0;o>s&&(i=!1),o===s&&o>=0&&r>a&&(i=!1),o===s&&0>o&&r>a&&(i=!1),!i&&e&&(this._currentValueInString=""+t)}catch(l){}return i},t.prototype._formatDigit=function(t,e,i,n,o){var r=this._removeNegativeSign(t),s,a,l,h,d,c;for(s=r.indexOf("."),-1===s&&(s=r.length),a="",l=0,h=0,c=r.length-1;c>=0;c--)d=r.charAt(c),s>c&&(a=d+a,h++,h===1*o[l]&&1*o[l]&&c&&(a=e+a,h=0,o.length-1>l&&l++));if(n>0)for(a+=i,c=0;n>c;c++)d="0",c+s+1<r.length&&(d=r.charAt(c+s+1)),a+=d;return-1===n&&s<r.length-1&&(a+=i,a+=r.substr(s+1)),a},t}();e.wijNumberFormat=a}(t.input||(t.input={}));var e=t.input}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijinputtext",o;!function(t){t._map=[],t._map[0]="None",t.None=0,t._map[1]="EllipsisEnd",t.EllipsisEnd=1,t._map[2]="EllipsisPath",t.EllipsisPath=2}(o||(o={}));var r;!function(t){t._map=[],t._map[0]="Append",t.Append=0,t._map[1]="Replace",t.Replace=1}(r||(r={}));var s=function(){function t(){}return t.Auto="auto",t.Active="active",t.Disabled="disabled",t.Inactive="inactive",t}(),a=function(i){function n(){i.apply(this,arguments)}return __extends(n,i),n.prototype._getIMTextBox=function(){return void 0===this.imtextbox&&(this.imtextbox=new d(this.element[0],this.outerDiv)),this.imtextbox},n.prototype._create=function(){i.prototype._create.call(this);var t=this;t.imtextbox=t._getIMTextBox()},n.prototype._init=function(){i.prototype._init.call(this),this.options.disableUserInput&&this.imtextbox.SetReadOnly(!0),this.imtextbox.placeHolder=this.options.nullText?this.options.nullText:"";var t=this;this.imtextbox.readingImeStringOutputEvent=function(e,i){t._trigger("readingImeStringOutput",null,i)},this.imtextbox.InvalidInputEvent=function(e,i){t._fireIvalidInputEvent(i)},this.imtextbox.SetAutoConvert(this.options.autoConvert),this.imtextbox.SetExitOnLastChar(this.options.blurOnLastChar),this.imtextbox.SetExitOnLeftRightKey(this.options.blurOnLeftRightKey),this.imtextbox.SetFormat(this.options.format),this.imtextbox.SetLengthAsByte(this.options.lengthAsByte),this.imtextbox.SetMaxLength(this.options.maxLength),this.imtextbox.SetMaxLineCount(this.options.maxLineCount),this.imtextbox.SetCountWrappedLine(this.options.countWrappedLine),null===this.options.text&&(this.options.text=this.getText()),this.setText(this.options.text),null!==this.options.invalidInput&&this.imtextbox.OnInvalidInput(this.options.invalidInput),this.imtextbox.TextChangedEvent=function(e,i){t.options.text=i,t._trigger("textChanged",null,i)};var e=this.element,n=this.options.wijCSS,o={input:!0,textarea:!0},r={text:!0,password:!0,email:!0,url:!0},s=e.get(0).nodeName.toLowerCase();if(o.hasOwnProperty(s)&&("input"!==s||!this.element.attr("type")||r.hasOwnProperty(this.element.attr("type").toLowerCase()))){if("input"===s){if(this.imtextbox.SetMultiLine(!1),"password"===this.element.attr("type")){var a;a=this.options.passwordChar?this.options.passwordChar:this.imtextbox.SystemPasswordChar(),this.imtextbox.SetPasswordChar(a)}}else"textarea"===s&&this.imtextbox.SetMultiLine(!0);e.is(":disabled")?(this._setOption("disabled",!0),e.addClass(n.stateDisabled)):(this._setOption("disabled",!1),e.removeClass(n.stateDisabled)),this.options.passwordChar&&this.imtextbox.SetPasswordChar(this.options.passwordChar)}},n.prototype.destroy=function(){var t=this,e=t.options.wijCSS;t.element.removeClass(e.widget).removeClass(e.stateDefault).removeClass(e.cornerAll).removeClass(e.stateHover).removeClass(e.stateActive).off("."+t.widgetName),t.element.off(".imtextbox"),i.prototype.destroy.call(this)},n.prototype._setOption=function(t,e){switch(t){case"nullText":case"placeholder":this.imtextbox.placeHolder=e}switch(i.prototype._setOption.call(this,t,e),t){case"autoConvert":this.imtextbox.SetAutoConvert(e);break;case"blurOnLastChar":this.imtextbox.SetExitOnLastChar(e);break;case"blurOnLeftRightKey":this.imtextbox.SetExitOnLeftRightKey(e);break;case"format":this.imtextbox.SetFormat(e);break;case"maxLineCount":this.imtextbox.SetMaxLineCount(e);break;case"countWrappedLine":this.imtextbox.SetCountWrappedLine(e);break;case"lengthAsByte":this.imtextbox.SetLengthAsByte(e);break;case"maxLength":this.imtextbox.SetMaxLength(e);break;case"readonly":case"disableUserInput":this.imtextbox.SetReadOnly(e);break;case"passwordChar":this.imtextbox.SetPasswordChar(e);break;case"text":this.setText(e);break;case"invalidInput":this.imtextbox.OnInvalidInput(e);break;case"":}},n.prototype._raiseTextChanged=function(){},n.prototype._updateTextOnLostFocus=function(){this.imtextbox.PasswordMode||i.prototype._updateTextOnLostFocus.call(this)},n.prototype._onMouseUp=function(t){},n.prototype._onCompositionStart=function(){},n.prototype._onCompositionEnd=function(){},n.prototype._onChange=function(){},n.prototype._onPaste=function(t){},n.prototype._onDrop=function(t){},n.prototype._onKeyDown=function(e){var i=this._getKeyCode(e),n=t.getKeyCodeEnum();return this.options.disableUserInput?void(i===n.TAB?this._processTabKey(e)&&this._stopEvent(e):this._stopEvent(e)):void(this._processKeyForDropDownList(e)||i===n.ENTER&&this._onEnterDown(e))},n.prototype._onKeyPress=function(e){if(!this.options.disableUserInput){var i=this._getKeyCode(e),n=t.getKeyCodeEnum();i===n.ENTER&&this._onEnterDown(e)}},n.prototype._onKeyUp=function(t){return this.options.disableUserInput?(this._raiseTextChanged(),void this._raiseDataChanged()):void 0},n.prototype._createTextProvider=function(){this._textProvider=new h(this)},n.prototype.selectText=function(t,i){"undefined"==typeof t&&(t=0),"undefined"==typeof i&&(i=this.getText().length),isNaN(t)&&(t=0),isNaN(i)&&(i=0),this.element.is(":disabled")||(e.Utility.IsFireFox4OrLater()&&this.focus(),this.imtextbox.SetSelection(t,i))},n.prototype._updateText=function(){this.element.data("initialized")&&i.prototype._updateText.call(this)},n}(e.wijinputcore);e.wijinputtext=a;var l=function(){function t(){this.initSelector=":jqmData(role='wijinput')",this.wijCSS={},this.autoConvert=!0,this.blurOnLastChar=!1,this.blurOnLeftRightKey="none",this.format="",this.imeMode="auto",this.lengthAsByte=!1,this.maxLength=0,this.maxLineCount=0,this.countWrappedLine=!1,this.passwordChar="",this.text=null}return t}();a.prototype.options=i.extend(!0,{},e.wijinputcore.prototype.options,new l),i.wijmo.registerWidget(n,a.prototype);var h=function(t){function e(e){t.call(this),this.inputWidget=e}return __extends(e,t),e.prototype.toString=function(){return this.inputWidget._showNullText()&&!this.inputWidget.isFocused()&&this.isValueNull()?(this.inputWidget.element.data("isShowNullText",!0),this.inputWidget.options.nullText):this.inputWidget._showNullText()&&!this.inputWidget.isFocused()||!this.inputWidget.element.data("isShowNullText")?this.inputWidget.imtextbox&&this.inputWidget.imtextbox.GetPasswordChar()?this.inputWidget.imtextbox.GetText():this.inputWidget.imtextbox?this.inputWidget.imtextbox._getInputValueWithPlaceHolder():void 0!==this.inputWidget.options.text?this.inputWidget.options.text:this.inputWidget.element.val():(this.inputWidget.element.data("isShowNullText",!1),"")},e.prototype.isValueNull=function(){return this.inputWidget.imtextbox?this.inputWidget.imtextbox.isNullText:!0},e.prototype.setText=function(t){this.inputWidget.imtextbox.SetText(t)},e}(e.wijTextProvider);e.wijInputTextProvider=h;var d=function(){function t(t,i){this.placeHolder="",this.Focused=!1,this.InputElement=t,this._container=i,""===this.InputElement.id&&(this.InputElement.id="wijmo_input_"+e.Utility.IdCounter++),this.ScrollBarMode=e.ScrollBarMode.Fixed,this.IsControlInPreview=null,this.AddressObj=null,this.KeyActionList=null,this.UseSystemPasswordChar=!1,this.Overwrite=!1,this.Format="",this.ShowHistory=!1,this.ReadOnly=!1,this.AutoConvert=!0,this.CausesValidation=!1,this.ValidationGroup="",this.LengthAsByte=!1,this.MaxLength=0,this.MaxHistoryCount=10,this.MultiLine=!1,this.AcceptsCrLf=e.CrLfMode.NoControl,this.AcceptReturn=!0,this.AcceptTab=!1,this.HighlightText=!1,this.Ellipsis=o.None,this.EllipsisString=String.fromCharCode(8230),this.ExitOnLastChar=!1,e.Utility.IPad?this.TouchDropDownScale=1:this.TouchDropDownScale=1.5,this.ExitOnLeftRightKey=e.ExitOnLeftRightKey.None,this.EditMode=e.EditMode.Insert,this.__editModeInternal=e.EditMode.Insert,this.AutoPostBack=!1,this.PasswordMode=!1,this.PasswordChar="",this.OverflowTip=!1,this.MaxLineCount=0,this.CountWrappedLine=!1,this.IsInUpdatePanelAndAsyncPostBack=!1,this.UseClipboard=!0,this.ReadingImeStringOutput=new Object,this.ReadingImeStringOutput.OutputMode=r.Append,this.ReadingImeStringOutput.TargetControl=null,this.ScrollBars=e.ScrollBars.None,this.prevval="",this.RubyText="",this.FocusType=e.FocusType.None,this.SelectionStart=0,this.SelectionEnd=0,this.SelectionLength=0,this.OldSelectionStart=this.SelectionStart,this.OldSelectionEnd=this.SelectionEnd;var n=this,a=null!=n;if(this.IsInUpdatePanelAndAsyncPostBack?a&&(this.OldText=n.GetOldValue()):this.OldText=this.Text,this.LastStart=this.SelectionStart,this.LastEnd=this.SelectionEnd,this.Text="",this.LastText=this.Text,this.BuffText="",this.IsUndoAfterDel=!1,this.MouseButton=e.MouseButton.Left,this.EnableOnSelectStartEvent=!0,this.isLeftMouseButtonPressed=!1,this.OrientText="",this.ImeSelect=!1,this.ImeSelectTimes=0,this.DragEdit=!1,this.DropEdit=!1,this.isFuncKeyPressed=!1,this.SystemChange=!0,this.ImeMode=!1,this.KeyDownAction=!1,this.FocusExit=!1,this.lastValue="",this.truePosition=-1,this.mouseupTimes=0,this.LastInputText="",this.BeforeDragSelectionStart=0,this.BeforeDragSelectionEnd=0,this.IsMouseDown=!1,this.Type="Edit",this.ToolTip=null,!this.MultiLine&&this.OverflowTip){var l=this;e.Utility.AttachEvent(document,"mousemove",function(t){e.GlobalEventHandler.OnMouseMove(l,t)},!1)}this.HasFocus=!1;var h={SelectionStart:this.SelectionStart,SelectionEnd:this.SelectionEnd,Text:this.Text,OldSelectionStart:this.OldSelectionStart,OldSelectionEnd:this.OldSelectionEnd,OldText:this.OldText,LastStart:this.LastStart,LastEnd:this.LastEnd,LastText:this.LastText,BuffText:this.BuffText};this.DropDownEditData=h,this.IsChangedByDropDownEdit=!1,this.DropText="",this.isTextEllipsis=!1,this.TextHeadLength=0,this.IsJapanConvertKeyPress=!1,this.NeedReCalCursorPos=!0,e.Utility.IsIE()||(this.IsActive=!1),this.HasValidatedImeInput=!0,this.IsFocusToDropDownEdit=!1,this.IsCausedByClickingDropDownBt=!1,this.IsCausedByImplementingDrop=!1,e.Utility.IsIE()||(this.MaxLineCount=0,this.Ellipsis=o.None,this.OverflowTip=!1,this.IsImplementImeInput=!1),this.Create(),this.AddAllEventsHandler(),this.EditStatusChangedEvent=null,this.InvalidInputEvent=null,this.KeyExitEvent=null,this.TextChangedEvent=null,this.DropDownCloseEvent=null,this.DropDownOpenEvent=null,this.readingImeStringOutputEvent=null,this.IsjQueryControl=!0,this.UIProcess=new c(this.AutoConvert,this.Format,this.PasswordMode,this.PasswordChar,this.IsjQueryControl,this),this.Text="",this.isPasting=!1,this.WordWrap=!0,this.Enabled=!0,this.AutoCompleteType="None",""===this.InputElement.style.imeMode&&this.SetImeMode(s.Auto),this._autoComplete=new u(this),this.IsFromServer=!1,this._historyList=[],this.IsFromServer?this.EnableAutoComplete=this.ShowHistory&&"Disabled"!=this.AutoCompleteType&&!this.ReadOnly&&this.Enabled:this.EnableAutoComplete=this.ShowHistory&&!this.ReadOnly&&this.Enabled,this._lines=[],this.tempIMEMode="auto",this.HeightChangedBySet=!1,this.Width="",this.Height="",this.LastPassWordChar="",e.Utility.AttachFocusEventOfDocument(),this.ShouldShowClearButton=!0,this.switchPasswordChar=!1,""===this.InputElement.value?this.isNullText=!0:this.isNullText=!1}return t.prototype.GetId=function(){return this.InputElement.id},t.prototype.GetContainer=function(){return this._container},t.prototype.GetJQueryInputElement=function(){return i(this.InputElement)},t.prototype.GetInputElement=function(){return this.InputElement},t.prototype.Create=function(){e.Utility.IsIE10OrLater()&&this.CreateHideMSClearButtonForIE10Class()},t.prototype.CreateHideMSClearButtonForIE10Class=function(){if(void 0===t.HideMSClearButtonForIE10ClassName){t.HideMSClearButtonForIE10ClassName="gcsh_HideMSClearButtonForIE10";var i=e.Utility.CreateClassStyle(t.HideMSClearButtonForIE10ClassName+"::-ms-clear");i.style.display="none"}},t.prototype.IsNullFormat=function(){return!1},t.prototype.IsNeedFishEyeButton=function(){return e.Utility.IsIE10OrLater()&&!this.MultiLine&&this.PasswordMode},t.prototype.SetAddressObj=function(t){this.AddressObj=t},t.prototype.ShowClearButton=function(){this.InputElement.className=this.InputElement.className.replace(t.HideMSClearButtonForIE10ClassName,"")},t.prototype.HideClearButton=function(){null!=this.InputElement.className&&-1==this.InputElement.className.indexOf(t.HideMSClearButtonForIE10ClassName)&&(this.InputElement.className+=" "+t.HideMSClearButtonForIE10ClassName)},t.prototype.HandleClearButton=function(t){if(e.Utility.IsIE10OrLater()&&this.FocusedWhenMouseDown&&this.MouseDownOnClearButton&&t.target==this.InputElement&&!this.MultiLine){var i=document.activeElement==t.target,n=e.Utility.IsMouseDownOnClearButton(t);if(this.MouseUpHasValue&&i&&n&&!this.PasswordMode){var o=this;setTimeout(function(t){o.Clear()},0)}}},t.prototype.GetAcceptsTab=function(){return this.AcceptTab},t.prototype.SetAcceptsTab=function(t){t=e.Utility.CheckBool(t),this.AcceptTab=t},t.prototype.GetAcceptsCrlf=function(){return this.AcceptsCrLf},t.prototype.SetAcceptsCrlf=function(t){t=e.Utility.CheckEnum(e.CrLfMode,t),this.AcceptsCrLf=t},t.prototype.GetAutoConvert=function(){return this.AutoConvert},t.prototype.SetAutoConvert=function(t){t=e.Utility.CheckBool(t),this.AutoConvert=t,this.UIProcess.Reset()},t.prototype.GetCountWrappedLine=function(){return this.CountWrappedLine},t.prototype.SetCountWrappedLine=function(t){t=e.Utility.CheckBool(t),this.CountWrappedLine=t,this.InternalSetText(this.GetText()),this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetEditMode=function(){return this.EditMode},t.prototype.SetEditMode=function(t){var i=t;if(i=e.Utility.CheckEnum(e.EditMode,i),i===e.EditMode.Insert||i===e.EditMode.FixedInsert?this.Overwrite=!1:this.Overwrite=!0,i!==this.EditMode){var n=!1;this._isinsertGroup(i)&&this._isOverwriteGroup(this.EditMode)?n=!0:this._isinsertGroup(this.EditMode)&&this._isOverwriteGroup(i)&&(n=!0),this.EditMode=i,this.__editModeInternal=i,n&&this.UIProcess.FireEvent(this,this.EditStatusChangedEvent,null,"EditStatusChanged")}},t.prototype._getEditModeInternal=function(){return this.__editModeInternal},t.prototype._setEditModeInternal=function(t){t=e.Utility.CheckEnum(e.EditMode,t),t===e.EditMode.Insert||t===e.EditMode.FixedInsert?this.Overwrite=!1:this.Overwrite=!0,t!==this.__editModeInternal&&(this.__editModeInternal=t)},t.prototype.GetEllipsis=function(){return this.Ellipsis},t.prototype.SetEllipsis=function(t){var i=t;i=e.Utility.CheckEnum(o,i),this.Ellipsis=i,this.InternalDirectSetText(this.Text),this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetEllipsisString=function(){return this.EllipsisString},t.prototype.SetEllipsisString=function(t){t=e.Utility.CheckString(t),this.EllipsisString=t,this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetExitOnLastChar=function(){return this.ExitOnLastChar},t.prototype.SetExitOnLastChar=function(t){t=e.Utility.CheckBool(t),this.ExitOnLastChar=t},t.prototype.GetExitOnLeftRightKey=function(){switch(this.ExitOnLeftRightKey){case e.ExitOnLeftRightKey.None:return"none";case e.ExitOnLeftRightKey.Both:return"both";case e.ExitOnLeftRightKey.Left:return"left";case e.ExitOnLeftRightKey.Right:return"right"}},t.prototype.SetExitOnLeftRightKey=function(t){switch(e.Utility.CheckString(t),t.toLowerCase()){case"none":this.ExitOnLeftRightKey=e.ExitOnLeftRightKey.None;break;case"both":this.ExitOnLeftRightKey=e.ExitOnLeftRightKey.Both;break;case"left":this.ExitOnLeftRightKey=e.ExitOnLeftRightKey.Left;break;case"right":this.ExitOnLeftRightKey=e.ExitOnLeftRightKey.Right;
}},t.prototype.GetFormat=function(){return this.Format},t.prototype.SetFormat=function(t){t=e.Utility.CheckString(t),this.Format=t,this.UIProcess.Reset();var i=this.InternalSetText(this.GetText());this.Text=i,this.DropDownEditData.Text=i,this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetHighlightText=function(){return this.HighlightText},t.prototype.SetHighlightText=function(t){t=e.Utility.CheckBool(t),this.HighlightText=t},t.prototype.GetHistoryList=function(){return this._historyList},t.prototype.SetHistoryList=function(t){if(null!==t){var e;if(e=arguments[0]instanceof Array?arguments[0]:Array.prototype.slice.call(arguments),0!==e.length&&(1!==e.length||""!==e[0])){this.IsFromServer=!1,this._historyList=[];for(var i=0;i<e.length;i++)this._historyList.push(e[i])}}},t.prototype.GetImeMode=function(){return null!==this.InputElement?this.InputElement.style.imeMode||"auto":""},t.prototype.SetImeMode=function(t){e.Utility.CheckString(t),null!==this.InputElement&&(this.InputElement.style.imeMode=t)},t.prototype.GetLengthAsByte=function(){return this.LengthAsByte},t.prototype.SetLengthAsByte=function(t){t=e.Utility.CheckBool(t),this.LengthAsByte=t,this.SetText(this.UIProcess.Filter.CheckText(this.GetText()).CheckedText)},t.prototype.GetLines=function(){var t=new Array,i=this.GetText(),n="\r\n";(!e.Utility.IsIE()||e.Utility.IsIE9OrLater())&&(n="\n");for(var o=i.IndexOf(n),r=0;-1!=o;)t[r++]=i.Substring(0,o),i=i.Substring(o+n.GetLength(),i.GetLength()),o=i.IndexOf(n);return t[r]=i,t},t.prototype.SetLines=function(t){if(null!==t){var i;if(i=arguments[0]instanceof Array?arguments[0]:Array.prototype.slice.call(arguments),0!==i.length&&(1!==i.length||""!==i[0])){this._lines=[];for(var n=0;n<i.length;n++)this._lines.push(i[n]);var o="";if(this.MultiLine)for(var r=0;r<this._lines.length;r++)r>0&&(o+=e.Utility.IsIE()?"\r\n":"\n"),o+=this._lines[r];else for(var r=0;r<this._lines.length;r++)o+=this._lines[r];this.SetText(o)}}},t.prototype.GetMaxHistoryCount=function(){return this.MaxHistoryCount},t.prototype.SetMaxHistoryCount=function(t){if(t=e.Utility.CheckInt(t),0>t)throw"ArgumentOutOfRangeException";this.MaxHistoryCount=t},t.prototype.GetMaxLength=function(){return this.MaxLength},t.prototype.SetMaxLength=function(t){if(t=e.Utility.CheckInt(t),0>t)throw"ArgumentOutOfRangeException";this.MaxLength=t,this.InternalSetText(this.GetText()),this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),this.DropDownEditData.Text=this.GetText()},t.prototype.GetMaxLineCount=function(){return this.MaxLineCount},t.prototype.SetMaxLineCount=function(t){if(t=e.Utility.CheckInt(t),0>t)throw"ArgumentOutOfRangeException";this.MaxLineCount=t,this.InternalSetText(this.GetText()),this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetMultiLine=function(){return this.MultiLine},t.prototype.SetMultiLine=function(t){t=e.Utility.CheckBool(t),t!==this.MultiLine&&(this.MultiLine=t,this.InternalDirectSetText(this.Text),this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),this.DropDownEditData.Text=this.GetText())},t.prototype.GetOverflowTip=function(){return this.OverflowTip},t.prototype.SetOverflowTip=function(t){if(t=e.Utility.CheckBool(t),this.OverflowTip=t,!this.MultiLine&&this.OverflowTip){var i=this;e.Utility.AttachEvent(document,"mousemove",function(t){e.GlobalEventHandler.OnMouseMove(i,t)},!1)}},t.prototype.GetOverwrite=function(){return this.Overwrite},t.prototype.GetPasswordChar=function(){return this.PasswordChar},t.prototype.SetPasswordChar=function(t){if(""!==t){if(t=e.Utility.CheckChar(t),this.PasswordChar===this.SystemPasswordChar()&&this.GetUseSystemPasswordChar())return void(this.LastPassWordChar=t);this.LastPassWordChar=this.PasswordChar,this.PasswordChar=t,this.PasswordMode=!0,this.InternalSetText(this.GetText()),this.tempIMEMode=this.GetImeMode(),this.SetImeMode(s.Disabled)}else{if(this.UseSystemPasswordChar===!1&&(this.PasswordMode=!1,this.SetText(this.hideText),""!==this.tempIMEMode&&this.SetImeMode(this.tempIMEMode)),this.PasswordChar===this.SystemPasswordChar()&&!this.GetUseSystemPasswordChar()&&""!==this.LastPassWordChar)return this.PasswordChar=e.Utility.CheckChar(this.LastPassWordChar),this.PasswordMode=!0,this.InternalSetText(this.GetText()),this.tempIMEMode=this.GetImeMode(),this.SetImeMode(s.Disabled),this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),void 0;this.PasswordChar=t}this.switchPasswordChar=!0,this.UIProcess.Reset(),this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetReadingImeStringOutputMode=function(){return this.ReadingImeStringOutput.OutputMode},t.prototype.SetReadingImeStringOutputMode=function(t){t=e.Utility.CheckString(t),this.ReadingImeStringOutput.OutputMode=t},t.prototype.GetReadingImeStringOutputTargetControl=function(){return this.ReadingImeStringOutput.TargetControl},t.prototype.SetReadingImeStringOutputTargetControl=function(t){t=e.Utility.CheckString(t),this.ReadingImeStringOutput.TargetControl=t},t.prototype.GetReadOnly=function(){return this.ReadOnly},t.prototype.SetReadOnly=function(t){t=e.Utility.CheckBool(t),null!=this.InputElement&&(this.InputElement.readOnly=t),this.ReadOnly=t,this.IsFromServer?this.EnableAutoComplete=this.ShowHistory&&"Disabled"!=this.AutoCompleteType&&!this.ReadOnly&&t:this.EnableAutoComplete=this.ShowHistory&&!this.ReadOnly&&t},t.prototype.GetScrollBarMode=function(){return this.ScrollBarMode},t.prototype.SetScrollBarMode=function(t){t=e.Utility.CheckEnum(e.ScrollBarMode,t),this.ScrollBarMode=t,this._CheckScrollBar(this.GetScrollBars(),t)},t.prototype.GetScrollBars=function(){return this.ScrollBars},t.prototype.SetScrollBars=function(t){t=e.Utility.CheckEnum(e.ScrollBars,t),this.ScrollBars=t,this._CheckScrollBar(t,this.GetScrollBarMode());var i=this.InputElement.style.width;this.InputElement.style.width=parseInt(this.InputElement.style.width)-5+"px";var n=this;setTimeout(function(){n.InputElement.style.width=i},10)},t.prototype.GetSelectionStart=function(){return Math.min(this.SelectionStart,this.SelectionEnd)},t.prototype.SetSelectionStart=function(t){if(t=e.Utility.CheckInt(t),0>t)throw"ArgumentOutOfRangeException";if(null!=t){var i=t.toString(),n=parseInt(i);if(e.Utility.FilterText("0123456789",i)==i)if(n>this.GetText().GetLength())this.SelectionStart=this.GetText().GetLength(),this.SelectionEnd=this.GetText().GetLength(),this.MultiLine||(this.DropDownEditData.SelectionStart=this.DropDownEditData.Text.GetLength(),this.DropDownEditData.SelectionEnd=this.DropDownEditData.Text.GetLength());else{var o=this.GetSelectionLength();this.SelectionStart=n,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,n)),n-0+o<=this.GetText().GetLength()?(this.SelectionEnd=n-0+o,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,n+o))):(this.SelectionEnd=this.GetText().GetLength(),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.DropDownEditData.Text.GetLength()))}}},t.prototype.GetSelectedText=function(){return this.GetText().Substring(Math.min(this.SelectionStart,this.SelectionEnd),Math.max(this.SelectionStart,this.SelectionEnd))},t.prototype.SetSelectedText=function(t){t=e.Utility.CheckString(t),this.OldText=this.GetText();var i=this.SelectionStart,n=this.SelectionEnd,r=this.GetText();this.MultiLine||(this.DropDownEditData.OldText=this.DropDownEditData.Text,i=this.DropDownEditData.SelectionStart,n=this.DropDownEditData.SelectionEnd,r=this.DropDownEditData.Text);var s=this.UIProcess.TextBoxPaste(i,n,r,this.ExitOnLastChar,this.AcceptTab,this.AcceptReturn,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.MultiLine,t,!0);null!=s.Text&&(this.DirectSetText(s.Text),this.MultiLine||(this.DropDownEditData.Text=s.Text)),null!=s.SelectionStart&&(this.SelectionStart=s.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=s.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(this.DropDownEditData.Text,s.SelectionStart))),null!=s.SelectionEnd&&(this.SelectionEnd=s.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=s.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(this.DropDownEditData.Text,s.SelectionEnd)));var a=this.OldText;this.OldText=this.GetText(),this.LastText=this.OldText,this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.LastText=this.DropDownEditData.OldText,this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetSelectionLength=function(){return Math.abs(this.SelectionEnd-this.SelectionStart)},t.prototype.SetSelectionLength=function(t){if(t=e.Utility.CheckInt(t),0>t)throw"ArgumentOutOfRangeException";if(t=t.toString(),e.Utility.FilterText("0123456789",t)==t){var i=this.GetSelectionStart();this.SelectionStart=i,i+(t-0)<=this.GetText().GetLength()?(this.SelectionEnd=i+(t-0),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,i+parseInt(t)))):(this.SelectionEnd=this.GetText().GetLength(),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.DropDownEditData.Text.GetLength()))}},t.prototype.GetShowHistory=function(){return this.ShowHistory},t.prototype.SetShowHistory=function(t){t=e.Utility.CheckBool(t),this.ShowHistory=t,this.IsFromServer?this.EnableAutoComplete=this.ShowHistory&&"Disabled"!=this.AutoCompleteType&&!this.ReadOnly&&this.Enabled:this.EnableAutoComplete=this.ShowHistory&&!this.ReadOnly&&this.Enabled},t.prototype.GetText=function(){var t=this._getInputValueWithPlaceHolder();if(this.isTextEllipsis&&!this.DragEdit&&(t=this.Text),this.PasswordMode){var i=this.hideText,n=i.LastIndexOf(":true"),o;return o=-1==n?i:i.Substring(0,n)}return!e.Utility.IsIE()&&this.FFDragFlag&&(t=this.Text),t},t.prototype.SetText=function(t){t=e.Utility.CheckString(t),this.OldText=this.GetText(),this.switchPasswordChar=!1,this.InternalSetText(t,!1),this.GetText()!=this.OldText&&(this.OldText=this.GetText(),this.SetHideText(this.GetText())),this.LastText=this.GetText();var i=this.GetText().GetLength();this.SelectionStart=i,this.SelectionEnd=i,this.BuffText=this.LastText,this.DropDownEditData.Text=this.GetText(),this.DropDownEditData.LastText=this.DropDownEditData.Text,this.DropDownEditData.SelectionStart=i,this.DropDownEditData.SelectionEnd=i,this.DropDownEditData.BuffText=this.DropDownEditData.Text,this.Ellipsis!==o.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.GetTouchDropDownScale=function(){return this.TouchDropDownScale},t.prototype.SetTouchDropDownScale=function(t){t=e.Utility.CheckFloat(t,.25,4),this.TouchDropDownScale=t},t.prototype.GetUseClipboard=function(){return this.UseClipboard},t.prototype.SetUseClipboard=function(t){t=e.Utility.CheckBool(t),this.UseClipboard=t},t.prototype.GetUseSystemPasswordChar=function(){return this.UseSystemPasswordChar},t.prototype.SetUseSystemPasswordChar=function(t){t=e.Utility.CheckBool(t),this.UseSystemPasswordChar=t,t===!0?(this.PasswordMode=!0,this.SetPasswordChar(this.SystemPasswordChar())):this.SetPasswordChar(""),this.UIProcess.Reset()},t.prototype.GetWordWrap=function(){return this.WordWrap},t.prototype.SetWordWrap=function(t){t=e.Utility.CheckBool(t),this.WordWrap=t,t===!1?this.InputElement.style.wordWrap="normal":this.InputElement.style.wordWrap="break-word";var i=this.InputElement.style.width;this.InputElement.style.width=parseInt(this.InputElement.style.width)-5+"px";var n=this;setTimeout(function(){n.InputElement.style.width=i},10),this._CheckScrollBar(this.GetScrollBars(),this.GetScrollBarMode())},t.prototype.Drop=function(){},t.prototype.Clear=function(){this.SetText("")},t.prototype.SetFocus=function(){},t.prototype.OnDropDownClose=function(t){t=e.Utility.CheckFunction(t),this.DropDownCloseEvent=t},t.prototype.OnDropDownOpen=function(t){t=e.Utility.CheckFunction(t),this.DropDownOpenEvent=t},t.prototype.OnEditStatusChanged=function(t){t=e.Utility.CheckFunction(t),this.EditStatusChangedEvent=t},t.prototype.OnInvalidInput=function(t){t=e.Utility.CheckFunction(t),this.InvalidInputEvent=t,this.UIProcess.InvalidInputEvent=t},t.prototype.OnKeyExit=function(t){t=e.Utility.CheckFunction(t),this.KeyExitEvent=t},t.prototype.OnTextChanged=function(t){t=e.Utility.CheckFunction(t),this.TextChangedEvent=t},t.prototype.Undo=function(){var t=this.GetText(),e=this.BuffText,i=this.LastText,n=this.LastSelectionStart,o=this.LastSelectionEnd;this.MultiLine||(t=this.DropDownEditData.Text,e=this.DropDownEditData.BuffText,i=this.DropDownEditData.LastText,n=this.DropDownEditData.LastSelectionStart,o=this.DropDownEditData.LastSelectionEnd);var r=this.UIProcess.TextBoxUndo(t,e,i,n,o);return null==r?!1:(null!=r.Text&&(r.DelInclude?(this.BuffText=this.Text,this.IsUndoAfterDel=!0,this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)):(this.LastText=this.Text,this.MultiLine||(this.DropDownEditData.LastText=this.DropDownEditData.Text)),this.InternalSetText(r.Text,!0)),null!=r.SelectionStart&&(this.LastSelectionStart=this.SelectionStart,this.SelectionStart=r.SelectionStart,this.MultiLine||(this.DropDownEditData.LastSelectionStart=this.DropDownEditData.SelectionStart,this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(r.Text,r.SelectionStart))),null!=r.SelectionEnd&&(this.LastSelectionEnd=this.SelectionEnd,this.SelectionEnd=r.SelectionEnd,this.MultiLine||(this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.SelectionEnd,this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(r.Text,r.SelectionEnd))),1==r.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd),void 0)},t.prototype.Cut=function(){var t=this.SelectionStart,e=this.SelectionEnd,i=this.GetText();this.MultiLine||(t=this.DropDownEditData.SelectionStart,e=this.DropDownEditData.SelectionEnd,i=this.DropDownEditData.Text);var n=this.UIProcess.Cut(i,t,e);return null==n?!1:(null!=n.SelectionStart&&(this.SelectionStart=n.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(n.Text,n.SelectionStart))),null!=n.SelectionEnd&&(this.SelectionEnd=n.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(n.Text,n.SelectionEnd))),n.DelInclude&&(this.IsUndoAfterDel=!0,this.BuffText=this.GetText(),this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)),null!=n.Text&&(this.DirectSetText(n.Text),this.MultiLine||(this.DropDownEditData.Text=n.Text)),1==n.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd),null!=n.EventInfo&&this.UIProcess.FireEvent(this,n.EventInfo.Name,n.EventInfo.Args,n.EventInfo.Type),void 0)},t.prototype.Copy=function(){this.PasswordMode||this.UIProcess.Copy(this.GetText(),this.SelectionStart,this.SelectionEnd)},t.prototype.Delete=function(){var t=this.SelectionStart,e=this.SelectionEnd,i=this.GetText();this.MultiLine||(t=this.DropDownEditData.SelectionStart,e=this.DropDownEditData.SelectionEnd,i=this.DropDownEditData.Text);var n=this.UIProcess.Delete(this.MultiLine,i,t,e);return null==n?!1:(n.DelInclude&&(this.BuffText=this.Text,this.IsUndoAfterDel=!0,this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)),null!=n.SelectionStart&&(this.SelectionStart=n.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(n.Text,n.SelectionStart))),null!=n.SelectionEnd&&(this.SelectionEnd=n.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(n.Text,n.SelectionEnd))),null!=n.Text&&(this.DirectSetText(n.Text),this.MultiLine||(this.DropDownEditData.Text=n.Text)),1==n.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd),void 0)},t.prototype.Paste=function(t){var e=this.SelectionStart,i=this.SelectionEnd,n=this.GetText();this.MultiLine||(e=this.DropDownEditData.SelectionStart,i=this.DropDownEditData.SelectionEnd,n=this.DropDownEditData.Text);var o=this.UIProcess.TextBoxPaste(e,i,n,this.ExitOnLastChar,this.AcceptTab,this.AcceptReturn,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.MultiLine,t,!1);if(null==o)return!1;if(null!=o.SelectionStart&&(this.SelectionStart=o.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(o.Text,o.SelectionStart))),null!=o.SelectionEnd&&(this.SelectionEnd=o.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(o.Text,o.SelectionEnd))),null!=o.Text&&(this.DirectSetText(o.Text),this.MultiLine||(this.DropDownEditData.Text=o.Text)),1==o.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd),null!=o.EventInfo)for(var r=0;r<o.EventInfo.length;r++)null!=o.EventInfo[r]&&this.UIProcess.FireEvent(this,o.EventInfo[r].Name,o.EventInfo[r].Args,o.EventInfo[r].Type)},t.prototype.SelectAll=function(){var t=this.GetText();this.MultiLine||(t=this.DropDownEditData.Text);var e=this.UIProcess.TextBoxSelectAll(t);return null==e?!1:(null!=e.SelectionStart&&(this.SelectionStart=e.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(t,e.SelectionStart))),null!=e.SelectionEnd&&(this.SelectionEnd=e.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(t,e.SelectionEnd))),1==e.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd),void 0)},t.prototype._CheckScrollBar=function(t,i){switch(t){case e.ScrollBars.Both:i==e.ScrollBarMode.Automatic?(this.InputElement.style.overflowX="auto",this.InputElement.style.overflowY="auto"):(this.InputElement.style.overflowX=this.GetWordWrap()?"auto":"scroll",this.InputElement.style.overflowY="scroll");break;case e.ScrollBars.None:this.InputElement.style.overflowX="hidden",this.InputElement.style.overflowY="hidden";break;case e.ScrollBars.Vertical:i==e.ScrollBarMode.Automatic?(this.InputElement.style.overflowX="hidden",this.InputElement.style.overflowY="auto"):(this.InputElement.style.overflowX="hidden",this.InputElement.style.overflowY="scroll");break;case e.ScrollBars.Horizontal:this.InputElement.style.overflowY="hidden",i==e.ScrollBarMode.Automatic?this.InputElement.style.overflowX="auto":this.InputElement.style.overflowX=this.GetWordWrap()?"auto":"scroll"}if(e.Utility.safari||e.Utility.chrome){var n=this.InputElement.style.width;this.InputElement.style.width=parseInt(this.InputElement.style.width)-1+"px";var o=this;setTimeout(function(){o.InputElement.style.width=n},0)}e.Utility.IPad&&(this.InputElement.style.webkitOverflowScrolling="touch"),this.InternalSetText(this.GetText())},t.prototype.Select=function(){return this._isInnerKeyPressCall?void delete this._isInnerKeyPressCall:(this.SelectionStart=e.Utility.GetSelectionStartPosition(this.InputElement),this.SelectionEnd=this.SelectionStart+e.Utility.GetSelectionText(this.InputElement).GetLength(),this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd)),void 0)},t.prototype._IMSetSelection=function(t,i,n,o){var r={start:i,end:n};if(i>n){var s=i;i=n,n=s}if(e.Utility.IsIE())try{var a=t.createTextRange();if(o){for(var l=t.value,h=0,d=0,c=0,u=l.lastIndexOf("\r\n");-1!=u;)h++,u>=i&&d++,u>=n&&c++,l=l.substring(0,u),u=l.lastIndexOf("\r\n");d=h-d;var p=i;n=n,i=p-d,n=t.value.length-n-c,a.moveEnd("character",-1*parseInt(n)),a.moveStart("character",parseInt(i)),e.Utility.InnerSelect=!0,a.select(),e.Utility.InnerSelect=!1}else{var p=i;n=n,i=p,n=t.value.length-n,a.moveEnd("character",-1*parseInt(n)),a.moveStart("character",parseInt(i)),e.Utility.InnerSelect=!0,a.select(),e.Utility.InnerSelect=!1}}catch(g){}else{var p=i;n=n,i=p;try{var f=parseInt(i),m=parseInt(n);(t.selectionStart!=f||t.selectionEnd!=m)&&t.setSelectionRange(f,m)}catch(g){}}var w=t.value.substring(0,f),y=e.Utility.MeasureText(w,t).Width,v=t.scrollHeight,_=t.clientWidth,S=t.currentStyle||window.getComputedStyle(t,null);_-=parseInt(S.paddingLeft)+parseInt(S.paddingRight);var x=t.clientHeight;return x-=parseInt(S.paddingTop)+parseInt(S.paddingBottom),e.Utility.IsIE10OrLater()&&(_-=x),t.scrollLeft>y?t.scrollLeft=y:y>t.scrollLeft+_&&(t.scrollLeft=y-_+parseInt(S.paddingLeft)),t.scrollTop>v?t.scrollTop=v:v>t.scrollTop+x&&(t.scrollTop=v-x+parseInt(S.paddingTop)),r},t.prototype.SetSelection=function(t,e){this.MultiLine?this._IMSetSelection(this.InputElement,t,e,!0):this._IMSetSelection(this.InputElement,t,e),this.SelectionStart=t,this.SelectionEnd=e},t.prototype.InternalSetSelection=function(t,e){this.MultiLine?this._IMSetSelection(this.InputElement,t,e,!0):(this._IMSetSelection(this.InputElement,t,e),this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,t),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,e)),this.SelectionStart=t,this.SelectionEnd=e},t.prototype.SetInnerSelectionStart=function(t){this.SelectionStart=t,this.DropDownEditData.SelectionStart=t},t.prototype.SetInnerSelectionEnd=function(t){this.SelectionEnd=t,this.DropDownEditData.SelectionEnd=t},t.prototype.GetTrueSelection=function(t,e,i,n){var o=new Object;return o.SelectionStart=t,o.SelectionEnd=e,this.isTextEllipsis?(o.SelectionStart=this.GetTruePosition(t,i,n,this.TextHeadLength),t==e?o.SelectionEnd=o.SelectionStart:o.SelectionEnd=this.GetTruePosition(e,i,n,this.TextHeadLength),o):o},t.prototype.DropDownListValidate=function(t){for(var e=t,i=new Array,n=0,o=0;n<e.length;n++){var r=e[n];if(this.UIProcess.ListValidateCheck(e[n])){if(0!=this.MaxLength&&(r=this.UIProcess.MaxLengthCheck(r,this.MaxLength,this.LengthAsByte)),0!=this.MaxLineCount&&this.MultiLine)if(this.PasswordMode){var s=this.UIProcess.GetPasswordText(r,this.PasswordChar,this.MultiLine);s=this.UIProcess.MaxLineCheck("","",s,this.MaxLineCount,this.CountWrappedLine),r=r.Substring(0,s.GetLength())}else r=this.UIProcess.MaxLineCheck("","",r,this.MaxLineCount,this.CountWrappedLine);r==e[n]&&(i[o]=e[n],o++)}}return i},t.prototype.SystemPasswordChar=function(){var t=e.Utility.GetClientOS();switch(t.toLowerCase()){case"win2000":return"*";case"win2003":case"winxp":case"vista":case"win7":case"win8":return"●";default:return"*"}},t.prototype.InternalSetText=function(t,i,n){var o=this.UIProcess.FormatCheck(t,this.AcceptTab,this.AcceptReturn),r=o;if(0!=this.MaxLength&&(r=this.UIProcess.MaxLengthCheck(o,this.MaxLength,this.LengthAsByte)),0!=this.MaxLineCount&&this.MultiLine)if(this.PasswordMode){var s=this.UIProcess.GetPasswordText(r,this.PasswordChar,this.MultiLine);s=this.UIProcess.MaxLineCheck("","",s,this.MaxLineCount,this.CountWrappedLine),r=r.Substring(0,s.GetLength())}else r=this.UIProcess.MaxLineCheck("","",r,this.MaxLineCount,this.CountWrappedLine);return n&&(e.Utility.firefox||e.Utility.chrome)?this.DirectSetText(r,!0):this.DirectSetText(r),!this.MultiLine&&i&&(this.DropDownEditData.Text=r),r},t.prototype.DirectSetText=function(t,i){this.SystemChange=!1;var n=t;this.PasswordMode&&(n=this.UIProcess.GetPasswordText(t,this.PasswordChar,this.MultiLine)),!this.MultiLine&&!e.Utility.IsIE()&&(n=n.replace(/\r\n/g,""),n=n.replace(/\n/g,""),n=n.replace(/\r/g,"")),this.Text!=t&&(this.Text=t,this.switchPasswordChar||(this.switchPasswordChar=!1),this.GetJQueryInputElement().data("preText",t)),i||this._setInputValueWithPlaceHolder(n),this.SetHideText(t)},t.prototype.InternalDirectSetText=function(t){var e=t;this.PasswordMode&&(e=this.UIProcess.GetPasswordText(t,this.PasswordChar,this.MultiLine)),this._setInputValueWithPlaceHolder(e)},t.prototype._setInputValueWithPlaceHolder=function(t){""===t?(this.isNullText=!0,this.Focused===!1&&(t=this.placeHolder)):this.isNullText=!1,this.InputElement.value=t},t.prototype._getInputValueWithPlaceHolder=function(){return this.isNullText?"":this.InputElement.value},t.prototype.SetHideText=function(t){this.hideText!==t&&""!=this.TextChangedEvent&&null!=this.TextChangedEvent&&this.UIProcess.FireEvent(this,this.TextChangedEvent,t,"textChanged"),this.hideText=t},t.prototype.GetSingleCurPosition=function(t,e){if(0>e)return-1;var i=e;e>=t.GetLength()&&(i=t.GetLength());for(var n=t.Substring(0,i);;){var o=n.GetLength();if(n=n.replace(/\r/g,""),n=n.replace(/\n/g,""),o==n.GetLength())break}return n.GetLength()},t.prototype.GetSingleText=function(t){for(var e=t;;){var i=e.GetLength();if(e=e.replace(/\r/g,""),e=e.replace(/\n/g,""),e.GetLength()==i)break}return e},t.prototype.GetMultiPosition=function(t,e){if(0>=e)return 0;if(e>=t.GetLength())return t.GetLength();for(var i=e;i<t.GetLength();){var n=t.Substring(0,i);if(n=this.GetSingleText(n),n.GetLength()==e)break;i+=1}return i},t.prototype.GetOldValue=function(){return this.OldText},t.prototype.GetValue=function(){return this.GetText()},t.prototype.SetInnerText=function(t){this.SetText(t)},t.prototype.GetDisPlayText=function(t){var e=t;return this.PasswordMode&&(e=this.UIProcess.GetPasswordText(t,this.PasswordChar,this.MultiLine)),e},t.prototype.Focus=function(){this.oldTextValue=this._getInputValueWithPlaceHolder();var t=this.oldTextValue;if(e.Utility.IsIE()||(this.IsActive=!0),this.HasFocus=!0,this._autoComplete.GetIsFocusOnList())this._autoComplete.SetIsFocusOnList(!1);else{this._autoComplete.HideDropdown();var i;i="None"!=this.AutoCompleteType?this.GetItem(this.AutoCompleteType):this.GetItem(this.GetId(),"focus");var n=null!=i?i.sort():null;1==e.Utility.LoadComplete&&this._autoComplete.SetDataList(n)}var o=this.UIProcess.TextBoxFocus(this.FocusType,this.InputElement,this.GetText(),this.MultiLine,this.HighlightText,!1);if(e.Utility.CurrentActiveControlId=this.GetId(),null!=o){if(this.isTextEllipsis&&this.InternalDirectSetText(this.Text),null!=o.SelectionStart&&(this.SelectionStart=o.SelectionStart),null!=o.SelectionEnd&&(this.SelectionEnd=o.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart)),null!=o.SelectionStart&&null!=o.SelectionEnd){var r=this.GetTrueSelection(this.SelectionStart,this.SelectionEnd,this.Text,t);this.isTextEllipsis&&(this.SelectionStart=r.SelectionStart,this.SelectionEnd=r.SelectionEnd),this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,r.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,r.SelectionEnd))}if(1==this.UIProcess.japInput)-1!=this.truePosition&&(this.SelectionStart=this.truePosition,this.SelectionEnd=this.truePosition,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd))),this.UIProcess.japInput=!1;else if(this.FocusType!=e.FocusType.ContextMenu&&this.FocusType!=e.FocusType.ClientEvent&&this.FocusType!=e.FocusType.DropDown&&this.FocusType!=e.FocusType.DragDrop&&(this.OldText=this.GetText(),this.OldSelectionStart=this.SelectionStart,this.OldSelectionEnd=this.SelectionEnd,this.LastSelectionStart=this.OldSelectionStart,this.LastSelectionEnd=this.OldSelectionEnd,!this.MultiLine)){this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.OldSelectionStart=this.DropDownEditData.SelectionStart,this.DropDownEditData.OldSelectionEnd=this.DropDownEditData.SelectionEnd,this.DropDownEditData.LastSelectionStart=this.DropDownEditData.OldSelectionStart,this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.OldSelectionEnd;var s=this;setTimeout(function(){s.DropDownEditData.SelectionStart=s.SelectionStart,s.DropDownEditData.SelectionEnd=s.SelectionEnd},0)}1==this.ReadOnly&&this.FocusType==e.FocusType.None&&(this.SelectionStart=0,this.SelectionEnd=this.Text.length),(1==o.SetSelection||this.isTextEllipsis)&&this.SetSelection(this.SelectionStart,this.SelectionEnd),this.IsCausedByImplementingDrop&&(this.IsCausedByImplementingDrop=!1),this.FocusExit&&(this.UIProcess.MoveControl(this.InputElement,!0),this.FocusExit=!1),this.isTextEllipsis&&(this.isTextEllipsis=!1)}},t.prototype.SetInnerFocus=function(t){null!==t&&void 0!==t?this.FocusType=t:this.FocusType=e.FocusType.ClientEvent,this.InputElement.focus(),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd))},t.prototype.LoseFocus=function(t){if(e.Utility.IsIE()||(this.IsActive=!1),e.Utility.IsIE()&&this.ImeMode&&this.ReadingImeOperation(),this.ImeMode&&""!==this.InputElement.value&&(this.isNullText=!1),e.Utility.IsIE())this.ImeMode?(this.ImeInput("LoseFocusInput",void 0,t),this.ImeSelectTimes=0):this.Text!=this.GetText()&&this.InternalSetText(this.Text,!0);else if(this.ImeMode&&this.ImeInput("ReInput",!0,t),this.GetDisPlayText(this.Text)!=this._getInputValueWithPlaceHolder()){var i=this.Text;i=i.replace(/\\/g,"\\\\"),this.MultiLine?(i=i.replace(/\r/g,"\\r"),i=i.replace(/\n/g,"\\n")):(i=i.replace(/\r\n/g,""),i=i.replace(/\r/g,""),i=i.replace(/\n/g,"")),this.InternalSetText(i,!0)}if(this.HasFocus=!1,this._autoComplete.IsVisible()){if(this._autoComplete.GetIsMouseOnList())return;this._autoComplete.HideDropdown()}this.FocusType!=e.FocusType.DropDown&&(this.FocusType=e.FocusType.None);var n;n=e.Utility.IsIE()?this.GetText():this.hideText,this.OldText==n||this.UIProcess.japInput?(this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),this.hideText!=this.GetText()&&e.Utility.IsIE()&&this.SetHideText(this.GetText())):(this.OldText=this.Text,e.Utility.IsIE()&&(this.Text=this.GetText(),this.SetHideText(this.GetText())),this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),this.SystemChange&&this.oldTextValue==this.GetText()||(this.SystemChange=!0))},t.prototype.GetTruePosition=function(t,e,i,n){var o=this.EllipsisString.GetLength();if(n>=t)return t;if(t>=n+o)return e.GetLength()-i.GetLength()+t;var r=e.GetLength()-i.GetLength()+o,s=Math.floor((t-n)*r/o)+n;return s},t.prototype.DealEllipsis=function(t,i,n,r){if(this.isTextEllipsis=!1,!t&&i!=o.None){this.InternalDirectSetText(this.Text);var s=i,a=0,l=0,h=0,d=0,c=r.value,u=r.value,p="",g="",f=0,m=!0;if(r.value=c,e.Utility.GetTextBoxScrollWidth(r,this.IsControlInPreview)>r.clientWidth){this.isTextEllipsis=!0,r.value=n;var w=n;if(e.Utility.GetTextBoxScrollWidth(r,this.IsControlInPreview)>r.clientWidth)w="",c=n,u=n;else if(s==o.EllipsisPath){var y=u.LastIndexOf("\\");-1!=y&&(r.value=w+u.substr(y),e.Utility.GetTextBoxScrollWidth(r,this.IsControlInPreview)<=r.clientWidth&&(w=r.value,c=u.Substring(0,y),s=o.EllipsisEnd))}r.value=c+w;do a=r.value.GetLength(),l=Math.ceil(e.Utility.GetTextBoxScrollWidth(r,this.IsControlInPreview)/a),h=e.Utility.GetTextBoxScrollWidth(r,this.IsControlInPreview)-r.clientWidth,d=Math.ceil(h/l),s==o.EllipsisEnd?(r.value=c.Substring(0,c.GetLength()-d)+w,c=c.Substring(0,c.GetLength()-d)):s==o.EllipsisPath&&(f=Math.ceil((c.GetLength()-d)/2),p=c.substr(0,f),g=c.substr(f+d),r.value=p+w+g,c=p+g);while(e.Utility.GetTextBoxScrollWidth(r,this.IsControlInPreview)>r.clientWidth);var v=c.GetLength();do s==o.EllipsisEnd?(r.value=u.Substring(0,v+1)+w,v+=1):s==o.EllipsisPath&&(m?(g=u.substr(u.GetLength()-g.GetLength()-1),m=!1):(p=u.substr(0,p.GetLength()+1),
m=!0),r.value=p+w+g);while(e.Utility.GetTextBoxScrollWidth(r,this.IsControlInPreview)==r.clientWidth);s==o.EllipsisEnd?(r.value=u.Substring(0,v-1)+w,this.TextHeadLength=v-1):s==o.EllipsisPath&&(m?p=u.substr(0,p.GetLength()-1):g=u.substr(u.GetLength()-g.GetLength()+1),r.value=p+w+g,this.TextHeadLength=p.GetLength())}}},t.prototype.ImeInput=function(t,i,n){var o;if(o="DirectInput"!=t||i?"LoseFocusInput"==t&&this._getInputValueWithPlaceHolder()!=this.GetText()?this._getInputValueWithPlaceHolder():this.GetText():this.InputElement.value,o==this.Text)return this.lastValue=this.Text,null!=n&&e.Utility.PreventDefault(n),this.ImeMode=!1,!1;if(e.Utility.IsIE()&&this.HasValidatedImeInput)return this.InternalSetText(o,!0),!1;var r;if(""!=this.Text){var s=Math.min(this.SelectionStart,this.SelectionEnd),a=Math.max(this.SelectionStart,this.SelectionEnd),l=this.Text;if(e.Utility.IsIE()||(l=this.GetDisPlayText(this.Text)),a<l.GetLength()){var h=l.Substring(a,l.GetLength()),d=o.IndexOf(h);r=-1!=d?o.Substring(s,o.GetLength()-h.GetLength()):""}else r=o.Substring(s,o.GetLength())}else r=o;if(""!=r&&!this.MultiLine&&!this._autoComplete.IsDataListEmpty()&&this.EnableAutoComplete&&this._autoComplete.KeyUp(null,!0),"ReInput"==t&&(r=i?r.Substring(0,r.GetLength()):r.Substring(0,r.GetLength()-1)),"Record"==t)return r;var c=!1;"LoseFocusInput"==t&&(c=!0,this.UIProcess.japInput=!0),this.UIProcess.keypressResponse=!0,this.UIProcess.inputJap=!0,"ReInput"==t||!e.Utility.IsIE()&&"ClickInput"==t?this.InnerKeyPress(r,!0,c):this.InnerKeyPress(r,!1,c),this.HasValidatedImeInput=!0,this.UIProcess.inputJap=!1,this.UIProcess.japInput=!1,this.ImeMode=!1,this.ImeSelect=!1,("ReInput"==t||"ClickInput"==t)&&(this.truePosition=this.SelectionStart,this.FocusType=e.FocusType.ImeInput)},t.prototype.CanUndo=function(){return this.IsChangedByDropDownEdit?(this.IsUndoAfterDel?this.BuffText=this.GetText():this.LastText=this.GetText(),this.IsChangedByDropDownEdit=!1,!0):this.IsUndoAfterDel?this.GetText()!=this.BuffText:this.GetText()!=this.LastText},t.prototype.GetCookie=function(t){for(var e=document.cookie.split("; "),i=0;i<e.length;i++){var n=e[i].split("=");if(t==n[0]&&null!=n[1])return window.unescape(n[1])}return null},t.prototype.SetCookie=function(t,e){var i=new Date(2020,8,20);if(-1==document.cookie.IndexOf(t)){if(""!=e)for(;-1!=e.IndexOf(",");)e=e.replace(",","@#GCD#@");document.cookie=t+"="+window.escape(e)+"; expires="+i.toGMTString()}else{for(var n=document.cookie.split("; "),o="",r=0;r<n.length;r++){var s=n[r].split("=");if(t==s[0]){if(null!=s[1]){o=window.unescape(s[1]);break}return void(document.cookie=t+"="+window.escape(e.replace(",","@#GCD#@"))+"; expires="+i.toGMTString())}}if(""!=e){for(;-1!=e.IndexOf(",");)e=e.replace(",","@#GCD#@");for(var a=o.split(","),l=!1,h=0;h<a.length;h++)a[h]==e&&(l=!0);if(!l){o=e+","+o;var d=o.split(",");if(d.length>this.MaxHistoryCount){for(var c="",u=0;u<this.MaxHistoryCount;u++)c+=u!=this.MaxHistoryCount-1?d[u]+",":d[u];o=c}document.cookie=t+"="+window.escape(o)+"; expires="+i.toGMTString()}}}},t.prototype.DelCookie=function(t){document.cookie=t+"="+window.escape("")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT;"},t.prototype.DeleteItem=function(t){for(;-1!=t.IndexOf("&nbsp;");)t=t.replace("&nbsp;"," ");var e=new Date(2020,8,20),i;if(i="None"!=this.AutoCompleteType?this.GetCookie(this.AutoCompleteType):this.GetCookie(this.GetId()),null!=i)try{var n=i.split(","),o=i.split(",");if(n.length>0){var r;for(r=0;r<n.length;r++){for(;-1!=n[r].IndexOf("@#GCD#@");)n[r]=n[r].replace("@#GCD#@",",");if(-1!=n[r].IndexOf("&")){for(var s=n[r],a="";-1!=s.IndexOf("&");){s=s.replace("&","&amp;");var l=s.IndexOf("&");a+=s.Substring(0,l+5),s=s.Substring(l+5,s.GetLength())}-1==s.IndexOf("&")&&""!=s&&(a+=s),n[r]=a}for(;-1!=n[r].IndexOf("<");)n[r]=n[r].replace("<","&lt;");for(;-1!=n[r].IndexOf(">");)n[r]=n[r].replace(">","&gt;");if(n[r]==t)break}if(r<o.length&&o.length>1){var h;for(h=r;h<o.length-1;h++)o[h]=o[h+1];o[n.length-1]=null;var d="";for(h=0;h<o.length-1;h++)d+=h!=o.length-2?o[h]+",":o[h];if("None"!=this.AutoCompleteType){document.cookie=this.AutoCompleteType+"="+window.escape(d)+"; expires="+e.toGMTString();for(var c=this.GetItem(this.AutoCompleteType).sort(),r=0;r<c.length;r++)for(;-1!=c[r].IndexOf("@#GCD#@");)c[r]=c[r].replace("@#GCD#@",",");this._autoComplete.SetDataList(c)}else{document.cookie=this.GetId()+"="+window.escape(d)+"; expires="+e.toGMTString();var c=this.GetItem(this.GetId()).sort();for(r=0;r<c.length;r++)for(;-1!=c[r].IndexOf("@#GCD#@");)c[r]=c[r].replace("@#GCD#@",",");this._autoComplete.SetDataList(c)}}else this._autoComplete.SetDataList([]),"None"!=this.AutoCompleteType?document.cookie=this.AutoCompleteType+"="+window.escape("")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT;":document.cookie=this.GetId()+"="+window.escape("")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT;"}}catch(u){}},t.prototype.GetItem=function(t,e){if(this.IsFromServer){var i;if("None"!=this.AutoCompleteType&&(i=this.GetCookie(this.AutoCompleteType)),null!=i)try{for(var n=i.split(","),o=n.length>this.MaxHistoryCount?this.MaxHistoryCount:n.length,r=0;o>r;r++)for(;-1!=n[r].IndexOf("@#GCD#@");)n[r]=n[r].replace("@#GCD#@",",");if(o!=n.length){for(var s=new Array,a=0;o>a;a++)s[a]=n[a];for(;a<n.length;)this.DeleteItem(n[a]),a++;n=s}return n.length>0&&(n=this.DropDownListValidate(n)),n}catch(l){}return null}var n=this._historyList;if(n=n.sort(),null!=n)try{var o=n.length>this.MaxHistoryCount?this.MaxHistoryCount:n.length;if(void 0!==e&&"focus"===e&&(o=n.length),o!=n.length){for(var s=new Array,a=0;o>a;a++)s[a]=n[a];for(;a<n.length;)this.DeleteItem(n[a]),a++;n=s}return n.length>0&&(n=this.DropDownListValidate(n)),n}catch(l){}return null},t.prototype.ResetData=function(t){this.SetText(t.ResetData)},t.prototype.ReadingImeOperation=function(){""!=this.RubyText&&(e.Utility.FireEvent(this,this.readingImeStringOutputEvent,{readingString:this.RubyText},"readingImeStringOutput"),this.prevval="",this.RubyText="")},t.prototype.ReadingImeKeyUpProcess=function(t,i,n){var o=this.ImeMode?this.InputElement.value:this._getInputValueWithPlaceHolder(),r=o;if(this.SelectionEnd<this.Text.GetLength()){var s=this.Text.GetLength()-this.SelectionEnd;r=o.Substring(0,o.GetLength()-s)}var a=r.Substring(this.SelectionStart,r.GetLength()),l=a,h;for(h=this.prevval.length;h>=0;h--)if(a.substring(0,h)==this.prevval.substring(0,h)){l=a.substring(h);break}if(this.prevval=a,o!=this.Text||13==t||n.altKey){if(32!=t&&229!=t&&!(t>=112&&123>=t)&&37!=t&&39!=t&&38!=t&&40!=t&&27!=t&&28!=t&&29!=t&&8!=t){var d=this.ConvertReadingIMEString(l,i);e.Utility.IsIE()&&(this.ImeMode?((192==t||219==t||221==t)&&1==l.length&&2==d.length&&this.RubyText.charAt(this.RubyText.length-1)==d.charAt(0)&&(d=d.charAt(1)),this.RubyText+=d):this.ReadingImeOperation())}}else this.prevval="",this.RubyText=""},t.prototype.IsValidReadingString=function(t){if(void 0===t||null===t||0===t.length)return!1;for(var e=0;e<t.length;e++)if(!this.IsValidCharacter(t[e]))return!1;return!0},t.prototype.IsValidCharacter=function(t){var i=e.CharProcess.CharEx;if(i.IsSpace(t))return!0;var n=i.GetCharType(t),o=n&~i.Ctype.FullWidth;return o==i.Ctype.Hiragana||o==i.Ctype.Katakana||o==i.Ctype.UpperCase||o==i.Ctype.LowerCase||o==i.Ctype.Numeric||o==i.Ctype.Symbol||o==i.Ctype.MathSymbol||o==i.Ctype.Punctuation||-1!==i.CharCategory._jpnMixed.indexOf(t)?!0:!1},t.prototype.UpdateReadingIME=function(t){this.RubyText=this.ConvertReadingIMEString(t),this.ReadingImeOperation()},t.prototype.ConvertReadingIMEString=function(t,i){void 0===i&&(i=e.CharProcess.CharEx);for(var n="",o=0;o<t.length;o++){var r=t.charAt(o),s=i.ToHalfKatakana(r);"゛"==r&&(s="ﾞ"),"゜"==r&&(s="ﾟ"),"･"==s&&(s=""),n+=s}return n},t.prototype.AddAllEventsHandler=function(){var t=this;if(null!=this.GetInputElement()){var i=function(i){e.GlobalEventHandler.OnMouseDown(t,i)},n=function(i){e.GlobalEventHandler.OnMouseUp(t,i)},o=function(i){e.GlobalEventHandler.OnSelectStart(t,i)},r=function(i){e.GlobalEventHandler.OnKeyDown(t,i)},s=function(i){e.GlobalEventHandler.OnKeyPress(t,i)},a=function(i){e.GlobalEventHandler.OnKeyUp(t,i)},l=function(i){e.GlobalEventHandler.OnDblClick(t,i)},h=function(i){e.GlobalEventHandler.OnHTML5BeforeCopy(t,i)},d=function(i){e.GlobalEventHandler.OnHTML5Cut(t,i)},c=function(i){e.GlobalEventHandler.OnHTML5Paste(t,i)},u=function(i){e.GlobalEventHandler.OnDragStart(t,i)},p=function(i){e.GlobalEventHandler.OnDragEnd(t,i)},g=function(i){e.GlobalEventHandler.OnMouseOut(t,i)},f=function(i){e.GlobalEventHandler.OnDrop(t,i)},m=function(i){e.GlobalEventHandler.OnTouchStart(t,i)},w=function(i){e.GlobalEventHandler.OnTouchEnd(t,i)},y=function(i){e.GlobalEventHandler.OnSelect(t,i)};if(e.Utility.safari){var v=function(e){t._safariDropText=getSelection().toString()},_=function(e){t._safariDropText=null};this.GetJQueryInputElement().on({"dragenter.imtextbox":v,"dragleave.imtextbox":_})}var S=function(i){e.GlobalEventHandler.OnDragEnter(t,i)},x=function(i){e.GlobalEventHandler.OnDragLeave(t,i)};if(e.Utility.IsIE7OrLater()&&!e.Utility.IsIE11OrLater()){var b=function(i){e.GlobalEventHandler.OnPropertyChanged(t,i)};this.GetJQueryInputElement().on({"onpropertychange.imtextbox":b})}else{var C=function(i){e.GlobalEventHandler.OnPropertyChanged(t,i)};this.GetJQueryInputElement().on({"propertychange.imtextbox":C})}var D=function(i){e.GlobalEventHandler.OnCompositionStart(t,i)},I=function(i){e.GlobalEventHandler.OnCompositionUpdate(t,i)},j=function(i){e.GlobalEventHandler.OnCompositionEnd(t,i)};if(e.Utility.IsIE10OrLater()){var T=function(i){e.GlobalEventHandler.OnMSPointerUp(t,i)},E=function(i){e.GlobalEventHandler.OnMSPointerDown(t,i)},k=function(i){e.GlobalEventHandler.OnMSGestureTap(t,i)};this.GetJQueryInputElement().on({"MSPointerUp.imtextbox":T,"MSPointerDown.imtextbox":E,"MSGestureTap.imtextbox":k})}var L=function(i){e.GlobalEventHandler.OnEditFieldLoseFocus(t,i)},P=function(i){e.GlobalEventHandler.OnFocusOut(t,i)},M=function(i){e.GlobalEventHandler.OnEditFieldFocus(t,i)},F=function(i){e.GlobalEventHandler.OnActivate(t,i)},A=function(i){e.GlobalEventHandler.OnDeActivate(t,i)};if("Android"===e.Utility.GetClientOS()){var B=function(i){e.GlobalEventHandler.OnWebkitEditableContentChanged(t,i)};this.GetJQueryInputElement().on({"webkitEditableContentChanged.imtextbox":B})}this.GetJQueryInputElement().on({"mousedown.imtextbox":i,"mouseup.imtextbox":n,"selectstart.imtextbox":o,"keydown.imtextbox":r,"keypress.imtextbox":s,"keyup.imtextbox":a,"dblclick.imtextbox":l,"beforecopy.imtextbox":h,"cut.imtextbox":d,"paste.imtextbox":c,"dragstart.imtextbox":u,"dragend.imtextbox":p,"mouseout.imtextbox":g,"drop.imtextbox":f,"touchstart.imtextbox":m,"touchend.imtextbox":w,"select.imtextbox":y,"dragenter.imtextbox":S,"dragleave.imtextbox":x,"compositionstart.imtextbox":D,"compositionupdate.imtextbox":I,"compositionend.imtextbox":j,"blur.imtextbox":L,"focusout.imtextbox":P,"focus.imtextbox":M,"activate.imtextbox":F,"deactivate.imtextbox":A})}},t.prototype.WebkitEditableContentChanged=function(t){var e=this,i=function(){try{e.ImeInput()}finally{e.ImeMode=!1}};setTimeout(i,0)},t.prototype.KeyDown=function(t){var i=this,n=t.keyCode,o=new Object;if(o.Shift=!1,o.Ctrl=!1,o.Alt=!1,t.shiftKey&&(o.Shift=!0),t.ctrlKey&&(o.Ctrl=!0),t.altKey&&(o.Alt=!0),this.LastInputText=this.GetText(),this.isFuncKeyPressed=!1,!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete){var r=this._autoComplete.KeyDown(t);if(null!=r&&0==r)return}if(this.KeyDownAction=!0,229==n&&!this.IsJapanConvertKeyPress||13==n&&this.GetText()!=this.Text)return this.ImeMode=!0,!0;if(this.ImeMode){var s=o.Shift||o.Ctrl||20==n||n>=112&&123>=n;s=s||8==n&&!e.Utility.IsIE(),s||(this.ImeInput("ReInput",!0,t),this.ImeSelectTimes=0,this.ImeMode=!1)}229==n&&this.IsJapanConvertKeyPress&&(this.IsJapanConvertKeyPress=!1);var a=new Object;if(o.Shift&&(n|=65536),o.Ctrl&&(n|=131072),o.Alt&&40===n)var l="DropDown";o.Alt&&(n|=262144);var h=!1,d;if(null!=this.KeyActionList)for(d=0;d<this.KeyActionList.length;d++)if(this.KeyActionList[d]==n.toString()){h=!0;break}if("DropDown"==l||(262182==n||262184==n)&&!h)return!1;n>95&&106>n&&(n-=48);var c=this.SelectionStart,u=this.SelectionEnd,p=this.GetText(),g=this.BuffText,f=this.LastText,m=this.LastSelectionStart,w=this.LastSelectionEnd;if(this.MultiLine||(c=this.DropDownEditData.SelectionStart,u=this.DropDownEditData.SelectionEnd,p=this.DropDownEditData.Text,g=this.DropDownEditData.BuffText,f=this.DropDownEditData.LastText,m=this.DropDownEditData.LastSelectionStart,w=this.DropDownEditData.LastSelectionEnd),a=this.UIProcess.TextBoxKeyDown(n,o,this._getEditModeInternal(),this.Overwrite,c,u,this.ReadOnly,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.ExitOnLastChar,this.ExitOnLeftRightKey,this.MultiLine,this.PasswordMode,p,this.AcceptTab,this.AcceptReturn,g,f,m,w,l,t),null==a)return!1;if(null!=a.inputChar)return!0;1==a.InputTab&&(this.Text=this.GetText(),this.InnerKeyPress("	")),a.DelInclude&&(this.IsUndoAfterDel=!0,a.SerialDel||(this.BuffText=this.GetText(),this.LastSelectionStart=this.BuffText.GetLength(),this.LastSelectionEnd=this.BuffText.GetLength(),this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text,this.DropDownEditData.LastSelectionStart=this.DropDownEditData.BuffText.GetLength(),this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.BuffText.GetLength()))),null!=a.Text&&(1==a.Undo&&(this.LastText=this.Text,this.BuffText=this.LastText,this.MultiLine||(this.DropDownEditData.LastText=this.DropDownEditData.Text,this.DropDownEditData.BuffText=this.DropDownEditData.LastText)),this.DirectSetText(a.Text),this.MultiLine||(this.DropDownEditData.Text=a.Text));var y=this.GetSelectionLength();null!=a.SelectionStart&&(1==a.Undo&&(this.isFuncKeyPressed=!0,this.LastSelectionStart=this.SelectionStart,this.MultiLine||(this.DropDownEditData.LastSelectionStart=this.DropDownEditData.SelectionStart)),this.SelectionStart=a.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(this.DropDownEditData.Text,a.SelectionStart))),null!=a.SelectionEnd&&(1==a.Undo&&(this.LastSelectionEnd=this.SelectionEnd,this.MultiLine||(this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.SelectionEnd)),this.SelectionEnd=a.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(this.DropDownEditData.Text,a.SelectionEnd)));var v=this.GetSelectionLength();if(null!=a.KeyCode){var _=new Object;return _.KeyCode=a.KeyCode,_}if(null!=a.FocusType&&(this.FocusType=a.FocusType),null!=a.Overwrite&&this.GetOverwrite()!=a.Overwrite&&(this._getEditModeInternal()==e.EditMode.Insert?this._setEditModeInternal(e.EditMode.Overwrite):this._getEditModeInternal()==e.EditMode.Overwrite&&this._setEditModeInternal(e.EditMode.Insert)),null!=a.EventInfo)for(d=0;d<a.EventInfo.length;d++)null!=a.EventInfo[d]&&("KeyExit"==a.EventInfo[d].Type?this.EventInfo=a.EventInfo[d]:this.UIProcess.FireEvent(this,a.EventInfo[d].Name,a.EventInfo[d].Args,a.EventInfo[d].Type));return null!=a.System?(setTimeout(function(){a.System&&""===i.InputElement.value&&i.Clear()},0),a.System):(1==a.SetSelection&&(0==y&&0!=v?e.Utility.ShouldFireOnSelectStart=!0:e.Utility.ShouldFireOnSelectStart=!1,this.SetSelection(this.SelectionStart,this.SelectionEnd),e.Utility.ShouldFireOnSelectStart=!1),!1)},t.prototype.KeyPress=function(t,i,n){var o=t;if(!e.Utility.IsIE()&&this.ImeMode){var r=192==i.keyCode&&i.altKey;if(r)return this.ImeInput("ReInput",!0,i),this.ImeSelectTimes=0,this.ImeMode=!1,void 0}if(!e.Utility.IsIE()&&0==i.charCode){var s=i.keyCode||i.charCode;if(s=!this.MultiLine||!this.AcceptReturn&&this.MultiLine&&!i.ctrlKey)return!0}return this.InnerKeyPress(o,n)},t.prototype.KeyUp=function(t){!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&(8!=t.keyCode&&46!=t.keyCode&&9!=t.keyCode||""!=this.GetText()?this.isFuncKeyPressed?this._autoComplete.HideDropdown():this.LastInputText!=this.GetText()&&""!=this.GetText()&&this._autoComplete.KeyUp(t):this._autoComplete.GetIsDeleteItem()||this._autoComplete.HideDropdown(),this._autoComplete.SetIsDeleteItem(!1)),this.KeyDownAction=!1;var i=t.keyCode,n=e.CharProcess.CharEx;if(13==i&&this._getInputValueWithPlaceHolder()!=this.Text&&(e.Utility.IsIE()&&this.ImeMode?this.HasValidatedImeInput=!1:e.Utility.IsIE()||(this.ImeMode=!0)),1==this.ImeMode){var o=this._getInputValueWithPlaceHolder(),r=o;if(this.SelectionEnd<this.Text.GetLength()){var s=this.Text.GetLength()-this.SelectionEnd;r=o.Substring(0,o.GetLength()-s)}r=r.Substring(r.GetLength()-1,r.GetLength()),13==i?(this.ImeInput("DirectInput",void 0,t),this.ImeSelectTimes=0):i>=48&&57>=i||i>=96&&105>=i?(i>=96&&(i-=48),r=n.ToHalfWidth(r),r==String.fromCharCode(i)||this.ImeSelect?r==String.fromCharCode(i)&&this.ImeSelectTimes<1?this.HasValidatedImeInput=!1:this.ImeSelect||(this.ImeInput("ReInput",void 0,t),this.HasValidatedImeInput=!1,this.ImeMode=!0):this.HasValidatedImeInput=!1,this.ImeSelectTimes=0):32==i?0==this.ImeSelect&&(1==this.ImeSelectTimes?this.ImeSelect=!0:n.ToHalfWidth(r)!=String.fromCharCode(i)?this.ImeSelectTimes++:this.HasValidatedImeInput&&(this.UIProcess.inputJap=!0,e.Utility.IsIE()&&(this.HasValidatedImeInput=!1),this.ImeInput("DirectInput",void 0,t),this.ImeSelectTimes=0)):i>=65&&90>=i?(this.ImeSelectTimes=0,this.HasValidatedImeInput=!1):32==i||106==i||107==i||109==i||173==i&&e.Utility.IsFireFox4OrLater()||110==i||111==i||219==i||220==i||221==i||222==i||i>=186&&192>=i||226==i?(this.ImeSelectTimes>=1&&this.ImeInput("ReInput",void 0,t),this.ImeSelectTimes=0,e.Utility.IsIE()&&(this.HasValidatedImeInput=!1)):40==i||38==i?0==this.ImeSelect&&1==this.ImeSelectTimes&&(this.ImeSelect=!0):8==i||46==i?this.ImeSelectTimes=0:27==i?this.ImeSelectTimes=0:244==i?this.IsJapanConvertKeyPress=!0:e.Utility.IsIE()||243!=i?e.Utility.IsIE()&&229==i&&(this.HasValidatedImeInput=!1):(this.ImeInput("ReInput",!0,t),this.ImeSelectTimes=0,this.ImeMode=!1)}if(242==i&&this.ImeInput("ReInput",!0,t),this.ReadingImeKeyUpProcess(i,n,t),1==this.UIProcess.keyupResponse){this.UIProcess.keyupResponse=!1;var a=this.UIProcess.TextBoxKeyUp(this.InputElement,this.MultiLine,this.SelectionStart,this.SelectionEnd,this.GetText()),l=this.SelectionStart,h=this.SelectionEnd,d=!1,c=!1;this.MultiLine||(l=this.DropDownEditData.SelectionStart,h=this.DropDownEditData.SelectionEnd),null!=a.SelectionStart&&this.SelectionStart!=a.SelectionStart&&(d=!0,this.SelectionStart=a.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart))),null!=a.SelectionEnd&&this.SelectionEnd!=a.SelectionEnd&&(this.SelectionEnd=a.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart),c=!0,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd)));var u=this._getInputValueWithPlaceHolder(),p=this.MultiLine?this.Text:this.GetSingleText(this.Text),g=p.GetLength()-u.GetLength(),f;this.MultiLine?this.PasswordMode?0!=g&&(f=this.Text,d&&c?p=f.Substring(0,this.SelectionStart)+f.Substring(h,f.GetLength()):d||(h=this.SelectionStart+g,p=f.Substring(0,l)+f.Substring(h,f.GetLength()))):p=this.GetText():(0!=g&&(f=this.DropDownEditData.Text,d&&c?this.DropDownEditData.Text=f.Substring(0,this.DropDownEditData.SelectionStart)+f.Substring(h,f.GetLength()):d||(h=this.GetMultiPosition(f,this.SelectionStart+g),this.DropDownEditData.Text=f.Substring(0,l)+f.Substring(h,f.GetLength()))),p=this.GetSingleText(this.DropDownEditData.Text)),1==a.SystemEdit&&(this.Text=p,this.SetHideText(p)),null!=a.Text&&this.InternalSetText(a.Text,!0),1==a.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd)}},t.prototype.PropertyChange=function(t){if(null!=t&&e.Utility.IsIE10OrLater()&&"value"==t.propertyName,this.DragEdit)this.DragEdit=!1,this.MultiLine||this.Text!=this.GetText()&&(this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.Text=this.DropDownEditData.Text.Substring(0,this.DropDownEditData.SelectionStart)+this.DropDownEditData.Text.Substring(this.DropDownEditData.SelectionEnd,this.DropDownEditData.Text.GetLength()),this.DropDownEditData.LastText=this.DropDownEditData.OldText,this.DropDownEditData.SelectionEnd=this.DropDownEditData.SelectionStart),this.OldText=this.Text,this.Text=this.GetText(),this.SetHideText(this.GetText()),this.SystemChange=!0,this.LastText=this.OldText,this.SetSelectionLength(0);else if(this.DropEdit){this.DropEdit=!1,this.FocusType=e.FocusType.DragDrop,this.SelectionStart=e.Utility.GetSelectionStartPosition(this.InputElement),this.SelectionEnd=this.SelectionStart+e.Utility.GetSelectionText(this.InputElement).GetLength();var i=this._getInputValueWithPlaceHolder();if(this.MultiLine){if(this.PasswordMode){var n=this.SelectionEnd-this.DropText.GetLength();i=this.Text.Substring(0,n)+this.DropText+this.Text.Substring(n,this.Text.GetLength())}}else{var o,r=this.GetSingleText(this.DropDownEditData.Text),s=i.GetLength()-r.GetLength();o=this.PasswordMode?this.DropText:i.Substring(this.SelectionEnd-s,this.SelectionEnd),0!=s&&(this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd-s),this.DropDownEditData.Text=this.DropDownEditData.Text.Substring(0,this.DropDownEditData.SelectionStart)+o+this.DropDownEditData.Text.Substring(this.DropDownEditData.SelectionStart,this.DropDownEditData.Text.GetLength()),this.DropDownEditData.LastText=this.DropDownEditData.OldText,this.DropDownEditData.SelectionEnd=this.DropDownEditData.SelectionStart+s),this.PasswordMode&&(i=this.GetSingleText(this.DropDownEditData.Text))}this.OldText=this.Text,this.Text=i,this.SetHideText(i),this.SystemChange=!0,this.LastText=this.OldText}else!this.MultiLine&&!this.isTextEllipsis&&!this.PasswordMode&&this.SetHideText(this.GetText());return!1},t.prototype.MouseDown=function(t){var i=e.Utility.GetMouseButton(t);if(this.FocusedWhenMouseDown=document.activeElement==t.target,this.MouseDownOnClearButton=e.Utility.IsMouseDownOnClearButton(t),e.Utility.IsIE()||(this.IsActive=!0,this.ImeMode&&i==e.MouseButton.Left&&(this.IsImplementImeInput=!0)),this.MouseButton=i,this.BeforeDragSelectionStart=this.SelectionStart,this.BeforeDragSelectionEnd=this.SelectionEnd,this.MouseButton==e.MouseButton.Right)this.FocusType!=e.FocusType.ClientEvent&&(this.FocusType=e.FocusType.Click);else{this.isLeftMouseButtonPressed=!0,this.FocusType!=e.FocusType.ClientEvent&&(this.FocusType=e.FocusType.Click);try{var n=e.Utility.GetSelectionText(this.InputElement);""!=n&&(this.IsMouseDown=!0,e.Utility.ClearSelection(this.InputElement))}catch(o){}}var r=this.UIProcess.TextBoxMouseDown(this.InputElement,i);null!=r&&(null!=r.SelectionStart&&(this.SelectionStart=r.SelectionStart),null!=r.SelectionEnd&&(this.SelectionEnd=r.SelectionEnd))},t.prototype.MouseUp=function(t){var i=null;if(e.Utility.IsIE()&&this.ImeMode&&this.ReadingImeOperation(),this.IsMouseDown=!1,e.Utility.IsIE()&&(this.ImeMode||this.Text!=this.GetText()))this.ImeMode?(this.ImeInput("ClickInput",void 0,t),this.ImeSelectTimes=0):this.InternalSetText(this.Text,!0);else if(e.Utility.IsIE()||!this.ImeMode&&this.GetDisPlayText(this.Text)==this._getInputValueWithPlaceHolder()){this.isLeftMouseButtonPressed=!1,this.LastStart=this.SelectionStart,this.LastEnd=this.SelectionEnd;var n=this.SelectionStart,o=this.SelectionEnd,r=this.GetText(),s=null;null!=i&&null!=i.Ctrl&&(s=i.Ctrl);var a=this.UIProcess.TextBoxMouseUp(this.InputElement,n,o,this.MouseButton,this.MultiLine,r,s,this.HighlightText,t);if(null==a)return;null!=a.SelectionStart&&(this.SelectionStart=a.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart))),null!=a.SelectionEnd&&(this.SelectionEnd=a.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd))),1==a.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd)}else{if(!this.IsImplementImeInput)return;if(this.ImeInput("ClickInput",void 0,t),this.ImeSelectTimes=0,this.GetDisPlayText(this.Text)!=this._getInputValueWithPlaceHolder()){this.IsImplementImeInput=!1;var l=this.Text;this.MultiLine?(l=l.replace(/\r/g,"\\r"),l=l.replace(/\n/g,"\\n")):(l=l.replace(/\r\n/g,""),l=l.replace(/\r/g,""),l=l.replace(/\n/g,""));var h=this;window.setTimeout(function(){h.InternalSetText(l,!0)},0),this.Select()}}this.MouseButton=e.MouseButton.Left,void 0==this.MouseUpPointerType&&(this.MouseUpHasValue=t.target.value.length>0),this.HandleClearButton(t)},t.prototype.MouseWheel=function(t){},t.prototype.ShouldCancelMouseWheelDefaultBehavior=function(){return!1},t.prototype.MouseOut=function(){if(1==this.IsMouseDown&&(4===this.MouseUpPointerType||void 0==this.MouseUpPointerType||"mouse"===this.MouseUpPointerType)){var t=Math.min(this.BeforeDragSelectionStart,this.BeforeDragSelectionEnd),i=Math.max(this.BeforeDragSelectionStart,this.BeforeDragSelectionEnd),n=this.GetText().Substring(t,i);""!=n&&(this.SetSelection(this.BeforeDragSelectionStart,this.BeforeDragSelectionEnd),e.Utility.DragDrop(this.InputElement)),this.IsMouseDown=!1}},t.prototype.DoubleClick=function(){!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&!this.ReadOnly&&this._autoComplete.ShowDropdown();var t=this.UIProcess.TextBoxDoubleClick(this.InputElement,this.SelectionStart,this.GetText());return null!=t.SelectionStart&&(this.SelectionStart=t.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart))),null!=t.SelectionEnd&&(this.SelectionEnd=t.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd)),this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart)),1==t.SetSelection&&this.SetSelection(this.SelectionStart,this.SelectionEnd),!0},t.prototype.DragStart=function(t){this.PasswordMode?t.dataTransfer.effectAllowed="none":this.DragEdit=!0},t.prototype.DragEnd=function(){this.DragEdit=!0},t.prototype.DragEnter=function(){this.isTextEllipsis&&this.InternalDirectSetText(this.GetText())},t.prototype.DragLeave=function(){this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},t.prototype.MouseMove=function(t){},t.prototype.MouseOver=function(){},t.prototype._isinsertGroup=function(t){return t==e.EditMode.Insert||t==e.EditMode.FixedInsert},t.prototype._isOverwriteGroup=function(t){return t==e.EditMode.Overwrite||t==e.EditMode.FixedOverwrite},t.prototype.InnerKeyPress=function(t,e,i){var n=t,o;this.ImeMode||this.isPasting?o=this.Text:(o=this._getInputValueWithPlaceHolder(),""!=o&&(o=this.GetText())),this.isPasting=!1;var r=this.SelectionStart,s=this.SelectionEnd;this.MultiLine||(r=this.DropDownEditData.SelectionStart,s=this.DropDownEditData.SelectionEnd);var a=this.UIProcess.TextBoxKeyPress(r,s,n,o,this.MaxLength,this.LengthAsByte,this.ExitOnLastChar,this.Overwrite,this.MultiLine,this.MaxLineCount,this.CountWrappedLine);if(null!=a.Text&&(a.DelInclude&&(this.BuffText=this.GetText(),this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)),this.DirectSetText(a.Text,e),this.MultiLine||(this.DropDownEditData.Text=a.Text)),null!=a.SelectionStart&&(this.SelectionStart=a.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(a.Text,a.SelectionStart))),null!=a.SelectionEnd&&(this.SelectionEnd=a.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(a.Text,a.SelectionEnd))),1==a.SetSelection&&!e&&!i&&(this._isInnerKeyPressCall=!0,this.SetSelection(this.SelectionStart,this.SelectionEnd)),null!=a.EventInfo)for(var l=0;l<a.EventInfo.length;l++)null!=a.EventInfo[l]&&this.UIProcess.FireEvent(this,a.EventInfo[l].Name,a.EventInfo[l].Args,a.EventInfo[l].Type);return 1==a.SystemEdit?!0:!1},t.prototype._isSupportClipBoard=function(){if(!this.GetUseClipboard())return!0;if(e.Utility.IsIE())return!0;if(e.Utility.IsFireFox4OrLater())try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var t=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!t)return;var i=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!i)return;i.addDataFlavor("text/unicode"),t.getData(i,t.kGlobalClipboard);var n=new Object,o=new Object;try{i.getTransferData("text/unicode",n,o)}catch(r){return null}if(n&&(n=Components.interfaces.nsISupportsWString?n.value.QueryInterface(Components.interfaces.nsISupportsWString):Components.interfaces.nsISupportsString?n.value.QueryInterface(Components.interfaces.nsISupportsString):null),n)return n.data.substring(0,o.value/2)}catch(s){return!1}return!1},t.prototype.MSPointerUp=function(t){null!=t&&(this.MouseUpPointerType=t.pointerType,this.MouseUpHasValue=(t.srcElement||t.target).value.length>0)},t.prototype.CompositionStart=function(t){this.ImeMode=!0,this._lastCompositionText="",this._lastCompositionOffset=0,this._convertedOnLastUpdate=!1,this._cachedReadingString="",this._readingString="",this._compositionUpdateFired=!1},t.prototype.CompositionUpdate=function(t){if(this._compositionUpdateFired=!0,void 0!==t.originalEvent.data&&0!==t.originalEvent.data.length){var e=this.InputElement.selectionStart-t.originalEvent.data.length;if(e>this._lastCompositionOffset){if(!this._convertedOnLastUpdate){var i=this._lastCompositionText.substring(0,e-this._lastCompositionOffset);this.IsValidReadingString(i)?this._cachedReadingString+=i:this._cachedReadingString+=this._readingString,this._readingString="",this._convertedOnLastUpdate=!0}}else this._convertedOnLastUpdate&&(this._convertedOnLastUpdate=!1);this.IsValidReadingString(t.originalEvent.data)&&(this._readingString=t.originalEvent.data)}},t.prototype.CompositionEnd=function(t){var i=this.HasValidatedImeInput;this.ImeMode=!0,this.HasValidatedImeInput=!1;var n=this,o=function(){try{n.ImeInput("DirectInput",void 0,t)}finally{n.ImeMode=!1}};e.Utility.IsIE9OrLater()?o():setTimeout(o,0),this._compositionUpdateFired||this.CompositionUpdate(t),this._convertedOnLastUpdate=!1;var r=this._cachedReadingString+this._readingString;this._cachedReadingString="",this._readingString="",0!==t.originalEvent.data.length&&0!==r.length&&(this.UpdateReadingIME(r),(e.Utility.IPad&&e.Utility.safari||e.Utility.chrome&&"Android"===e.Utility.GetClientOS())&&(this.HasValidatedImeInput=i,this.ImeMode=!1))},t.prototype.SelectStart=function(t){if(this.ImeMode)return!1;if(this.isLeftMouseButtonPressed){var e=this.UIProcess.SelectStart(this.InputElement,t,this.MultiLine);null!=e.SelectionStart&&(this.SelectionStart=e.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,e.SelectionStart))),null!=e.SelectionEnd&&(this.SelectionEnd=e.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,e.SelectionEnd)))}},t.prototype.DragDrop=function(t){if(!p.Utility.IsIE()&&this.ReadOnly)return!1;this.FFDragFlag=!1,p.Utility.IsIE()||(this.FFDragFlag=!0),!p.Utility.IsIE()&&!p.Utility.safari&&this.SetInnerFocus();var e=p.Utility.GetSelectionStartPosition(this.InputElement),i=e,n=this.UIProcess.DragDrop(t,this.ExitOnLastChar,e,i,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.MultiLine,this.GetText());if(null!=n){if(null!=n.DropText){var o,r;if(this.PasswordMode){var s=this.UIProcess.GetPasswordText(n.DropText,this.PasswordChar,this.MultiLine);p.Utility.IsIE()?(window.event.dataTransfer.setData("Text",s),s!=window.event.dataTransfer.getData("Text")&&(o=this.GetText(),
r=o+n.DropText,this.InternalSetText(r,!0),p.Utility.PreventDefault(window.event))):(o=this.GetText(),r=o+n.DropText,this.InternalSetText(r,!0,!0)),this.DropText=n.DropText}else if(p.Utility.IsIE())if(event.dataTransfer.setData("Text",n.DropText),n.DropText!=event.dataTransfer.getData("Text"))o=this.GetText(),r=o+n.DropText,this.InternalSetText(r,!0),p.Utility.PreventDefault(event);else{var a=this;setTimeout(function(){var t=a.GetText();a.InternalSetText(t,!0)},0)}else o=this.GetText(),r=o+n.DropText,this.InternalSetText(r,!0,!0);this.DropEdit=!0}if(null!=n.EventInfo)for(var l=0;l<n.EventInfo.length;l++)null!=n.EventInfo[l]&&null!=n.EventInfo[l].Name&&(this.UIProcess.FireEvent(this,n.EventInfo[l].Name,n.EventInfo[l].Args,n.EventInfo[l].Type),n.EventInfo[l].Name==this.KeyExitEvent&&(this.FocusExit=!0));this.FFDragFlag=!1;var h=this,d=this.MultiLine,c=this.Ellipsis,u=this.EllipsisString,p=this.InputElement;return setTimeout(function(){h.InternalSetText(h.GetText()),h.DealEllipsis(d,c,u,p)},0),!0}},t.prototype.MSGestureTap=function(t){if(this.Focused&&!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&!this.ReadOnly){var e=this;setTimeout(function(){e.Focused&&e._autoComplete.ShowDropdown()},400)}},t.prototype.MSPointerDown=function(t){if(this.Focused&&(t.pointerType===t.MSPOINTER_TYPE_TOUCH||"touch"===t.pointerType)&&!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&!this.ReadOnly){var e=new MSGesture;e.target=t.target,e.addPointer(t.pointerId)}},t.prototype.GetShowLiterals=function(){return e.ShowLiterals.Always},t}();e.IMTextBox=d;var c=function(t){function n(e,i,n,o,r,s){t.call(this),this.isMulSelected=!1,this.isOverWrite=!1,this.ForwardSelection="None",this.isCtrlPress=!1,this.isCtrlClick=!1,this.isDblClick=!1,this.isTriClick=!1,this.isInputValid=!0,this.ctrlDelete=!1,this.ctrlBackspace=!1,this.IsDelInclude=!1,this.IsSerialDel=!1,this.StartPos=null,this.LastKey=null,this.keypressResponse=!1,this.systemEdit=!1,this.keyupResponse=!1,this.japInput=!1,this.inputJap=!1,this.IsKeyDown=!1,this.CurStart=0,this.CurEnd=0,this.control=s,this.Owner=s,this.Filter=new g(e,i),this.IsjQueryControl=r,this.PasswordMode=n,this.PasswordChar=o}return __extends(n,t),n.prototype.Reset=function(){this.Filter=new g(this.control.AutoConvert,this.control.Format),this.PasswordMode=this.control.PasswordMode,this.PasswordChar=this.control.GetPasswordChar()},n.prototype.TextBoxKeyDown=function(t,i,n,o,r,s,a,l,h,d,c,u,p,g,f,m,w,y,v,_,S,x,b,C){i.Ctrl?this.isCtrlPress=!0:this.isCtrlPress=!1;var D=new Object;switch(n){case e.EditMode.Insert:this.isOverWrite=!1;break;case e.EditMode.Overwrite:this.isOverWrite=!0;break;case e.EditMode.FixedInsert:this.isOverWrite=!1;break;case e.EditMode.FixedOverwrite:this.isOverWrite=!0}r!=s?this.isMulSelected=!0:this.isMulSelected=!1;var I;switch(b){case"Clear":return a||(D.SelectionStart=0,D.SelectionEnd=0,D.Text="",D.DelInclude=!0,this.IsDelInclude=!0),D;case"NextControl":return I=this.MoveControl(this.control.InputElement,!0,!1,"NextControl"),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0),D;case"PreviousControl":return I=this.MoveControl(this.control.InputElement,!1,!1,"PreviousControl"),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0),D}if(a&&131117!=t&&131139!=t&&9!=t&&65545!=t&&131081!=t&&196617!=t&&131137!=t&&37!=t&&39!=t&&38!=t&&40!=t)return D;var j;switch(t){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 116:case 121:case 123:D.System=!0;break;case 45:var T;if(n===e.EditMode.FixedInsert)T=!1;else if(n===e.EditMode.FixedOverwrite)T=!0;else if(T=!o,""!=this.EditStatusChangedEvent&&null!=this.EditStatusChangedEvent){var E=new Object;E.Name=this.EditStatusChangedEvent,E.Args=null,E.Type="EditStatusChanged",D.EventInfo=new Array,D.EventInfo[0]=E}D.Overwrite=T;break;case 13:g&&y?(this.keypressResponse=!0,this.keyupResponse=!0,D.System=!0):g&&!y?(D.System=!1,D.IsDoPostBack=!0):(this.keypressResponse=!0,this.keyupResponse=!1,D.System=!0);break;case 131085:g&&(this.systemEdit=!0,this.keypressResponse=!0,this.keyupResponse=!0,D.System=!0);break;case 9:case 65545:g&&w&&!a?(this.keypressResponse=!0,D.InputTab=!0):(D.System=!0,I=new Object,""!=this.KeyExitEvent&&null!=this.KeyExitEvent&&(I.Name=this.KeyExitEvent,I.Args={Key:9==t?e.ExitKeys.Tab:e.ExitKeys.ShiftTab},I.Type="KeyExit"),D.EventInfo=new Array,D.EventInfo[0]=I,g&&(D.SelectionStart=m.GetLength(),D.SelectionEnd=m.GetLength()));break;case 131081:I=this.MoveControl(this.control.InputElement,!0,!1,"NextControl"),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0);break;case 196617:I=this.MoveControl(this.control.InputElement,!1,!1,"PreviousControl"),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0);break;case 8:case 65544:this.systemEdit=!0,this.keyupResponse=!0,this.DelOperation(t,r,s),D.DelInclude=!0,D.SerialDel=this.IsSerialDel,D.System=!0;break;case 46:this.systemEdit=!0,this.keyupResponse=!0,this.DelOperation(t,r,s),D.DelInclude=!0,D.SerialDel=this.IsSerialDel,D.System=!0;break;case 131080:case 196616:this.isMulSelected?(this.keyupResponse=!0,this.ctrlBackspace=!0):(this.systemEdit=!0,this.keyupResponse=!0,D.System=!0),this.DelOperation(t,r,s),D.SerialDel=this.IsSerialDel,D.DelInclude=!0;break;case 131118:this.keyupResponse=!0,D.System=!0,this.DelOperation(t,r,s),D.SerialDel=this.IsSerialDel,D.DelInclude=!0,D.KeyCode=39,this.ctrlDelete=!0;break;case 131139:case 131117:if(f)D.System=!1;else{var k;k=void 0===this.Owner?this.control:this.Owner,k._isSupportClipBoard()?this.Copy(m,r,s):D.System=!0}break;case 65581:case 131158:k=void 0===this.Owner?this.control:this.Owner,k._isSupportClipBoard()?D=this.TextBoxPaste(r,s,m,u,w,y,l,h,d,c,g):D.System=!0;break;case 131160:f?D.System=!1:(k=void 0===this.Owner?this.control:this.Owner,k._isSupportClipBoard()?D=this.Cut(m,r,s):D.System=!0);break;case 65582:r!=s?D=this.Cut(m,r,s):(this.systemEdit=!0,this.keyupResponse=!0,D.KeyCode=8),this.DelOperation(t,r,s),D.SerialDel=this.IsSerialDel,D.DelInclude=!0;break;case 131137:D=this.TextBoxSelectAll(m);break;case 131162:D=this.TextBoxUndo(m,v,_,S,x,r,s);break;case 65573:this.ForwardSelection="Left",D.System=!0,this.keyupResponse=!0;break;case 65575:this.ForwardSelection="Right",D.System=!0,this.keyupResponse=!0;break;case 65574:g?(this.ForwardSelection="Left",D.System=!0,this.keyupResponse=!0):(s>0&&(D.SelectionEnd=s-1),D.SetSelection=!0);break;case 65576:g?(this.ForwardSelection="Right",D.System=!0,this.keyupResponse=!0):(s<m.GetLength()&&(D.SelectionEnd=s+1),D.SetSelection=!0);break;case 65569:this.ForwardSelection="Left",D.System=!0,this.keyupResponse=!0;break;case 65570:this.ForwardSelection="Right",D.System=!0,this.keyupResponse=!0;break;case 196645:this.ForwardSelection="Left",D.System=!0,this.keyupResponse=!0;break;case 196647:this.ForwardSelection="Right",D.System=!0,this.keyupResponse=!0;break;case 65572:case 196644:this.ForwardSelection="Left",D.System=!0,this.keyupResponse=!0;break;case 65571:case 196643:this.ForwardSelection="Right",D.System=!0,this.keyupResponse=!0;break;case 37:case 131109:if(j=!1,this.IsKeyDown?j=!0:(this.IsKeyDown=!0,this.CurStart=r,this.CurEnd=s),j&&0===this.CurStart&&0==this.CurEnd&&(p===e.ExitOnLeftRightKey.Both||p===e.ExitOnLeftRightKey.Left)){var L=37===t?"Left":"CtrlLeft";I=this.MoveControl(this.control.InputElement,!1,!0,L),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0),this.IsKeyDown=!1;break}if(this.CurStart-=1,this.CurEnd=this.CurStart,0!==r||0!==s||p!==e.ExitOnLeftRightKey.Both&&p!==e.ExitOnLeftRightKey.Left)a||(this.keyupResponse=!0),D.System=!0;else{var L=37===t?"Left":"CtrlLeft";I=this.MoveControl(this.control.InputElement,!1,!0,L),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0)}break;case 39:case 131111:if(j=!1,this.IsKeyDown?j=!0:(this.IsKeyDown=!0,this.CurStart=r,this.CurEnd=s),j&&this.CurStart===m.GetLength()&&this.CurEnd===m.GetLength()&&(p===e.ExitOnLeftRightKey.Both||p===e.ExitOnLeftRightKey.Right)){var L=39==t?"Right":"CtrlRight";I=this.MoveControl(this.control.InputElement,!0,!0,L),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0),this.IsKeyDown=!1;break}if(this.CurStart+=1,this.CurEnd=this.CurStart,r!==m.GetLength()||s!==m.GetLength()||p!==e.ExitOnLeftRightKey.Both&&p!==e.ExitOnLeftRightKey.Right)a||(this.keyupResponse=!0),D.System=!0;else{var L=39==t?"Right":"CtrlRight";I=this.MoveControl(this.control.InputElement,!0,!0,L),null!=I&&(D.EventInfo=new Array,D.EventInfo[0]=I.EventInfo,D.FocusType=I.FocusType,D.FocusExit=!0)}break;case 33:case 131105:this.keyupResponse=!0,g?D.System=!0:D.System=!1;break;case 34:case 131106:this.keyupResponse=!0,g?D.System=!0:D.System=!1;break;case 38:a||(this.keyupResponse=!0),this.Owner.GetMultiLine()?D.System=!0:D.System=!1;break;case 40:a||(this.keyupResponse=!0),this.Owner.GetMultiLine()?D.System=!0:D.System=!1;break;case 131108:case 36:this.keyupResponse=!0,D.System=!0;break;case 131107:case 35:this.keyupResponse=!0,D.System=!0;break;case 131112:case 131110:this.keyupResponse=!0,D.System=!0;break;case 27:this.control.Clear()}if(void 0!==t&&null!==t){if(t>=48&&57>=t||t>=65&&90>=t||t>=96&&105>=t||229==t||0==t||231==t)return this.keypressResponse=!0,null==D&&(D={}),D.System=!0,D.inputChar=!0,D;if(32==t||106==t||107==t||109==t||173==t&&e.Utility.IsFireFox4OrLater()||110==t||111==t||219==t||220==t||221==t||222==t||t>=186&&192>=t||226==t||231==t)return this.keypressResponse=!0,D.System=!0,D;if(!e.Utility.IsIE()&&(61===t||59===t))return this.keypressResponse=!0,D.System=!0,D;if(C.shiftKey)var P=t-65536;if(P>=48&&57>=P||P>=65&&90>=P||P>=96&&105>=P||229==P)return this.keypressResponse=!0,D.System=!0,D;if(32==P||106==P||107==P||109==P||173==t&&e.Utility.IsFireFox4OrLater()||110==P||111==P||219==P||220==P||221==P||222==P||P>=186&&192>=P||226==P||231==P)return this.keypressResponse=!0,D.System=!0,D;if(!e.Utility.IsIE()&&(61==P||59==P))return this.keypressResponse=!0,D.System=!0,D}return D},n.prototype.TextBoxKeyPress=function(t,n,o,r,s,a,l,h,d,c,u){if(1==this.keypressResponse){this.keypressResponse=!1,this.isInputValid=!0;var p=new Object,g=new Object,f="\r\n";(!e.Utility.IsIE()||parseInt(i.browser.version)>=9)&&(f="\n");var m="";if("	"==o)m=o;else if("\r"==o||"\n"==o){if(!d)return p.SystemEdit=!0,p;m=f}else if(1==o.GetLength())m=this.Filter.Check(o);else{var w=this.Filter.CheckText(o);m=w.CheckedText,this.isInputValid=w.IsInputValid}if(t==n){if(0!=s){var y=s-this.GetLength(r,a);if(m==f)y<f.GetLength()&&0!=s&&(m="");else if(!h||h&&t==r.GetLength())m=s>this.GetLength(r,a)?this.MaxLengthCheck(m,y,a):"";else if(h){var v=r.Substring(0,t),_=r.Substring(t,r.GetLength()),S=_.IndexOf(f);-1!=S&&(v+=_.Substring(S,_.GetLength())),y=s-this.GetLength(v,a),m=this.MaxLengthCheck(m,y,a)}}}else{var x=r.Substring(Math.min(t,n),Math.max(t,n));if(0!=s){var y=s-this.GetLength(r,a)+this.GetLength(x,a);m==f?y<f.GetLength()&&(m=""):m=this.MaxLengthCheck(m,y,a)}}if(0!=c&&d)if(c>=this.GetLinesCount(r,u)){var b=r.Substring(0,t),C=r.Substring(n,r.GetLength());if(this.PasswordMode){b=this.GetPasswordText(b,this.PasswordChar,d),C=this.GetPasswordText(C,this.PasswordChar,d);var D=this.GetPasswordText(m,this.PasswordChar,d);D=this.MaxLineCheck(b,C,D,c,u),m=m.Substring(0,D.GetLength())}else m=this.MaxLineCheck(b,C,m,c,u)}else m="";""!=o&&""==m&&(this.isInputValid=!1);var I=r;if(h&&m!=f&&t==n){if(""!=m)if(t==r.GetLength())I=r+m;else if(t+f.GetLength()<=r.GetLength()&&r.Substring(t,t+f.GetLength())==f)I=r.Substring(0,t)+m+r.Substring(t,r.GetLength());else{var j;if(0!=s&&a){for(var T=m.GetLength(),E=r.Substring(t,t+T),k=this.GetLength(E,a),L=this.GetLength(m,a);L>k&&T<=r.GetLength();)T+=1,E=r.Substring(t,t+T),k=this.GetLength(E,a);j=r.Substring(t,t+T)}else j=r.Substring(t,t+m.GetLength());var S=j.IndexOf(f);I=-1!=S?r.Substring(0,t)+m+r.Substring(t+S,r.GetLength()):r.Substring(0,t)+m+r.Substring(t+j.GetLength(),r.GetLength())}}else{if(t>n){var P=t;t=n,n=P}t!=n&&(p.DelInclude=!0,this.IsDelInclude=!0),I=r.Substring(0,t)+m+r.Substring(n,r.GetLength())}if(p.Text=I,p.SetSelection=!0,(0!=this.isInputValid||m.GetLength()>0)&&(p.SelectionStart=t+m.GetLength(),p.SelectionEnd=p.SelectionStart),p.EventInfo=new Array,!this.isInputValid){this.isInputValid=!0;var w=new Object;w.Name=this.control.InvalidInputEvent,w.Args=o,w.Type="invalidInput",p.EventInfo[0]=w}if(null!=p.Text&&l&&0!=s){var M=this.GetLength(p.Text.Substring(0,p.SelectionStart),a);if(M==s&&""!=m){var w=this.MoveControl(this.control.InputElement,!0,!1,"CharInput");null!=w&&(p.EventInfo[1]=w.EventInfo,p.FocusType=w.FocusType,p.FocusExit=!0,p.SetSelection=!1)}}return p}return!1},n.prototype.TextBoxKeyUp=function(t,i,n,o,r){var s=new Object;if(this.IsKeyDown=!1,s.SelectionStart=e.Utility.GetSelectionStartPosition(t),s.SelectionEnd=s.SelectionStart+e.Utility.GetSelectionText(this.control.InputElement).GetLength(),1==this.systemEdit&&(this.systemEdit=!1,s.SystemEdit=!0),this.ctrlDelete||this.ctrlBackspace){var a;this.ctrlDelete?(a=s.SelectionStart,this.ctrlDelete=!1):this.ctrlBackspace&&(a=o,this.ctrlBackspace=!1),s.Text=r.Substring(0,n)+r.Substring(a,r.GetLength()),s.SelectionStart=s.SelectionEnd=n,s.SetSelection=!0}return s},n.prototype.TextBoxMouseDown=function(t,e){return this.isFocusing=!1,new Object},n.prototype.TextBoxMouseUp=function(t,i,n,o,r,s,a,l,h){var d=new Object;if(this.isFocusing&&(this.isFocusing=!1,l))return d;if(o==e.MouseButton.Left){if(this.isDblClick&&!e.Utility.GrapeCityTimeout)if(this.isDblClick=!1,this.isTriClick=!0,r){var c=e.Utility.GetSelectionStartPosition(t),u=this.GetLineEnds(c,s);null!=u.start&&(d.SelectionStart=u.start),null!=u.end&&(d.SelectionEnd=u.end)}else d.SelectionStart=0,d.SelectionEnd=s.GetLength();else""==e.Utility.GetSelectionText(this.control.InputElement)&&r?""==e.Utility.GetSelectionText(this.control.InputElement)?(d.SelectionStart=e.Utility.GetSelectionStartPosition(t),d.SelectionEnd=d.SelectionStart+e.Utility.GetSelectionText(this.control.InputElement).GetLength()):(d.SelectionStart=e.Utility.GetSelectionStartPosition(t),document.selection&&h.y<document.selection.createRange().offsetTop&&(d.SelectionStart-=2),d.SelectionEnd=d.SelectionStart):(d.SelectionStart=e.Utility.GetSelectionStartPosition(t),d.SelectionEnd=d.SelectionStart+e.Utility.GetSelectionText(this.control.InputElement).GetLength());if(!e.Utility.IsIE()&&e.Utility.FuncKeysPressed.Ctrl)if(r){var c=e.Utility.GetSelectionStartPosition(t),u=this.GetLineEnds(c,s);null!=u.start&&(d.SelectionStart=u.start),null!=u.end&&(d.SelectionEnd=u.end)}else d.SelectionStart=0,d.SelectionEnd=s.GetLength();d.SelectionStart!=d.SelectionEnd&&(d.SetSelection=!0)}return d},n.prototype.GetLineEnds=function(t,n){var o=n,r=0,s="\r\n";(!e.Utility.IsIE()||parseInt(i.browser.version)>=9)&&(s="\n");for(var a=o.IndexOf(s),l=new Object;-1!=a;){if(t>=r&&t<r+a+s.GetLength())return l.start=r,l.end=r+a,l;r=r+a+s.GetLength(),o=o.Substring(a+s.GetLength(),o.GetLength()),a=o.IndexOf(s)}return l.start=r,l.end=n.GetLength(),l},n.prototype.ShowContextMenu=function(t,i){var n=new Object;return n.SelectionStart=e.Utility.GetSelectionStartPosition(t),n.SelectionEnd=n.SelectionStart+e.Utility.GetSelectionText(this.control.InputElement).GetLength(),n},n.prototype.TextBoxDoubleClick=function(t,i,n){this.isDblClick=!0,e.Utility.GrapeCityTimeout=!1,window.setTimeout(function(){e.Utility.GrapeCityTimeout=!0},500);var o=new Object;return o.SelectionStart=e.Utility.GetSelectionStartPosition(t),o.SelectionEnd=o.SelectionStart+e.Utility.GetSelectionText(this.control.InputElement).GetLength(),o},n.prototype.SelectStart=function(t,i,n){this.isTriClick&&(this.isTriClick=!1);var o=new Object;return o.SelectionStart=e.Utility.GetSelectionStartPosition(t),o.SelectionEnd=o.SelectionStart,o},n.prototype.Copy=function(t,i,n){if(i!=n){if(i>n){var o=i;i=n,n=o}var r=t.Substring(i,n),s=!0;this.Owner&&(this.Owner.MultiLine===!1&&(r=e.BaseUIProcess.UpdateCrLfString(r,this.Owner.AcceptsCrLf)),s=this.Owner.UseClipboard),e.Utility.IsIE()?e.Utility.SetCopy(r,s):e.Utility.SetCopy(r,!1)}},n.prototype.TextBoxPaste=function(t,i,n,o,r,s,a,l,h,d,c,u,p){this.isInputValid=!0;var g=new Object,f=this.Owner?this.Owner.UseClipboard:!0;e.Utility.IsIE()||(f=!1);var m=null==u?e.Utility.GetPasteData(f):u;if(!p&&this.Owner&&this.Owner.MultiLine===!1&&(m=e.BaseUIProcess.UpdateCrLfString(m,this.Owner.AcceptsCrLf)),e.Utility.IsIE9OrLater()&&this.Owner&&this.Owner.MultiLine===!0&&(m=e.BaseUIProcess.FilterReturnChar(m)),null==m)return g;this.FireClientEvent("OnBeforePaste");var w=this.FormatCheck(m,r,s),y=w,v;if(0!=a){var _=this.GetLength(n.Substring(Math.min(t,i),Math.max(t,i)),l);v=a-this.GetLength(n,l)+_,y=this.MaxLengthCheck(w,v,l)}if(0!=h&&c)if(h>=this.GetLinesCount(n,d)){var S=n.Substring(0,t),x=n.Substring(i,n.GetLength());if(this.PasswordMode){S=this.GetPasswordText(S,this.PasswordChar,c),x=this.GetPasswordText(x,this.PasswordChar,c);var b=this.GetPasswordText(y,this.PasswordChar,c);b=this.MaxLineCheck(S,x,b,h,d),y=y.Substring(0,b.GetLength())}else y=this.MaxLineCheck(S,x,y,h,d)}else y="";var C=Math.min(t,i),D=Math.max(t,i);if((""!=y||p===!0)&&(g.Text=n.Substring(0,C)+y+n.Substring(D,n.GetLength()),g.SelectionStart=C+y.GetLength(),g.SelectionEnd=g.SelectionStart),g.SetSelection=!0,t!=i&&(g.DelInclude=!0,this.IsDelInclude=!0),g.EventInfo=new Array,!this.isInputValid){this.isInputValid=!0;var I=new Object;I.Name=this.control.InvalidInputEvent,I.Args=m,I.Type="invalidInput",g.EventInfo[0]=I}if(null!=g.Text)var j=this.GetLength(g.Text.Substring(0,g.SelectionStart),l);else var j=0;if(0!=a&&j==a&&o&&""!=y){var I=this.MoveControl(this.control.InputElement,!0,!1,"CharInput");null!=I&&(g.EventInfo[1]=I.EventInfo,g.FocusType=I.FocusType,g.FocusExit=!0,g.SetSelection=!1)}return this.FireClientEvent("OnPaste"),g},n.prototype.Cut=function(t,e,i){var n=new Object;return e!=i&&this.FireClientEvent("OnBeforeCut"),this.Copy(t,e,i),i>e?(n.SelectionStart=e,n.Text=t.Substring(0,e)+t.Substring(i,t.GetLength())):(n.SelectionStart=i,n.Text=t.Substring(0,i)+t.Substring(e,t.GetLength())),n.SelectionEnd=n.SelectionStart,n.SetSelection=!0,n.Text!=t&&(n.DelInclude=!0,this.IsDelInclude=!0),e!=i&&this.FireClientEvent("OnCut"),n},n.prototype.TextBoxUndo=function(t,e,i,n,o,r,s){var a=new Object;return this.IsDelInclude?t!=e&&(a.Text=e,a.SelectionStart=r,a.SelectionEnd=s,a.SetSelection=!0,a.DelInclude=!0,a.Undo=!0):t!=i&&(a.Text=i,a.SelectionStart=n,a.SelectionEnd=o,a.SetSelection=!0,a.Undo=!0),this.StartPos=null,this.LastKey=null,a},n.prototype.Delete=function(t,e,i,n){var o=new Object;return n>i?(o.SelectionStart=i,o.Text=e.Substring(0,i)+e.Substring(n,e.GetLength())):(o.SelectionStart=n,o.Text=e.Substring(0,n)+e.Substring(i,e.GetLength())),o.SelectionEnd=o.SelectionStart,o.SetSelection=!0,o.Text!=e&&(o.DelInclude=!0,this.IsDelInclude=!0),o},n.prototype.TextBoxSelectAll=function(t){var e=new Object;return e.SelectionStart=0,e.SelectionEnd=t.GetLength(),e.SetSelection=!0,e},n.prototype.DragDrop=function(t,e,i,n,o,r,s,a,l,h){this.isInputValid=!0;var d=new Object,c=this.FormatCheck(t),u=c,p=0;if(0!=o&&(p=o-this.GetLength(h,r),u=this.MaxLengthCheck(c,p,r)),0!=s&&l)if(s>=this.GetLinesCount(h,a)){var g=h.Substring(0,i),f=h.Substring(n,h.GetLength());if(this.PasswordMode){g=this.GetPasswordText(g,this.PasswordChar,l),f=this.GetPasswordText(f,this.PasswordChar,l);var m=this.GetPasswordText(u,this.PasswordChar,l);m=this.MaxLineCheck(g,f,m,s,a),u=m.Substring(0,u.GetLength())}else u=this.MaxLineCheck(g,f,u,s,a)}else u="";if(d.DropText=u,d.EventInfo=new Array,!this.isInputValid){this.isInputValid=!0;var w=new Object;w.Name=this.control.InvalidInputEvent,w.Args=c,w.Type="invalidInput",d.EventInfo[0]=w}if(this.GetLength(c,r)>=p&&0!=o&&e&&""!=u){var w=new Object;""!=this.KeyExitEvent&&null!=this.KeyExitEvent&&(w.Name=this.KeyExitEvent,w.Args=new Object,w.Args.Key=9,w.Type="KeyExit"),d.EventInfo[1]=w}return d},n.prototype.TextBoxFocus=function(t,i,n,o,r,s){var a=new Object;return this.isFocusing=!0,t===e.FocusType.Left?(a.SelectionStart=0,a.SelectionEnd=0):t===e.FocusType.Right&&(a.SelectionStart=n.GetLength(),a.SelectionEnd=n.GetLength()),r?s||(a.SelectionStart=0,a.SelectionEnd=n.GetLength()):(t===e.FocusType.Click||t==e.FocusType.DragDrop)&&(a.SelectionStart=e.Utility.GetSelectionStartPosition(i),a.SelectionEnd=a.SelectionStart+e.Utility.GetSelectionText(this.control.InputElement).GetLength()),(t!==e.FocusType.Click||r)&&(a.SetSelection=!0),a},n.prototype.MaxLengthCheck=function(t,e,i){var n="",o=0;if("\r\n"==t)e>=2&&(n=t);else if(i)for(var r=0;r<t.GetLength();r++){var s=t.Substring(r,r+1);if(s.length>=2?o+=2*s.length:this.Filter.IsFullWidth(s)?o+=2:o++,!(e>=o))break;n+=t.Substring(r,r+1)}else n=t.GetLength()<=e?t:t.Substring(0,e);var a=n.GetLength();return 0!=a&&"\r"==n.Substring(a-1,a)&&(n=n.Substring(0,a-1)),n!=t&&(this.isInputValid=!1),n},n.prototype.MaxLineCheck=function(t,e,i,n,o){var r="",s=t+i+e,a=this.GetLinesCount(s,o);if(n>=a)r=i;else{var l=0,h=i.GetLength();do{var d=Math.floor((l+h)/2),c=i.Substring(0,d);if(s=t+c+e,a=this.GetLinesCount(s,o),a>n)h=d;else if(n>a)l=d;else if(a==n&&h>l+1)l=d;else if(a==n&&h==l+1)break}while(h>l);r=i.Substring(0,l)}return r!=i&&(this.isInputValid=!1),r},n.prototype.GetLinesCount=function(t,e){var n=1,o=e;if(""==t)return n;var r=this._testTextArea;if((void 0===this._testTextArea||null===this._testTextArea)&&(this._testTextArea=i("<textarea/>"),this._testTextArea.css("visibility","hidden"),this._testTextArea.css("position","absolute"),this._testTextArea.css("left","-100000000px"),this._testTextArea.css("top","-100000000px"),this._testTextArea.attr("rows",1),this._testTextArea.appendTo(i(document.body)),r=this._testTextArea,o=!1),!o){var s=t,a=s,l=s.IndexOf("\r\n");for(n=1;-1!=l;)a=a.replace("\r\n",""),n+=1,s=s.Substring(l+2,s.GetLength()),l=s.IndexOf("\r\n");for(s=a,l=s.IndexOf("\r");-1!=l;)a=a.replace("\r",""),n+=1,s=s.Substring(l+1,s.GetLength()),l=s.IndexOf("\r");for(s=a,l=s.IndexOf("\n");-1!=l;)a=a.replace("\n",""),n+=1,s=s.Substring(l+1,s.GetLength()),l=s.IndexOf("\n");return n}var h=t;h=h.replace(/\r\n/g,"\r"),h=h.replace(/\n/g,"\r");var l=h.IndexOf("\r");if(-1!=l){n=0;var d=h.Substring(0,l);return n+=this.GetLinesCount(d,e),h=h.Substring(l+1,h.GetLength()),n+=this.GetLinesCount(h,e)}var c=i(this.control.InputElement);if(r.css("fontSize",c.css("fontSize")),r.css("fontFamily",c.css("fontFamily")),r.css("width",c.css("width")),r.css("borderWidth",c.css("borderWidth")),r.css("padding",c.css("padding")),r.css("wordWrap",c.css("wordWrap")),r.css("overflowY",c.css("overflowY")),null!=r){for(r.val(t),r=r.get(0);r.scrollHeight-r.clientHeight>1;)r.rows++;return r.scrollTop=0,n=r.rows,r.rows>1&&(r.rows=1),n}},n.prototype.FormatCheck=function(t,e,i){this.Owner&&!this.Owner.MultiLine&&t&&("string"!=typeof t&&(t=t.toString()),t=t.replace(/[\r\n]/g,""));var n=this.Filter.CheckText(t),o=n.CheckedText;return this.isInputValid=n.IsInputValid,o},n.prototype.ListValidateCheck=function(t){var e=this.Filter.autoConvert;this.Filter.autoConvert=!1;var i=this.Filter.CheckText(t);return this.Filter.autoConvert=e,i.IsInputValid},n.prototype.GetLength=function(t,e){var i=0;if(e)for(var n=0;n<t.GetLength();n++){var o=t.Substring(n,n+1);o.length>=2?i+=2*o.length:this.Filter.IsFullWidth(o)?i+=2:i++}else i=t.GetLength();return i},n.prototype.TextBoxProcessBackSpace=function(t,e,i,n){var o=new Object;return this.systemEdit=!0,this.keyupResponse=!0,o.System=!0,o},n.prototype.GetRightWordPosition=function(t,e){if(t<e.GetLength()){for(var i=t,n=e.Substring(t,t+1),o=n;(!this.Filter.IsFormatSpace(o)||this.Filter.IsFormatSpace(n))&&("\r"!=n&&"\n"!=o||t==i)&&("	"!=n&&"	"!=o||t==i)&&(i+=1,i<e.GetLength());)o=n,n=e.Substring(i,i+1);return i}return t},n.prototype.DelOperation=function(t,e,i){this.IsDelInclude=!0;var n=Math.abs(i-e);switch(t){case 8:var o=!1;if(this.IsKeyDown?o=!0:(this.IsKeyDown=!0,this.CurStart=e-1),o){this.IsSerialDel=!0;break}if(this.CurStart==this.StartPos&&(this.IsSerialDel=!0,this.CurStart-=1),e!=i){if(e<this.StartPos)this.StartPos-=n;else if(e==this.StartPos){this.IsSerialDel=!0,this.StartPos=e;break}}else if(e==this.StartPos){this.IsSerialDel=!0,this.StartPos=e-1;break}e-=1,this.StartPos==e?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=e-1;break;case 131080:case 196616:if(e==i)e-=1;else if(e<this.StartPos)this.StartPos-=n;else if(e==this.StartPos){this.IsSerialDel=!0,this.StartPos=e-1;break}this.StartPos==e?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=e-1;break;case 65544:e!=i&&e<this.StartPos&&(this.StartPos-=n),this.StartPos==e?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=e-1;break;case 65582:if(e==i)e-=1;else if(e<this.StartPos)this.StartPos-=n;else if(e==this.StartPos){this.IsSerialDel=!0,this.StartPos=e;break}this.StartPos==e||this.StartPos==i?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=e-1;break;case 46:var r=null;if(8==this.LastKey&&(r=e,e-=1),this.StartPos==e||null!=this.StartPos&&1==Math.abs(this.StartPos-e)||this.StartPos==i)this.IsSerialDel=!0;else if(this.IsSerialDel=!1,null!=r){this.StartPos=r;break}this.StartPos=e;break;case 131118:if(e!=i)if(e<this.StartPos)this.StartPos-=n;else if(e==this.StartPos){this.IsSerialDel=!0,this.StartPos=e;break}e-=1,this.StartPos==e||e-this.StartPos==1?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=e}this.LastKey=t},n.prototype.GetPasswordText=function(t,e,i){for(var n="",o=0;o<t.GetLength();o++){var r=t.Substring(o,o+1);"\r"!=r&&"\n"!=r?n+=e:i&&(n+=r)}return n},n}(e.BaseUIProcess);e.GcTextBoxUIProcess=c;var u=function(){function t(t){this._hightlightIndex=-1,this._dataList=[],this._isDeleteItem=!1,this._isFocusOnList=!1,this._isMouseOnList=!1,this._owner=t;var e=5;this._maxItems=e,this._firstItemShowing=0,this._lastItemShowing=e-1,this._refreshElement(),this._createDropdown()}return t.prototype._refreshElement=function(){this._controlContainer=this._owner.GetContainer(),this._inputElement=this._owner.GetJQueryInputElement(),this._maxItems=this._owner.GetMaxHistoryCount(),this._inputElement&&this._inputElement.attr("autocomplete","off")},t.prototype._createDropdown=function(){var t=i("<div>");t.css({position:"absolute",zIndex:"999999",display:"none",backgroundColor:"white",border:"solid 1px black",overflowX:"hidden",overflowY:"auto"});var n=this;t.bind("focus",function(){n._isFocusOnList=!0,t.blur(),n._owner.SetInnerFocus(e.FocusType.ContextMenu)}),t.bind("mouseover",function(){n._isMouseOnList=!0}),t.bind("mouseout",function(){n._isMouseOnList=!1}),t.bind("contextmenu",function(t){t.preventDefault()}),this._dropDownElement=t},t.prototype.GetIsDeleteItem=function(){return this._isDeleteItem},t.prototype.SetIsDeleteItem=function(t){this._isDeleteItem=t},t.prototype.GetIsFocusOnList=function(){return this._isFocusOnList},t.prototype.SetIsFocusOnList=function(t){this._isFocusOnList=t},t.prototype.GetIsMouseOnList=function(){return this._isMouseOnList},t.prototype.ShowDropdown=function(){this._refreshElement(),this.IsVisible()&&this.HideDropdown(),this._dropDownElement.empty();var t;if(t=this._addDisplayItems(),0!==t){var n=e.Utility.GetElementPosition(this._controlContainer.get(0)).Left,o=e.Utility.GetElementPosition(this._controlContainer.get(0)).Top+this._controlContainer.outerHeight(),r=this._controlContainer.outerWidth(),s="";if(t>this._maxItems){var a=e.Utility.MeasureText("WHQ",this._dropDownElement.get(0).firstChild).Height;s=this._maxItems*(a+2)+"px"}var l="";1==e.Utility.IsTouchMouseDown&&(l=this._owner.GetTouchDropDownScale()+""),r-=2,this._dropDownElement.css("left",n+"px"),this._dropDownElement.css("top",o+"px"),this._dropDownElement.css("width",r+"px"),this._dropDownElement.css("display",""),e.Utility.SetZoomStyle(this._dropDownElement,l),this._dropDownElement.css("height",s),i("body").append(this._dropDownElement);var h=this;this._docClickListerner=function(){h.HideDropdown()},i(document).bind("click",this._docClickListerner)}},t.prototype._addDisplayItems=function(){for(var t=this._inputElement.val(),n=[],o=0;o<this._dataList.length;++o)this._dataList[o].substr(0,t.GetLength())==t&&this._dataList[o].GetLength()>t.GetLength()&&n.push(this._dataList[o]);var r=this,s=n.length>this._maxItems?this._maxItems:n.length;for(o=0;s>o;++o){var a=i("<div>");a.attr("index",o),a.css({fontFamily:e.Utility.GetOSDefaultFontFamily(),fontSize:"10pt",whiteSpace:"nowrap",padding:"1px"}),a.bind("mouseover",function(t){var e=t.target||t.srcElement;r.HighlightItem(parseInt(e.getAttribute("index").toString()))}),a.bind("click",function(){r._isFocusOnList=!1,r.SetValue(),r.HideDropdown()}),a.html(e.Utility.EncodingToHTML(n[o])),this._dropDownElement.append(a)}return s},t.prototype.HideDropdown=function(){this.IsVisible()&&(this._dropDownElement.remove(),this._dropDownElement.css("display","none"),i("document").unbind("click",this._docClickListerner),this._dropDownElement.empty(),this._isMouseOnList=!1,this._hightlightIndex=-1)},t.prototype.SetDataList=function(t){(null===t||void 0===t)&&(t=[]),this._dataList=t},t.prototype.IsDataListEmpty=function(){return 0===this._dataList.length},t.prototype.HighlightItem=function(t){this.SetHighlighItem(t)},t.prototype.SetHighlighItem=function(t){-1!==this._hightlightIndex&&(this._dropDownElement.get(0).childNodes[this._hightlightIndex].style.backgroundColor="",this._dropDownElement.get(0).childNodes[this._hightlightIndex].style.color=""),this._hightlightIndex=t,-1!==this._hightlightIndex&&(this._dropDownElement.get(0).childNodes[this._hightlightIndex].style.color="white")},t.prototype.Highlight=function(t){var e=!1;if(t>0&&this._hightlightIndex==this._dropDownElement.get(0).childNodes.length-1?(this.SetHighlighItem(-1),e=!0):0>t&&0==this._hightlightIndex&&(this.SetHighlighItem(-1),e=!0),-1===this._hightlightIndex)0==e&&(t>0&&this.SetHighlighItem(0),0>t&&this.SetHighlighItem(this._dropDownElement.get(0).childNodes.length-1));else{var i;t>1&&this._firstItemShowing+this._maxItems-1!==this._hightlightIndex&&(t=this._firstItemShowing+this._maxItems-this._hightlightIndex),-1>t&&this._firstItemShowing!=this._hightlightIndex&&(t=this._firstItemShowing-this._hightlightIndex),i=t>0?this._hightlightIndex+t>=this._dropDownElement.get(0).childNodes.length?this._dropDownElement.get(0).childNodes.length-1:this._hightlightIndex+t:this._hightlightIndex+t<0?0:this._hightlightIndex+t,t>1&&(i-=1),this.SetHighlighItem(i)}},t.prototype.SetValue=function(){var t=this._dropDownElement.get(0).childNodes[this._hightlightIndex].innerHTML;t=e.Utility.DecodingFromHTML(t),this._owner.InternalSetText(t,!0),this._owner.SetInnerFocus(e.FocusType.ContextMenu);var i=this._inputElement.val().GetLength(),n=Math.abs(this._owner.SelectionEnd-this._owner.SelectionStart);0!=n?this._owner.InternalSetSelection(0,i):this._owner.InternalSetSelection(i,i)},t.prototype.ScrollCheck=function(){if(-1!==this._hightlightIndex){this._hightlightIndex>this._lastItemShowing&&(this._firstItemShowing=this._hightlightIndex-(this._maxItems-1),this._lastItemShowing=this._hightlightIndex),this._hightlightIndex<this._firstItemShowing&&(this._firstItemShowing=this._hightlightIndex,this._lastItemShowing=this._hightlightIndex+(this._maxItems-1));var t=e.Utility.MeasureText("WQH",this._dropDownElement.get(0).firstChild).Height+2;this._dropDownElement.get(0).scrollTop=this._firstItemShowing*t}},t.prototype.KeyDown=function(t){var i=t.keyCode,n={Shift:!1,Ctrl:!1,Alt:!1};t.shiftKey&&(n.Shift=!0),t.ctrlKey&&(n.Ctrl=!0),t.altKey&&(n.Alt=!0);var o=e.Key;switch(i){case o.Enter:if(-1!==this._hightlightIndex)return this.SetValue(),this.HideDropdown(),t.stopPropagation(),t.preventDefault(),!1;break;case o.Delete:if(-1!==this._hightlightIndex){var r=this._dropDownElement.get(0).childNodes[this._hightlightIndex].innerHTML;return this.HideDropdown(),
this._owner.DeleteItem(r),this._isDeleteItem=!0,this._inputElement.focus(),this.IsVisible()||this.ShowDropdown(),t.stopPropagation(),t.preventDefault(),!1}break;case o.Escape:this.HideDropdown(),t.stopPropagation(),t.preventDefault();break;case o.Up:if(n.Alt)break;return this.IsVisible()?(-1===this._hightlightIndex&&this.ShowDropdown(),this.Highlight(-1),this.ScrollCheck()):this.ShowDropdown(),!1;case o.PageUp:return this.IsVisible()?(-1===this._hightlightIndex&&this.ShowDropdown(),this.Highlight(-1*this._maxItems),this.ScrollCheck()):this.ShowDropdown(),!1;case o.Tab:this.HideDropdown();break;case o.Down:if(n.Alt)break;return this.IsVisible()?(this.Highlight(1),this.ScrollCheck()):this.ShowDropdown(),!1;case o.PageDown:return this.IsVisible()?(this.Highlight(this._maxItems),this.ScrollCheck()):this.ShowDropdown(),!1}},t.prototype.KeyUp=function(t,i){if(i===!0)return void this.ShowDropdown();var n=t.keyCode,o=e.Key;switch(n){case o.Enter:break;case o.Escape:this.HideDropdown();break;case o.Up:case o.Down:break;default:this.ShowDropdown()}},t.prototype.IsVisible=function(){return""===this._dropDownElement.css("display")},t}();e.AutoComplete=u;var p=function(){function t(){this.DBCS_UpperAlphabet=2147483650,this.SBCS_UpperAlphabet=1073741825,this.DBCS_LowerAlphabet=2147483656,this.SBCS_LowerAlphabet=1073741828,this.DBCS_Number=2147483680,this.SBCS_Number=1073741840,this.DBCS_Binary=2147483776,this.SBCS_Binary=1073741888,this.DBCS_Hexadecimal=2147484160,this.SBCS_Hexadecimal=1073742080,this.DBCS_Symbol=2147485696,this.SBCS_Symbol=1073742848,this.DBCS_NumberSymbol=2147491840,this.SBCS_NumberSymbol=1073745920,this.DBCS_Katakana=2147516416,this.SBCS_Katakana=1073758208,this.DBCS_Space=2147614720,this.SBCS_Space=1073807360,this.TwoBytes=2148007936,this.FourBytes=2147745792,this.DBCS_ShiftJIS=2148532224,this.DBCS_JISX0208=2149580800,this.Emoji=4194304,this.IVS=8388608,this.DBCS_Hiragana=2164260864,this.Upper_SBCS_Katakana=1207959552,this.Upper_DBCS_Katakana=2415919104,this.Upper_DBCS_Hiragana=2684354560,this.All=3321888768,this.DBCS_All=2214592512,this.SBCS_All=1107296256,this.DBCS=2147483648,this.SBCS=1073741824}return t}(),g=function(){function t(t,i){this.charType=new p,this.format=i,this.includeFormat="",this.excludeFormat="",this.includeNormalChar="",this.excludeNormalChar="",this.allowTypes=this.charType.All,this.excludeTypes=this.charType.All,this.include=!0,this.autoConvert=t,this.charExInstance=e.CharProcess.CharEx,this.isInputValid=!0,this.ParseFormat(this.format)}return t.prototype.allowDBCS=function(){return!(0!=(this.allowTypes&this.charType.DBCS_All)^this.include)},t.prototype.allowSBCS=function(){return!(0!=(this.allowTypes&this.charType.SBCS_All)^this.include)},t.prototype.GetIncludeFormat=function(t){if(null==t||0==t.GetLength())return"";for(var e="",i=0;i<t.GetLength();i++){var n=t.Substring(i,i+1);if("\\"==n){if(i==t.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";e+=n,e+=t.Substring(i+1,i+2),i++}else{if("^"==n)return e;e+=n}}return e},t.prototype.GetExcludeFormat=function(t){if(null==t||0==t.GetLength())return"";for(var e=0,i="",n=0;n<t.GetLength();n++){var o=t.Substring(n,n+1);if("\\"==o){if(n==t.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";0!=e&&(i+=o,i+=t.Substring(n+1,n+2)),n++}else if("^"==o){if(e++,e>1)throw"Exception.TextFilter.Format.DuplicatedChar"}else 0!=e&&(i+=o)}return 1==e&&(i="^"+i),i},t.prototype.ParseIncludeFormat=function(t){if(null==t||0==t.GetLength())return this.allowTypes=this.charType.All,this.includeNormalChar="",this.includeFormat="",void 0;this.allowTypes=0,this.includeNormalChar="";for(var e=0;e<t.GetLength();e++)switch(t.charCodeAt(e)){case 94:break;case 92:if(e==t.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";this.includeNormalChar=this.includeNormalChar+t.Substring(e+1,e+2),e++;break;case 65313:(this.allowTypes&this.charType.DBCS_UpperAlphabet)!=(0|this.charType.DBCS_UpperAlphabet)&&(this.allowTypes|=this.charType.DBCS_UpperAlphabet);break;case 65:(this.allowTypes&this.charType.SBCS_UpperAlphabet)!=this.charType.SBCS_UpperAlphabet&&(this.allowTypes|=this.charType.SBCS_UpperAlphabet);break;case 65345:(this.allowTypes&this.charType.DBCS_LowerAlphabet)!=(0|this.charType.DBCS_LowerAlphabet)&&(this.allowTypes|=this.charType.DBCS_LowerAlphabet);break;case 97:(this.allowTypes&this.charType.SBCS_LowerAlphabet)!=this.charType.SBCS_LowerAlphabet&&(this.allowTypes|=this.charType.SBCS_LowerAlphabet);break;case 65323:(this.allowTypes&this.charType.DBCS_Katakana)!=(0|this.charType.DBCS_Katakana)&&(this.allowTypes|=this.charType.DBCS_Katakana);break;case 75:(this.allowTypes&this.charType.SBCS_Katakana)!=this.charType.SBCS_Katakana&&(this.allowTypes|=this.charType.SBCS_Katakana);break;case 65305:(this.allowTypes&this.charType.DBCS_Number)!=(0|this.charType.DBCS_Number)&&(this.allowTypes|=this.charType.DBCS_Number);break;case 57:(this.allowTypes&this.charType.SBCS_Number)!=this.charType.SBCS_Number&&(this.allowTypes|=this.charType.SBCS_Number);break;case 65283:(this.allowTypes&this.charType.DBCS_NumberSymbol)!=(0|this.charType.DBCS_NumberSymbol)&&(this.allowTypes|=this.charType.DBCS_NumberSymbol);break;case 35:(this.allowTypes&this.charType.SBCS_NumberSymbol)!=this.charType.SBCS_NumberSymbol&&(this.allowTypes|=this.charType.SBCS_NumberSymbol);break;case 65312:(this.allowTypes&this.charType.DBCS_Symbol)!=(0|this.charType.DBCS_Symbol)&&(this.allowTypes|=this.charType.DBCS_Symbol);break;case 64:(this.allowTypes&this.charType.SBCS_Symbol)!=this.charType.SBCS_Symbol&&(this.allowTypes|=this.charType.SBCS_Symbol);break;case 65314:(this.allowTypes&this.charType.DBCS_Binary)!=(0|this.charType.DBCS_Binary)&&(this.allowTypes|=this.charType.DBCS_Binary);break;case 66:(this.allowTypes&this.charType.SBCS_Binary)!=this.charType.SBCS_Binary&&(this.allowTypes|=this.charType.SBCS_Binary);break;case 65336:(this.allowTypes&this.charType.DBCS_Hexadecimal)!=(0|this.charType.DBCS_Hexadecimal)&&(this.allowTypes|=this.charType.DBCS_Hexadecimal);break;case 88:(this.allowTypes&this.charType.SBCS_Hexadecimal)!=this.charType.SBCS_Hexadecimal&&(this.allowTypes|=this.charType.SBCS_Hexadecimal);break;case 65322:(this.allowTypes&this.charType.DBCS_Hiragana)!=(0|this.charType.DBCS_Hiragana)&&(this.allowTypes|=this.charType.DBCS_Hiragana);break;case 65338:(this.allowTypes&this.charType.DBCS_All)!=(0|this.charType.DBCS_All)&&(this.allowTypes|=this.charType.DBCS_All);break;case 65325:(this.allowTypes&this.charType.DBCS_ShiftJIS)!=(0|this.charType.DBCS_ShiftJIS)&&(this.allowTypes|=this.charType.DBCS_ShiftJIS);break;case 65321:(this.allowTypes&this.charType.DBCS_JISX0208)!=(0|this.charType.DBCS_JISX0208)&&(this.allowTypes|=this.charType.DBCS_JISX0208);break;case 72:(this.allowTypes&this.charType.SBCS_All)!=this.charType.SBCS_All&&(this.allowTypes|=this.charType.SBCS_All);break;case 78:(this.allowTypes&this.charType.Upper_SBCS_Katakana)!=this.charType.Upper_SBCS_Katakana&&(this.allowTypes|=this.charType.Upper_SBCS_Katakana);break;case 65326:(this.allowTypes&this.charType.Upper_DBCS_Katakana)!=this.charType.Upper_DBCS_Katakana&&(this.allowTypes|=this.charType.Upper_DBCS_Katakana);break;case 65319:(this.allowTypes&this.charType.Upper_DBCS_Hiragana)!=this.charType.Upper_DBCS_Hiragana&&(this.allowTypes|=this.charType.Upper_DBCS_Hiragana);break;case 65331:(this.allowTypes&this.charType.DBCS_Space)!=this.charType.DBCS_Space&&(this.allowTypes|=this.charType.DBCS_Space);break;case 83:(this.allowTypes&this.charType.SBCS_Space)!=this.charType.SBCS_Space&&(this.allowTypes|=this.charType.SBCS_Space);break;case 65332:(this.allowTypes&this.charType.FourBytes)!=this.charType.FourBytes&&(this.allowTypes|=this.charType.FourBytes);break;case 65316:(this.allowTypes&this.charType.TwoBytes)!=this.charType.TwoBytes&&(this.allowTypes|=this.charType.TwoBytes);break;case 65317:this.allowTypes|=this.charType.Emoji;break;case 65334:this.allowTypes|=this.charType.IVS;break;default:this.includeNormalChar=this.includeNormalChar+t.Substring(e,e+1)}},t.prototype.ParseExcludeFormat=function(t){if(null==t||0==t.GetLength())return this.excludeTypes=this.excludeTypes.All,this.excludeNormalChar="",this.excludeFormat="",void 0;if("^"==t)return this.excludeTypes=this.charType.All,this.excludeNormalChar="",this.excludeFormat="^",void 0;this.excludeTypes=0,this.excludeNormalChar="";for(var e=0;e<t.GetLength();e++)switch(t.charCodeAt(e)){case 94:break;case 92:if(e==t.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";this.excludeNormalChar=this.excludeNormalChar+t.Substring(e+1,e+2),e++;break;case 65313:(this.excludeTypes&this.charType.DBCS_UpperAlphabet)!=(0|this.charType.DBCS_UpperAlphabet)&&(this.excludeTypes|=this.charType.DBCS_UpperAlphabet);break;case 65:(this.excludeTypes&this.charType.SBCS_UpperAlphabet)!=this.charType.SBCS_UpperAlphabet&&(this.excludeTypes|=this.charType.SBCS_UpperAlphabet);break;case 65345:(this.excludeTypes&this.charType.DBCS_LowerAlphabet)!=(0|this.charType.DBCS_LowerAlphabet)&&(this.excludeTypes|=this.charType.DBCS_LowerAlphabet);break;case 97:(this.excludeTypes&this.charType.SBCS_LowerAlphabet)!=this.charType.SBCS_LowerAlphabet&&(this.excludeTypes|=this.charType.SBCS_LowerAlphabet);break;case 65323:(this.excludeTypes&this.charType.DBCS_Katakana)!=(0|this.charType.DBCS_Katakana)&&(this.excludeTypes|=this.charType.DBCS_Katakana);break;case 75:(this.excludeTypes&this.charType.SBCS_Katakana)!=this.charType.SBCS_Katakana&&(this.excludeTypes|=this.charType.SBCS_Katakana);break;case 65305:if((this.excludeTypes&this.charType.DBCS_Number)==(0|this.charType.DBCS_Number))return;this.excludeTypes|=this.charType.DBCS_Number;break;case 57:(this.excludeTypes&this.charType.SBCS_Number)!=this.charType.SBCS_Number&&(this.excludeTypes|=this.charType.SBCS_Number);break;case 65283:(this.excludeTypes&this.charType.DBCS_NumberSymbol)!=(0|this.charType.DBCS_NumberSymbol)&&(this.excludeTypes|=this.charType.DBCS_NumberSymbol);break;case 35:(this.excludeTypes&this.charType.SBCS_NumberSymbol)!=this.charType.SBCS_NumberSymbol&&(this.excludeTypes|=this.charType.SBCS_NumberSymbol);break;case 65312:(this.excludeTypes&this.charType.DBCS_Symbol)!=(0|this.charType.DBCS_Symbol)&&(this.excludeTypes|=this.charType.DBCS_Symbol);break;case 64:(this.excludeTypes&this.charType.SBCS_Symbol)!=this.charType.SBCS_Symbol&&(this.excludeTypes|=this.charType.SBCS_Symbol);break;case 65314:(this.excludeTypes&this.charType.DBCS_Binary)!=(0|this.charType.DBCS_Binary)&&(this.excludeTypes|=this.charType.DBCS_Binary);break;case 66:(this.excludeTypes&this.charType.SBCS_Binary)!=this.charType.SBCS_Binary&&(this.excludeTypes|=this.charType.SBCS_Binary);break;case 65336:(this.excludeTypes&this.charType.DBCS_Hexadecimal)!=(0|this.charType.DBCS_Hexadecimal)&&(this.excludeTypes|=this.charType.DBCS_Hexadecimal);break;case 88:(this.excludeTypes&this.charType.SBCS_Hexadecimal)!=this.charType.SBCS_Hexadecimal&&(this.excludeTypes|=this.charType.SBCS_Hexadecimal);break;case 65322:(this.excludeTypes&this.charType.DBCS_Hiragana)!=(0|this.charType.DBCS_Hiragana)&&(this.excludeTypes|=this.charType.DBCS_Hiragana);break;case 65338:(this.excludeTypes&this.charType.DBCS_All)!=(0|this.charType.DBCS_All)&&(this.excludeTypes|=this.charType.DBCS_All);break;case 65325:(this.excludeTypes&this.charType.DBCS_ShiftJIS)!=(0|this.charType.DBCS_ShiftJIS)&&(this.excludeTypes|=this.charType.DBCS_ShiftJIS);break;case 65321:(this.excludeTypes&this.charType.DBCS_JISX0208)!=(0|this.charType.DBCS_JISX0208)&&(this.excludeTypes|=this.charType.DBCS_JISX0208);break;case 72:(this.excludeTypes&this.charType.SBCS_All)!=this.charType.SBCS_All&&(this.excludeTypes|=this.charType.SBCS_All);break;case 78:(this.excludeTypes&this.charType.Upper_SBCS_Katakana)!=this.charType.Upper_SBCS_Katakana&&(this.excludeTypes|=this.charType.Upper_SBCS_Katakana);break;case 65326:(this.excludeTypes&this.charType.Upper_DBCS_Katakana)!=this.charType.Upper_DBCS_Katakana&&(this.excludeTypes|=this.charType.Upper_DBCS_Katakana);break;case 65319:(this.excludeTypes&this.charType.Upper_DBCS_Hiragana)!=this.charType.Upper_DBCS_Hiragana&&(this.excludeTypes|=this.charType.Upper_DBCS_Hiragana);break;case 65331:(this.excludeTypes&this.charType.DBCS_Space)!=this.charType.DBCS_Space&&(this.excludeTypes|=this.charType.DBCS_Space);break;case 83:(this.excludeTypes&this.charType.SBCS_Space)!=this.charType.SBCS_Space&&(this.excludeTypes|=this.charType.SBCS_Space);break;case 65332:(this.excludeTypes&this.charType.FourBytes)!=this.charType.FourBytes&&(this.excludeTypes|=this.charType.FourBytes);break;case 65316:(this.excludeTypes&this.charType.TwoBytes)!=this.charType.TwoBytes&&(this.excludeTypes|=this.charType.TwoBytes);break;case 65317:this.excludeTypes|=this.charType.Emoji;break;case 65334:this.excludeTypes|=this.charType.IVS;break;default:this.excludeNormalChar=this.excludeNormalChar+t.Substring(e,e+1)}},t.prototype.ParseFormat=function(t){this.includeFormat=this.GetIncludeFormat(t),this.excludeFormat=this.GetExcludeFormat(t),this.ParseIncludeFormat(this.includeFormat),this.ParseExcludeFormat(this.excludeFormat)},t.prototype.IsValidProcess=function(t,e,i){if(-1!=i.IndexOf(t))return!0;if("	"==t||"\r"==t||"\n"==t)return!0;if(0==e)return!1;var n=!1;if(e==this.charType.All)return!0;if((e&this.charType.Emoji)==(0|this.charType.Emoji)&&this.IsEmoji(t))return!0;if((e&this.charType.IVS)==(0|this.charType.IVS)&&this.IsIVS(t))return!0;if((e&this.charType.FourBytes)==(0|this.charType.FourBytes)&&this.IsFourBytes(t))return!0;if(1==t.GetLength()&&t.length>1)return!1;if((e&this.charType.DBCS_ShiftJIS)==(0|this.charType.DBCS_ShiftJIS)&&this.IsShiftJIS(t))return!0;if(this.charExInstance.IsFullWidth(t)){if((e&this.charType.DBCS)!=(0|this.charType.DBCS))return!1;if((e&this.charType.DBCS_All)==(0|this.charType.DBCS_All)&&"　"!=t)n=!0;else if((e&this.charType.DBCS_LowerAlphabet)==(0|this.charType.DBCS_LowerAlphabet)&&this.IsLower(t))n=!0;else if((e&this.charType.DBCS_UpperAlphabet)==(0|this.charType.DBCS_UpperAlphabet)&&this.IsUpper(t))n=!0;else if((e&this.charType.DBCS_Number)==(0|this.charType.DBCS_Number)&&this.IsNumber(t))n=!0;else if((e&this.charType.DBCS_Binary)==(0|this.charType.DBCS_Binary)&&this.IsBinary(t))n=!0;else if((e&this.charType.DBCS_Hexadecimal)==(0|this.charType.DBCS_Hexadecimal)&&this.IsHex(t))n=!0;else if((e&this.charType.DBCS_Symbol)==(0|this.charType.DBCS_Symbol)&&this.IsSymbol(t))n=!0;else if((e&this.charType.DBCS_NumberSymbol)==(0|this.charType.DBCS_NumberSymbol)&&this.IsNumberSymbol(t))n=!0;else if((e&this.charType.DBCS_Katakana)==(0|this.charType.DBCS_Katakana)&&this.IsKatakana(t)){var o=this.IsHiragana(t);n=o?this.include?!0:(e&this.charType.DBCS_Hiragana)==(0|this.charType.DBCS_Hiragana):!0}else if((e&this.charType.DBCS_Hiragana)==(0|this.charType.DBCS_Hiragana)&&this.IsHiragana(t)){var o=this.IsKatakana(t);n=o?this.include?!0:(e&this.charType.DBCS_Katakana)==(0|this.charType.DBCS_Katakana):!0}else(e&this.charType.DBCS_JISX0208)==(0|this.charType.DBCS_JISX0208)&&this.IsJISX0208(t)?n=!0:(e&this.charType.Upper_DBCS_Katakana)==(0|this.charType.Upper_DBCS_Katakana)&&this.IsKatakana(t)&&this.IsUpperKana(t)?n=!0:(e&this.charType.Upper_DBCS_Hiragana)==(0|this.charType.Upper_DBCS_Hiragana)&&this.IsHiragana(t)&&this.IsUpperKana(t)?n=!0:(e&this.charType.DBCS_Space)==(0|this.charType.DBCS_Space)&&this.IsFormatSpace(t)?n=!0:(e&this.charType.FourBytes)==(0|this.charType.FourBytes)&&this.IsFourBytes(t)?n=!0:(e&this.charType.TwoBytes)==(0|this.charType.TwoBytes)&&!this.IsFourBytes(t)&&"　"!=t&&(n=!0)}else{if((e&this.charType.SBCS)!=this.charType.SBCS)return!1;(e&this.charType.SBCS_All)==this.charType.SBCS_All&&" "!=t?n=!0:(e&this.charType.SBCS_LowerAlphabet)==this.charType.SBCS_LowerAlphabet&&this.IsLower(t)?n=!0:(e&this.charType.SBCS_UpperAlphabet)==this.charType.SBCS_UpperAlphabet&&this.IsUpper(t)?n=!0:(e&this.charType.SBCS_Number)==this.charType.SBCS_Number&&this.IsNumber(t)?n=!0:(e&this.charType.SBCS_Binary)==this.charType.SBCS_Binary&&this.IsBinary(t)?n=!0:(e&this.charType.SBCS_Hexadecimal)==this.charType.SBCS_Hexadecimal&&this.IsHex(t)?n=!0:(e&this.charType.SBCS_Symbol)==this.charType.SBCS_Symbol&&this.IsSymbol(t)?n=!0:(e&this.charType.SBCS_NumberSymbol)==this.charType.SBCS_NumberSymbol&&this.IsNumberSymbol(t)?n=!0:(e&this.charType.SBCS_Katakana)==this.charType.SBCS_Katakana&&this.IsKatakana(t)?n=!0:(e&this.charType.Upper_SBCS_Katakana)==this.charType.Upper_SBCS_Katakana&&this.IsKatakana(t)&&this.IsUpperKana(t)?n=!0:(e&this.charType.SBCS_Space)==this.charType.SBCS_Space&&this.IsFormatSpace(t)&&(n=!0)}return n},t.prototype.IsIncludeValid=function(t){return this.IsValidProcess(t,this.allowTypes,this.includeNormalChar)},t.prototype.IsExcludeValid=function(t){return this.IsValidProcess(t,this.excludeTypes,this.excludeNormalChar)},t.prototype.IsValid=function(t){if(""!=this.excludeFormat){if(this.IsExcludeValid(t))return!1;if(""!=this.includeFormat)return this.IsIncludeValid(t)}else if(""!=this.includeFormat)return this.IsIncludeValid(t);return!0},t.prototype.IsFormatSpace=function(t){return" "==t||"　"==t?!0:!1},t.prototype.IsFourBytes=function(t){var i=e.CharProcess.CharEx,n=t.Substring(0,1);if(n.length>1)for(var o=0;o<n.length;o++)if(i.IsSurrogate(n[o]))return!0;return!1},t.prototype.IsUpper=function(t){return this.charExInstance.IsUpper(t)},t.prototype.IsLower=function(t){return this.charExInstance.IsLower(t)},t.prototype.IsNumber=function(t){return this.charExInstance.IsDigit(t)},t.prototype.IsBinary=function(t){return t=this.IsFullWidth(t)?this.ToHalfWidth(t):t,"0"==t||"1"==t},t.prototype.IsHex=function(t){return t=this.IsFullWidth(t)?this.ToHalfWidth(t):t,"A"==t||"B"==t||"C"==t||"D"==t||"E"==t||"F"==t||"a"==t||"b"==t||"c"==t||"d"==t||"e"==t||"f"==t||this.IsDigit(t)},t.prototype.IsSymbol=function(t){return this.charExInstance.IsHalfWidthSymbol(t)||this.charExInstance.IsFullWidthSymbol(t)},t.prototype.IsNumberSymbol=function(t){return t=this.IsFullWidth(t)?this.ToHalfWidth(t):t,this.IsDigit(t)||"+"==t||"-"==t||"$"==t||"%"==t||"\\"==t||","==t||"."==t},t.prototype.IsKatakana=function(t){return this.charExInstance.IsKatakana(t)},t.prototype.IsHiragana=function(t){return this.charExInstance.IsHiragana(t)},t.prototype.IsShiftJIS=function(t){return this.charExInstance.IsShiftJIS(t)},t.prototype.IsJISX0208=function(t){return this.charExInstance.IsJISX0208(t)},t.prototype.IsEmoji=function(t){var e={};return!1},t.prototype.IsIVS=function(t){var e={};return!1},t.prototype.IsDBCS=function(t){return this.IsFullWidth(t)},t.prototype.IsSBCS=function(t){return!this.IsFullWidth(t)},t.prototype.IsFullWidth=function(t){return this.charExInstance.IsFullWidth(t)},t.prototype.IsSurrogatePair=function(t){return this.charExInstance.IsSurrogatePair(t)},t.prototype.ToHalfWidth=function(t){return this.charExInstance.ToHalfWidth(t)},t.prototype.IsDigit=function(t){return this.charExInstance.IsDigit(t)},t.prototype.IsUpperKana=function(t){return this.charExInstance.IsUpperKana(t)},t.prototype.CheckValidSpace=function(t){return" "==t&&(this.allowTypes&this.charType.SBCS_Space)==(0|this.charType.SBCS_Space)?!0:"　"==t&&(this.allowTypes&this.charType.DBCS_Space)==(0|this.charType.DBCS_Space)?!0:!1},t.prototype.Check=function(t,e){var i;i=null!=e?t.Substring(e,e+1):t;var n=this.IsValid(i);return n?i:this.autoConvert?null!=e?this.Convert(t,e):this.Convert(i):""},t.prototype.CheckText=function(t){for(var e=t.GetLength(),i={IsInputValid:!0,CheckedText:""},n=0;e>n;){var o=t.Substring(n,n+1);if("	"!=o&&"\r"!=o&&"\n"!=o){var r=this.Check(t,n);null!=r.index?(n=r.index,o=r.strValue):(o=r,n++),""==o&&(i.IsInputValid=!1)}else n++;i.CheckedText+=o}return i},t.prototype.Convert=function(t,e){var i;i=null==e?t:t.Substring(e,e+1);var n=!1;if(this.charExInstance.IsAlphabet(i)){var o=this.charExInstance.IsLower(i)?i.toUpperCase():i.toLowerCase();return n=this.IsValid(o),n?o:(i=this.charExInstance.IsFullWidth(i)?this.charExInstance.ToHalfWidth(i):this.charExInstance.ToFullWidth(i).text,n=this.IsValid(i),n?i:(o=this.charExInstance.IsFullWidth(o)?this.charExInstance.ToHalfWidth(o):this.charExInstance.ToFullWidth(o).text,n=this.IsValid(o),n?o:""))}if(this.charExInstance.IsHiragana(i)){if(this.charExInstance.IsLowerKana(i)){var r=this.charExInstance.ToUpperKana(i);if(n=this.IsValid(r))return r}else if(this.charExInstance.HasLowerKana(i)){var s=this.charExInstance.ToLowerKana(i);if(n=this.IsValid(s))return s}var o=this.charExInstance.ToKatakana(i);if(n=this.IsValid(o))return o;if(this.charExInstance.IsLowerKana(o)){var r=this.charExInstance.ToUpperKana(o);if(n=this.IsValid(r))return r}else if(this.charExInstance.HasLowerKana(o)){var s=this.charExInstance.ToLowerKana(o);if(n=this.IsValid(s))return s}var a=this.charExInstance.ToHalfWidthEx(o);if(n=this.IsValid(a))return a;if(this.charExInstance.IsLowerKana(a)){if(a=this.charExInstance.ToUpperKana(a),n=this.IsValid(a))return a}else if(this.charExInstance.HasLowerKana(a)&&(a=this.charExInstance.ToLowerKana(a),n=this.IsValid(a)))return a;return""}if(this.charExInstance.IsKatakana(i)){if(this.charExInstance.IsLowerKana(i)){var r=this.charExInstance.ToUpperKana(i);if(n=this.IsValid(r))return r}else if(this.charExInstance.HasLowerKana(i)){var s=this.charExInstance.ToLowerKana(i);if(n=this.IsValid(s))return s}var l=!1,o=i;if(this.charExInstance.IsFullWidth(i)){var h=this.charExInstance.ToHalfWidthEx(i);if(h.GetLength()>0&&(n=this.IsValid(h)))return h;if(this.charExInstance.IsLowerKana(h)){if(h=this.charExInstance.ToUpperKana(h),n=this.IsValid(h))return h}else if(this.charExInstance.HasLowerKana(h)&&(h=this.charExInstance.ToLowerKana(h),n=this.IsValid(h)))return h}else{if(null==e){if(o=this.charExInstance.ToFullWidth(i).text,!this.charExInstance.IsKatakana(o))return"";if(n=this.IsValid(o))return o}else{if(e+1<t.GetLength()){var d=this.charExInstance.ToFullWidth(t.Substring(e,e+2));o=d.text,l=d.processedAll}else o=this.charExInstance.ToFullWidth(i).text;if(!this.charExInstance.IsKatakana(o))return"";if(n=this.IsValid(o))return e++,l&&e++,{index:e,strValue:o}}if(this.charExInstance.IsLowerKana(o)){var r=this.charExInstance.ToUpperKana(o);if(n=this.IsValid(r))return r}else if(this.charExInstance.HasLowerKana(o)){var s=this.charExInstance.ToLowerKana(o);if(n=this.IsValid(s))return s}}if(o=this.charExInstance.ToHiragana(o),n=this.IsValid(o)){if(null!=e){e++,l&&e++;var c={index:e,strValue:o};return"ゔ"==o&&(l?c.strValue="う゛":c.strValue=""),c}return"ゔ"==o?"":o}if(this.charExInstance.IsLowerKana(o)){var r=this.charExInstance.ToUpperKana(o);if(n=this.IsValid(r))return r}else if(this.charExInstance.HasLowerKana(o)){var s=this.charExInstance.ToLowerKana(o);if(n=this.IsValid(s))return s}}return i=this.charExInstance.IsFullWidth(i)?this.charExInstance.ToHalfWidth(i):this.charExInstance.ToFullWidth(i).text,n=this.IsValid(i),n?i:""},t}();e.TextFilter=g}(t.input||(t.input={}));var e=t.input}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";function i(t,e){var i=n.extend(!0,{},t,e);return delete i.constructor,i}var n=jQuery;e.extendWidgetOptions=i;var o=function(i){function o(){i.apply(this,arguments),this._dataOffset=0,this.rowOuterHeight=-1,this._windowResizeTimer=0,this.mEditSkechRowIndex=-1}return __extends(o,i),o.CSS={wijgrid:"wijmo-wijgrid",root:"wijmo-wijgrid-root",editedCellMarker:"wijmo-wijgrid-cell-edit",inputMarker:"wijgridinput",table:"wijmo-wijgrid-table",TH:"wijgridth",TD:"wijgridtd",cellContainer:"wijmo-wijgrid-innercell",rowHeader:"wijmo-wijgrid-rowheader",currentRowHeaderCell:"wijmo-wijgrid-current-rowheadercell",currentHeaderCell:"wijmo-wijgrid-current-headercell",currentCell:"wijmo-wijgrid-current-cell",cellAlignLeft:"wijalign-left",cellAlignRight:"wijalign-right",cellAlignCenter:"wijalign-center",filterList:"wijmo-wijgrid-filterlist",filter:"wijmo-wijgrid-filter",filterInput:"wijmo-wijgrid-filter-input",filterTrigger:"wijmo-wijgrid-filter-trigger",filterNativeHtmlEditorWrapper:"wijgrid-input-wrapper",headerArea:"wijmo-wijgrid-header",footerArea:"wijmo-wijgrid-footer",headerRow:"wijmo-wijgrid-headerrow",row:"wijmo-wijgrid-row",dataRow:"wijmo-wijgrid-datarow",altRow:"wijmo-wijgrid-alternatingrow",emptyDataRow:"wijmo-wijgrid-emptydatarow",filterRow:"wijmo-wijgrid-filterrow",groupHeaderRow:"wijmo-wijgrid-groupheaderrow",groupFooterRow:"wijmo-wijgrid-groupfooterrow",footerRow:"wijmo-wijgrid-footerrow",loadingOverlay:"wijmo-wijgrid-overlay",loadingText:"wijmo-wijgrid-loadingtext",groupArea:"wijmo-wijgrid-group-area",groupAreaEmpty:"wijmo-wijgrid-group-area-empty",groupAreaButton:"wijmo-wijgrid-group-button",groupAreaButtonSort:"wijmo-wijgrid-group-button-sort",groupAreaButtonClose:"wijmo-wijgrid-group-button-close",groupToggleVisibilityButton:"wijmo-wijgrid-grouptogglebtn",fixedView:"wijmo-wijgrid-fixedview",scroller:"wijmo-wijgrid-scroller",dndHelper:"wijmo-wijgrid-dnd-helper",dndArrowTopContainer:"wijmo-wijgrid-dnd-arrow-top",dndArrowBottomContainer:"wijmo-wijgrid-dnd-arrow-bottom",freezingHandleV:"wijmo-wijgrid-freezing-handle-v",freezingHandleH:"wijmo-wijgrid-freezing-handle-h",resizingHandle:"wijmo-wijgrid-resizehandle",headerCellSortIcon:"wijmo-wijgrid-sort-icon",headerCellText:"wijmo-wijgrid-headertext",c1basefield:"wijmo-c1basefield",c1band:"wijmo-c1band",c1field:"wijmo-c1field"},o.prototype._createWidget=function(e,n){var o=e&&t.data.util.isClassInstance(e.data)&&!("function"==typeof wijdatasource&&e.data instanceof wijdatasource)&&e.data;o&&delete e.data,i.prototype._createWidget.apply(this,arguments),o&&(e.data=o,this.option("data",o))},o.prototype._create=function(){var e=this;if(!this.element.is("table"))throw"invalid markup";this._windowResizeTimer=0,this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this.rowOuterHeight=-1,this._initialized=!1,this._destroyed=!1,this._rendered=!1,this._eventUID=void 0,this._dataViewWrapper=void 0,this._originalHtml=void 0,this._originalAttr=void 0,this._originalCssText=void 0,this._autoHeight=void 0,this._autoWidth=void 0,this._renderCounter=0,this.$superPanelHeader=void 0,this.$topPagerDiv=void 0,this.$bottomPagerDiv=void 0,this.$groupArea=void 0,this.__uid=void 0,this._wijDataView=void 0,this.outerDiv=void 0,this.sketchTable=void 0,this.cellFormatter=void 0,this.rowStyleFormatter=void 0,this.cellStyleFormatter=void 0,this._eventUID=t.grid.getUID(),this._spinnerIsActivated=!1,this.deficientFilters={};var i="data"in this.options,o=i&&this.options.data;i&&delete this.options.data,this.options=n.extend(!0,{},this.options),n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options),i&&(this.options.data=o),window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._initialized=!1,this._destroyed=!1,this.mClosestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this._dataViewWrapper=new t.grid.dataViewWrapper(this),this._originalHtml=this.element.html(),this._originalAttr={},this._originalCssText=this.element[0].style.cssText,this.element.addClass(t.grid.wijgrid.CSS.root),this.element.wrap('<div class="'+this.options.wijCSS.widget+" "+t.grid.wijgrid.CSS.wijgrid+" "+this.options.wijCSS.wijgrid+" "+this.options.wijCSS.content+" "+this.options.wijCSS.cornerAll+'"></div>'),this.outerDiv=this.element.parent();var r=this.element[0].style.height,s=this.element[0].style.width;r&&this.outerDiv.css("height",r),this._autoHeight=""==r||"auto"==r,s&&this.outerDiv.css("width",this.element[0].style.width),this._autoWidth=""==s||"auto"==s,this.element.css({height:"",width:""}),this.options.disabled&&this.disable(),this.cellFormatter=new t.grid.cellFormatterHelper,this.rowStyleFormatter=new t.grid.rowStyleFormatterHelper(this),this.cellStyleFormatter=new t.grid.cellStyleFormatterHelper(this),this._viewPortBounds({start:0,end:0}),this._allowVirtualScrolling()&&(this._viewPortBounds().start=this._scrollingState.index,this._serverSideVirtualScrolling()&&(this._dataOffset=this._scrollingState.index)),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(t){e._initialized&&!e._destroyed&&t.target!==e.outerDiv[0]&&e.setSize()},"wijgrid"),this._renderCounter=0},o.prototype._destroy=function(){var e,i=this;try{this._view().dispose(),this._detachEvents(!0),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._dragndropui&&(this._dragndropui.dispose(),this._dragndropui=null),this._dataViewWrapper.dispose(),t.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.wijRemoveVisibilityObserver&&this.element.wijRemoveVisibilityObserver(),this.element.insertBefore(this.outerDiv),this.outerDiv.remove(),this.element.html(this._originalHtml),n.each(this._originalAttr,function(t,e){void 0===e?i.element.removeAttr(t):i.element.attr(t,e)}),this.element.removeClass(t.grid.wijgrid.CSS.root),this.element[0].style.cssText=this._originalCssText}finally{this._destroyed=!0}},o.prototype._init=function(){this.$superPanelHeader=null,this.$topPagerDiv=null,this.$bottomPagerDiv=null,this.$groupArea=null,this._prevHoveredSketchRowIndex=-1,this.mClosestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this.options.data||(this._field("thead")||this._field("thead",t.grid.readTableSection(this.element,1)),this._field("tfoot")||this._field("tfoot",t.grid.readTableSection(this.element,3))),this._initialized=this._initialized||!1,this.ensureControl(!0)},o.prototype._setOption=function(t,e){var n=this["_preset_"+t],o=this.options[t],r,s;void 0!==n&&(e=n.apply(this,[e,o])),r=e!==o||"columns"===t.toLowerCase(),i.prototype._setOption.apply(this,[t,e]),r&&(s=this["_postset_"+t],void 0!==s&&s.apply(this,[e,o]))},o.prototype.columns=function(){return this._field("columns")||[]},o.prototype.currentCell=function(i,n,o){var r,s=this._view(),a=this._rows();if(0===arguments.length)return r=this._field("currentCell"),r||this._field("currentCell",r=t.grid.cellInfo.outsideValue),r;if(r="number"!=typeof i?i._clone():new t.grid.cellInfo(i,n),!r.isEqual(t.grid.cellInfo.outsideValue)){if(!r._isValid())throw"invalid arguments";if(r._clip(this._getDataCellsRange(e.dataRowsRangeMode.sketch)),r.rowIndex()>=0&&!(s._getRowInfoBySketchRowIndex(r.rowIndex()).type&t.grid.rowType.data))return}return r._setGridView(this),this._changeCurrentCell(null,r,{changeSelection:o||!1,setFocus:!1}),this._field("currentCell")},o.prototype.data=function(){return this._dataViewWrapper.dataView().getSource()},o.prototype.dataView=function(){return this._dataViewWrapper.dataView()},o.prototype.doRefresh=function(i){var o=this;n.isPlainObject(i)||(i={});var r,s=this,a=t.grid.EXPANDO,l=i&&i.virtualScrollData;if(!this._initialized)try{this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.getFieldsInfo(),!0,!0)}catch(h){throw h}finally{this._ownerise(!0),this._initialized=!0}if(!l){this._rebuildLeaves();var d=e.lazy(this._dataViewWrapper.data,this._dataViewWrapper),c=this._dataViewWrapper.dataView(),u=this._prepareTotalsRequest(!0);if(u.length&&n.each(this._field("leaves"),function(t,e){e._totalsValue=d().totals?d().totals[e.dataKey]:void 0}),c.count()){r=this._field("leaves");var p=new t.grid.LazySketchTable({count:function(){return c.count()},getRange:function(t,e,i,n){for(var s=0;e>s;s++){var a=t+s,l=c.item(a);i[n+s]=o._buildSketchRow({values:l,originalRowIndex:a},r)}}});(this._hasGrouping()||this._hasMerging())&&p.ensureNotLazy(),this.sketchTable=p}else{this.sketchTable=new t.grid.SketchTable;var g=d().emptyData;g&&(r=this._field("visibleLeaves"),n.each(g,function(t,e){s.sketchTable.add(s._buildSketchRowEmptyDataItem(e,r,t===g.length-1))}))}}this._onRendering(i),l?this._refreshVirtual(i):this._refresh(i),i&&n.isFunction(i.beforeOnRendered)&&i.beforeOnRendered.apply(this,[i]),this._onRendered(i),i&&n.isFunction(i.afterRefresh)&&i.afterRefresh.apply(this,[i]);
},o.prototype.beginEdit=function(){if(!this._allowCellEditing())throw'Can be used only if the editingMode option is set to "cell".';return this._beginEditInternal(null)},o.prototype.endEdit=function(){return this._endEditInternal(null)},o.prototype.editRow=function(e){if("row"!==this.options.editingMode)throw'Can be used only if the editingMode option is set to "row".';if(this.mEditSkechRowIndex>=0&&this.cancelRowEditing(),e>=0){for(var i=-1,n,o=0;o<this.sketchTable.count()&&0>i;o++)n=this.sketchTable.row(o),n.isDataRow()&&n.dataItemIndex()===e&&(i=o);if(i>=0){var r=this._view();if(this.mEditSkechRowIndex=i,n.renderState|=t.grid.renderState.editing,r._isRowRendered(this.mEditSkechRowIndex)>=0){var s=r._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1);s.state|=t.grid.renderState.editing,r._removeBodyRow(s.sectionRowIndex,!1),s=r._insertBodyRow(n,s.sectionRowIndex,s.dataItemIndex,-1)}}}},o.prototype.updateRow=function(){if(this.mEditSkechRowIndex>=0){var i=t.grid.asEditableDataView(this._dataViewWrapper.dataView()),n=!1;if(!i)throw"The provided DataView doesn't supports the editing operation.";try{var o=this.sketchTable.row(this.mEditSkechRowIndex),r=this._view();if(!(o&&o.isDataRow()&&o.renderState&t.grid.renderState.editing))throw"Invalid row";if(this._view()._isRowRendered(this.mEditSkechRowIndex)>=0){for(var s=r._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1),a=this._field("visibleLeaves"),l=[],h=new t.grid.cellEditorHelper,d=0;d<a.length;d++){var c=a[d];if(t.grid.validDataKey(c.dataKey)&&!c.readOnly){var u=s.$rows.children("td, th").eq(d);if(u.length){var p=r._changeCellRenderState(u,t.grid.renderState.none,!0);if(p&t.grid.renderState.editing){var g=r.getAbsoluteCellInfo(u[0],!0),f=h.updateCell(this,g,null);if(!(f&e.updateCellResult.success))return void(n=!0);f&e.updateCellResult.notEdited||l.push(g)}}}}for(var d=0;d<l.length;d++)h.cellEditEnd(this,l[d],null);o.renderState&=~t.grid.renderState.editing,s.state&=~t.grid.renderState.editing,r._removeBodyRow(s.sectionRowIndex,!1),s=r._insertBodyRow(o,s.sectionRowIndex,s.dataItemIndex,-1)}else o.renderState&=~t.grid.renderState.editing}finally{n||(this.mEditSkechRowIndex=-1)}}},o.prototype.cancelRowEditing=function(){if(this.mEditSkechRowIndex>=0)try{var e=this.sketchTable.row(this.mEditSkechRowIndex),i=this._view();if(!(e&&e.isDataRow()&&e.renderState&t.grid.renderState.editing))throw"Invalid row.";if(e.renderState&=~t.grid.renderState.editing,this._view()._isRowRendered(this.mEditSkechRowIndex)>=0){var n=i._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1);n.state&=~t.grid.renderState.editing,i._removeBodyRow(n.sectionRowIndex,!1),n=i._insertBodyRow(e,n.sectionRowIndex,n.dataItemIndex,-1)}}finally{this.mEditSkechRowIndex=-1}},o.prototype.deleteRow=function(e){if(e>=0){var i=t.grid.asEditableDataView(this._dataViewWrapper.dataView());if(!i||!i.canRemove())throw"The provided DataView doesn't supports the deleting operation.";this._dataViewWrapper.ignoreChangeEvent(!0),i.remove(e),this._dataViewWrapper.ignoreChangeEvent(!1),this.ensureControl(!0,{forceDataLoad:!0})}},o.prototype.ensureControl=function(e,i){this._loading(),n.isPlainObject(i)||(i={data:null,afterRefresh:null,beforeRefresh:null}),this._initialized?(!i||!i.virtualScrollData)&&this._convertWidgetsToOptions():(this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.isDataLoaded()&&this._dataViewWrapper.getFieldsInfo(),this._dataViewWrapper.isDataLoaded(),!1),this._dataViewWrapper.isOwnDataView()||new t.grid.settingsManager(this).MapDVToWG()),this._ownerise(!0),this._initialized&&i&&n.isFunction(i.beforeRefresh)&&i.beforeRefresh.apply(this),i&&i.virtualScrollData||(this.mAllowVirtualScrolling=void 0,this.mEditSkechRowIndex=-1),e===!0?this._dataViewWrapper.load(i):(this.doRefresh(i),this._loaded())},o.prototype.getCellInfo=function(t){var e=null;return t&&(t=this._findUntilOuterDiv(t,{td:!0,th:!0}))&&(e=this._view().getAbsoluteCellInfo(t,!1)),e},o.prototype.getFilterOperatorsByDataType=function(e){return new t.grid.filterOperatorsCache(this).getByDataType(e||"string")},o.prototype.pageCount=function(){return this._customPagingEnabled()?Math.ceil(this.options.totalRows/this.options.pageSize)||1:this.options.allowPaging?this._dataViewWrapper.dataView().pageCount():1},o.prototype._closestCulture=function(){return this.mClosestCulture},o.prototype._serverShaping=function(){return!1},o.prototype._pageIndexForDataView=function(){return this.options.pageIndex},o.prototype.setSize=function(t,e){var i=this._view(),o=null,r=this.outerDiv,s=this._field("visibleLeaves"),a=[];i&&i.getScrollValue&&(o=i.getScrollValue()),(t||0===t)&&(this._autoWidth=!1,r.width(t)),(e||0===e)&&(this._autoHeight=!1,r.height(e)),n.each(s,function(t,e){var o=i.getHeaderCell(t),r=i.getJoinedCols(t);n(o).css("width",""),n.each(r,function(t,e){n(e).css("width","")})}),this._setSizeInternal(o);var l=this._UIFrozener();l&&l.refresh()},o.prototype._setSizeInternal=function(t){this._view().updateSplits(t)},o.prototype.selection=function(){var e=this._field("selection");return e||this._field("selection",e=new t.grid.selection(this)),e},o.prototype._onDataViewCurrentPositionChanged=function(t,e){var i=this._currentCellFromDataView(this.currentCell().cellIndex()),n=this.selection();i=this.currentCell(i,null,!0)},o.prototype._resetDataProperties=function(){this.options.pageIndex=0;var t=this._viewPortBounds();t.start=t.end=0},o.prototype._onDataViewLoading=function(){this._activateSpinner(),this._trigger("dataLoading")},o.prototype._onDataViewReset=function(e){new t.grid.settingsManager(this).MapDVToWG(),this._trigger("dataLoaded"),this.doRefresh(e),this._loaded()},o.prototype._onDataViewLoaded=function(){},o.prototype._loading=function(){this._activateSpinner(),this._trigger("loading")},o.prototype._loaded=function(){this._deactivateSpinner(),this._trigger("loaded")},o.prototype._buildSketchRow=function(i,n){var o,r,s,a,l,h,d=t.data.Expando.getFrom(i.values,!1),c=d?d[t.grid.EXPANDO]:null,u=new t.grid.SketchDataRow(i.originalRowIndex,void 0,c&&c.rowAttributes),p=c&&c.cellsAttributes;for(o=0,r=n.length;r>o;o++)s=n[o],t.grid.validDataKey(s.dataKey)&&(a=p?p[s.dataKey]:null,l=this._dataViewWrapper.getValue(i.values,s.dataKey),u.add(new e.ValueCell(this.parse(s,l),a)));return u},o.prototype._buildSketchRowEmptyDataItem=function(i,n,o){var r,s,a=new e.SketchRow(t.grid.rowType.emptyDataRow,void 0),l=n.length;for(r=0,s=i.length;s>r;r++)a.add(new e.HtmlCell(i[r],{colSpan:l>0&&o?l:1}));return a},o.prototype._prepareColumnOptions=function(i,o,r,s,a){t.grid.traverse(i,function(t){t.isBand=n.isArray(t.columns)||"c1band"===t.clientType,(e.c1commandbtnfield.test(t)||e.c1btnfield.test(t))&&(t.dataKey=null),t._originalDataKey=t.dataKey,t._originalHeaderText=t.headerText}),(new t.grid.bandProcessor).getVisibleHeight(i,!0);var l=[],h=this._originalHeaderRowData(),d=this._originalFooterRowData(),c=(o||"").toLowerCase(),u=this;s&&t.grid.columnsGenerator.generate(c,r,i),t.grid.setTraverseIndex(i),t.grid.traverse(i,function(i){i.isBand=n.isArray(i.columns)||"c1band"===i.clientType,t.grid.shallowMerge(i,e.c1basefield.prototype.options),i.isBand?i.clientType="c1band":e.c1commandbtnfield.test(i)?(i.clientType="c1commandbtnfield",t.grid.shallowMerge(i,e.c1btnfieldbase.prototype.options),t.grid.shallowMerge(i,e.c1commandbtnfield.prototype.options),i.editCommand=i.editCommand||{},t.grid.shallowMerge(i.editCommand,e.c1commandbtnfield.prototype.options.editCommand),i.cancelCommand=i.cancelCommand||{},t.grid.shallowMerge(i.cancelCommand,e.c1commandbtnfield.prototype.options.cancelCommand),i.deleteCommand=i.deleteCommand||{},t.grid.shallowMerge(i.deleteCommand,e.c1commandbtnfield.prototype.options.deleteCommand),i.updateCommand=i.updateCommand||{},t.grid.shallowMerge(i.updateCommand,e.c1commandbtnfield.prototype.options.updateCommand)):e.c1btnfield.test(i)?(i.clientType="c1btnfield",t.grid.shallowMerge(i,e.c1btnfieldbase.prototype.options),t.grid.shallowMerge(i,e.c1btnfield.prototype.options)):(t.grid.shallowMerge(i,e.c1field.prototype.options),i.groupInfo=i.groupInfo||{},t.grid.shallowMerge(i.groupInfo,e.c1field.prototype.options.groupInfo),i.clientType||(i.clientType="c1field")),i.isLeaf&&!i.isBand&&l.push(i)}),this._field("leaves",l),s&&n.each(l,n.proxy(function(e,i){var o="number"==typeof i.dataKey?i.dataKey:e;("merge"===c||i.dynamic===!0)&&void 0===i.headerText&&(u._dataViewWrapper&&u._dataViewWrapper.isBoundedToDOM()&&h&&o<h.length?i.headerText=n.trim(h[o]):t.grid.validDataKey(i.dataKey)&&(i.headerText=""+i.dataKey)),u._dataViewWrapper&&u._dataViewWrapper.isBoundedToDOM()&&d&&o<d.length&&(i._footerTextDOM=n.trim(d[o]))},this))},o.prototype._rebuildLeaves=function(){var e=[],i=[],o;this._showRowHeader()&&(o=t.grid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:!0,allowMoving:!1,allowSizing:!1,allowSort:!1,isRowHeader:!0}),o.owner=this,e.push(o)),n.each(this.options.columns,function(t,i){e.push(i)}),this._columnsHeadersTable((new t.grid.bandProcessor).generateSpanTable(e,i)),this._field("leaves",i),this._onLeavesCreated()},o.prototype._onLeavesCreated=function(){var e=this._field("leaves"),i=this._dataViewWrapper.getFieldsInfo(),o,r=0,s=0,a=this;this._field("visibleLeaves",n.grep(e,function(e,a){return e.leavesIdx=a,t.grid.validDataKey(e.dataKey)?e.dataIndex=r++:e.dataIndex=-1,e.isBand||(o=i[e.dataKey],o&&(e._underlyingDataType=o.type,e._underlyingDataFormatString=o.format),n.isFunction(e.dataParser)&&(e.dataParser=new e.dataParser)),e.parentVis?(e.visLeavesIdx=s++,!0):!1}))},o.prototype._allowEditing=function(){return this.options.allowEditing===!0||"cell"===this.options.editingMode||"row"===this.options.editingMode},o.prototype._allowCellEditing=function(){return this.options.allowEditing===!0||"cell"===this.options.editingMode},o.prototype._allowVirtualScrolling=function(){return void 0===this.mAllowVirtualScrolling&&(this.mAllowVirtualScrolling=!this.options.allowPaging&&this.options.allowVirtualScrolling&&this.options.staticRowIndex<0&&"none"!==this.options.scrollMode&&!this._hasMerging()),this.mAllowVirtualScrolling},o.prototype._headerRows=function(){return this._view().headerRows()},o.prototype._filterRow=function(){return this._view().filterRow()},o.prototype._rows=function(){return this._view().bodyRows()},o.prototype._localizeFilterOperators=function(e){var i=this,o=new t.grid.filterOperatorsCache(this);n.each(e,function(t,e){if(e.name){var i=o.getByName(e.name);i&&(i.displayName=e.displayName)}})},o.prototype._UIDragndrop=function(e){return!this._dragndropui&&e&&(this._dragndropui=new t.grid.uiDragndrop(this)),this._dragndropui},o.prototype._UIFrozener=function(e){return!this._frozenerui&&e&&(this._frozenerui=new t.grid.uiFrozener(this)),this._frozenerui},o.prototype._UIResizer=function(e){return!this._resizerui&&e&&(this._resizerui=new t.grid.uiResizer(this)),this._resizerui},o.prototype._UISelection=function(e){return!this._selectionui&&e&&(this._selectionui=new t.grid.uiSelection(this)),this._selectionui},o.prototype._postset_allowColMoving=function(t,e){var i=this;n.each(this.columns(),function(e,n){t?i._UIDragndrop(!0).attach(n):i._UIDragndrop(!0).detach(n)});var o=this._field("groupedWidgets");o&&n.each(o,function(e,n){t?i._UIDragndrop(!0).attach(n):i._UIDragndrop(!0).detach(n)})},o.prototype._postset_allowSorting=function(t,e){this.ensureControl(!1)},o.prototype._postset_columns=function(t,e){this._initialized=!1,this.ensureControl(!0)},o.prototype._postset_allowPaging=function(t,e){this.ensureControl(!0)},o.prototype._postset_freezingMode=function(t,e){this._frozenerui&&this._frozenerui.refresh()},o.prototype._postset_culture=function(t,e){throw"read-only"},o.prototype._postset_customFilterOperators=function(t,e){var i=this._dataViewWrapper.dataView()},o.prototype._postset_data=function(e,i){this._ownerise(!1),t.grid.traverse(this.options.columns,function(t,e){if(t.dynamic){var i=n.inArray(t,e);i>=0&&e.splice(i,1)}else t.dataKey=t._originalDataKey,t.headerText=t._originalHeaderText}),this._initialized=!1,this._dataViewWrapper&&this._dataViewWrapper.dispose(),this._dataViewWrapper=new t.grid.dataViewWrapper(this),this.ensureControl(!0)},o.prototype._postset_disabled=function(e,i){var n=this,o=this._view();t.grid.iterateChildrenWidgets(this.outerDiv,function(t,i){i!==n&&i.option("disabled",e)}),o&&o.ensureDisabledState()},o.prototype._postset_groupIndent=function(t,e){this.ensureControl(!1)},o.prototype._postset_groupAreaCaption=function(t,e){var i=this._groupedColumns();this.$groupArea&&(!i||!i.length)&&this.$groupArea.html(t||"&nbsp;")},o.prototype._postset_highlightCurrentCell=function(t,e){var i=this.currentCell();i&&i._isValid()&&this._highlightCellPosition(i,t)},o.prototype._preset_pageIndex=function(t,e){if(isNaN(t))throw"out of range";var i=this.pageCount(),n=function(t){return t>i-1&&(t=i-1),0>t&&(t=0),t},o;return t=n(t),this.options.allowPaging&&t!==e&&(o={newPageIndex:t},t=this._onPageIndexChanging(o)?n(o.newPageIndex):e),t},o.prototype._postset_pageIndex=function(t,e){if(this.options.allowPaging){var i={newPageIndex:t};this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onPageIndexChanged(i)):this.ensureControl(!0,{afterRefresh:function(){this._onPageIndexChanged(i)}})}},o.prototype._preset_pageSize=function(t,e){if(isNaN(t))throw"out of range";return 0>=t&&(t=1),t},o.prototype._postset_pageSize=function(t,e){this._resetDataProperties(),this.options.allowPaging&&!this._customPagingEnabled()&&this.ensureControl(!0)},o.prototype._postset_pagerSettings=function(t,e){this.ensureControl(!1)},o.prototype._postset_rowHeight=function(t,e){this.rowOuterHeight=-1,this.ensureControl(!1)},o.prototype._postset_scrollMode=function(t,e){this.ensureControl(!1)},o.prototype._postset_selectionMode=function(e,i){var n=this.selection(),o=this.currentCell(),r=this.selection().selectedCells().length();n.beginUpdate(),n.clear(),o&&o._isValid()&&r&&n._selectRange(new t.grid.cellInfoRange(o,o),!1,!1,t.grid.cellRangeExtendMode.none,null),n.endUpdate(),this._view().toggleDOMSelection("none"===e)},o.prototype._postset_showFilter=function(t,e){this.ensureControl(!1)},o.prototype._postset_showGroupArea=function(t,e){this.ensureControl(!1)},o.prototype._postset_showRowHeader=function(t,e){this.ensureControl(!1)},o.prototype._postset_staticRowIndex=function(){"none"!==this.options.scrollMode&&this.ensureControl(!1)},o.prototype._postset_staticColumnIndex=function(){"none"!==this.options.scrollMode&&this.ensureControl(!1)},o.prototype._postset_allowVirtualScrolling=function(t,e){this.ensureControl(!1)},o.prototype._preset_allowVirtualScrolling=function(t,e){if(isNaN(t)||0>t)throw"out of range";return t},o.prototype._activateSpinner=function(){if(!this._spinnerIsActivated){var e=t.grid.wijgrid.CSS,i=this.options.wijCSS,n=this.outerDiv.append('<div class="'+e.loadingOverlay+" "+i.wijgridLoadingOverlay+" "+i.overlay+'"></div><span class="'+e.loadingText+" "+i.wijgridLoadingText+" "+i.content+" "+i.cornerAll+'"><span class="'+i.icon+" "+i.iconClock+'"></span>'+this.options.loadingText+"</span>").find("> ."+e.loadingText);n.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"}),this._spinnerIsActivated=!0}},o.prototype._customPagingEnabled=function(){return this.options.allowPaging&&this.options.totalRows>=0},o.prototype._deactivateSpinner=function(){if(this._spinnerIsActivated)try{var e=t.grid.wijgrid.CSS;this.outerDiv.find("> ."+e.loadingOverlay+", > ."+e.loadingText).remove()}finally{this._spinnerIsActivated=!1}},o.prototype._columnWidgetsFactory=function(t,e){var i,o=e.clientType;!o&&e.isBand&&(o="c1band"),e=n.extend({},e,{disabled:this.options.disabled});try{switch(n.data(t[0],"wijgridowner",this),o){case"c1basefield":i=t.c1basefield(e);break;case"c1band":i=t.c1band(e);break;case"c1btnfield":i=t.c1btnfield(e);break;case"c1commandbtnfield":i=t.c1commandbtnfield(e);break;default:i=t.c1field(e)}}finally{n.removeData(t[0],"wijgridowner")}return i},o.prototype._convertWidgetsToOptions=function(){this._initialized&&this._mergeWidgetsWithOptions&&(this._ownerise(!1),this._widgetsToOptions(),this._ownerise(!0))},o.prototype._field=function(e,i){return t.grid.dataPrefix(this.element,this._data$prefix,e,i)},o.prototype._removeField=function(t){var e=this._data$prefix+t;this.element.removeData(e)},o.prototype._prepareTotalsRequest=function(e){var i=this._field("leaves"),o,r;return i&&this.options.showFooter?o=n.map(i,function(i,n){return!i.isBand&&t.grid.validDataKey(i.dataKey)&&i.aggregate&&"none"!==i.aggregate?e?[{column:i,aggregate:i.aggregate}]:[{dataKey:i.dataKey,aggregate:i.aggregate}]:null}):[]},o.prototype._widgetsToOptions=function(){var e=t.grid.flatten(this.options.columns);n.each(this.columns(),function(t,i){delete i.options.columns;var o=e[i.options.travIdx];n.extend(!0,o,i.options),o.filterValue=i.options.filterValue,o.filterOperator=i.options.filterOperator})},o.prototype._recreateColumnWidgets=function(){n.each(this.columns(),function(t,e){e.destroy()});var e=[],i=this._headerRows(),o,r,s,a,l,h,d;if(i&&i.length())for(o=[],t.grid.traverse(this.options.columns,function(t){t.parentVis&&o.push(t)}),r=0,s=o.length;s>r;r++)a=o[r],l=i.item(a.thY),h=t.grid.rowAccessor.getCell(l,a.thX),d=this._columnWidgetsFactory(n(h),a),e.push(d.data(t.grid.widgetName(d)));this._field("columns",e)},o.prototype._groupedColumns=function(t){var e;if(t=!(e=this._field("groupedColumns"))||t){e=[];var i=this._field("leaves")||[],o=!1,r=function(t){return t.groupInfo&&t.groupInfo.position&&"none"!==t.groupInfo.position};n.each(i,function(t,i){r(i)?(o=o||void 0===i.groupedIndex,o||e.push(i)):delete i.groupedIndex}),o?n.each(i,function(t,i){r(i)&&(i.groupedIndex=e.length,e.push(i))}):(e.sort(function(t,e){return t.groupedIndex-e.groupedIndex}),n.each(e,function(t,e){e.groupedIndex=t})),this._field("groupedColumns",e)}return e||[]},o.prototype._ownerise=function(e){if(e){var i=this;t.grid.traverse(this.options.columns,function(t){t.owner=i;var e,n,o;if((e=t.groupInfo)&&(e.owner=t,e.expandInfo))for(n=0,o=e.expandInfo.length;o>n;n++)e.expandInfo[n].owner=e})}else t.grid.traverse(this.options.columns,function(t){delete t.owner;var e,i,n;if((e=t.groupInfo)&&(delete e.owner,e.expandInfo))for(i=0,n=e.expandInfo.length;n>i;i++)delete e.expandInfo[i].owner})},o.prototype._ensureRenderableBounds=function(e){return t.grid.ensureBounds(e,this._renderableRowsCount()-1)},o.prototype._ensureTotalRowsBounds=function(e){return t.grid.ensureBounds(e,this._totalRowsCount()-1)},o.prototype._ensureViewPortBoundsVisible=function(t){var e=this._renderableRowsCount();return t.end>=e&&(t.start-=t.end-e,t.end=e-1),t},o.prototype._renderableBoundsCollection=function(){return this.mRenderableBoundsCollection},o.prototype._rebuildRenderBoundsCollection=function(){var e=-1,i=-1,n=!1,o=this._totalRowsCount();if(this.mRenderableBoundsCollection=new t.grid.renderBoundsCollection(o-1),this._allowVirtualScrolling()&&this._serverSideVirtualScrolling())this.mRenderableBoundsCollection.add({start:0,end:o-1});else if(this._allowVirtualScrolling()&&this._hasGrouping()){for(var r=0;r<this.sketchTable.count();r++){var s=this.sketchTable.row(r);"none"===s.style("display")?(e>=0&&(this.mRenderableBoundsCollection.add({start:e,end:i}),n=!1),e=i=-1):0>e?(n=!0,e=i=r):i++}n&&this.mRenderableBoundsCollection.add({start:e,end:i})}else this.mRenderableBoundsCollection.add({start:0,end:o-1})},o.prototype._refresh=function(e){(new t.grid.grouper).group(this,this.sketchTable,this._field("leaves")),(new t.grid.merger).merge(this.sketchTable,this._field("visibleLeaves")),this._rebuildRenderBoundsCollection(),"none"!==this.options.scrollMode?this.mView=new t.grid.fixedView(this,this._viewPortBounds()):this.mView=new t.grid.flatView(this,this._viewPortBounds()),this._render(),this._ownerise(!1),this._recreateColumnWidgets(),this._ownerise(!0),this.options.allowPaging&&(this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5),this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5))},o.prototype._refreshVirtual=function(t){var e=t.virtualScrollData,i={top:0,bottom:0};e.data&&(i=this._processVirtualData(e)),this._updateRowInfos(e,i),this._renderVirtualIntoView(e)},o.prototype._updateRowInfos=function(t,i){var n=this._viewPortBounds(),o=this._view(),r=t.newBounds,s=this._view().bodyRows(),a,l,h,d;switch(t.mode){case e.intersectionMode.reset:break;case e.intersectionMode.overlapBottom:for(a={start:r.start-n.start,end:n.end-n.start},h=r.start-n.start,l=a.start;l<=a.end;l++)d=o._getRowInfo(s.item(l),!1),d.sectionRowIndex-=h,0!==i.top&&(d.dataItemIndex+=i.top),o._setRowInfo(d.$rows,d);break;case e.intersectionMode.overlapTop:for(a={start:n.start-n.start,end:r.end-n.start},h=n.start-r.start,l=a.start;l<=a.end;l++)d=o._getRowInfo(s.item(l),!1),d.sectionRowIndex+=h,0!==i.top&&(d.dataItemIndex+=i.top),o._setRowInfo(d.$rows,d)}},o.prototype._renderVirtualIntoView=function(t){var i=this._viewPortBounds(),n=this,o,r=this._view(),s,a,l;switch(t.mode){case e.intersectionMode.reset:r._clearBody();var h=t.newBounds.end-t.newBounds.start+1;this._renderableBoundsCollection().forEachIndex(t.newBounds.start,h,function(t){o=n.sketchTable.row(t-n._dataOffset),r._insertBodyRow(o,-1,o.dataItemIndex(),t)}),r._rebuildOffsets();break;case e.intersectionMode.overlapBottom:for(s={start:t.newBounds.start,end:i.end},a=0;a<s.start-i.start;a++)r._removeBodyRow(0);var h=t.newBounds.end-s.end;this._renderableBoundsCollection().forEachIndex(s.end+1,h,function(t){o=n.sketchTable.row(t-n._dataOffset),r._insertBodyRow(o,-1,o.dataItemIndex(),t)});break;case e.intersectionMode.overlapTop:for(s={start:i.start,end:t.newBounds.end},a=0;a<i.end-t.newBounds.end;a++)r._removeBodyRow(s.end-s.start+1);l=0;var h=i.start-t.newBounds.start;this._renderableBoundsCollection().forEachIndex(t.newBounds.start,h,function(t){o=n.sketchTable.row(t-n._dataOffset),r._insertBodyRow(o,l++,o.dataItemIndex(),t)})}},o.prototype._processVirtualData=function(t){var i=this._dataViewWrapper,n=i.dataView().getSource(),o,r=this._field("leaves"),s,a,l,h=0,d={top:0,bottom:0},c,u=this._serverSideVirtualScrollingMargin();switch(t.mode){case e.intersectionMode.reset:for(this.sketchTable.clear(),i._unsafeSplice(0,n.length),this._dataOffset=t.request.index,s=0;s<t.data.length;s++)i._unsafePush(o=t.data[s]),this.sketchTable.add(this._buildSketchRow(i._wrapDataItem(o,s),r));break;case e.intersectionMode.overlapBottom:for(s=0;s<t.data.length;s++)i._unsafePush(o=t.data[s]),this.sketchTable.add(this._buildSketchRow(i._wrapDataItem(o,n.length-1),r));d.bottom=t.data.length;break;case e.intersectionMode.overlapTop:for(s=t.data.length-1;s>=0;s--)i._unsafeSplice(0,0,o=t.data[s]),this.sketchTable.insert(0,this._buildSketchRow(i._wrapDataItem(o,s),r));this._dataOffset=t.request.index,d.top=t.data.length}return a=this._ensureTotalRowsBounds({start:t.newBounds.start,end:t.newBounds.end}),l={start:this._dataOffset,end:this._dataOffset+n.length-1},h=l.end-a.end-u,h>0&&(d.bottom-=h,i._unsafeSplice(n.length-h,h),this.sketchTable.removeLast(h)),h=a.start-l.start-u,h>0&&(d.top-=h,i._unsafeSplice(0,h),this.sketchTable.removeFirst(h),this._dataOffset+=h),this.sketchTable.updateIndexes(),i._refreshSilent(),d},o.prototype._needToCreatePagerItem=function(){return this.options.allowPaging===!0},o.prototype._isMobileEnv=function(){return this._isMobile},o.prototype._render=function(){var e=this._view(),i=this.options,o=t.grid.wijgrid.CSS,r=this.options.wijCSS,s;e.render(),s=this.outerDiv,"none"!==i.scrollMode&&(s=this.outerDiv.find("div."+o.scroller+":first")),this.$superPanelHeader=null,this.$topPagerDiv&&(this.$topPagerDiv.data("wijmo-wijpager")&&this.$topPagerDiv.wijpager("destroy"),this.$topPagerDiv.remove()),this.$topPagerDiv=null,this._needToCreatePagerItem()&&("top"===i.pagerSettings.position||"topAndBottom"===i.pagerSettings.position)&&(this.$topPagerDiv||(s.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$topPagerDiv=n('<div class="'+o.headerArea+" "+r.wijgridHeaderArea+" "+r.header+" "+r.cornerTop+'"></div>')))),i.showGroupArea?this._processGroupArea(s):this.$groupArea=null,this.$bottomPagerDiv&&(this.$bottomPagerDiv.data("wijmo-wijpager")&&this.$bottomPagerDiv.wijpager("destroy"),this.$bottomPagerDiv.remove()),this.$bottomPagerDiv=null,this._needToCreatePagerItem()&&("bottom"===i.pagerSettings.position||"topAndBottom"===i.pagerSettings.position)&&(this.$bottomPagerDiv||s.append(this.$bottomPagerDiv=n('<div class="'+o.footerArea+" "+r.wijgridFooterArea+" wijmo-wijsuperpanel-footer "+r.stateDefault+" "+r.cornerBottom+'"></div>')))},o.prototype._processGroupArea=function(e){var i=this,o=this._groupedColumns(),r=[],s=t.grid.wijgrid.CSS,a=this.options.wijCSS;this.$groupArea=n('<div class="'+a.content+" "+a.helperClearFix+" "+s.groupArea+" "+a.wijgridGroupArea+'"></div>'),o.length>0?n.each(o,function(t,e){var o=n('<a href="#"></a>').appendTo(i.$groupArea);try{n.data(o[0],"wijgridowner",i),o.c1groupedfield(n.extend({},{allowMoving:e.allowMoving,allowSort:e.allowSort,dataIndex:e.dataIndex,dataKey:e.dataKey,headerText:e.headerText,isBand:e.isBand,isLeaf:e.isLeaf,linearIdx:e.linearIdx,parentIdx:e.parentIdx,sortDirection:e.sortDirection,travIdx:e.travIdx,groupedIndex:e.groupedIndex},{disabled:i.options.disabled}))}finally{n.removeData(o[0],"wijgridowner")}r.push(o.data("wijmo-c1groupedfield"))}):this.$groupArea.addClass(s.groupAreaEmpty).css("padding",0).html(this.options.groupAreaCaption||"&nbsp;"),this._field("groupedWidgets",r),this.$superPanelHeader||e.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$groupArea),this._UIDragndrop(!0).attachGroupArea(this.$groupArea)},o.prototype._pagerSettings2PagerWidgetSettings=function(){return n.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:n.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:n.proxy(this._onPagerWidgetPageIndexChanged,this)})},o.prototype._showRowHeader=function(){return this.options.showRowHeader===!0&&"right"!==this.options.staticColumnsAlignment},o.prototype._attachEvents=function(){var t=this._view(),i=t.focusableElement(),o=this;i.bind("keydown."+this.widgetName,n.proxy(this._onKeyDown,this)),this.mKeyDownEventListener=new e.keyDownEventListener(this,i),n.each(t.subTables(),function(t,e){var i=e.element();i&&(i.tHead&&n(i.tHead).bind("click."+o.widgetName,n.proxy(o._onClick,o)),i.tBodies.length&&n(i.tBodies[0]).bind("click."+o.widgetName,n.proxy(o._onClick,o)).bind("dblclick."+o.widgetName,n.proxy(o._onDblClick,o)).bind("mousemove."+o.widgetName,n.proxy(o._onMouseMove,o)).bind("mouseout."+o.widgetName,n.proxy(o._onMouseOut,o)))}),n(window).bind("resize."+this.widgetName+"."+this._eventUID,n.proxy(this._onWindowResize,this))},o.prototype._detachEvents=function(t){var e=this._view(),i=this,o;this._windowResizeTimer=0,n(window).unbind("resize."+this.widgetName+"."+this._eventUID),e&&(o=e.focusableElement(),o.unbind("keydown."+this.widgetName),n.each(e.subTables(),function(){var t=this.element();t&&(t.tHead&&n(t.tHead).unbind("."+i.widgetName),t.tBodies.length&&n(t.tBodies[0]).unbind("."+i.widgetName))}))},o.prototype._handleSort=function(e,i){var o=this.options.columns,r=e.travIdx,s,a;e&&this.options.allowSorting&&(s="none"===e.sortDirection?"ascending":"ascending"===e.sortDirection?"descending":"ascending",a={column:e,sortDirection:s,sortCommand:e.dataKey+" "+("ascending"===s?"asc":"desc")},this._onColumnSorting(a)&&(e.sortDirection=a.sortDirection,i?e.sortOrder=this._customSortOrder++:(this._customSortOrder=1e3,n.each(this.columns(),function(t,e){e.options.sortOrder=0,e.options.travIdx!==r&&(!e.options.groupInfo||"none"===e.options.groupInfo.position)&&(e.options.sortDirection="none")}),t.grid.traverse(o,function(t){t.sortOrder=0,t.travIdx!==r&&(!t.groupInfo||"none"===t.groupInfo.position)&&(t.sortDirection="none")})),a={column:e,sortDirection:e.sortDirection,sortCommand:e.dataKey+" "+("ascending"===e.sortDirection?"asc":"desc")},this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnSorted(a)):this.ensureControl(!0,{afterRefresh:function(){this._onColumnSorted(a)}})))},o.prototype._handleDragnDrop=function(e,i,o,r,s){var a=t.grid.getColumnByTravIdx(this.options.columns,e),l=t.grid.getColumnByTravIdx(this.options.columns,i),h=r?"groupArea":"columns",d=s?"groupArea":"columns";s?this._onColumnGrouping({drag:a.found,drop:l?l.found:null,dragSource:h,dropSource:d,at:o})&&this.ensureControl(!0,{beforeRefresh:function(){if(l)switch(o){case"left":a.found.groupedIndex=l.found.groupedIndex-.5;break;case"right":a.found.groupedIndex=l.found.groupedIndex+.5}else a.found.groupedIndex=0;r||n.extend(!0,a.found,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:a.found,drop:l?l.found:null,dragSource:h,dropSource:d,at:o})}}):this._onColumnDropping({drag:a.found,drop:l.found,at:o})&&this.ensureControl(!1,{beforeRefresh:function(){switch(a.at.splice(a.found.linearIdx,1),o){case"left":a.at===l.at&&a.found.linearIdx<l.found.linearIdx?l.at.splice(l.found.linearIdx-1,0,a.found):l.at.splice(l.found.linearIdx,0,a.found);break;case"right":a.at===l.at&&a.found.linearIdx<l.found.linearIdx?l.at.splice(l.found.linearIdx,0,a.found):l.at.splice(l.found.linearIdx+1,0,a.found);break;case"center":l.found.columns.push(a.found)}t.grid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:a.found,drop:l.found,at:o})}})},o.prototype._handleFilter=function(e,i,n){var o=new t.grid.filterOperatorsCache(this).getByName(i),r,s,a;o&&(o.arity>1?(r=this.parse(e.options,n),s=null!==r&&("string"===t.grid.getDataType(e.options)||!isNaN(r))):s=!0,s&&(a={column:e.options,operator:o.name,value:r},this._onColumnFiltering(a)&&(e.options.filterValue=a.value,e.options.filterOperator=a.operator,this._resetDataProperties(),this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnFiltered({column:e.options})):this.ensureControl(!0,{afterRefresh:function(){this._onColumnFiltered({column:e.options})}}))))},o.prototype._handleUngroup=function(e){var i=t.grid.getColumnByTravIdx(this.options.columns,e),o;i&&i.found&&(o=i.found,this._onColumnUngrouping({column:o})&&this.ensureControl(!0,{beforeRefresh:function(){delete o.groupedIndex,n.extend(!0,o,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:o})}}))},o.prototype._onVirtualScrolling=function(t,e,i,o,r,s){var a=this;this.ensureControl(this._serverSideVirtualScrolling(),{virtualScrollData:{newBounds:t,request:e,mode:i,data:s},beforeOnRendered:function(t){var e=a._viewPortBounds();n.extend(e,t.virtualScrollData.newBounds)},afterRefresh:function(t){a._view()._adjustRowsHeights(),r&&r(o)}})},o.prototype._handleVirtualScrolling=function(t,i,n){"undefined"==typeof i&&(i=null);var o=this._view(),r=this._viewPortBounds(),s=this._ensureRenderableBounds({start:t,end:t+o.getVirtualPageSize()-1}),a=this._ensureTotalRowsBounds({start:this._dataOffset,end:this._dataOffset+this._dataViewWrapper.dataView().count()-1}),l=null,h,d=this._view().getVirtualPageSize();if(h=i?i:s.start>r.end||s.end<r.start?e.intersectionMode.reset:s.start>r.start?e.intersectionMode.overlapBottom:s.start<r.start?e.intersectionMode.overlapTop:s.start!==r.start||s.end!==r.end?e.intersectionMode.reset:e.intersectionMode.none,this._serverSideVirtualScrolling())switch(h){case e.intersectionMode.reset:l={index:t,maxCount:d};break;case e.intersectionMode.overlapBottom:s.end>a.end&&(l={index:a.end+1,maxCount:d});break;case e.intersectionMode.overlapTop:s.start<a.start&&(l={index:Math.max(0,a.start-d),maxCount:0},l.maxCount=a.start-l.index)}h!==e.intersectionMode.none&&this._onVirtualScrolling(s,l,h,t,n);
},o.prototype._serverSideVirtualScrolling=function(){return!1},o.prototype._serverSideVirtualScrollingMargin=function(){var t=2*this._view().getVirtualPageSize();return 20>t&&(t=20),t},o.prototype._onColumnDropping=function(t){return this._trigger("columnDropping",null,t)},o.prototype._onColumnDropped=function(t){this._trigger("columnDropped",null,t)},o.prototype._onColumnGrouping=function(t){return this._trigger("columnGrouping",null,t)},o.prototype._onColumnGrouped=function(t){this._trigger("columnGrouped",null,t)},o.prototype._onColumnUngrouping=function(t){return this._trigger("columnUngrouping",null,t)},o.prototype._onColumnUngrouped=function(t){this._trigger("columnUngrouped",null,t)},o.prototype._onColumnFiltering=function(t){return this._trigger("filtering",null,t)},o.prototype._onColumnFiltered=function(t){this._trigger("filtered",null,t)},o.prototype._onFilterOperatorsListShowing=function(t){this._trigger("filterOperatorsListShowing",null,t)},o.prototype._onColumnSorting=function(t){return this._trigger("sorting",null,t)},o.prototype._onColumnSorted=function(t){this._trigger("sorted",null,t)},o.prototype._onCurrentCellChanged=function(e,i){var n=this.options,o=this.currentCell(),r=o.row(),s=r&&r.type&t.grid.rowType.data?r.dataItemIndex:-1;if(this._dataViewWrapper.currentPosition(s),"none"!==n.scrollMode&&o&&!o.isEqual(t.grid.cellInfo.outsideValue)){var a=o;!(a.row().type&t.grid.rowType.data)&&!a.tableCell()&&(a=o._clone(),a.cellIndex(0)),this._view().scrollTo(a)}this._trigger("currentCellChanged");var l=e&&(e.type||"").toLowerCase()||"";if(i.changeSelection){var h=this.selection(),d=this.options.selectionMode.toLowerCase(),c=i.selectionExtendMode||t.grid.cellRangeExtendMode.none;if(h.beginUpdate(),l){if(o._isValid())switch(l){case"click":(!e.shiftKey||!h._multipleRangesAllowed()&&"singlerange"!==d)&&h._startNewTransaction(o),e.shiftKey&&e.ctrlKey?h._clearRange(new t.grid.cellInfoRange(o,o),c):h._selectRange(new t.grid.cellInfoRange(h._anchorCell(),o),e.ctrlKey,e.shiftKey,c,null);break;case"keydown":(!e.shiftKey||!h._multipleRangesAllowed()&&"singlerange"!==d)&&h._startNewTransaction(o),h._selectRange(new t.grid.cellInfoRange(h._anchorCell(),o),!1,e.shiftKey,t.grid.cellRangeExtendMode.none,null)}}else h.clear(),o._isValid()&&(h._startNewTransaction(o),h._selectRange(new t.grid.cellInfoRange(o,o),!1,!1,t.grid.cellRangeExtendMode.none,null));h.endUpdate()}"click"===l&&this._editBySingleClick()&&this._beginEditInternal(e)},o.prototype._onPageIndexChanging=function(t){return this._trigger("pageIndexChanging",null,t)},o.prototype._onPageIndexChanged=function(t){this._trigger("pageIndexChanged",null,t)},o.prototype._onPagerWidgetPageIndexChanging=function(t,e){e.handled=!0},o.prototype._onPagerWidgetPageIndexChanged=function(t,e){this._setOption("pageIndex",e.newPageIndex)},o.prototype._onRendering=function(t){var e=this._view();if(this._rendered=!1,!t.virtualScrollData){var i=this._field("currentCell");this._field("currentCellPrevCycle",i?{x:i.cellIndex(),y:i.rowIndex(),dataItemIndex:i.row()?i.row().dataItemIndex:-1}:{x:-1,y:-1,dataItemIndex:-1}),this._field("currentCell",null),e&&e.dispose(),this._detachEvents(!1),this.element.detach(),this.element.css({"table-layout":"",width:""}),this.element.empty(),this.outerDiv.empty(),this.outerDiv.append(this.element),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null)}this._trigger("rendering")},o.prototype._onRendered=function(e){var i=this._view(),o,r=this.selection().selectedCells().length()>0;if(this._rendered=!0,e.virtualScrollData)this.currentCell(this.currentCell(),null,!1),this.selection()._ensureSelection();else{this._field("selection",null),this._attachEvents(),this._setAttr(i.focusableElement(),"tabIndex",0);var s=this._field("currentCellPrevCycle");if(this._dataViewWrapper.isOwnDataView&&s.dataItemIndex>=0){var a=this._dataViewWrapper.dataView().count();s.dataItemIndex>=a&&(s.dataItemIndex=a-1),this._dataViewWrapper.currentPosition(s.dataItemIndex)}o=this._currentCellFromDataView(s.x),!o._isValid()&&this.options.showSelectionOnRender&&(o=this._getFirstDataRowCell(0)),this.currentCell(o,null,!0),this._UISelection(!0);var l=new t.grid.uiResizer(this);n.each(this.columns(),function(t,e){var i=e.options;i.visible&&i.parentVis&&i.isLeaf&&l.addElement(e)}),this._resizerui=l,this._setSizeInternal(this._scrollingState),"none"!==this.options.scrollMode&&(this._frozenerui=new t.grid.uiFrozener(this))}this._renderCounter++,this._trigger("rendered")},o.prototype._onClick=function(e){if(this._canInteract()&&e.target){var i=this._view(),o=this._findUntilOuterDiv(e.target,{td:!0,th:!0}),r,s,a=t.grid.cellRangeExtendMode.none,l,h,d=!1;if(o){if(n(e.target).hasClass(t.grid.wijgrid.CSS.groupToggleVisibilityButton))return this._onGroupBtnClick(e),e.stopPropagation(),!1;if(r=n(o).closest("tr"),!r.length)return;s=i.getAbsoluteCellInfo(o,!1),(r.hasClass(t.grid.wijgrid.CSS.dataRow)||r.hasClass(t.grid.wijgrid.CSS.headerRow))&&((s.cellIndex()<0||s.rowIndex()<0)&&(s.rowIndex()>=0?(s=new t.grid.cellInfo(0,s.rowIndex()),a=t.grid.cellRangeExtendMode.row,d=!0):s.cellIndex()>=0&&(s=this._getFirstDataRowCell(s.cellIndex()),a=t.grid.cellRangeExtendMode.column,d=!0)),d||(s=i.getAbsoluteCellInfo(o,!0)),this._changeCurrentCell(e,s,{changeSelection:!0,setFocus:!0,selectionExtendMode:a}));var c={cell:s};this._trigger("cellClicked",null,c)}}},o.prototype._onDblClick=function(t){this._editBySingleClick()||this._beginEditInternal(t)},o.prototype._onGroupBtnClick=function(i){if(this._canInteract()){var o=n(i.target).closest("tr"),r=t.grid.groupHelper,s=r.getGroupInfo(o[0]),a,l,h=this;s&&(a=r.getColumnByGroupLevel(this._field("leaves"),s.level),a&&(l=a.groupInfo.expandInfo[s.index],l.isExpanded?l.collapse():l.expand(i.shiftKey),this._allowVirtualScrolling()&&(this._rebuildRenderBoundsCollection(),this._view().vsUI._changeVisibleRowsCount(this._renderableBoundsCollection().capacity()),this._ensureViewPortBoundsVisible(this._viewPortBounds()),this._handleVirtualScrolling(this._viewPortBounds().start,e.intersectionMode.reset)),this.setSize()))}},o.prototype._onKeyDown=function(i){var o=this.mKeyDownEventListener.isHiddenInput(n(i.target));if(!this._canInteract()||o&&this.mKeyDownEventListener.canHandle(i))return!0;var r=i.target.tagName.toLowerCase(),s=n(i.target),a=this.currentCell(),l=t.getKeyCodeEnum();if(o||"input"!==r&&"option"!==r&&"select"!==r&&"textarea"!==r||0!==s.closest("tr.wijmo-wijgrid-datarow").length){if(this._allowCellEditing()){if((i.which===l.ESCAPE||113===i.which)&&a._isValid()&&a._isEdit())return this._endEditInternal(i),!1;if(113===i.which)return this._beginEditInternal(i),!1}if(!this.options.allowKeyboardNavigation)return!0;var h;switch(i.which){case l.DOWN:case l.PAGE_DOWN:case l.UP:case l.PAGE_UP:case l.LEFT:case l.RIGHT:case l.HOME:case l.END:case l.TAB:if(o||this._canMoveToAnotherCell(i.target,i.which)){var d=this._getDataCellsRange(e.dataRowsRangeMode.renderable);h=this._getNextCurrentCell(d,a,i.keyCode,i.shiftKey)}}if(h){var c=h._isRendered(),u=this._renderableBoundsCollection().getRenderedIndex(h.rowIndex()),p,g,f=this._allowVirtualScrolling()&&u-this._viewPortBounds().start>=this._rows().length()-1,m=this;return this._allowVirtualScrolling()&&(!c||f&&(p=this._view().getVisibleAreaBounds(!0))&&(g=h.row().$rows)&&g.offset().top+g.outerHeight()>p.top+p.height)?(h.rowIndex()>a.rowIndex()&&(u-=this._rows().length()-1,u+=1),this._view().vsUI.scrollTo(u,function(){m._changeCurrentCell(i,h,{changeSelection:!0,setFocus:!0})})):this._changeCurrentCell(i,h,{changeSelection:!0,setFocus:!1}),!1}return!0}return!0},o.prototype._onMouseMove=function(e){var i=this._view(),o=this._frozenerui,r,s,a,l,h,d=t.grid.renderState;if(this.options.highlightOnHover&&this._canInteract()&&(!o||!o.inProgress())&&(r=this._findUntilOuterDiv(e.target,{td:!0,th:!0}))){if(s=n(r).closest("tr"),!s.length||!s.hasClass(t.grid.wijgrid.CSS.dataRow)&&!s.hasClass(t.grid.wijgrid.CSS.headerRow))return;a=i.getAbsoluteCellInfo(r,!0);var c=a.rowIndex();c!==this._prevHoveredSketchRowIndex&&(void 0!==this._prevHoveredSketchRowIndex&&i._isRowRendered(this._prevHoveredSketchRowIndex)>=0&&(h=i._getRowInfoBySketchRowIndex(this._prevHoveredSketchRowIndex),h&&(i._changeRowRenderState(h,d.hovered,!1),this.rowStyleFormatter.format(h))),this._prevHoveredSketchRowIndex=c,c>=0&&(h=i._getRowInfoBySketchRowIndex(c),h&&(i._changeRowRenderState(h,d.hovered,!0),this.rowStyleFormatter.format(h))))}},o.prototype._onMouseOut=function(e){if(this._canInteract()){var i=this._findUntilOuterDiv(e.relatedTarget,{tr:!0});if(!i||!n(i).hasClass(t.grid.wijgrid.CSS.dataRow)){var o=this._prevHoveredSketchRowIndex,r=this._view();if(o>=0){var s=r._getRowInfoBySketchRowIndex(o);s&&s.$rows&&(r._changeRowRenderState(s,t.grid.renderState.hovered,!1),this.rowStyleFormatter.format(s)),this._prevHoveredSketchRowIndex=-1}}}},o.prototype._onWindowResize=function(t){var e=this;this._windowResizeTimer>0&&(window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=0),-1!==this._windowResizeTimer&&(this._windowResizeTimer=window.setTimeout(function(){e._windowResizeTimer=-1;try{!e._destroyed&&e._initialized&&e.element.parent().length&&e.setSize()}finally{e._windowResizeTimer=0}},50))},o.prototype._fieldResized=function(t,e,i){0>e&&(e=0),0>=i&&(i=1);var n={column:t.options,oldWidth:e,newWidth:i};if(this._trigger("columnResizing",null,n)!==!1){(isNaN(n.newWidth)||n.newWidth<0)&&(n.newWidth=1),t.option("width",n.newWidth);var o={column:t.options};this._trigger("columnResized",null,o)}},o.prototype._changeCurrentCell=function(i,o,r){var s=this.currentCell(),a=this._getDataCellsRange(e.dataRowsRangeMode.sketch),l,h,d=this.options.highlightCurrentCell,c,u=i&&i.target&&n(i.target).is(":focus"),p=this,g=function(t){u?n(i.target).focus():p.mKeyDownEventListener.focus(n(t))};if(a._isValid()&&a._containsCellInfo(o)||o.isEqual(t.grid.cellInfo.outsideValue))if(s.cellIndex()!==o.cellIndex()||s.rowIndex()!==o.rowIndex()){if(l={cellIndex:o.cellIndex(),rowIndex:o.rowIndex(),oldCellIndex:s.cellIndex(),oldRowIndex:s.rowIndex()},!this._trigger("currentCellChanging",null,l))return!1;h=!1,this._allowCellEditing()&&s._isEdit()&&!(h=this._endEditInternal(null))||(a._containsCellInfo(s)&&d&&this._highlightCellPosition(s,!1),s=o._clone(),s._setGridView(this),d&&this._highlightCellPosition(s,!0),r.setFocus&&(c=s.tableCell())&&g(c),this._field("currentCell",s),this._onCurrentCellChanged(i,r))}else d&&this._highlightCellPosition(s,!0),!s._isEdit()&&(c=s.tableCell())&&(i&&this._editBySingleClick()?this._beginEditInternal(i):r.setFocus&&g(c));return!0},o.prototype._highlightCellPosition=function(e,i){if(e&&e._isValid()){var o=e.cellIndexAbs(),r=e.rowIndexAbs(),s=t.grid.renderState,a=this._view(),l,h,d;h=a.getHeaderCell(o),h&&(l=a._getRowInfo(this._headerRows().item(e.column().thY)),h=n(h),d=a._changeCellRenderState(h,s.current,i),this.cellStyleFormatter.format(h,o,e.column(),l,d)),e._isRendered()&&(h=a.getJoinedRows(r,0),h&&(l=a._getRowInfo(h),a._changeRowRenderState(l,s.current,i),this.rowStyleFormatter.format(l)),h=a.getCell(o,r),h&&(h=n(h),d=a._changeCellRenderState(h,s.current,i),this.cellStyleFormatter.format(h,o,e.column(),l,d)))}},o.prototype._beginEditInternal=function(e){if(this._canInteract()&&this._allowCellEditing()){var i=this.currentCell(),n=i.column(),o;if(n&&!n.readOnly)return o=(new t.grid.cellEditorHelper).cellEditStart(this,i,e)}return!1},o.prototype._endEditInternal=function(i){if(this._canInteract()&&this._allowCellEditing()){var o=this.currentCell(),r=new t.grid.cellEditorHelper,s=r.updateCell(this,o,i);if(s&e.updateCellResult.success){if(s&e.updateCellResult.notEdited)return!0;r.cellEditEnd(this,o,i),o=this.currentCell();var a=o.tableCell();return a?this.mKeyDownEventListener.focus(n(a)):n(this._view().focusableElement()).focus(),this._allowVirtualScrolling()||this._view().ensureHeight(o.rowIndex()),!0}}return!1},o.prototype._onViewInsertEmptyRow=function(t,e,i,n,o){return null},o.prototype._onViewCreateEmptyCell=function(t,e,i){return null},o.prototype._onViewCellRendered=function(t,e,i,n){},o.prototype._onViewRowRendered=function(t){},o.prototype._getDataParser=function(e){return e.dataParser||t.data.defaultParsers[e.dataType]||t.data.defaultParsers.string},o.prototype.parse=function(e,i){var o=t.grid.getDataType(e),r=t.grid.getDataType(e);return n.isFunction(i)&&(i=i()),i=t.data.convert(i,o,r,{culture:this.mClosestCulture,format:e.dataFormatString||e._underlyingDataFormatString,nullString:this.options.nullString,parser:e.dataParser})},o.prototype.toStr=function(e,i){var n=this._dataViewWrapper.dataView(),o=t.grid.getDataType(e),r="string";return i=t.data.convert(i,o,r,{culture:this.mClosestCulture,format:e.dataFormatString||e._underlyingDataFormatString,nullString:this.options.nullString,parser:e.dataParser})},o.prototype.parseFailed=function(t,e,i,n){return e},o.prototype._funcOptions=function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","cellClicked","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},o.prototype._canInteract=function(){return!this.options.disabled},o.prototype._canMoveToAnotherCell=function(e,i){var o=e.tagName.toLowerCase(),r,s,a,l;switch(o){case"input":if(n(e).hasClass(t.grid.wijgrid.CSS.inputMarker)){var h=e;return"text"===h.type?(r=h.value.length,s=new t.grid.domSelection(h).getSelection(),a=t.getKeyCodeEnum(),l=i===a.TAB||i===a.UP||i===a.DOWN||i===a.PAGE_DOWN||i===a.PAGE_UP||0===s.length&&(0===s.start&&(i===a.LEFT||i===a.HOME)||s.end>=r&&(i===a.RIGHT||i===a.END))):!0}return!1;case"textarea":case"select":return!1}return!0},o.prototype._editBySingleClick=function(){var t=(this.options.editingInitOption||"").toLowerCase();switch(t){case"click":case"doubleclick":break;case"auto":default:t=this._isMobileEnv()?"click":"doubleclick"}return"click"===t},o.prototype._getDataToAbsOffset=function(){var t=0,e=0,i=this._headerRows();return this._showRowHeader()&&t++,i&&(e+=i.length()),this._filterRow()&&e++,{x:t,y:e}},o.prototype._currentCellFromDataView=function(e){var i=this._dataViewWrapper.currentPosition(),n=new t.grid.cellInfo(e,this._dataViewDataRowIndexToGrid(i),null);return n.rowIndex()<0?n.cellIndex(-1):n.cellIndex()<0&&n.cellIndex(0),n},o.prototype._dataViewDataRowIndexToGrid=function(e){var i=t.grid.rowType,n=this._view(),o=this._rows(),r,s,a;if(0>e)return-1;for(r=0,s=o.length();s>r;r++)if(a=n._getRowInfo(o.item(r)),a.type&i.data&&a.dataItemIndex===e)return a.sectionRowIndex;return-1},o.prototype._getDataCellsRange=function(i,n){"undefined"==typeof n&&(n=!1);var o=0,r=0,s=this._field("visibleLeaves").length-1,a;switch(i){case e.dataRowsRangeMode.rendered:if(this._rendered){a=this._rows().length()-1;break}case e.dataRowsRangeMode.sketch:a=this._totalRowsCount()-1;break;case e.dataRowsRangeMode.renderable:a=this._renderableRowsCount()-1}return this._showRowHeader()&&s--,n&&a>0&&a--,(0>s||0>a)&&(o=r=s=a=-1),new t.grid.cellInfoRange(new t.grid.cellInfo(o,r,null),new t.grid.cellInfo(s,a,null))},o.prototype._getDataItem=function(t){return this.dataView().item(t)},o.prototype._getFirstDataRowCell=function(e){var i,n,o,r=this._view(),s=this._rows(),a=t.grid.rowType;for(i=0,n=s.length();n>i;i++)if(o=r._getRowInfo(s.item(i)),o.type&a.data)return new t.grid.cellInfo(e,i);return t.grid.cellInfo.outsideValue},o.prototype._getNextCurrentCell=function(e,i,n,o){var r=i.cellIndex(),s=i.rowIndex(),a=t.getKeyCodeEnum(),l=this.sketchTable,h=this._renderableBoundsCollection().getRenderedIndex(s),d=this._renderableBoundsCollection(),c,u=n===a.TAB,p=function(t,e,i,n){"undefined"==typeof n&&(n=!1);var o=t?d.forEachIndex:d.forEachIndexBackward,r=0,s=null;return o.call(d,e,-1,function(t){var e=l.row(t),o=e.isDataRow();return(!n||o)&&"none"!==e.style("display")&&(s=t,++r>=i)?!1:void 0}),s};switch(n){case a.ENTER:case a.DOWN:null!=(c=p(!0,h+1,1))&&(s=c);break;case a.PAGE_DOWN:null!=(c=p(!0,h+1,this._pageSizeKey))&&(s=c);break;case a.UP:null!=(c=p(!1,h-1,1))&&(s=c);break;case a.PAGE_UP:null!=(c=p(!1,h-1,this._pageSizeKey))&&(s=c);break;case a.TAB:o?(r--,r<e.topLeft().cellIndex()&&(r=e.bottomRight().cellIndex(),null!=(c=p(!1,h-1,1,!0))?s=c:null!=(c=p(!1,d.capacity()-1,1,!0))&&(s=c))):(r++,r>e.bottomRight().cellIndex()&&(r=e.topLeft().cellIndex(),null!=(c=p(!0,h+1,1,!0))?s=c:null!=(c=p(!0,0,1,!0))&&(s=c)));break;case a.END:r=e.bottomRight().cellIndex();break;case a.HOME:r=e.topLeft().cellIndex();break;case a.LEFT:r>e.topLeft().cellIndex()&&r--;break;case a.RIGHT:r<e.bottomRight().cellIndex()&&r++}return new t.grid.cellInfo(r,s,this)},o.prototype._findUntilOuterDiv=function(t,e){for(var i=t,n,o,r=null;i;i=i.parentNode)if(o=i.nodeName&&i.nodeName.toLowerCase()){if(i===this.outerDiv[0]){n=i;break}e[o]&&(r=i)}return n?r:null},o.prototype._getStaticIndex=function(t){var i,n=this._getDataCellsRange(e.dataRowsRangeMode.rendered);return this._hasSpannedCells()?-1:(i=t?Math.min(this.options.staticRowIndex,n.bottomRight().rowIndex()):Math.min(this.options.staticColumnIndex,n.bottomRight().cellIndex()),-1>i&&(i=-1),i)},o.prototype._getStaticOffsetIndex=function(t){var e=0;return t?this._showRowHeader()&&e++:(e=this._columnsHeadersTable().length,this.options.showFilter&&e++),e},o.prototype._getRealStaticColumnIndex=function(){var t,e,i=this._getStaticOffsetIndex(!0),n=this._getStaticIndex(!1),o,r;if(o=n+i,n>=0){for(t=this._field("visibleLeaves"),e=t.length,r=o;e>o;o++)if(-1===t[o].parentIdx){o>r&&o--;break}o>=e&&(o=e-1)}return o},o.prototype._getRealStaticRowIndex=function(){var t=this._getStaticOffsetIndex(!1);return this._getStaticIndex(!0)+t},o.prototype._hasMerging=function(){var t=this._field("leaves"),e,i,n,o=!1;if(t)for(e=0,i=t.length;i>e&&!o;e++)n=t[e],o=o||n.parentVis&&n.rowMerge&&"none"!==n.rowMerge;return o},o.prototype._hasGrouping=function(){var t=this._field("leaves"),e,i,n,o=!1;for(e=0,i=t.length;i>e&&!o;e++)n=t[e],o=n.groupInfo&&"none"!==n.groupInfo.position;return o},o.prototype._hasSpannedCells=function(){return this._hasGrouping()||this._hasMerging()},o.prototype._columnsHeadersTable=function(t){return arguments.length&&this._field("columnsHeadersTable",t),this._field("columnsHeadersTable")},o.prototype._view=function(){return this.mView},o.prototype._originalFooterRowData=function(){var t=this._field("tfoot");return t&&t.length?t[0]:null},o.prototype._originalHeaderRowData=function(){var t=this._field("thead");return t&&t.length?t[0]:null},o.prototype._setAttr=function(t,e,i){var o=this;return t===this.element?2===arguments.length?(n.each(e,function(e,i){e in o._originalAttr||(o._originalAttr[e]=t.attr(e))}),t.attr(e)):(e in this._originalAttr||(this._originalAttr[e]=t.attr(e)),t.attr(e,i)):3===arguments.length?t.attr(e,i):t.attr(e)},o.prototype._totalRowsCount=function(){return this.sketchTable.count()},o.prototype._renderableRowsCount=function(){return this._renderableBoundsCollection().capacity()},o.prototype._trackScrollingPosition=function(t,e){this._scrollingState.x=t,this._scrollingState.y=e},o.prototype._trackScrollingIndex=function(t){this._scrollingState.index=t},o.prototype._uid=function(){return void 0===this.__uid&&(this.__uid=t.grid.getUID()),"wijgrid"+this.__uid},o.prototype._viewPortBounds=function(t){return arguments.length&&(this.mViewPortBounds=t),this.mViewPortBounds},o.prototype._viewPortBoundsOfEntirelyShownRows=function(){var t=this._viewPortBounds(),e=!1,i=t.end-t.start+1;if(this._allowVirtualScrolling()){var o=this._view();i<o.getVirtualPageSize()&&(e=!0)}return e||(t=n.extend({},t),t.end--),t},o}(t.wijmoWidget);e.wijgrid=o,o.prototype.widgetEventPrefix="wijgrid",o.prototype._data$prefix="wijgrid",o.prototype._customSortOrder=1e3,o.prototype._pageSizeKey=10,o.prototype._mergeWidgetsWithOptions=!0;var r=function(){function t(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},this.wijCSS={wijgrid:"",wijgridTable:"",wijgridTH:"",wijgridTD:"",wijgridCellContainer:"",wijgridRowHeader:"",wijgridCurrentRowHeaderCell:"",wijgridCurrentHeaderCell:"",wijgridCurrentCell:"",wijgridCellAlignLeft:"",wijgridCellAlignRight:"",wijgridCellAlignCenter:"",wijgridFilterList:"",wijgridFilter:"",wijgridFilterInput:"",wijgridFilterTrigger:"",wijgridFilterNativeHtmlEditorWrapper:"",wijgridHeaderArea:"",wijgridFooterArea:"",wijgridHeaderRow:"",wijgridRow:"",wijgridDataRow:"",wijgridAltRow:"",wijgridEmptyDataRow:"",wijgridFilterRow:"",wijgridGroupHeaderRow:"",wijgridGroupFooterRow:"",wijgridFooterRow:"",wijgridLoadingOverlay:"",wijgridLoadingText:"",wijgridGroupArea:"",wijgridGroupAreaButton:"",wijgridGroupAreaButtonSort:"",wijgridGroupAreaButtonClose:"",wijgridGroupToggleVisibilityButton:"",wijgridFixedView:"",wijgridScroller:"",wijgridDndHelper:"",wijgridDndArrowTopContainer:"",wijgridDndArrowBottomContainer:"",wijgridFreezingHandleV:"",wijgridFreezingHandleH:"",wijgridResizingHandle:"",wijgridHeaderCellSortIcon:"",wijgridHeaderCellText:""},this.allowColMoving=!1,this.allowColSizing=!1,this.allowEditing=!1,this.allowKeyboardNavigation=!0,this.allowPaging=!1,this.allowSorting=!1,this.allowVirtualScrolling=!1,this.cellStyleFormatter=void 0,this.columns=[],this.columnsAutogenerationMode="merge",this.culture="",this.customFilterOperators=[],this.data=null,this.editingInitOption="auto",this.editingMode="none",this.ensureColumnsPxWidth=!1,this.filterOperatorsSortMode="alphabeticalCustomFirst",this.freezingMode="none",this.groupAreaCaption="Drag a column here to group by that column.",this.groupIndent=10,this.highlightCurrentCell=!1,this.highlightOnHover=!0,this.loadingText="Loading...",this.nullString="",this.pageIndex=0,this.pageSize=10,this.pagerSettings={mode:"numeric",pageButtonCount:10,position:"bottom"},this.readAttributesFromData=!1,this.rowHeight=-1,this.rowStyleFormatter=void 0,this.scrollMode="none",this.selectionMode="singleRow",this.showFilter=!1,this.showFooter=!1,this.showGroupArea=!1,this.showSelectionOnRender=!0,this.showRowHeader=!1,this.staticColumnIndex=-1,this.staticColumnsAlignment="left",this.staticRowIndex=-1,this.totalRows=-1,this.afterCellEdit=null,this.afterCellUpdate=null,this.beforeCellEdit=null,this.beforeCellUpdate=null,this.cellClicked=null,this.columnDragging=null,this.columnDragged=null,this.columnDropping=null,this.columnDropped=null,this.columnGrouping=null,this.columnGrouped=null,this.columnResizing=null,this.columnResized=null,this.columnUngrouping=null,this.columnUngrouped=null,this.currentCellChanging=null,this.currentCellChanged=null,this.filterOperatorsListShowing=null,this.filtering=null,this.filtered=null,this.groupAggregate=null,this.groupText=null,this.invalidCellValue=null,this.pageIndexChanging=null,this.pageIndexChanged=null,this.selectionChanged=null,this.sorting=null,this.sorted=null,this.dataLoading=null,this.dataLoaded=null,this.loading=null,this.loaded=null,this.rendering=null,this.rendered=null}return t}();o.prototype.options=t.grid.extendWidgetOptions(t.wijmoWidget.prototype.options,new r),n.wijmo.registerWidget("wijgrid",o.prototype)}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function t(t){t&&(this.__attr=t)}return t.prototype.attrs=function(){return this.__attr},t.prototype.ensureAttr=function(){return this.__attr=this.__attr||{},this.__attr},t.prototype.attr=function(t,e){return 0==arguments.length?this.__attr:1==arguments.length?this.__attr?this.__attr[t]:null:void(this.ensureAttr()[t]=e)},t.prototype.style=function(t,e){return 0==arguments.length?this.__style:1==arguments.length?this.__style&&this.__style[t]:void(this.ensureStyle()[t]=e)},t.prototype.deleteStyle=function(t){this.__style&&delete this.__style[t]},t.prototype.ensureStyle=function(){return this.__style=this.__style||{},this.__style},t}();e.SketchObject=n;var o=function(t){function e(e){t.call(this,e)}return __extends(e,t),e.prototype.visible=function(t){return 0==arguments.length?this._visible!==!1:void(this._visible=t)},e}(n);e.SketchCell=o;var r=function(t){function e(e,i){t.call(this,i),this.value=e}return __extends(e,t),e}(o);e.ValueCell=r;var s=function(t){function e(e,i){"undefined"==typeof e&&(e=""),t.call(this,i),this.html=e}return __extends(e,t),e.nbsp=function(){return new e("&nbsp;")},e}(o);e.HtmlCell=s;var a=function(e){function i(i,n,o){e.call(this,o),this.rowType=i,this.renderState=n,n||(this.renderState=t.grid.renderState.rendering)}return __extends(i,e),i.prototype.isDataRow=function(){return(this.rowType&t.grid.rowType.data)==t.grid.rowType.data},i.prototype.dataItemIndex=function(t){return"undefined"==typeof t&&(t=0),-1},i.prototype.cellCount=function(){return this._cells?this._cells.length:0},i.prototype._ensureCells=function(){this._cells=this._cells||[]},i.prototype.add=function(t){this._ensureCells(),this._cells.push(t)},i.prototype.insert=function(t,e){this._ensureCells(),this._cells.splice(t,0,e)},i.prototype.cell=function(t){return this._cells[t]},i.prototype.valueCell=function(t){return this.cell(t)},i.prototype.removeAt=function(t){if(!this._cells)throw"Wrong index";this._cells.splice(t,1)},i.prototype.clear=function(){},i.prototype.getRowInfo=function(){return{type:this.rowType,state:this.renderState,sectionRowIndex:null,dataRowIndex:null,virtualDataItemIndex:null,dataItemIndex:this.dataItemIndex(),$rows:null}},i}(n);e.SketchRow=a;var l=function(e){function i(i,n,o){e.call(this,t.grid.rowType.data|(i%2==1?t.grid.rowType.dataAlt:0),n,o),this.originalRowIndex=i,this.renderState=n,n||(this.renderState=t.grid.renderState.rendering)}return __extends(i,e),i.prototype.dataItemIndex=function(t){return"undefined"==typeof t&&(t=0),t+this.originalRowIndex},i.prototype.isDataRow=function(){return!0},i}(a);e.SketchDataRow=l;var h=function(e){function i(i,n){"undefined"==typeof i&&(i=!0);var o=i?t.grid.rowType.groupHeader:t.grid.rowType.groupFooter;e.call(this,o,void 0,n)}return __extends(i,e),i.prototype.getRowInfo=function(){var t=e.prototype.getRowInfo.call(this);return void 0!==this.groupByValue&&(t.groupByValue=this.groupByValue),t},i}(a);e.SketchGroupRow=h;var d=function(){function t(){this._table=[]}return t.prototype.getRawTable=function(){return this._table},t.prototype.row=function(t){return this._table[t]},t.prototype.valueAt=function(t,e){return this.row(t).valueCell(e).value},t.prototype.count=function(t){return"number"==typeof t&&(this._table.length=t),this._table.length},t.prototype.add=function(t){this._table.push(t)},t.prototype.insert=function(t,e){this._table.splice(t,0,e)},t.prototype.clear=function(){this._table.length=0},t.prototype.removeFirst=function(t){"undefined"==typeof t&&(t=1),this._table.splice(0,t)},t.prototype.removeLast=function(t){"undefined"==typeof t&&(t=1),this._table.splice(this._table.length-t,t)},t.prototype.replace=function(t,e){this._table.splice(t,1,e)},t.prototype.updateIndexes=function(){for(var t=0;t<this._table.length;t++){var e=this._table[t];this._table[t].isDataRow()&&(e.originalRowIndex=t)}},t.prototype.isLazy=function(){return!1},t.prototype.ensureNotLazy=function(){},t}();e.SketchTable=d;var c=function(t){function e(e){if(t.call(this),this.mIsLazy=!0,this.pageSize=30,null==e)throw"Row source is null";this.mSource=e,this._table.length=e.count()}return __extends(e,t),e.prototype.isLazy=function(){return this.mIsLazy},e.prototype.ensureNotLazy=function(){this.isLazy()&&(this.ensureRange(),this.mIsLazy=!1)},e.prototype.invalidate=function(){this._table=new Array(this.mSource.count()),this.isLazy()||this.updateRange()},e.prototype.row=function(e){return t.prototype.row.call(this,e)||this.ensureRange(Math.max(0,e-this.pageSize/2),this.pageSize),t.prototype.row.call(this,e)},e.prototype.ensureRange=function(t,e){if("undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=this._table.length-t),this.isLazy()){if(0>t)throw"Wrong range start";if(this._table.length=this.mSource.count(),0!=this._table.length){for(;t<this._table.length&&this._table[t];)t++;if(!(t>=this._table.length)){for(var i=Math.min(t+e-1,this._table.length-1);i>=t&&this._table[i];)i--;e=i-t+1,e>0&&this.updateRange(t,e)}}else if(e>0)throw"Wrong range length"}},e.prototype.updateRange=function(t,e){if("undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=this._table.length-t),null==this.mSource)throw"Cannot create sketch row because source is null";this.mSource.getRange(t,e,this._table,t)},e}(d);e.LazySketchTable=c}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){var e=i.data(this.element[0],"wijgridowner");this._field("owner",e),t.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass(e.options.wijCSS.widget+" "+t.grid.wijgrid.CSS.c1basefield+" "+e.options.wijCSS.stateDefault),this.options.disabled&&this.disable(),e.options.allowColMoving&&e._UIDragndrop(!0).attach(this)},n.prototype._init=function(){this.element.wrapInner("<div class='"+t.grid.wijgrid.CSS.cellContainer+" "+this._owner().options.wijCSS.wijgridCellContainer+"'></div>"),this._refreshHeaderCell()},n.prototype.destroy=function(){try{e.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},n.prototype._destroy=function(){if(!this._isDestroyed()){var e=this._owner();e&&e._UIDragndrop()&&e._UIDragndrop().detach(this),t.grid.remove$dataByPrefix(this.element,this._data$prefix);var i=t.grid.wijgrid.CSS,n=e.options.wijCSS;this.element.removeClass(n.widget+" "+i.c1basefield+" "+n.c1basefield+" "+n.stateDefault).html(this.element.find("."+i.headerCellText).html())}},n.prototype._field=function(e,i){return t.grid.dataPrefix(this.element,this._data$prefix,e,i)},n.prototype._removeField=function(t){var e=this._data$prefix+t;this.element.removeData(e)},n.prototype._setOption=function(t,i){var n=this["_preset_"+t],o=this.options[t],r,s;if(void 0!==n&&(i=n.apply(this,[i,o])),r=i!==o,e.prototype._setOption.apply(this,[t,i]),r){if(void 0!==this.options.groupedIndex){var a=this._owner()._field("groupedWidgets")[this.options.groupedIndex];a&&t in a.options&&a._setOption(t,i)}s=this["_postset_"+t],void 0!==s&&s.apply(this,[i,o])}},n.prototype._postset_allowMoving=function(t,e){},n.prototype._preset_clientType=function(t,e){throw"read-only"},n.prototype._postset_headerText=function(t,e){this._refreshHeaderCell()},n.prototype._postset_visible=function(t,e){this._owner().ensureControl(!1)},n.prototype._postset_width=function(e,i){var n=this._owner();if(n){this.options.ensurePxWidth=!0;var o=t.grid.getColumnByTravIdx(n.options.columns,this.options.travIdx);o&&(o.found.width=e,o.found.ensurePxWidth=!0),n.setSize()}},n.prototype._owner=function(){return this._field("owner")},n.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},n.prototype._canDrag=function(){return this.options.allowMoving===!0},n.prototype._canDropTo=function(e){return t.grid.isChildOf(this._owner().options.columns,e,this)?!1:!0},n.prototype._createHeaderContent=function(t){return t.html(this.options.headerText||"&nbsp;")},n.prototype._decorateHeaderContent=function(e){return e.wrapInner('<span class="'+t.grid.wijgrid.CSS.headerCellText+" "+this._owner().options.wijCSS.wijgridHeaderCellText+'" />');
},n.prototype._refreshHeaderCell=function(){var e=this.element.children("."+t.grid.wijgrid.CSS.cellContainer).empty();this._createHeaderContent(e),this._decorateHeaderContent(e)},n.prototype._isDestroyed=function(){return this._destroyed},n}(t.wijmoWidget);e.c1basefield=n,n.prototype._data$prefix="c1basefield";var o=function(){function t(){this.allowMoving=!0,this.allowSizing=!0,this.cellFormatter=void 0,this.dataKey=void 0,this.ensurePxWidth=void 0,this.footerText=void 0,this.headerText=void 0,this.textAlignment=void 0,this.visible=!0,this.width=void 0}return t}();e.c1basefield_options=o,n.prototype.options=t.grid.extendWidgetOptions(t.wijmoWidget.prototype.options,new o),i.wijmo.registerWidget("c1basefield",n.prototype)}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){e.prototype._create.apply(this,arguments);var i=this._owner();this.element.addClass(i.options.wijCSS.widget+" "+t.grid.wijgrid.CSS.c1field)},n.prototype._destroy=function(){if(!this._isDestroyed()){var i=this._owner();if(this.element.find("*").unbind("."+this.widgetName),this.$filterEditor){switch(this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName),this._getInputEditorType(this.options)){case"date":this.$filterEditor.data("wijmo-wijinputdate")&&this.$filterEditor.wijinputdate("destroy");break;case"text":this.$filterEditor.data("wijmo-wijinputtext")&&this.$filterEditor.wijinputtext("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.data("wijmo-wijinputnumber")&&this.$filterEditor.wijinputnumber("destroy")}this.$filterEditor=null}this.element.removeClass(i.options.wijCSS.widget+" "+t.grid.wijgrid.CSS.c1field),this._removeDropDownFilterList(),e.prototype._destroy.apply(this,arguments)}},n.prototype._init=function(){e.prototype._init.apply(this,arguments),this.$filterEditor=null;var t=this._owner();this.filterRow=t._filterRow(),t.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},n.prototype._postset_aggregate=function(t,e){this._owner().ensureControl(!1)},n.prototype._postset_allowSort=function(t,e){this._refreshHeaderCell()},n.prototype._postset_dataType=function(t,e){throw"read-only"},n.prototype._postset_dataParser=function(t,e){this._owner().ensureControl(!1)},n.prototype._postset_dataFormatString=function(t,e){this._owner().ensureControl(!1)},n.prototype._postset_filterOperator=function(t,e){this._owner().ensureControl(!0)},n.prototype._postset_filterValue=function(t,e){this._owner().ensureControl(!0)},n.prototype._postset_groupInfo=function(t,e){this._owner().ensureControl(!0)},n.prototype._postset_rowMerge=function(t,e){this._owner().ensureControl(!1)},n.prototype._postset_showFilter=function(t,e){this._owner().ensureControl(!1)},n.prototype._postset_sortDirection=function(t,e){this.options.sortOrder=0,this._owner().ensureControl(!0)},n.prototype._postset_width=function(t,i){e.prototype._postset_width.apply(this,arguments)},n.prototype._canDropTo=function(t){return e.prototype._canDropTo.apply(this,arguments)?void 0!==this.options.groupedIndex&&t instanceof i.wijmo.c1groupedfield?!1:!0:!1},n.prototype._isSortable=function(){return t.grid.validDataKey(this.options.dataKey)},n.prototype._isSortableUI=function(){var t=this._owner();return t&&t.options.allowSorting&&this.options.allowSort&&this._isSortable()},n.prototype._decorateHeaderContent=function(n){var o=this._owner(),r=t.grid.wijgrid.CSS,s=o.options.wijCSS;if(this._isSortable()){this._isSortableUI()?n.wrapInner('<a class="'+r.headerCellText+" "+s.wijgridHeaderCellText+'" href="#" role="button" />').children("a").bind("click."+this.widgetName,this,i.proxy(this._onHrefClick,this)):e.prototype._decorateHeaderContent.apply(this,arguments);var a=r.headerCellSortIcon+" "+s.wijgridHeaderCellSortIcon+" "+s.icon;switch(this.options.sortDirection){case"ascending":n.append(i('<span class="'+a+" "+s.iconArrowUp+'"></span>'));break;case"descending":n.append(i('<span class="'+a+" "+s.iconArrowDown+'"></span>'))}}else e.prototype._decorateHeaderContent.apply(this,arguments)},n.prototype._prepareFilterCell=function(){var e=this.options.visLeavesIdx,n=this._owner(),o=null,r,s,a=this,l,h=t.grid.HTML5InputSupport.getDefaultInputType(n._isMobileEnv(),this.options),d=n.options.wijCSS,c=t.grid.wijgrid.CSS;if(e>=0){if(n=this._owner(),!this.filterRow)throw"exception";if(o=i(t.grid.rowAccessor.getCell(this.filterRow,e)),this.$filterEditor=o.find("input"),o.bind(i.support.selectstart?"selectstart":"mousedown",function(t){t.stopPropagation()}),r=n.parse(this.options,t.grid.filterHelper.getSingleValue(this.options.filterValue)),null===r||"undefined"===r)switch(t.grid.getDataType(this.options)){case"boolean":r=!1;break;case"number":case"currency":r=0;break;case"datetime":r=new Date;break;default:r=""}switch(s={culture:n.options.culture,disabled:n.options.disabled,decimalPlaces:function(t){var e=/^(n|p|c){1}(\d*)$/.exec(t);return e&&e[2]?parseInt(e[2],10):(e=/^(d){1}(\d*)$/.exec(t),e?0:2)}(this.options.dataFormatString)},l=this._getInputEditorType(this.options)){case"date":"text"===h?this.$filterEditor.wijinputdate(i.extend(s,{date:r,dateFormat:this.options.dataFormatString||void 0,showTrigger:!0})):this._createHtmlEditor(this.$filterEditor,h,t.grid.HTML5InputSupport.toStr(r,h));break;case"text":this.$filterEditor.wijinputtext({text:r+""});break;case"numberCurrency":this.$filterEditor.wijinputnumber(i.extend(s,{type:"currency",value:r}));break;case"numberNumber":"text"===h?this.$filterEditor.wijinputnumber(i.extend(s,{value:r})):this._createHtmlEditor(this.$filterEditor,h,t.grid.HTML5InputSupport.toStr(r,h));break;case"numberPercent":this.$filterEditor.wijinputnumber(i.extend(s,{type:"percent",value:100*r}));break;default:throw t.grid.stringFormat('Unsupported editor type: "{0}"',l)}o.find("."+c.filterTrigger).attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(t){a.options.disabled||i(this).addClass(d.stateDefault+" "+d.stateHover)}).bind("mouseleave."+this.widgetName,function(t){a.options.disabled||i(this).removeClass(d.stateDefault+" "+d.stateHover+" "+d.stateActive)}).bind("mouseup."+this.widgetName,this,function(t){a.options.disabled||i(this).removeClass(d.stateDefault+" "+d.stateActive)}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(t){t.preventDefault()})}},n.prototype._createHtmlEditor=function(e,i,n){return e.wrap('<span class="'+t.grid.wijgrid.CSS.filterNativeHtmlEditorWrapper+" "+this._owner().options.wijCSS.wijgridFilterNativeHtmlEditorWrapper+'"></span').attr("type",i).val(n)},n.prototype._onFilterBtnClick=function(e){var n=e.data.column,o=8,r=n._owner(),s,a,l,h,d,c,u,p,g=t.grid.HTML5InputSupport.getDefaultInputType(r._isMobileEnv(),n.options);return n.options.disabled?!1:n.$dropDownFilterList?(n._removeDropDownFilterList(),!1):(e.target.focus(),s=t.grid.filterHelper.getSingleOperatorName(n.options.filterOperator).toLowerCase(),a=r.getFilterOperatorsByDataType(t.grid.getDataType(n.options)),l={operators:i.extend(!0,[],a),column:n.options},r._onFilterOperatorsListShowing(l),h=[],l.operators&&i.each(l.operators,function(t,e){h.push({label:e.displayName||e.name,value:e.name,selected:e.name.toLowerCase()===s})}),n.$dropDownFilterList=i("<div />").addClass(t.grid.wijgrid.CSS.filterList+" "+r.options.wijCSS.wijgridFilterList).appendTo(document.body).wijlist({autoSize:!0,maxItemsCount:o,selected:function(e,i){var o,s;switch(s=n._getInputEditorType(n.options)){case"date":o="text"===g?n.$filterEditor.wijinputdate("option","date")||new Date:t.grid.HTML5InputSupport.parse(n.$filterEditor.val(),g)||new Date;break;case"text":o=n.$filterEditor.wijinputtext("option","text");break;case"numberNumber":if("text"!==g){o=t.grid.HTML5InputSupport.parse(n.$filterEditor.val(),g)||0;break}case"numberCurrency":case"numberPercent":o=n.$filterEditor.wijinputnumber("option","value"),"numberPercent"===s&&(o/=100)}n._removeDropDownFilterList(),r._handleFilter(n,i.item.value,o)}}),n.$dropDownFilterList.css("z-index",t.grid.getZIndex(r.outerDiv,9999)),n.$dropDownFilterList.wijlist("setItems",h).wijlist("renderList"),u=150|n.$dropDownFilterList.width(),n.$dropDownFilterList.width(h.length>o?u+20:u).wijlist("refreshSuperPanel").position({of:i(this),my:"left top",at:"left bottom"}),n.$dropDownFilterList.$button=i(this),p=n.$dropDownFilterList.eventUID=t.grid.getUID(),i(document).bind("mousedown."+n.widgetName+"."+p,{column:n},n._onDocMouseDown),void 0)},n.prototype._onDocMouseDown=function(e){var n=i(e.target),o=t.grid.wijgrid.CSS,r=n.parents("."+o.filterList+":first"),s=n.is("."+o.filterTrigger)?n:n.parents("."+o.filterTrigger+":first");s.length&&s[0]===e.data.column.$dropDownFilterList.$button[0]||r.length&&r[0]===e.data.column.$dropDownFilterList[0]||e.data.column._removeDropDownFilterList()},n.prototype._onHrefClick=function(t){if(t.data.options.disabled)return!1;if(t.data.options.allowSort){var e=t.data._owner();e._handleSort(t.data.options,t.ctrlKey)}return!1},n.prototype._removeDropDownFilterList=function(){if(this.$dropDownFilterList){var t=this.$dropDownFilterList.eventUID;this.$dropDownFilterList.remove(),this.$dropDownFilterList=null,i(document).unbind("mousedown."+this.widgetName+"."+t,this._onDocMouseDown)}},n.prototype._getInputEditorType=function(e){switch(t.grid.getDataType(e)){case"number":return e.dataFormatString&&0===e.dataFormatString.indexOf("p")?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"text"}},n}(e.c1basefield);e.c1field=n;var o=function(t){function e(){t.apply(this,arguments),this.aggregate="none",this.allowSort=!0,this.dataType=void 0,this.inputType=void 0,this.dataParser=void 0,this.dataFormatString=void 0,this.filterOperator="nofilter",this.filterValue=void 0,this.groupInfo={expandInfo:[],level:void 0,groupSingleRow:!0,collapsedImageClass:void 0,expandedImageClass:void 0,position:"none",outlineMode:"startExpanded",headerText:void 0,footerText:void 0},this.readOnly=!1,this.rowMerge="none",this.showFilter=!0,this.sortDirection="none",this.valueRequired=!1}return __extends(e,t),e}(e.c1basefield_options);e.c1field_options=o,n.prototype.options=t.grid.extendWidgetOptions(e.c1basefield.prototype.options,new o),i.wijmo.registerWidget("c1field",i.wijmo.c1basefield,n.prototype)}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){e.prototype._create.apply(this,arguments);var i=this._owner();this.element.addClass(i.options.wijCSS.widget+" "+t.grid.wijgrid.CSS.c1band)},n.prototype._canDropTo=function(t){return e.prototype._canDropTo.apply(this,arguments)?!(t instanceof i.wijmo.c1groupedfield):!1},n}(e.c1basefield);e.c1band=n;var o=function(t){function e(){t.apply(this,arguments),this.columns=[]}return __extends(e,t),e}(e.c1field_options);n.prototype.options=t.grid.extendWidgetOptions(e.c1basefield.prototype.options,new o),i.wijmo.registerWidget("c1band",i.wijmo.c1basefield,n.prototype)}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){var e=i.data(this.element[0],"wijgridowner"),n=t.grid.wijgrid.CSS,o=e.options.wijCSS;this._field("owner",e),t.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass(n.groupAreaButton+" "+o.wijgridGroupAreaButton+" "+o.stateDefault+" "+o.cornerAll),this.options.disabled&&this.disable(),e.options.allowColMoving&&e._UIDragndrop(!0).attach(this)},n.prototype._init=function(){this._refreshHeaderCell()},n.prototype.destroy=function(){try{e.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},n.prototype._destroy=function(){if(!this._isDestroyed()){this.element.find("*").unbind("."+this.widgetName);var e=this._owner();e&&e._dragndrop(!1)&&e._dragndrop(!1).detach(this),t.grid.remove$dataByPrefix(this.element,this._data$prefix)}},n.prototype._field=function(e,i){return t.grid.dataPrefix(this.element,this._data$prefix,e,i)},n.prototype._removeField=function(t){var e=this._data$prefix+t;this.element.removeData(e)},n.prototype._setOption=function(t,i){var n=this["_preset_"+t],o=this.options[t],r,s;void 0!==n&&(i=n.apply(this,[i,o])),r=i!==o,e.prototype._setOption.apply(this,[t,i]),r&&(s=this["_postset_"+t],void 0!==s&&s.apply(this,[i,o]))},n.prototype._postset_headerText=function(t,e,i){this._refreshHeaderCell()},n.prototype._postset_allowSort=function(t,e,i){this._refreshHeaderCell()},n.prototype._owner=function(){return this._field("owner")},n.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},n.prototype._canDrag=function(){return this.options.allowMoving===!0},n.prototype._canDropTo=function(e){return e instanceof i.wijmo.c1groupedfield?t.grid.isChildOf(this._owner().options.columns,e,this)?!1:!0:!1},n.prototype._isSortable=function(){return t.grid.validDataKey(this.options.dataKey)},n.prototype._isSortableUI=function(){var t=this._owner();return t&&t.options.allowSorting&&this.options.allowSort&&this._isSortable()},n.prototype._refreshHeaderCell=function(){var e=t.grid.wijgrid.CSS,n=this._owner().options.wijCSS,o=i('<span class="'+e.groupAreaButtonClose+" "+n.wijgridGroupAreaButtonClose+" "+n.stateDefault+" "+n.cornerAll+'"><span class="'+n.icon+" "+n.iconClose+'"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);if(this.element.html(this.options.headerText||"").prepend(o),this._isSortableUI()&&this.element.bind("click."+this.widgetName,this,i.proxy(this._onHrefClick,this)),this._isSortable()){var r=e.groupAreaButtonSort+" "+n.wijgridGroupAreaButtonSort+" "+n.icon;switch(this.options.sortDirection){case"ascending":this.element.append(i('<span class="'+r+" "+n.iconArrowUp+'"></span>'));break;case"descending":this.element.append(i('<span class="'+r+" "+n.iconArrowDown+'"></span>'))}}},n.prototype._onCloseClick=function(t){var e=t.data.options;return e.disabled||t.data._owner()._handleUngroup(t.data.options.travIdx),!1},n.prototype._onHrefClick=function(e){var i=e.data._owner(),n=e.data.options,o;return!n.disabled&&n.allowSort&&(o=t.grid.search(i.columns(),function(t){return t.options.travIdx===n.travIdx}),o=o.found?o.found.options:t.grid.getColumnByTravIdx(i.options.columns,n.travIdx).found,o&&i._handleSort(o,e.ctrlKey)),!1},n.prototype._isDestroyed=function(){return this._destroyed},n}(t.wijmoWidget);e.c1groupedfield=n,n.prototype._data$prefix="c1groupedfield",n.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},allowMoving:!0,allowSort:!0,headerText:void 0,sortDirection:"none"}),i.wijmo.registerWidget("c1groupedfield",n.prototype)}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){"use strict";var e=jQuery,i=function(){function t(t){var i=this;this.mSettings=e.extend(!0,{},t),this.mElement=this._createButton(t).addClass("wijmo-wijgrid-commandbutton").click(function(t){!i.mSettings.disabled&&e.isFunction(i.mSettings.click)&&i.mSettings.click.call(i,t)})}return t.prototype._createButton=function(t){throw"not implemented"},t.prototype.element=function(){return this.mElement},t}();t.wijgridCommandButtonBase=i;var n=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype._createButton=function(t){var i=e('<a href="#" />').text(t.text||"");return t.disabled&&i.prop("disabled","disabled"),i},i}(i);t.wijgridCommandLink=n;var o=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype._createButton=function(t){var i=e('<input type="button" />').val(t.text).button({disabled:t.disabled});return i},i}(i);t.wijgridCommandButton=o;var r=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype._createButton=function(t){var i=e("<button />"),n=!!t.text;return n?i.text(t.text):i.html("&nbsp;"),i.button({disabled:t.disabled,icons:{primary:t.iconClass},text:n}),i},i}(i);t.wijgridCommandImageButton=r;var s=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype._createButton=function(t){var i=e("<button />").html("&nbsp;").button({disabled:t.disabled,icons:{primary:t.iconClass},text:!1});return i},i}(i);t.wijgridCommandImage=s}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.testC1GridViewCommandField=function(t){return t&&t.innerState&&"c1commandfield"===(t.innerState.clientType||"").toLowerCase()},e.testC1GridViewButtonField=function(t){return t&&t.innerState&&"c1buttonfield"===(t.innerState.clientType||"").toLowerCase()},e.test=function(t){return t&&t.buttonType&&!e.testC1GridViewCommandField(t)&&!e.testC1GridViewButtonField(t)},e}(e.c1basefield);e.c1btnfieldbase=n;var o=function(t){function e(){t.apply(this,arguments),this.buttonType="button"}return __extends(e,t),e}(e.c1basefield_options);e.c1btnfieldbase_options=o,n.prototype.options=t.grid.extendWidgetOptions(e.c1basefield.prototype.options,new o);var r=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.test=function(t){return n.test(t)||t.command},e}(n);e.c1btnfield=r;var s=function(t){function e(){t.apply(this,arguments),this.command=void 0}return __extends(e,t),e}(o);e.c1btnfield_options=s,r.prototype.options=t.grid.extendWidgetOptions(n.prototype.options,new s),i.wijmo.registerWidget("c1btnfield",r.prototype);var a=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.test=function(t){return n.testC1GridViewCommandField(t)||n.testC1GridViewButtonField(t)?!1:t.showDeleteButton&&t.showDeleteButton!==!1||t.showEditButton&&t.showEditButton!==!1||t.cancelCommand||t.deleteCommand||t.editCommand||t.updateCommand},e}(n);e.c1commandbtnfield=a;var l=function(t){function e(){t.apply(this,arguments),this.showDeleteButton=!1,this.showEditButton=!1,this.cancelCommand={text:"Cancel",iconClass:"ui-icon-close",click:void 0},this.deleteCommand={text:"Delete",iconClass:"ui-icon-trash",click:void 0},this.editCommand={text:"Edit",iconClass:"ui-icon-pencil",click:void 0},this.updateCommand={text:"Update",iconClass:"ui-icon-disk",click:void 0}}return __extends(e,t),e}(o);e.c1commandbtnfield_options=l,a.prototype.options=t.grid.extendWidgetOptions(n.prototype.options,new l),i.wijmo.registerWidget("c1commandbtnfield",a.prototype)}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";function i(t){var e=[];return n(t,e),e}function n(t,e){var i,o,r,s;if(t)for(i=0,o=t.length;o>i;i++)r=t[i],r.options&&(r=r.options),s=r.columns,s&&s.length?n(s,e):e.push(r)}function o(t,e){var i,n,o,r=null;if(t&&e>=0)for(i=0,n=t.length;n>i&&!r;i++){if(o=t[i],o.options&&(o=o.options),o.travIdx===e)return{found:o,at:t};o.columns&&(r=this.getColumnByTravIdx(o.columns,e))}return r}function r(t,e,i){if(e.options&&(e=e.options),i.options&&(i=i.options),i.isBand&&e.parentIdx>=0){if(e.parentIdx===i.travIdx)return!0;if(e.parentIdx>i.travIdx)for(var n=this.flatten(t);;){if(e=n[e.parentIdx],e.travIdx===i.travIdx)return!0;if(-1===e.parentIdx)break}}return!1}function s(t){var e=[];return a(t,e),e}function a(t,e){var i,n,o;if(t)for(i=0,n=t.length;n>i;i++)o=t[i],o.isLeaf&&e.push(o),o.columns&&a(o.columns,e)}function l(t){return h(t,0,-1)}function h(t,e,i){var n,o,r;if(t)for(n=0,o=t.length;o>n;n++)r=t[n],r.options&&(r=r.options),r.linearIdx=n,r.travIdx=e++,r.parentIdx=i,r.columns&&(e=h(r.columns,e,e-1));return e}function d(e){var i=[];return t.grid.traverse(e,function(t){i.push(t)}),i}function c(e,i){var n,o,r;if(e&&u.isFunction(i))for(n=0;n<e.length;n++)r=e[n],r.options&&(r=r.options),o=e.length,i(r,e),e.length===o?r.columns&&t.grid.traverse(r.columns,i):n--}var u=jQuery,p=function(){function e(){}return e.prototype.generateSpanTable=function(t,e){this._height=this._width=this._inc=this._shift=0,this._table=[],this._traverseList=[],this._savedXPos=[];var i=this._generateSpanTable(t,e,!0);return i},e.prototype._generateSpanTable=function(e,i,n){var o,r,s=this;for(this._height=this.getVisibleHeight(e,n),i=i||[],t.grid.traverse(e,function(t){t.isLeaf&&i.push(t),s._traverseList.push(t)}),this._width=i.length,o=0;o<this._height;o++)for(this._table[o]=[],r=0;r<this._width;r++)this._table[o][r]={column:null,colSpan:0,rowSpan:0};return this._setTableValues(e,0,0),this._table},e.prototype.getVisibleHeight=function(t,e){var i,n,o,r,s=0;if(u.isArray(t))for(i=0,n=t.length;n>i;i++)r=this.getVisibleHeight(t[i],e),s=Math.max(s,r);else if(o=void 0===t.visible?!0:t.visible,t.parentVis=o&&e,t.isBand){for(i=0,n=t.columns.length;n>i;i++)r=this.getVisibleHeight(t.columns[i],t.parentVis),s=Math.max(s,r);if(!t.parentVis)return s;t.isLeaf=0===s,s++}else t.isLeaf=!0,t.parentVis&&(s=1);return s},e.prototype._getVisibleParent=function(t){for(;t;)if(t=this._traverseList[t.parentIdx],t&&(t.parentVis||void 0===t.parentVis))return t;return null},e.prototype._setTableValues=function(t,e,i){var n,o,r,s,a,l;if(u.isArray(t))for(n=0,o=t.length;o>n;n++)this._setTableValues(t[n],e,i);else{if(void 0===t.travIdx)throw"undefined travIdx";if(r=i+this._shift,t.parentVis&&(s=r+this._inc,this._table[e][s].column=t,this._savedXPos[t.travIdx]=s),t.isBand)for(n=0,o=t.columns.length;o>n;n++)this._setTableValues(t.columns[n],e+1,i);t.parentVis?this._shift-r===0?(this._table[e][this._savedXPos[t.travIdx]].rowSpan=this._height-e,this._shift++):this._table[e][this._savedXPos[t.travIdx]].colSpan=this._shift-r:!t.isBand&&this._height>0&&(l=this._getVisibleParent(t),a=l?l.isLeaf:!1,a&&this._inc++,e>=this._height&&(e=this._height-1),s=i+this._shift+this._inc,this._table[e][s].column=t,a||(l&&this._savedXPos[l.travIdx]===s&&this._shiftTableElements(s,e),this._inc++))}},e.prototype._shiftTableElements=function(t,e){var i;for(i=0;e>i;i++)this._table[i][t+1]=this._table[i][t],this._table[i][t]={column:null,colSpan:0,rowSpan:0},this._table[i][t+1].column&&this._savedXPos[this._table[i][t+1].column.travIdx]++},e}();e.bandProcessor=p,e.getAllLeaves=i,e.getColumnByTravIdx=o,e.isChildOf=r,e.getLeaves=s,e.setTraverseIndex=l,e.flatten=d,e.traverse=c}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(e){if(this._dvFilteringSettings=void 0,this._dvPagingSettings=void 0,this._dvSortingSettings=void 0,this._wgFilteringSettings=void 0,this._wgPagingSettings=void 0,this._wgSortingSettings=void 0,!e)throw"exception";this._wijgrid=e,this._dataView=e._dataViewWrapper.dataView(),this._filterCache=new t.grid.filterOperatorsCache(e)}return e.prototype.compareSettings=function(){var e=!0,i,n,o,r;if(e=(i=this.DVPagingSettings())===(n=this.WGPagingSettings()),!e&&i&&n&&(e=i.pageSize===n.pageSize&&i.pageIndex===n.pageIndex),e&&(e=(i=this.DVSortingSettings())===(n=this.WGSortingSettings()),!e&&i&&n&&(r=i.length)===n.length))for(e=!0,o=0;r>o&&e;o++)e=i[o].dataKey===n[o].dataKey&&i[o].sortDirection===n[o].sortDirection;return e&&(i=this.DVFilteringSettings(),n=this.WGFilteringSettings(),e=t.grid.compareObj(i,n)),e},e.prototype.DVFilteringSettings=function(){function t(e,n){var o;i.each(e,function(e,r){"string"==typeof r?o=r:i.isArray(r)?t(r,n):(n.filterValue.push(r.value),n.filterOperator.push({name:r.originalOperator||r.operator,condition:o}))})}if(void 0===this._dvFilteringSettings){var e=[],n=this._dataView.filter();n&&i.each(n,function(n,o){var r={dataKey:n};i.isArray(o)?(r.filterValue=[],r.filterOperator=[],t(o,r)):i.isPlainObject(o)?(r.filterValue=o.value,r.filterOperator=o.originalOperator||o.operator||"Equals"):(r.filterValue=o,r.filterOperator="Equals"),e.push(r)}),this._dvFilteringSettings=e.length?e:null}return this._dvFilteringSettings},e.prototype.DVPagingSettings=function(){if(void 0===this._dvPagingSettings){var e=t.grid.asPagedDataView(this._dataView);if(e){var i=e.pageSize();this._dvPagingSettings=i>0?{pageSize:e.pageSize(),pageIndex:e.pageIndex()}:null}}return this._dvPagingSettings},e.prototype.DVSortingSettings=function(){if(void 0===this._dvSortingSettings){var e=[],n=t.data.sorting.compile(this._dataView.sort()).normalized;n&&i.each(n,function(t,i){null!==i&&e.push({dataKey:"string"==typeof i?i:i.property,sortDirection:i.asc||void 0===i.asc?"ascending":"descending"})}),this._dvSortingSettings=e.length?e:null}return this._dvSortingSettings},e.prototype.WGFilteringSettings=function(){if(void 0===this._wgFilteringSettings){var e=[],n=this._wijgrid._field("leaves"),o=this;n&&i.each(n,function(i,n){if(t.grid.validDataKey(n.dataKey)&&n.filterOperator){var r=t.grid.deepExtend({},{foo:n.filterValue}).foo,s=t.grid.deepExtend({},{foo:n.filterOperator}).foo,a=t.grid.filterHelper.verify(s,r,n.dataType,o._filterCache);a&&e.push({owner:n,dataKey:n.dataKey,filterValue:a.filterValue,filterOperator:a.filterOperator})}}),this._wgFilteringSettings=e.length?e:null}return this._wgFilteringSettings},e.prototype.WGPagingSettings=function(){return void 0===this._wgPagingSettings&&(this._wgPagingSettings=this._wijgrid.options.allowPaging?{pageSize:this._wijgrid.options.pageSize,pageIndex:this._wijgrid.options.pageIndex}:null),this._wgPagingSettings},e.prototype.WGSortingSettings=function(){if(void 0===this._wgSortingSettings){var e={},n=[],o=this._wijgrid._groupedColumns(!0),r=this._wijgrid._field("leaves")||[],s=function(e){return!e.isBand&&t.grid.validDataKey(e.dataKey)},a=0;i.each(o,function(t,i){s(i)&&("none"===i.sortDirection&&(i.sortDirection="ascending"),e[i.dataKey]={dataKey:i.dataKey,sortDirection:i.sortDirection,sortOrder:a++})}),a++,i.each(r,function(t,i){s(i)&&("ascending"===i.sortDirection||"descending"===i.sortDirection)&&(e[i.dataKey]||(e[i.dataKey]={dataKey:i.dataKey,sortDirection:i.sortDirection,sortOrder:(i.sortOrder||0)+a}))}),i.each(e,function(t,e){n.push(e)}),n.sort(function(t,e){return t.sortOrder-e.sortOrder}),i.each(n,function(t,e){delete e.sortOrder}),this._wgSortingSettings=n.length?n:null}return this._wgSortingSettings},e.prototype.MapWGToDV=function(){var e=this,n={},o,r;return this._mapPagingParams()&&(o=this.WGPagingSettings())?(n.pageIndex=o.pageIndex,n.pageSize=o.pageSize):n.pageSize=-1,this._mapSortingParams()&&(n.sort=[],(o=this.WGSortingSettings())&&(n.sort=[],i.each(o,function(t,e){n.sort.push({property:e.dataKey,asc:"ascending"===e.sortDirection})}))),this._wijgrid.deficientFilters={},this._mapFilteringParams()&&(i.each(this._wijgrid._field("leaves"),function(i,n){t.grid.validDataKey(n.dataKey)&&void 0===n.filterOperator^void 0===n.filterValue&&(e._wijgrid.deficientFilters[n.dataKey]={filterOperator:n.filterOperator,filterValue:n.filterValue})}),n.filter={},(o=this.WGFilteringSettings())&&(n.filter=this._convertFilterToDV(o)),i.isEmptyObject(n.filter)&&(n.filter=null)),n},e.prototype.MapDVToWG=function(){var e,n={},o=this._mapSortingParams(),r=this._mapPagingParams(),s=this._mapFilteringParams(),a=t.grid.asPagedDataView(this._dataView),l=this;i.each(this._wijgrid._field("leaves"),function(t,e){o&&(e.sortOrder=0,e.sortDirection="none"),s&&(e.filterOperator="nofilter",e.filterValue=void 0),n[e.dataKey]=e}),r&&a&&(this._wijgrid.options.pageSize=a.pageSize(),this._wijgrid.options.pageIndex=a.pageIndex()),o&&(e=this.DVSortingSettings())&&i.each(e,function(t,e){var i;(i=n[e.dataKey])&&(i.sortDirection=e.sortDirection,i.sortOrder=t)}),s&&((e=this.DVFilteringSettings())&&i.each(e,function(t,e){var o;(o=n[e.dataKey])&&(o.filterValue=e.filterValue,o.filterOperator=e.filterOperator,i.isPlainObject(o.filterOperator)&&(o.filterOperator=o.filterOperator.name),delete l._wijgrid.deficientFilters[o.dataKey])}),i.each(this._wijgrid.deficientFilters,function(t,e){n[t].filterOperator=e.filterOperator,n[t].filterValue=e.filterValue}))},e.prototype._mapPagingParams=function(){return this._wijgrid.options.allowPaging&&!this._wijgrid._customPagingEnabled()&&!this._wijgrid._serverShaping()},e.prototype._mapSortingParams=function(){return!this._wijgrid._serverShaping()},e.prototype._mapFilteringParams=function(){return!this._wijgrid._serverShaping()},e.prototype.makeProxyFilter=function(e,n,o,r){o=o.toLowerCase();var s=this,a="datetime"===e.dataType,l={originalOperator:void 0,property:n,operator:o,value:r},h=this._filterCache.getByNameInt(o),d=t.data.filtering.ops[o];if("nofilter"!==o&&(h.isCustom||a))if(l.originalOperator=l.operator,h.isCustom)l.operator=i.extend(!0,{},h.op),l.operator.apply=l.operator.operator;else{l.operator=i.extend(!0,{},d);var c=e.inputType?t.grid.TimeUnitConverter.convertInputType(e.inputType):t.grid.TimeUnitConverter.convertFormatString(e.dataFormatString||"d");l.operator.apply=function(i,n){return i instanceof Date||(i=s._wijgrid.parse(e,i)),n instanceof Date||(n=s._wijgrid.parse(e,n)),t.grid.TimeUnitConverter.cutDate(i,c),t.grid.TimeUnitConverter.cutDate(n,c),d.apply(i,n)}}return l},e.prototype._convertFilterToDV=function(t){var e={},n=this;return i.each(t,function(t,o){var r=o.dataKey,s=[],a="and",l,h,d,c;if(i.isPlainObject(o)&&(h=o.filterOperator,d=o.filterValue,null!=h)){if(i.isArray(h)||(h=[h]),i.isArray(d)||(d=[d]),h.length!=d.length)throw"The number of filter operators must match the number of filter values";0!=h.length&&(i.each(h,function(t,e){function h(){c.length>1?c.splice(0,0,"or"):c=c[0]}function u(){null==a&&(a=l,s.splice(0,0,l))}var p;if("string"==typeof e&&(e={name:e}),!i.isPlainObject(e)||!e.name)throw"Invalid filter operator";p=d[t],i.isArray(p)||(p=[p]),c=i.map(p,function(t){return n.makeProxyFilter(o.owner,r,e.name,t)}),a=null,l=e.condition||"or",s.length<=1||a==l?1==c.length||s.length<=1||"or"==a?(s=s.concat(c),u()):(h(),s.push(c),u()):(h(),s=[s,c],u())}),i.each(s,function(t,e){i.isArray(e)&&2==e.length&&(s[t]=e[1])}),2==s.length&&typeof("string"===s[0])&&s.shift(),1==s.length&&(s=s[0]),e[r]=s)}}),e},e}();e.settingsManager=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";function i(t){return t&&"pageCount"in t?t:null}function n(t){return t&&"commitEdit"in t?t:null}var o=jQuery,r=function(){function e(t){this._domSource=null,this._ignoreAllEvents=!1,this._ignoreChangeEvent=!1,this._ignoreCurrentChangedEvent=!1,this._sharedDataItems=null,this._userData=null,this._totals=null,this._changeTimer=0,this._toDispose=[],this._isOwnDataView=!1,this._isWijdatasource=!1,this._isDynamicWijdatasource=!1,this._wijgrid=t,this._createDataViewWrapper()}return e.prototype.data=function(){var e=this._getDataViewInst(),i=t.grid.asPagedDataView(e);return{data:this._getSharedDataItems(),totalRows:null!=i?i.totalItemCount():(e.getSource()||[]).length,totals:this._getTotals(),emptyData:this.isBoundedToDOM()?this._domSource.emptyData:null}},e.prototype.dataView=function(){return this._getDataViewInst()},e.prototype.dispose=function(){var t=this._getDataViewInst();this._propChangeListener.dispose(),o.each(this._toDispose,function(t,e){e.dispose()}),t&&this._isOwnDataView&&t.dispose(),this._wijgrid._wijDataView=null},e.prototype.ignoreChangeEvent=function(t){
return arguments.length?void(this._ignoreChangeEvent=t===!0):this._ignoreChangeEvent},e.prototype.ignoreCurrentChangedEvent=function(t){return arguments.length?void(this._ignoreCurrentChangedEvent=t===!0):this._ignoreCurrentChangedEvent},e.prototype.isDataLoaded=function(){var t=this._getDataViewInst();return t.isLoaded()},e.prototype.isOwnDataView=function(){return this._isOwnDataView},e.prototype.getFieldsInfo=function(){var t=this._getDataViewInst();return this._propDescriptorsToFieldsInfo(t.getProperties())},e.prototype._propDescriptorsToFieldsInfo=function(t){var e={};return t&&o.each(t,function(t,i){"$$hash"!==i.name&&"$$hashKey"!==i.name&&(e[i.name]={name:i.name,type:i.type||"string"})}),e},e.prototype.isBoundedToDOM=function(){return null!==this._domSource},e.prototype.load=function(e){this._userData=e;var i=this._getDataViewInst();i||(this._createDataViewWrapper(),i=this._getDataViewInst()),this._onDataViewLoading();var n=new t.grid.settingsManager(this._wijgrid);if(e&&e.forceDataLoad||this._needToLoad(n)){var o=n.MapWGToDV(),r=!1;this._isWijdatasource&&!this._isDynamicWijdatasource&&i.isLoaded()&&(r=!0),this.ignoreCurrentChangedEvent(!0),i.refresh(o,r)}else this.isDataLoaded()&&(this._onDataViewLoaded(),this._onDataViewReset())},e.prototype.currentPosition=function(t){var e=this._getDataViewInst();if(!arguments.length)return e.currentPosition();this.ignoreCurrentChangedEvent(!0);try{e.currentPosition(t)}finally{this.ignoreCurrentChangedEvent(!1)}},e.prototype.getValue=function(t,e){var i=this._getDataViewInst();return"number"==typeof e&&(e+=""),i.getProperty(t,e)},e.prototype.setValue=function(t,e,i){var n=this._getDataViewInst();this.ignoreChangeEvent(!0);try{"number"==typeof e&&(e+=""),n.setProperty(t,e,i)}finally{this.ignoreChangeEvent(!1)}},e.prototype.makeDirty=function(){this._propChangeListener.removeAll(),this._totals=null,this._sharedDataItems=null},e.prototype._createDataViewWrapper=function(){var e,i=this._wijgrid.options.data,n=this._getDataViewInst(),r=!1;if(!n){if(i||(this._domSource=this._processDOM(this._wijgrid.element,this._wijgrid.options.readAttributesFromData),i=this._domSource.items),r="undefined"!=typeof wijdatasource&&i instanceof wijdatasource,this._isOwnDataView=o.isArray(i)||r,this._isWijdatasource=!!this._isOwnDataView&&!!r,this._isDynamicWijdatasource=!!(this._isOwnDataView&&r&&i.dynamic),this._isOwnDataView){!this._domSource&&this._wijgrid.options.readAttributesFromData&&this._moveAttributesToExpando(i);var s=this.isBoundedToDOM()&&t.grid.getTableSection(this._wijgrid.element,t.grid.rowScope.body);n=t.grid.GridDataView.create(t.data.asDataView(this._parseOwnData(i,s)))}else n=i;this._wijgrid._wijDataView=n,this._toDispose.push(n.isLoading.subscribe(o.proxy(this._onDataViewLoadingInternal,this))),this._toDispose.push(n.isLoaded.subscribe(o.proxy(this._onDataViewLoadedInternal,this))),this._toDispose.push(n.subscribe(o.proxy(this._onDataViewChangeInternal,this))),this._toDispose.push(n.currentPosition.subscribe(o.proxy(this._onDataViewCurrentChangedInternal,this))),this._propChangeListener=new t.grid.propChangeListener(o.proxy(this._onPropertyChanged,this))}},e.prototype._parseOwnData=function(e,i){var n=this;if(e&&e.length){var r=o.extend(!0,[],this._wijgrid.options.columns),s=t.data.ArrayDataViewBase._getProps(e[0])||[],a=this._propDescriptorsToFieldsInfo(s),l=[];this._wijgrid._prepareColumnOptions(r,"merge",a,!0,!0),t.grid.traverse(r,function(e){"string"!==t.grid.getDataType(e)&&t.grid.validDataKey(e.dataKey)&&l.push(e)}),l.length&&i&&o.each(e,function(e,o){t.grid.dataViewWrapper._parseDataItem(n._wijgrid,o,i&&i.rows[e],l)})}return e},e._parseDataItem=function(t,e,i,n){return o.each(n,function(n,o){var r=e[o.dataKey],s=t.parse(o,r);if(isNaN(s)){var a=null;i&&(a=i.cells[o.dataKey]),s=t.parseFailed(o,r,e,a)}e[o.dataKey]=s}),e},e.prototype._getDataViewInst=function(){return this._wijgrid._wijDataView},e.prototype._needToLoad=function(t){var e=this._getDataViewInst();return this._isDynamicWijdatasource||this._isWijdatasource&&!e.isLoaded()?!0:this._isOwnDataView&&!this._isWijdatasource&&this.isDataLoaded()?!0:this.isDataLoaded()||e.isLoading()?!t.compareSettings():!0},e.prototype._validateSettings=function(t){if(!this._isOwnDataView&&this._wijgrid.options.allowPaging&&(t.DVPagingSettings()||{}).pageSize!==(t.WGPagingSettings()||{}).pageSize)throw"The pageSize option of the external dataView can't be changed."},e.prototype._onDataViewLoadingInternal=function(t){this._ignoreAllEvents||t&&(this._userData||this._onDataViewLoading())},e.prototype._onDataViewLoadedInternal=function(t){this._ignoreAllEvents||t&&this._onDataViewLoaded()},e.prototype._onDataViewChangeInternal=function(t){var e=this;if(!this._ignoreAllEvents&&!this._ignoreChangeEvent){if(t.changes){if(t.length&&"detached"===t[0].entityState())return;o.each(t.changes,function(t,i){switch(i.changeType){case"remove":e._propChangeListener.remove(i.index);break;case"add":e._propChangeListener.insert(i.index,i.element)}})}this._onDataViewChange.apply(this,arguments)}},e.prototype._onDataViewCurrentChangedInternal=function(){this._ignoreAllEvents||this._ignoreCurrentChangedEvent||this._onDataViewCurrentChanged.apply(this,arguments)},e.prototype._onDataViewReset=function(){try{this.ignoreCurrentChangedEvent(!1),this.makeDirty(),this._wijgrid._onDataViewReset(this._userData)}finally{this._userData=null}},e.prototype._onPropertyChanged=function(t){var e=this;this._changeTimer>0&&(window.clearTimeout(this._changeTimer),this._changeTimer=0),-1!=this._changeTimer&&(this._changeTimer=window.setTimeout(function(){e._changeTimer=-1,e._wijgrid._destroyed||e._onDataViewChange(),e._changeTimer=0},100))},e.prototype._onDataViewChange=function(t){this._onDataViewReset()},e.prototype._onDataViewCurrentChanged=function(t,e){this._wijgrid._onDataViewCurrentPositionChanged(t,e)},e.prototype._onDataViewLoading=function(){this._wijgrid._onDataViewLoading()},e.prototype._onDataViewLoaded=function(){this._wijgrid._onDataViewLoaded()},e.prototype._getSharedDataItems=function(){if(!this._sharedDataItems){var t=this._getDataViewInst(),e=t.count();this._sharedDataItems=[];for(var i=!0,n=0;e>n;n++){var o=t.item(n);i&&!this._propChangeListener.insert(n,o)&&0===n&&(i=!1),this._sharedDataItems.push(this._wrapDataItem(o,n))}}return this._sharedDataItems||(this._sharedDataItems=[]),this._sharedDataItems},e.prototype._getTotals=function(){if(!this._totals){var t=this._getDataViewInst();this._totals=this._prepareTotals(t,this._wijgrid._prepareTotalsRequest(!0))}return this._totals||(this._totals={}),this._totals},e.prototype._prepareTotals=function(e,i){if(!i||0===i.length)return{};var n,o,r,s,a=[],l={};for(n=0,o=i.length;o>n;n++)a.push(new t.grid.tally);for(n=0,o=e.count();o>n;n++)for(r=0,s=a.length;s>r;r++)a[r].add(this._wijgrid.parse(i[r].column,this.getValue(n,i[r].column.dataKey)));for(n=0,o=a.length;o>n;n++)l[i[n].column.dataKey]=a[n].getValueString(i[n].column);return l},e.prototype._processDOM=function(e,i){var n={items:[],emptyData:[],header:t.grid.readTableSection(e,t.grid.rowScope.head)};return 1===t.grid.getTableSectionLength(e,2)&&o(t.grid.getTableSectionRow(e,2,0)).hasClass(t.grid.wijgrid.CSS.emptyDataRow)?n.emptyData=t.grid.readTableSection(e,t.grid.rowScope.body):n.items=t.grid.readTableSection(e,t.grid.rowScope.body,i),n},e.prototype._moveAttributesToExpando=function(e){o.each(e,function(e,i){var n=t.data.Expando.getFrom(i,!0),r;r=n[t.grid.EXPANDO]={cellsAttributes:{},rowAttributes:{}},i.rowAttributes&&(r.rowAttributes=i.rowAttributes,delete i.rowAttributes),o.each(i,function(t,e){o.isArray(e)&&(r.cellsAttributes[t]=e[1],i[t]=e[0])})})},e.prototype._wrapDataItem=function(t,e){return{values:t,originalRowIndex:e}},e.prototype._refreshSilent=function(){var t=this._getDataViewInst();if(t)try{this._ignoreAllEvents=!0,t.refresh()}finally{this._ignoreAllEvents=!1}},e.prototype._unsafeReplace=function(e,i){var n=this._getDataViewInst();n instanceof t.grid.GridDataView||"operation is not supported",n._unsafeReplace(e,i)},e.prototype._unsafeSplice=function(e,i,n){var o=this._getDataViewInst();o instanceof t.grid.GridDataView||"operation is not supported",2===arguments.length?o._unsafeSplice(e,i):o._unsafeSplice(e,i,n)},e.prototype._unsafePush=function(e){var i=this._getDataViewInst();i instanceof t.grid.GridDataView||"operation is not supported",i._unsafePush(e)},e}();e.dataViewWrapper=r,e.asPagedDataView=i,e.asEditableDataView=n;var s=function(){function t(t){this._subscriptions=[],this._callback=t}return t.prototype.insert=function(t,e){var i=null,n=this;return o.each(e,function(t,e){n._isValidPropName(t)&&e&&o.isFunction(e.subscribe)&&(i=i||[],i.push(e.subscribe(n._callback)))}),i?(this._subscriptions.length<t&&(this._subscriptions.length=t),this._subscriptions.splice(t,0,i),!0):!1},t.prototype.remove=function(t){var e=this._subscriptions[t];e&&o.each(e,function(t,i){i.dispose(),e[t]=null}),this._subscriptions[t]=null,this._subscriptions.splice(t,1)},t.prototype.removeAll=function(){for(var t,e;t=this._subscriptions.length;)this.remove(t-1);this._subscriptions=[]},t.prototype.dispose=function(){this.removeAll()},t.prototype._isValidPropName=function(t){return t&&"string"==typeof t?null===t.match(/^entityState|jQuery/):!0},t}();e.propChangeListener=s}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(e,i,n,o,r){this.cr=new t.grid.cellRange(-1,-1),this.isExpanded=!1,this._value=-1,this._sum=-1,this._position="none",this._hasHeaderOrFooter=!0,void 0!==e&&(this.isExpanded=e),void 0!==i&&(this.cr=i),void 0!==n&&(this._sum=n),void 0!==o&&(this._position=o),void 0!==r&&(this._hasHeaderOrFooter=r)}return e.prototype.isSubRange=function(t){return this.cr.r1>=t.cr.r1&&this.cr.r2<=t.cr.r2},e.prototype.toString=function(){return this.cr.r1+"-"+this.cr.r2},e.prototype.getHeaderImageClass=function(t){var e,i,n,o=null;if((e=this.owner)&&(i=e.owner)&&(n=i.owner)){var r=n.options.wijCSS;o=t?e.expandedImageClass||r.iconArrowRightDown:e.collapsedImageClass||r.iconArrowRight}return o},e.prototype.collapse=function(){var e,i,n,o,r;(e=this.owner)&&(i=e.owner)&&(n=i.owner)&&(o=n._field("leaves"),t.grid.groupHelper.isParentExpanded(o,this.cr,e.level)&&"footer"!==e.position&&"none"!==e.outlineMode&&(r=t.grid.groupHelper.getGroupedColumnsCount(o),this._collapse(n,n._rows(),o,this,r,n._allowVirtualScrolling())))},e.prototype.expand=function(e){var i,n,o,r,s;(i=this.owner)&&(n=i.owner)&&(o=n.owner)&&(r=o._field("leaves"),t.grid.groupHelper.isParentExpanded(r,this.cr,i.level)&&(s=t.grid.groupHelper.getGroupedColumnsCount(r),this._expand(o,o._rows(),r,this,s,e,!0,o._allowVirtualScrolling())))},e.prototype._collapse=function(e,i,n,o,r,s){var a=o.owner,l=o.cr.r1,h=o.cr.r2,d,c,u,p,g;switch(a.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(e.sketchTable.row(o.cr.r1),void 0),s||this._toggleRowVisibility(i.item(o.cr.r1),void 0,!1),l++}for(d=l;h>=d;d++)this._toggleSketchRowVisibility(e.sketchTable.row(d),!1),s||this._toggleRowVisibility(i.item(d),!1);for(o.isExpanded=!1,s||this._updateHeaderIcon(i,o),d=a.level+1;r>=d;d++)for(u=t.grid.groupHelper.getChildGroupRanges(n,o.cr,d-1),g=0,c=u.length;c>g;g++){switch(p=u[g],p.isExpanded=!1,p.owner.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(e.sketchTable.row(p.cr.r1),!1),s||this._toggleRowVisibility(i.item(p.cr.r1),void 0,!1)}s||this._updateHeaderIcon(i,p)}},e.prototype._expand=function(e,i,n,o,r,s,a,l){var h=o.owner,d=o.cr.r1,c=o.cr.r2,u,p,g,f,m;switch(h.position){case"header":this._toggleSketchRowVisibility(e.sketchTable.row(d),!0),l||this._toggleRowVisibility(i.item(d),!0,a||s),d++;break;case"footer":this._toggleSketchRowVisibility(e.sketchTable.row(c),!0),l||this._toggleRowVisibility(i.item(c),!0),c--;break;case"headerAndFooter":this._toggleSketchRowVisibility(e.sketchTable.row(d),!0),l||this._toggleRowVisibility(i.item(d),!0,a||s),a&&(this._toggleSketchRowVisibility(e.sketchTable.row(c),!0),l||this._toggleRowVisibility(i.item(c),!0)),d++,c--}if(a)if(o.isExpanded=!0,l||this._updateHeaderIcon(i,o),o.owner.level===r)for(u=d;c>=u;u++)this._toggleSketchRowVisibility(e.sketchTable.row(u),!0),l||this._toggleRowVisibility(i.item(u),!0);else{if(g=t.grid.groupHelper.getChildGroupRanges(n,o.cr,o.owner.level),g.length&&d!==g[0].cr.r1)for(u=d;u<g[0].cr.r1;u++)this._toggleSketchRowVisibility(e.sketchTable.row(u),!0),l||this._toggleRowVisibility(i.item(u),!0);if(s)for(u=0,p=g.length;p>u;u++)f=g[u],this._expand(e,i,n,f,r,s,!0,l);else for(u=0,p=g.length;p>u;u++)f=g[u],m="footer"===f.owner.position||"none"===f.owner.outlineMode?!0:!1,this._expand(e,i,n,f,r,!1,m,l)}},e.prototype._toggleRowVisibility=function(t,e,i){t&&(t[0]&&(void 0!==e&&(t[0].style.display=e?"":"none",t[0]["aria-hidden"]=e?"false":"true"),void 0!==i&&(t[0]["aria-expanded"]=i?"true":"false")),t[1]&&(void 0!==e&&(t[1].style.display=e?"":"none",t[1]["aria-hidden"]=e?"false":"true"),void 0!==i&&(t[1]["aria-expanded"]=i?"true":"false")))},e.prototype._toggleSketchRowVisibility=function(t,e){t&&void 0!==e&&(e?t.deleteStyle("display"):t.style("display","none"))},e.prototype._updateHeaderIcon=function(e,n){if("footer"!==n.owner.position){var o=e.item(n.cr.r1);o&&i.each(o,function(e,o){if(o){var r=i(o).find("div."+t.grid.wijgrid.CSS.groupToggleVisibilityButton);r&&r.length&&(r.toggleClass(n.getHeaderImageClass(!n.isExpanded),!1),r.toggleClass(n.getHeaderImageClass(n.isExpanded),!0))}})}},e}();e.groupRange=n;var o=function(){function n(){this._groupRowIdx=0}return n.prototype.group=function(t,e,i){this._grid=t,this._sketchTable=e,this._leaves=i,this._groupRowIdx=0;try{this._group()}finally{delete this._grid,delete this._sketchTable,delete this._leaves}},n.prototype._group=function(){var t=this;i.each(this._leaves,function(t,e){e.groupInfo&&(delete e.groupInfo.level,delete e.groupInfo.expandInfo)});var e=this._grid._groupedColumns(!0),n=1;0!=e.length&&(this._sketchTable.ensureNotLazy(),i.each(e,function(e,i){t._groupRowIdx=0,i.groupInfo&&i.groupInfo.position&&"none"!==i.groupInfo.position&&i.dataIndex>=0&&(i.groupInfo.level=n,i.groupInfo.expandInfo=[],t._processRowGroup(i,n++))}))},n.prototype._processRowGroup=function(e,n){var o=0,r=!0;i.each(this._leaves,function(t,e){return e.parentVis?(o=t,!1):void 0});for(var s=0;s<this._sketchTable.count();s++){var a=this._sketchTable.row(s);if(a.isDataRow()){var l=this._getGroupCellRange(s,e,n),h=!0,d="startCollapsed"===e.groupInfo.outlineMode,c,u,p,g;if(d||t.grid.groupHelper.isParentCollapsed(this._leaves,l,n)){if(e.groupInfo.groupSingleRow===!1&&l.r1===l.r2)continue;h=!1}if(n&&this._grid.options.groupIndent)for(var f=l.r1;f<=l.r2;f++)this._addIndent(this._sketchTable.row(f).cell(o),n);switch(r=e.groupInfo.groupSingleRow!==!1||l.r1!==l.r2,e.groupInfo.position){case"header":p=this._addGroupRange(e.groupInfo,l,h,r);for(var m=l.r1;m<=l.r2;m++)a=this._sketchTable.row(m),a.attr("aria-level",n+1),h||(a.style("display","none"),a.attr("aria-hidden",!0));if(!r)break;this._updateByGroupRange(p,n),g=t.grid.groupHelper.isParentCollapsed(this._leaves,p.cr,n),c=this._buildGroupRow(p,l,!0,g),this._sketchTable.insert(l.r1,c),c.attr("arial-level",n),c.attr("aria-expanded",h),g&&(c.style("display","none"),c.attr("aria-hidden",!0)),s=l.r2+1;break;case"footer":if(p=this._addGroupRange(e.groupInfo,l,!0,r),!r)break;this._updateByGroupRange(p,n),u=this._buildGroupRow(p,l,!1,!1),u.attr("aria-level",n),this._sketchTable.insert(l.r2+1,u),s=l.r2+1,g=t.grid.groupHelper.isParentCollapsed(this._leaves,p.cr,n),g&&(u.style("display","none"),u.attr("aria-hidden",!0));break;case"headerAndFooter":for(p=this._addGroupRange(e.groupInfo,l,h,r),m=l.r1;m<=l.r2;m++)a=this._sketchTable.row(m),a.attr("aria-level",n+1),h||(a.style("display","none"),a.attr("aria-hidden",!0));if(!r)break;this._updateByGroupRange(p,n),g=t.grid.groupHelper.isParentCollapsed(this._leaves,p.cr,n),c=this._buildGroupRow(p,l,!0,g),u=this._buildGroupRow(p,l,!1,!1),this._sketchTable.insert(l.r2+1,u),u.attr("aria-level",n),(g||!h)&&(u.style("display","none"),u.attr("aria-hidden",!0)),this._sketchTable.insert(l.r1,c),c.attr("aria-level",n),c.attr("aria-expanded",h),g&&(u.style("display","none"),u.attr("aria-hidden",!0)),s=l.r2+2;break;default:throw t.grid.stringFormat('Unknown Position value: "{0}"',e.groupInfo.position)}this._groupRowIdx++}}},n.prototype._buildGroupRow=function(i,n,o,r){var s=i.owner,a=s.owner,l=a.owner,h=(o?"GH":"GF")+this._groupRowIdx+"-"+s.level,d=new t.grid.SketchGroupRow(o,{id:h}),c=void 0,u="",p="",g,f,g,m,w,y,v,_,S,x=t.grid.wijgrid.CSS,b=l.options.wijCSS;if(a.dataIndex>=0&&null!==(c=this._sketchTable.valueAt(n.r1,a.dataIndex))&&(u=l.toStr(a,c)),d.groupByValue=c,this._grid._showRowHeader()&&d.add(e.HtmlCell.nbsp()),g=new e.HtmlCell,o&&"none"!==s.outlineMode){var C=i.getHeaderImageClass(i.isExpanded);g.html='<div class="'+b.icon+" "+C+" "+x.groupToggleVisibilityButton+" "+b.wijgridGroupToggleVisibilityButton+'">&nbsp;</div>'}for(d.add(g),a.aggregate&&"none"!==a.aggregate&&(p=this._getAggregate(n,a,a,o,u)),m=o?s.headerText:s.footerText,"custom"===m?(w={data:this._sketchTable.getRawTable(),column:a,groupByColumn:s.owner,groupText:u,text:"",groupingStart:n.r1,groupingEnd:n.r2,isGroupHeader:o,aggregate:p},this._grid._trigger("groupText",null,w)&&(m=w.text)):((void 0===m||null===m)&&(o&&(m="{1}: {0}"),(p||0===p)&&(m=m?m+" {2}":"{2}")),m=t.grid.stringFormat(m,u,a&&a.headerText?a.headerText:"",p.toString())),m||(m="&nbsp;"),g.html+="<span>"+m+"</span>",this._addIndent(g,s.level-1),y=1,v=this._grid._showRowHeader()?1:0,_=!0;v<this._leaves.length;v++)if(f=this._leaves[v],f.parentVis){if(_){_=!1;continue}if(f.dynamic!==!0&&f.aggregate&&"none"!==f.aggregate)break;y++}for(;v<this._leaves.length;v++)f=this._leaves[v],f.parentVis&&(S=this._getAggregate(n,f,s.owner,o,u),!S&&0!==S&&(S="&nbsp;"),d.add(new e.HtmlCell(S.toString(),{groupInfo:{leafIndex:f.leavesIdx,purpose:t.grid.groupRowCellPurpose.aggregateCell}})));return g.ensureAttr().colSpan=y,g.ensureAttr().groupInfo={leafIndex:a.leavesIdx,purpose:t.grid.groupRowCellPurpose.groupCell},d},n.prototype._getAggregate=function(e,i,n,o,r){var s="",a,l,h;if(!i.aggregate||"none"===i.aggregate)return s;if("custom"===i.aggregate)a={data:this._sketchTable.getRawTable(),column:i,groupByColumn:n,groupText:r,text:"",groupingStart:e.r1,groupingEnd:e.r2,isGroupHeader:o},this._grid._trigger("groupAggregate",null,a)&&(s=a.text);else{for(l=new t.grid.tally,h=e.r1;h<=e.r2;h++)l.add(this._sketchTable.valueAt(h,i.dataIndex));s=l.getValueString(i)}return s},n.prototype._getGroupCellRange=function(e,i,n){var o=i.leavesIdx,r,s=new t.grid.cellRange(e,o),a=t.grid.groupHelper.getParentGroupRange(this._leaves,s,n),l,h,d;if(r=this._sketchTable.row(e),r.isDataRow())for(l=r.valueCell(i.dataIndex).value,l instanceof Date&&(l=l.getTime()),s.r2=e,d=this._sketchTable.count()-1;s.r2<d&&(this._sketchTable.row(s.r2+1).isDataRow()&&!(a&&s.r2+1>a.cr.r2))&&(h=this._sketchTable.valueAt(s.r2+1,i.dataIndex),h instanceof Date&&(h=h.getTime()),l===h);s.r2++);return s},n.prototype._addGroupRange=function(e,i,n,o){var r=null,s=t.grid.groupHelper.getChildGroupIndex(i,e.expandInfo),a,l,h,d;return s>=0&&s<e.expandInfo.length?r=e.expandInfo[s]:(a=new t.grid.cellRange(i.r1,i.r1,i.r2,i.r2),l="footer"!==e.position&&o?n&&"startCollapsed"!==e.outlineMode:!0,r=new t.grid.groupRange(l,a,-1,e.position,o),r.owner=e,e.expandInfo.push(r)),r&&o&&(h=i.r1,d=i.r2,"headerAndFooter"===e.position&&(d+=2),"headerAndFooter"!==e.position&&d++,r.cr.r2=d),r},n.prototype._updateByGroupRange=function(t,e){var i,n,o,r,s,a,l;for(i=0,n=this._leaves.length;n>i;i++)if(o=this._leaves[i].groupInfo,o&&o.level<e)for(r=o.expandInfo?o.expandInfo.length:0,s=0;r>s;s++)a=o.expandInfo[s],l="headerAndFooter"===t.position?2:1,a.cr.r1>=t.cr.r1&&(a.cr.r1!==t.cr.r1||"footer"!==a.position)&&(a.cr.r1+=l),a.cr.r2>=t.cr.r1&&(a.cr.r2+=l)},n.prototype._addIndent=function(t,e){var i;e>0&&(i=this._grid.options.groupIndent)&&(t.ensureStyle().paddingLeft=i*e+"px")},n}();e.grouper=o}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(){}return e._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"),e.getGroupInfo=function(e){if(e){var i=t.grid.groupHelper._getGroupInfoRegExp.exec(e.id),n,o,r;if(i)return n=parseInt(i[3],10),o=parseInt(i[2],10),r="H"===i[1],{level:n,index:o,isHeader:r,toString:function(){return(r?"GH":"GF")+o+"-"+n}}}return null},e.getColumnByGroupLevel=function(t,e){var i,n,o;for(i=0,n=t.length;n>i;i++)if(o=t[i],o.groupInfo&&o.groupInfo.level===e)return o;return null},e.getGroupedColumnsCount=function(t){var e=0,i,n,o;for(i=0,n=t.length;n>i;i++)o=t[i].groupInfo,o&&("header"===o.position||"headerAndFooter"===o.position||"footer"===o.position)&&e++;return e},e.getChildGroupIndex=function(t,e){for(var i=0,n=e.length-1,o,r;n>=i;){if(o=(n-i>>1)+i,r=e[o].cr.r1-t.r1,0===r)return o;0>r?i=o+1:n=o-1}return i},e.getParentGroupIndex=function(e,i){var n=t.grid.groupHelper.getChildGroupIndex(e,i);return n>0&&n--,n<i.length?n:-1},e.getChildGroupRanges=function(e,i,n){var o=[],r=t.grid.groupHelper.getColumnByGroupLevel(e,n+1);if(r)for(var s=r.groupInfo.expandInfo,a=t.grid.groupHelper.getChildGroupIndex(i,s),l=a,h=s.length;h>l;l++){var d=s[l];if(!(d.cr.r2<=i.r2))break;o.push(d)}return o},e.getParentGroupRange=function(e,i,n){if(void 0===n&&(n=65535),n-2>=0)for(var o=e.length-1;o>=0;o--){var r=e[o].groupInfo;if(r&&r.expandInfo&&!(r.level<0)&&r.level===n-1){var s=t.grid.groupHelper.getParentGroupIndex(i,r.expandInfo);if(s>=0)return r.expandInfo[s]}}return null},e.isParentCollapsed=function(e,i,n){if(1===n)return!1;for(var o=n;o>1;o--){var r=t.grid.groupHelper.getParentGroupRange(e,i,o);if(r&&!r.isExpanded)return!0;i=r.cr}return!1},e.isParentExpanded=function(e,i,n){if(1===n)return!0;for(var o=n;o>1;o--){var r=t.grid.groupHelper.getParentGroupRange(e,i,o);if(r&&r.isExpanded)return!0;i=r.cr}return!1},e}();e.groupHelper=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function t(t,e,i,n){switch(arguments.length){case 2:this.r1=this.r2=t,this.c1=this.c2=e;break;case 4:this.r1=t,this.r2=i,this.c1=e,this.c2=n;break;default:this.r1=0,this.r2=0,this.c1=0,this.c2=0}}return t.prototype.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2},t}();e.cellRange=n;var o=function(){function e(){}return e.prototype.merge=function(t,e){this._leaves=e,this._data=t;try{this._merge()}finally{delete this._data,delete this._leaves}},e.prototype._merge=function(){var t,e,i,n=!0;for(t=0,e=this._leaves.length;e>t;t++)i=this._leaves[t],i.dataIndex>=0&&!i.isBand&&("free"===i.rowMerge||"restricted"===i.rowMerge)&&(n&&(this._data.ensureNotLazy(),n=!1),this._mergeColumn(i))},e.prototype._mergeColumn=function(t){var e=t.dataIndex,i,n,o,r,s,a;for(n=0,o=this._data.count();o>n;n++)if(i=this._data.row(n),i.isDataRow()){if(r=this._getCellRange(n,t),r.r1!==r.r2)for(s=r.r2-r.r1+1,this._data.row(r.r1).cell(e).ensureAttr().rowSpan=s,a=r.r1+1;a<=r.r2;a++)this._data.row(a).cell(e).visible(!1);n=r.r2}},e.prototype._getCellRange=function(e,i){var n=i.dataIndex,o,r=new t.grid.cellRange(e,n),s=(this._data.valueAt(e,n)||"").toString(),a=this._data.count(),l,h,d;for(r.r2=e;r.r2<a-1&&(o=this._data.row(r.r2+1),o.isDataRow()&&(o.valueCell(n).value||"").toString()===s);r.r2++);return l=i.leavesIdx,l>0&&"restricted"===i.rowMerge&&(h=this._leaves[l-1],h.dataIndex>=0&&(d=this._getCellRange(e,h),r.r1=Math.max(r.r1,d.r1),r.r2=Math.min(r.r2,d.r2))),r},e}();e.merger=o}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";function i(e,i){var n,o,r;if(C.isArray(e)&&C.isArray(i)){if(e.length===i.length){for(r=!0,n=0,o=e.length;o>n&&r;n++)r=t.grid.compareObj(e[n],i[n]);return r}}else{if(C.isPlainObject(e)&&C.isPlainObject(i)){for(n in e)if(e.hasOwnProperty(n)&&!t.grid.compareObj(e[n],i[n]))return!1;for(n in i)if(i.hasOwnProperty(n)&&!t.grid.compareObj(e[n],i[n]))return!1;return!0}e instanceof Date&&(e=e.getTime()),i instanceof Date&&(i=i.getTime())}return e===i}function n(t){for(var e=[],i=0;i<arguments.length-1;i++)e[i]=arguments[i+1];var n,o;if(!t)return"";for(n=0,o=e.length;o>n;n++)t=t.replace(new RegExp("\\{"+n+"\\}","gm"),e[n]);return t}function o(t){return t&&!(0>t)||0===t}function r(t){return t&&t instanceof Date?!isNaN(t.getTime()):!1}function s(t){return t.dataType||t._underlyingDataType||"string"}function a(t,e){t&&e&&t.find(".ui-widget").each(function(t,i){return C.each(C(i).data(),function(i,n){n.widgetName&&e(t,n)}),!0})}function l(t,e){var i=[];C.each(t.data(),function(t){0===t.indexOf(e)&&i.push(t)}),C.each(i,function(e,i){t.removeData(i)})}function h(t){return C.extend(!0,{},e.c1basefield.prototype.options,e.c1field.prototype.options,{dynamic:!0,isLeaf:!0,isBand:!1,parentIdx:-1},t)}function d(t,e){if(t){var i=t.nodeType?C(t):t,n=i.offset();if(n)return e?{top:n.top,left:n.left,width:i[0].clientWidth||0,height:i[0].clientHeight||0}:{top:n.top,left:n.left,width:i.outerWidth(),height:i.outerHeight()}}return null}function c(t,e){return t&&(t.start<0&&(t.start=0),t.end<0&&(t.end=0),t.start=Math.min(t.start,e),t.end=Math.min(t.end,e)),t}function u(e,i,n){if(void 0===i&&(i=3),e&&0!==i){if(!n&&3===e.nodeType)return e.nodeValue;if(1===e.nodeType){switch(e.type){case"button":case"text":case"textarea":case"select-one":return e.value;case"checkbox":return e.checked.toString()}for(var o="",r=0,s;s=e.childNodes[r++];)o+=t.grid._getDOMText(s,i-1);return o}}return""}function p(t,e,i,n){var o=t.jquery||C.isArray(t),r,s,a,l=e+i;if(3===arguments.length)return o?C.data(t[0],l):C.data(t,l);if(o){for(r=0,s=t.length;s>r;r++)a=C.data(t[r],l,n);return a}return C.data(t,l,n)}function g(t,e){if(e&&t){var i,n,o;for(i in e)e.hasOwnProperty(i)&&(n=e[i],o=typeof n,("string"===o||"boolean"===o||"number"===o)&&void 0===t[i]&&(t[i]=n))}}function f(t){return t&&"object"==typeof t&&!(t instanceof Date)}function m(t,e){var i,n,o=C.isFunction(e);for(i in t)if(t.hasOwnProperty(i)&&(n=o?e(t[i]):t[i]===e,n===!0))return{at:i,found:t[i]};return{at:null,found:null}}function w(t,e){if(t){var i,n,o=0,r={},s,a;for(i=0,n=t.attributes.length;n>i;i++)a=t.attributes[i].name,a&&(!e||!e(a))&&(s=t.getAttribute(a),"style"===a&&(s="object"==typeof s?s.cssText:s),!s&&"class"===a&&(s=t.getAttribute("className")),s&&"function"!=typeof s&&(r[a]=s,o++));if(o)return r}return null}function y(e,i){var n,o,r,s,a;if(e){"object"!=typeof i&&!C.isFunction(i)&&(i={});for(n in e)o=e[n],r=i[r],o!==i&&(o&&(C.isPlainObject(o)||(s=C.isArray(o)))?(s?(s=!1,a=r&&C.isArray(r)?r:[]):a=r&&C.isPlainObject(r)?r:{},i[n]=t.grid.deepExtend(o,a)):i[n]=o)}return i}function v(t,e){return t&&t.jquery&&(t=t[0]),t?1===arguments.length?C.data(t,"wijgridwidgetName"):C.data(t,"wijgridwidgetName",e):void 0}function _(t,e){"undefined"==typeof e&&(e=99);var i=0;return t&&C.ui&&C.fn.zIndex&&(i=t.zIndex(),i&&i++),Math.max(i,e)}function S(t,e,i){return t>e&&e+i>t}function x(e,i,n,o,r,s){return t.grid.isOverAxis(e,n,r)&&t.grid.isOverAxis(i,o,s)}function b(){return"uid"+A++}var C=jQuery;e.EXPANDO="__wijgrid",function(t){t._map=[],t.header=1,t.data=2,t.dataAlt=4,t.filter=8,t.groupHeader=16,t.groupFooter=32,t.footer=64,t.emptyDataRow=128}(e.rowType||(e.rowType={}));var D=e.rowType;!function(t){t._map=[],t.none=0,t.rendering=1,t.current=2,t.hovered=4,t.selected=8,t.editing=16}(e.renderState||(e.renderState={}));var I=e.renderState;!function(t){t._map=[],t.table=0,t.head=1,t.body=2,t.foot=3}(e.rowScope||(e.rowScope={}));var j=e.rowScope;!function(t){t._map=[],t.none=0,t.column=1,t.row=2}(e.cellRangeExtendMode||(e.cellRangeExtendMode={}));var T=e.cellRangeExtendMode;!function(t){t._map=[],t.createIfNull=0,t.createAlways=1,t.dispose=2}(e.objectMode||(e.objectMode={}));var E=e.objectMode;!function(t){t._map=[],t.groupCell=0,t.aggregateCell=1}(e.groupRowCellPurpose||(e.groupRowCellPurpose={}));var k=e.groupRowCellPurpose;!function(t){t._map=[],t.sketch=0,t.rendered=1,t.renderable=2}(e.dataRowsRangeMode||(e.dataRowsRangeMode={}));var L=e.dataRowsRangeMode;!function(t){t._map=[],t.none=0,t.overlapTop=1,t.overlapBottom=2,t.reset=3}(e.intersectionMode||(e.intersectionMode={}));var P=e.intersectionMode;e.compareObj=i,e.stringFormat=n,e.validDataKey=o,e.validDate=r,e.getDataType=s,e.iterateChildrenWidgets=a,e.remove$dataByPrefix=l;var M=function(){function t(t){this._dom=t}return t.prototype.getSelection=function(){var t=0,e=0,i;return void 0!==this._dom.selectionStart?(t=this._dom.selectionStart,e=this._dom.selectionEnd):document.selection&&(i=document.selection.createRange().duplicate(),e=i.text.length,t=Math.abs(i.moveStart("character",-this._dom.value.length)),e+=t),{start:t,end:e,length:e-t}},t.prototype.setSelection=function(t){if(void 0!==this._dom.selectionStart)this._dom.setSelectionRange(t.start,t.end);else{var e=this._dom.createTextRange();e.collapse(!0),e.moveStart("character",t.start),e.moveEnd("character",t.end),e.select()}},t.prototype.toggleSelection=function(t){var e=C(this._dom),i="onselectstart"in this._dom;t?i?e.unbind(".wijgrid-disableSelection"):e.css({MozUserSelect:"",WebkitUserSelect:""}):i?e.bind("selectstart.wijgrid-disableSelection",function(t){t.preventDefault()}):e.css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})},t}();e.domSelection=M,e.createDynamicField=h,e.bounds=d,e.ensureBounds=c,e._getDOMText=u,e.dataPrefix=p,e.shallowMerge=g,e.isCustomObject=f,e.search=m,e.getAttributes=w,e.deepExtend=y,e.widgetName=v;var F=function(){function e(){}return e._requiresExtendedSupport={date:"",datetime:"","datetime-local":"",month:"",time:""},e.isExtendSupportRequired=function(e){return e=(e||"").toLowerCase(),e in t.grid.HTML5InputSupport._requiresExtendedSupport},e.getDefaultInputType=function(e,i){var n=i.inputType;if(!n&&(n="text",e))switch(t.grid.getDataType(i)){case"number":case"currency":n="number";break;case"datetime":n="datetime"}return n},e.toStr=function(e,i){var n=e;if(i=(i||"").toLowerCase(),t.grid.HTML5InputSupport.isExtendSupportRequired(i))switch(i){case"datetime":n=e?n=Globalize.format(e,"yyyy-MM-ddTHH:mm:ssZ"):"";break;case"datetime-local":n=e?n=Globalize.format(e,"yyyy-MM-ddTHH:mm:ss"):"";break;case"date":n=e?n=Globalize.format(e,"yyyy-MM-dd"):"";break;case"month":n=e?n=Globalize.format(e,"yyyy-MM"):"";break;case"time":n=e?n=Globalize.format(e,"HH:mm:ss"):""}else n=e+"";return n},e.parse=function(e,i){var n,o=function(e){return e=new Date(e),t.grid.validDate(e)||(e=null),e};if(i=(i||"").toLowerCase(),t.grid.HTML5InputSupport.isExtendSupportRequired(i))switch(i){case"datetime":n=Globalize.parseDate(e,"yyyy-MM-ddTHH:mm:ssZ")||Globalize.parseDate(e,"yyyy-MM-ddTHH:mmZ")||o(e);break;case"datetime-local":n=Globalize.parseDate(e,"yyyy-MM-ddTHH:mm:ss")||Globalize.parseDate(e,"yyyy-MM-ddTHH:mm")||o(e);break;case"date":n=Globalize.parseDate(e,"yyyy-MM-dd")||o(e);break;case"month":n=Globalize.parseDate(e,"yyyy-MM");break;case"time":n=Globalize.parseDate(e,"HH:mm:ss")||Globalize.parseDate(e,"HH:mm");break;case"number":n=parseFloat(e)}else n=e;return n},e.extend=function(t,e,i){if(t)switch(i=(i||"").toLowerCase()){case"date":t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate());break;case"month":t.setFullYear(e.getFullYear(),e.getMonth());break;case"time":t.setHours(e.getHours()),t.setMinutes(e.getMinutes()),t.setSeconds(e.getSeconds());break;default:t=e}else t=e;return t},e}();e.HTML5InputSupport=F,e.getZIndex=_,e.isOverAxis=S,e.isOver=x;var A=0;e.getUID=b,C.extend(C.wijmo.wijgrid,{rowType:t.grid.rowType,renderState:t.grid.renderState,bounds:t.grid.bounds})}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){function i(t,e){var i=!1,n;return function(){return i||(n=e?t.call(e):t(),i=!0),n}}!function(t){t._map=[],t.Millisecond=1,t.Second=2,t.Minute=4,t.Hour=8,t.Day=16,t.Month=32,t.Year=64,t.DATE=t.Year|t.Month|t.Day,t.TIME=t.Hour|t.Minute|t.Second|t.Millisecond,
t.ALL=t.DATE|t.TIME}(e.TimeUnit||(e.TimeUnit={}));var n=e.TimeUnit,o=function(){function e(){}return e.convertInputType=function(e){var i=t.grid.TimeUnitConverter.convertInputTypeToFormatString(e),n=t.grid.TimeUnitConverter.convertFormatString(i);return n},e.convertInputTypeToFormatString=function(t){switch((t||"").toLowerCase()){case"datetime":case"datetime-local":return"f";case"date":return"d";case"month":return"Y";case"time":return"t"}return""},e.convertFormatString=function(t){var e=0;if(t){if(1===t.length)switch(t[0]){case"t":return n.Hour|n.Minute;case"T":return n.TIME;case"d":case"D":return n.DATE;case"Y":return n.Month|n.Year;case"M":return n.Month|n.Day;case"S":return n.ALL}var i,o;(i=t.indexOf("'"))>=0&&(o=t.lastIndexOf("'"))>=0&&i!==o&&(t=t.substr(0,i)+t.substring(o+1,t.length-1));for(var r=0,s=t.length;s>r;r++)switch(t[r]){case"d":e|=n.Day;break;case"M":e|=n.Month;break;case"y":e|=n.Year;break;case"m":e|=n.Minute;break;case"h":case"H":e|=n.Hour;break;case"s":e|=n.Second;break;case"f":e|=n.Millisecond}}return e||n.ALL},e.cutDate=function(t,e){return t&&(e=~e,e&n.Millisecond&&t.setMilliseconds(0),e&n.Second&&t.setSeconds(0),e&n.Minute&&t.setMinutes(0),e&n.Hour&&t.setHours(0),e&n.Day&&t.setDate(1),e&n.Month&&t.setMonth(0),e&n.Year&&t.setFullYear(0)),t},e}();e.TimeUnitConverter=o,e.lazy=i}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function t(){}return t.NoFilterOp={applicableTo:null,name:"NoFilter",displayName:"No filter",arity:1,operator:function(){return!0}},t}(),o=function(){function e(e){this._cache={};var o=this;this._wijgrid=e,this._addOperator(null,n.NoFilterOp),i.each(t.data.filtering.ops,function(t,e){o._addOperator(t,e)}),i.each(e.options.customFilterOperators,function(t,e){o._addOperator(null,e,!0)})}return e.prototype.getByName=function(t){var e=this.getByNameInt(t);return e?e.op:null},e.prototype.getByNameInt=function(t){return this._cache[(t||"").toLowerCase()]},e.prototype.getByDataType=function(t){var e=[],n;switch(i.each(this._cache,function(n,o){var r=o.op;(!r.applicableTo||i.inArray(t,r.applicableTo)>=0)&&e.push(o)}),this._wijgrid.options.filterOperatorsSortMode.toLowerCase()){case"alphabetical":e.sort(this._sortAlpha);break;case"alphabeticalcustomfirst":e.sort(this._sortAlphaCustomFirst);break;case"alphabeticalembeddedFirst":e.sort(this._sortAlphaEmbeddedFirst);break;case"none":}return n=i.map(e,function(t,e){return t.op})},e.prototype._addOperator=function(t,e,i){"undefined"==typeof i&&(i=!1),t&&!e.name&&(e.name=t),t=(t||e.name).toLowerCase(),this._cache[t]||(this._cache[t]={op:e,isCustom:i===!0})},e.prototype._sortAlpha=function(t,e){var i=t.op.name.toLowerCase(),n=e.op.name.toLowerCase();if(i!==n){if("nofilter"===i)return-1;if("nofilter"===n)return 1}return i===n?0:n>i?-1:1},e.prototype._sortAlphaEmbeddedFirst=function(t,e){var i=t.op.name.toLowerCase(),n=e.op.name.toLowerCase();if(i!==n){if("nofilter"===i)return-1;if("nofilter"===n)return 1}if(t.isCustom!==e.isCustom){if(t.isCustom)return 1;if(e.isCustom)return-1}return i===n?0:n>i?-1:1},e.prototype._sortAlphaCustomFirst=function(t,e){var i=t.op.name.toLowerCase(),n=e.op.name.toLowerCase();if(i!==n){if("nofilter"===i)return-1;if("nofilter"===n)return 1}if(t.isCustom!==e.isCustom){if(t.isCustom)return-1;if(e.isCustom)return 1}return i===n?0:n>i?-1:1},e}();e.filterOperatorsCache=o;var r=function(){function e(){}return e.marker="_wijgrid",e.getSingleValue=function(t){return i.isArray(t)&&(t=t[0],i.isArray(t)&&(t=t[0])),t},e.getSingleOperatorName=function(t){return i.isArray(t)&&(t=t[0]),t.name||t||""},e.verify=function(e,n,o,r){if(e)if(i.isArray(e)){var s,a,l=[],h=[];for(i.isArray(n)||(n=[n]),s=0,a=e.length;a>s;s++)t.grid.filterHelper._verifySingleOp(e[s],n[s],o,r)&&(l.push({name:e[s].name||e[s],condition:e[s].condition||"or"}),h.push(n?n[s]:void 0));if(l.length)return{filterOperator:l,filterValue:h}}else if(t.grid.filterHelper._verifySingleOp(e,n,o,r))return{filterOperator:e,filterValue:n};return null},e._verifySingleOp=function(e,n,o,r){if(e&&(e=e.name||e)){var s;if(e=(e||"").toLowerCase(),("nofilter"!==e||void 0!==n)&&(s=r.getByName(e))&&(null===s.applicableTo||i.inArray(o||"string",s.applicableTo)>=0)&&(1===s.arity||s.arity>1&&void 0!==t.grid.filterHelper.getSingleValue(n)))return!0}return!1},e}();e.filterHelper=r}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";function i(e,i){if(e&&!e.nodeType&&(e=e[0]),e)switch(i){case t.grid.rowScope.head:return e.tHead;case t.grid.rowScope.body:if(e.tBodies)return e.tBodies[0]||null;break;case t.grid.rowScope.foot:return e.tFoot;default:return e}return null}function n(t,e){var i;return t&&!t.nodeType&&(t=t[0]),t&&(i=this.getTableSection(t,e))?i.rows.length:0}function o(t,e,i){var n;return t&&!t.nodeType&&(t=t[0]),t&&(n=this.getTableSection(t,e))?n.rows[i]||null:null}function r(e,i,n){var o,r,s,l,h,d,c,u,p=[],g=function(t){return t=t.toLowerCase(),"rowspan"===t||"colspan"===t},f;if(e&&!e.nodeType&&(e=e[0]),e&&(f=this.getTableSection(e,i)))for(o=0,r=f.rows.length;r>o;o++){for(h=f.rows[o],d=[],n&&(c=t.data.Expando.getFrom(d,!0),u=c[t.grid.EXPANDO]={cellsAttributes:{},rowAttributes:t.grid.getAttributes(h)||{}}),s=0,l=h.cells.length;l>s;s++)d[s]=a.trim(h.cells[s].innerHTML),n&&(u.cellsAttributes[s]=t.grid.getAttributes(h.cells[s],g)||{});p[o]=d}return p}function s(e){var i=e.parentNode.parentNode;switch(i.tagName.toLowerCase()){case"thead":return t.grid.rowScope.head;case"tbody":return t.grid.rowScope.body;case"tfoot":return t.grid.rowScope.foot}return null}var a=jQuery;e.getTableSection=i,e.getTableSectionLength=n,e.getTableSectionRow=o,e.readTableSection=r,e.determineSection=s;var l=function(){function e(t,e,i,n){this._width=0,this._table=t,this._offsets=[],n&&this.ensureColGroup(),i&&this.ensureTBody(),e||this._buildOffsets()}return e.prototype.element=function(){return this._table},e.prototype.width=function(){return this._width},e.prototype.getCellIdx=function(t,e){return t<this._width?this._offsets[e][t].cellIdx:-1},e.prototype.getColumnIdx=function(t,e){if("number"!=typeof t){var i=t;t=i.cellIndex,e=i.parentNode.rowIndex}return t<this._width?this._offsets[e][t].colIdx:-1},e.prototype.clearSection=function(e){var i,n,o=t.grid.getTableSection(this._table,e);switch(e){case t.grid.rowScope.body:i=this.getSectionLength(t.grid.rowScope.table),n=i+this.getSectionLength(e)-1;break;case t.grid.rowScope.foot:i=this.getSectionLength(t.grid.rowScope.table)+this.getSectionLength(t.grid.rowScope.head),n=i+this.getSectionLength(e)-1;break;default:i=0,n=this.getSectionLength(e)-1}for(;o.rows.length;)o.deleteRow(0);this._offsets.splice(i,n-i+1)},e.prototype.getSectionLength=function(e){return t.grid.getTableSectionLength(this._table,e)},e.prototype.getSectionRow=function(e,i){return t.grid.getTableSectionRow(this._table,i,e)},e.prototype.forEachColumnCellNatural=function(t,e,i){var n,o,r,s;for(n=0,o=this._table.rows.length;o>n;n++)if(r=this._table.rows[n],t<r.cells.length&&(s=e(r.cells[t],n,i),s!==!0))return s;return!0},e.prototype.forEachColumnCell=function(t,e,i){var n,o,r,s,a;for(n=0,o=this._offsets.length;o>n;n++)if(r=this._table.rows[n],s=this.getCellIdx(t,n),s>=0&&(a=e(r.cells[s],n,i),a!==!0))return a;return!0},e.prototype.forEachRowCell=function(t,e,i){var n=this._table.rows[t],o,r,s;for(o=0,r=n.cells.length;r>o;o++)if(s=e(n.cells[o],o,i),s!==!0)return s;return!0},e.prototype.colGroupTag=function(){var t=this._table.getElementsByTagName("colgroup");return t&&t[0]||null},e.prototype.colTags=function(){var t=this.colGroupTag();return t&&t.getElementsByTagName("col")||[]},e.prototype.ensureTBody=function(){return this._table.tBodies&&this._table.tBodies[0]||this._table.appendChild(document.createElement("tbody"))},e.prototype.ensureTHead=function(){return this._table.tHead&&this._table.tHead[0]||this._table.createTHead()},e.prototype.ensureTFoot=function(){return this._table.tFoot&&this._table.tFoot[0]||this._table.createTFoot()},e.prototype.ensureColGroup=function(){var t=this._table.getElementsByTagName("colgroup");return t&&t[0]||this._table.appendChild(document.createElement("colgroup"))},e.prototype.appendCol=function(t){var e=this.ensureColGroup();return t&&e.appendChild(t)||e.appendChild(document.createElement("col"))},e.prototype.removeOffset=function(t){t>=0&&t<this._offsets.length&&((0>t||!t&&0!==t)&&(t=this._offsets.length-1),this._offsets.splice(t,1))},e.prototype.insertOffset=function(t){var e,i;if(this._width>0){for(e=[],i=0;i<this._width;i++)e.push({cellIdx:i,colIdx:i});(0>t||!t&&0!==t)&&(t=this._offsets.length),this._offsets.splice(t,0,e)}},e.prototype.rebuildOffsets=function(){this._offsets=[],this._width=0,this._buildOffsets()},e.prototype._buildOffsets=function(){var t=[],e,i,n,o,r,s,a,l,h,d;for(i=0,n=this._table.rows.length;n>i;i++){for(e=[],this._offsets[i]=e,o=this._table.rows[i],r=0,s=0,a=o.cells.length;a>r;r++,s++){for(l=o.cells[r];t[s]>1;s++)t[s]--,e[s]={cellIdx:-1,colIdx:-1};for(t[s]>1||(t[s]=l.rowSpan),e[s]={cellIdx:r,colIdx:-1},e[r].colIdx=s,h=l.colSpan;h>1;h--)e[++s]={cellIdx:-1,colIdx:-1}}for(d=t.length;d>s;s++)t[s]--,e[s]={cellIdx:-1,colIdx:-1};this._width=Math.max(this._width,d)}},e}();e.htmlTableAccessor=l}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(t,e,i,n,o){"undefined"==typeof i&&(i=null),"undefined"==typeof n&&(n=!1),"undefined"==typeof o&&(o=!0),this.__isEdit=!1,this._wijgrid=i,this._virtualize=o,n?(this._ci=t-this._wijgrid._getDataToAbsOffset().x,this._ri=e-this._wijgrid._getDataToAbsOffset().y,this._virtualize&&(this._ri=this._wijgrid._renderableBoundsCollection().getAbsIndex(this._ri+this._wijgrid._viewPortBounds().start))):(this._ci=t,this._ri=e)}return e.outsideValue=new e(-1,-1,null),e.prototype.cellIndexAbs=function(){return this._ci+this._wijgrid._getDataToAbsOffset().x},e.prototype.rowIndexAbs=function(){var t=this._virtualize?this._wijgrid._renderableBoundsCollection().getRenderedIndex(this._ri)-this._wijgrid._viewPortBounds().start:this._ri;return t+=this._wijgrid._getDataToAbsOffset().y},e.prototype.cellIndex=function(t){return arguments.length?void(this._ci=t):this._ci},e.prototype.column=function(){return this._wijgrid&&this._isValid()?this._wijgrid._field("visibleLeaves")[this.cellIndexAbs()]:null},e.prototype.container=function(){var e=this.tableCell(),n;return e&&(n=i(e).children("div."+t.grid.wijgrid.CSS.cellContainer))?n:null},e.prototype.isEqual=function(t){return t&&t.rowIndex()===this.rowIndex()&&t.cellIndex()===this.cellIndex()},e.prototype.row=function(){var t=null,e=null;return this._wijgrid&&(this._virtualize?e=this._wijgrid._view()._getRowInfoBySketchRowIndex(this.rowIndex()):(t=this._wijgrid._view().rows().item(this.rowIndexAbs()),t&&t.length&&(e=this._wijgrid._view()._getRowInfo(t)))),e},e.prototype.rowIndex=function(t){return arguments.length?void(this._ri=t):this._ri},e.prototype.tableCell=function(){return this._wijgrid&&this._isValid()&&(!this._virtualize||this._isRendered())?this._wijgrid._view().getCell(this.cellIndexAbs(),this.rowIndexAbs()):null},e.prototype.value=function(e){var i,n,o;if(this._wijgrid&&this._isValid()&&(n=this.row(),n.type&t.grid.rowType.data)){if(i=this.column(),0===arguments.length)return o=this._wijgrid._dataViewWrapper.getValue(n.data,i.dataKey),this._wijgrid.parse(i,o);if(e=this._wijgrid.parse(i,e),null===e&&i.valueRequired||"string"!==t.grid.getDataType(i)&&isNaN(e))throw"invalid value";this._wijgrid._dataViewWrapper.setValue(n.dataItemIndex,i.dataKey,e);var r=this._wijgrid.sketchTable.row(this.rowIndex()),s=r.cell(i.dataIndex);s.value=e}},e.prototype.toString=function(){return this.cellIndex()+":"+this.rowIndex()},e.prototype._clip=function(t,e){"undefined"==typeof e&&(e=!1);var i=!1,n;return e?(this.cellIndexAbs()<(n=t.topLeft().cellIndexAbs())&&(i=!0,this._ci=t.topLeft().cellIndex()),this.cellIndexAbs()>(n=t.bottomRight().cellIndexAbs())&&(i=!0,this._ci=t.bottomRight().cellIndex()),this.rowIndexAbs()<(n=t.topLeft().rowIndexAbs())&&(i=!0,this._ri=t.topLeft().rowIndex()),this.rowIndexAbs()>(n=t.bottomRight().rowIndexAbs())&&(i=!0,this._ri=t.bottomRight().rowIndex())):(this.cellIndex()<(n=t.topLeft().cellIndex())&&(i=!0,this._ci=n),this.cellIndex()>(n=t.bottomRight().cellIndex())&&(i=!0,this._ci=n),this.rowIndex()<(n=t.topLeft().rowIndex())&&(i=!0,this._ri=n),this.rowIndex()>(n=t.bottomRight().rowIndex())&&(i=!0,this._ri=n)),i},e.prototype._clone=function(){return new t.grid.cellInfo(this.cellIndex(),this.rowIndex(),this._wijgrid,!1,this._virtualize)},e.prototype._isValid=function(){return this.cellIndex()>=0&&this.rowIndex()>=0},e.prototype._isRendered=function(){var t;if(this._wijgrid&&(t=this._wijgrid._view())&&this._isValid()){var e=this._wijgrid._view()._isRowRendered(this.rowIndex());return e>=0}return!1},e.prototype._isEdit=function(e){var n=null,o=t.grid.wijgrid.CSS.editedCellMarker;if(this._isValid())try{n=this.tableCell()}catch(r){}return arguments.length?(n&&i(n)[e?"addClass":"removeClass"](o),void(this.__isEdit=e)):n?i(n).hasClass(o):this.__isEdit},e.prototype._setGridView=function(t){this._wijgrid=t},e}();e.cellInfo=n;var o=function(){function e(t,e){if(!t||!e)throw"invalid arguments";this._topLeft=t._clone(),this._bottomRight=e._clone()}return e.prototype.bottomRight=function(){return this._bottomRight},e.prototype.isEqual=function(t){return t&&this._topLeft.isEqual(t.topLeft())&&this._bottomRight.isEqual(t.bottomRight())},e.prototype.topLeft=function(){return this._topLeft},e.prototype.toString=function(){return this._topLeft.toString()+" - "+this._bottomRight.toString()},e.prototype._isIntersect=function(t){var e,i,n,o;return t&&(e=t.bottomRight().rowIndex()-t.topLeft().rowIndex()+1,i=this._bottomRight.rowIndex()-this._topLeft.rowIndex()+1,t.topLeft().rowIndex()+e-this._topLeft.rowIndex()<e+i)?(n=t.bottomRight().cellIndex()-t.topLeft().cellIndex()+1,o=this._bottomRight.cellIndex()-this._topLeft.cellIndex()+1,t.topLeft().cellIndex()+n-this._topLeft.cellIndex()<n+o):!1},e.prototype._isValid=function(){return this._topLeft._isValid()&&this._bottomRight._isValid()},e.prototype._clip=function(t,e){"undefined"==typeof e&&(e=!1);var i=this._topLeft._clip(t,e),n=this._bottomRight._clip(t,e);return i||n},e.prototype._clone=function(){return new e(this._topLeft._clone(),this._bottomRight._clone())},e.prototype._containsCellInfo=function(t){return t&&t.cellIndex()>=this._topLeft.cellIndex()&&t.cellIndex()<=this._bottomRight.cellIndex()&&t.rowIndex()>=this._topLeft.rowIndex()&&t.rowIndex()<=this._bottomRight.rowIndex()},e.prototype._containsCellRange=function(t){return t&&this._containsCellInfo(t.topLeft())&&this._containsCellInfo(t.bottomRight())},e.prototype._extend=function(e,i){return e===t.grid.cellRangeExtendMode.column?(this._topLeft.rowIndex(i.topLeft().rowIndex()),this._bottomRight.rowIndex(i.bottomRight().rowIndex())):e===t.grid.cellRangeExtendMode.row&&(this._topLeft.cellIndex(i.topLeft().cellIndex()),this._bottomRight.cellIndex(i.bottomRight().cellIndex())),this},e.prototype._normalize=function(){var t=this._topLeft.cellIndex(),e=this._topLeft.rowIndex(),i=this._bottomRight.cellIndex(),n=this._bottomRight.rowIndex();this._topLeft.cellIndex(Math.min(t,i)),this._topLeft.rowIndex(Math.min(e,n)),this._bottomRight.cellIndex(Math.max(t,i)),this._bottomRight.rowIndex(Math.max(e,n))},e.prototype._height=function(){return this._bottomRight.rowIndex()-this._topLeft.rowIndex()},e.prototype._width=function(){return this._bottomRight.cellIndex()-this._topLeft.cellIndex()},e}();e.cellInfoRange=o,i.extend(i.wijmo.wijgrid,{cellInfo:t.grid.cellInfo,cellInfoRange:t.grid.cellInfoRange})}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function n(e,i){if(this._rowHeaderSize=22,this.mIsRendered=!1,this._sizesAdjCache={th:0,col:0,subTable:0},!e)throw"'wijgrid' must be specified";this._wijgrid=e,this._bounds=i,this._wijgrid.element.addClass(t.grid.wijgrid.CSS.table).addClass(this._wijgrid.options.wijCSS.wijgridTable)}return n.prototype.dispose=function(){this.toggleDOMSelection(!0),this._wijgrid.element.removeClass(t.grid.wijgrid.CSS.table).removeClass(this._wijgrid.options.wijCSS.wijgridTable)},n.prototype.ensureDisabledState=function(){var t="wijmo-wijgrid-disabled "+this._wijgrid.options.wijCSS.stateDisabled,e=this._wijgrid.options.disabled,n=this;i.each(this.subTables(),function(o,r){if(r){var s=i(r.element());e?(s.addClass(t),n._wijgrid._setAttr(s,"aria-disabled",!0)):(s.removeClass(t),n._wijgrid._setAttr(s,"aria-disabled",!1))}})},n.prototype.ensureWidth=function(t,e,i){this._setColumnWidth(t,e)},n.prototype.ensureHeight=function(t){},n.prototype.getScrollValue=function(){return null},n.prototype.getVisibleAreaBounds=function(t){throw"not implemented"},n.prototype.getVisibleContentAreaBounds=function(){throw"not implemented"},n.prototype.getFixedAreaVisibleBounds=function(){throw"not implemented"},n.prototype.isRendered=function(){return this.mIsRendered},n.prototype.render=function(){this._ensureRenderBounds(),this._preRender(),this._renderContent(),this._postRender()},n.prototype.toggleDOMSelection=function(e){i.each(this.subTables(),function(i,n){new t.grid.domSelection(n.element()).toggleSelection(e)}),new t.grid.domSelection(this._wijgrid.outerDiv).toggleSelection(e)},n.prototype.updateSplits=function(t){throw"not implemented"},n.prototype.getInlineTotalWidth=function(){throw"not implemented"},n.prototype.bodyRows=function(){if(!this._bodyRowsAccessor){if(!this.isRendered())throw"not rendered yet";this._bodyRowsAccessor=new t.grid.rowAccessor(this,t.grid.rowScope.body,0,0)}return this._bodyRowsAccessor},n.prototype.filterRow=function(){if(this._wijgrid.options.showFilter){if(!this.isRendered())throw"not rendered yet";var e=new t.grid.rowAccessor(this,t.grid.rowScope.head,0,0);return e.item(e.length()-1)}return null},n.prototype.footerRow=function(){if(this._wijgrid.options.showFooter){if(!this.isRendered())throw"not rendered yet";var e=new t.grid.rowAccessor(this,t.grid.rowScope.foot,0,0);return e.item(0)}},n.prototype.headerRows=function(){var e;if(!this._headerRowsAccessor){if(!this.isRendered())throw"not rendered yet";e=this._wijgrid.options.showFilter?1:0,this._headerRowsAccessor=new t.grid.rowAccessor(this,t.grid.rowScope.head,0,e)}return this._headerRowsAccessor},n.prototype.rows=function(){if(!this._rowsAccessor){if(!this.isRendered())throw"not rendered yet";this._rowsAccessor=new t.grid.rowAccessor(this,t.grid.rowScope.table,0,0)}return this._rowsAccessor},n.prototype.focusableElement=function(){return this._wijgrid.outerDiv},n.prototype.forEachColumnCell=function(t,e,i){throw"not implemented"},n.prototype.forEachRowCell=function(t,e,i){throw"not implemented"},n.prototype.getAbsoluteCellInfo=function(t,e){throw"not implemented"},n.prototype.getAbsoluteRowIndex=function(t){throw"not implemented"},n.prototype.getCell=function(t,e){throw"not implemented"},n.prototype.getColumnIndex=function(t){throw"not implemented"},n.prototype.getHeaderCell=function(t){throw"not implemented"},n.prototype.getJoinedCols=function(t){throw"not implemented"},n.prototype.getJoinedRows=function(t,e){throw"not implemented"},n.prototype.getJoinedTables=function(t,e){throw"not implemented"},n.prototype.subTables=function(){throw"not implemented"},n.prototype._getMappedScrollMode=function(){var t=this._wijgrid.options.scrollMode,e="auto",i="auto";switch(t){case"horizontal":e="hidden",i="visible";break;case"vertical":e="visible",i="hidden";break;case"both":e="visible",i="visible"}return{vScrollBarVisibility:e,hScrollBarVisibility:i}},n.prototype._postRender=function(){this.mIsRendered=!0,this.ensureDisabledState(),this._sizesAdjCache.col=0,this._sizesAdjCache.th=0,this._sizesAdjCache.subTable=0;var t=this._wijgrid._field("visibleLeaves");if(t.length>0){var e=this.getHeaderCell(0),n=this.getJoinedCols(0);e&&(this._sizesAdjCache.th=i(e).leftBorderWidth()+i(e).rightBorderWidth()),n&&n.length&&(this._sizesAdjCache.col=i(n[0]).leftBorderWidth()+i(n[0]).rightBorderWidth())}var o=this.subTables()[0];this._sizesAdjCache.subTable=i(o.element()).leftBorderWidth()+i(o.element()).rightBorderWidth()},n.prototype._preRender=function(){this.mIsRendered=!1},n.prototype._ensureRenderBounds=function(){var t=this._wijgrid._getDataCellsRange(e.dataRowsRangeMode.sketch);this._bounds.start=0,this._bounds.end=t.bottomRight().rowIndex()},n.prototype._renderContent=function(){this._renderCOLS(),this._renderHeader(),this._wijgrid.options.showFilter&&this._renderFilter(),this._renderBody(),this._wijgrid.options.showFooter&&this._renderFooter()},n.prototype._renderCOLS=function(){var t=this._wijgrid._field("visibleLeaves"),e,i,n,o;for(n=0,o=t.length;o>n;n++)e=t[n],i=this._createCol(e,n),this._appendCol(i,e,n)},n.prototype._renderHeader=function(){var e=t.grid.rowType,i=this._wijgrid._columnsHeadersTable(),n,o,r;if(i&&(o=i.length))for(n=0;o>n;n++)r=this._insertEmptyRow(e.header,void 0,n,-1,-1,-1,void 0),this._renderRow(r,null,i[n])},n.prototype._renderFilter=function(){var e=this._insertEmptyRow(t.grid.rowType.filter,void 0,-1,-1,-1,-1,void 0);this._renderRow(e,this._wijgrid._field("visibleLeaves"),null)},n.prototype._renderBody=function(){var e=t.grid.rowType,i=this._wijgrid._field("visibleLeaves"),n=this._wijgrid.sketchTable,o=-1,r=0,s=0,a=this._wijgrid._dataOffset,l=this;this._bounds.start>=0&&this._bounds.end>=0&&this._wijgrid._renderableBoundsCollection().forEachIndex(this._bounds.start,this._bounds.end-this._bounds.start+1,function(t){var e=n.row(t-a),h=e.isDataRow(),d=e.groupByValue,c=l._insertEmptyRow(e.rowType,void 0,s++,h?++o:-1,e.dataItemIndex(),e.dataItemIndex(r),d);l._renderRow(c,i,e)})},n.prototype._renderFooter=function(){var e=this._insertEmptyRow(t.grid.rowType.footer,void 0,-1,-1,-1,-1,void 0);this._renderRow(e,this._wijgrid._field("visibleLeaves"),null)},n.prototype._insertEmptyRow=function(e,i,n,o,r,s,a){var l=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),h=this._insertRow(e,n,l);return void 0===i&&(i=t.grid.renderState.rendering),this._createRowInfo(h,e,i,n,o,r,s,a)},n.prototype._createEmptyCell=function(e,i,n){var o=t.grid.rowType,r=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(e.type,r)},n.prototype._insertRow=function(t,e,i){throw"not implemented"},n.prototype._createCell=function(e,n){var o=t.grid.rowType,r;if(n||(n=e===o.header?document.createElement("th"):document.createElement("td")),e!==o.filter){if(r=document.createElement("div"),r.className=t.grid.wijgrid.CSS.cellContainer+" "+this._wijgrid.options.wijCSS.wijgridCellContainer,n.firstChild)for(;n.firstChild;)r.appendChild(n.firstChild);n.appendChild(r)}return i(n)},n.prototype._appendCell=function(t,e,i){throw"not implemented"},n.prototype._createCol=function(t,e){throw"not implemented"},n.prototype._appendCol=function(t,e,i){throw"not implemented"},n.prototype._renderRow=function(e,i,n){var o=t.grid.rowType,r,s;switch(e.type){case o.filter:this._renderFilterRow(e,i);break;case o.footer:this._renderFooterRow(e,i);break;case o.header:this._renderHeaderRow(e,n);break;case o.data:case o.data|o.dataAlt:this._renderDataRow(e,i,n),r=n.attr(),s=n.style();break;case o.emptyDataRow:case o.groupHeader:case o.groupFooter:this._renderSpannedRow(e,i,n),r=n.attr(),s=n.style();break;default:throw"unknown rowType"}this._rowRendered(e,r,s)},n.prototype._renderCell=function(e,n,o,r,s,a,l,h){var d=this._createEmptyCell(e,s.dataIndex,s),c=e.type===t.grid.rowType.filter?d:i(d[0].firstChild);this._appendCell(e,n,d),r?c.html(o):this._wijgrid.cellFormatter.format(d,c,s,o,e),this._cellRendered(e,d,n,s,a,l,h)},n.prototype._renderDataRow=function(e,i,n){var o,r,s,a,l,h,d,c;for(o=0,r=i.length;r>o;o++){if(s=i[o],a=s.dataIndex,0>a)h=null,d=null,l=null;else{var u=n.cell(a);if(!u||!u.visible())continue;l=this._wijgrid.toStr(s,u.value),h=u.attr(),d=u.style()}c=e.state,s.readOnly&&(c&=~t.grid.renderState.editing),this._renderCell(e,o,l,!1,s,c,h,d)}},n.prototype._renderFilterRow=function(e,i){var n,o,r;for(n=0,o=i.length;o>n;n++)r=i[n],this._renderCell(e,n,t.grid.filterHelper.getSingleValue(r.filterValue),!1,r,e.state)},n.prototype._renderFooterRow=function(t,e){var i,n;for(i=0,n=e.length;n>i;i++)this._renderCell(t,i,"",!1,e[i],t.state)},n.prototype._renderHeaderRow=function(t,e){var i,n,o=0,r;for(i=0,n=e.length;n>i;i++)r=e[i],r.column&&r.column.parentVis&&(r.column.thX=o++,r.column.thY=t.sectionRowIndex,this._renderCell(t,i,r.column.headerText,!1,r.column,t.state,{colSpan:r.colSpan,rowSpan:r.rowSpan}))},n.prototype._renderSpannedRow=function(e,i,n){var o,r,s=Math.min(i.length,n.cellCount());for(o=0;s>o;o++){var a=e.type===t.grid.rowType.emptyDataRow,l=n.cell(o);this._renderCell(e,o,l.html,a,i[o],e.state,l.attr(),l.style())}},n.prototype._cellRendered=function(t,e,i,n,o,r,s){this._wijgrid.cellStyleFormatter.format(e,i,n,t,o,r,s),this._changeCellRenderState(e,o,!1),this._wijgrid._onViewCellRendered(t,e,i,n)},n.prototype._rowRendered=function(e,i,n){this._wijgrid.rowStyleFormatter.format(e,i,n),e.state&=~t.grid.renderState.rendering,this._setRowInfo(e.$rows,e),this._wijgrid._onViewRowRendered(e),e.state&t.grid.renderState.editing&&this._makeRowEditable(e)},n.prototype._makeRowEditable=function(e){var i=this._wijgrid._field("visibleLeaves"),n=new t.grid.cellEditorHelper;if(i)for(var o=0;o<i.length;o++){var r=i[o];if(!r.readOnly&&t.grid.validDataKey(r.dataKey)){var s=e.$rows.children("td, th").eq(o);if(s.length){var a=this.getAbsoluteCellInfo(s[0],!0);this._changeCellRenderState(s,t.grid.renderState.editing,n.cellEditStart(this._wijgrid,a,null))}}}},n.prototype._isBodyRow=function(e){var i=t.grid.rowType,n=e.type;return n&i.data||n===i.groupHeader||n===i.groupFooter||n===i.emptyDataRow},n.prototype._changeRowRenderState=function(t,e,i){i?t.state|=e:t.state&=~e,this._setRowInfo(t.$rows,t)},n.prototype._changeCellRenderState=function(e,i,n){var o=t.grid.dataPrefix,r=this._wijgrid._data$prefix,s=o(e,r,"renderState");return n?(i=s|i,o(e,r,"renderState",i)):(i=s&~i,o(e,r,"renderState",i)),i},n.prototype._adjustWidthArray=function(t,e,n,o){var r=this._sumWidthArray(t),s=this._sumWidthArray(e),a=[],l,h=0,d,c,u=!0;if(n>=r){if(i.extend(!0,a,t),r===n||o)return a;l=n-r}else{if(i.extend(!0,a,e),s>=n)return a;l=n-s}return i.each(a,function(t,e){e.real||h++}),0!==h&&(d=Math.floor(l/h),c=l-d*h,i.each(a,function(t,e){e.real||(e.width+=d,u&&(e.width+=c,u=!1))})),a},n.prototype._getColumnWidth=function(t){var e,n,o,r,s,a,l,h,d,c,u;if(n=this._wijgrid._field("visibleLeaves")[t],void 0!==n._realWidth)e={width:n._realWidth,real:!0};else if(n.isRowHeader)e={width:this._rowHeaderSize,real:!0};else{var p=0;for(o=this.getJoinedTables(!0,t),r=o[2],s=0;2>s;s++)if(a=o[s],null!==a&&(l=a.element().rows,u=l.length)){for(c=u-1,d=null;c>=0;c--)if(l[c].cells.length===a.width()){d=l[c];break}d&&(h=d.cells[r],p=Math.max(p,i(h).outerWidth()))}e={width:p,real:!1}}return e},n.prototype._setColumnWidth=function(t,e){var n=this.getHeaderCell(t),o=this.getJoinedCols(t),r;if(e){var s=this;n&&(r=e-this._sizesAdjCache.th,0>r&&(r=0),n.style.width=r+"px"),i.each(o,function(t,i){i&&(r=e-s._sizesAdjCache.col,0>r&&(r=0),i.style.width=r+"px")})}},n.prototype._setTableWidth=function(t,e,n,o){var r,s,a=this;i.each(t,function(t,i){i[0].style.tableLayout="fixed",i[0].style.width=e-a._sizesAdjCache.subTable+"px"}),r=t[0].outerWidth(),s=r-e,0!==s&&this._setColumnWidth(o,n-s)},n.prototype._sumWidthArray=function(t,e,n){var o=0;return i.each(t,function(t,i){return void 0!==e&&void 0!==n&&(e>t||t>n)?!0:void(o+=i.width)}),o},n.prototype._clearBody=function(){i.each(this.subTables(),function(t,e){e.clearSection(2)})},n.prototype._rebuildOffsets=function(){i.each(this.subTables(),function(t,e){e.rebuildOffsets()})},n.prototype._removeBodyRow=function(e,i){"undefined"==typeof i&&(i=!0);var n=t.grid.rowType,o=this._wijgrid._rows(),r,s,a,l,h;e>=0&&e<(s=o.length())&&(a=this._getRowInfo(o.item(e),!1),l=this.getAbsoluteRowIndex(a.$rows[0]),a.$rows.remove(),i&&(h=this.getJoinedTables(!1,l),h[0]&&h[0].removeOffset(h[2]),h[1]&&h[1].removeOffset(h[2])))},n.prototype._insertBodyRow=function(e,i,n,o){var r=this._wijgrid._field("visibleLeaves"),s=t.grid.rowType,a=this._wijgrid._view(),l=this._wijgrid._rows(),h=l.length(),d=e.isDataRow(),c,u,p;return(0>i||i>=h||!i&&0!==i)&&(i=h),c=this._insertEmptyRow(e.rowType,e.renderState,i,-1,n,o,e.groupByValue),this._renderRow(c,r,e),u=this.getAbsoluteRowIndex(c.$rows[0]),p=this.getJoinedTables(!1,u),p[0]&&p[0].insertOffset(u),p[1]&&p[1].insertOffset(u),c},n.prototype._findRowInfo=function(t){var e=this.bodyRows(),n=0,o=e.length(),r;if(i.isFunction(t))for(n=0;o>n;n++)if(r=this._getRowInfo(e.item(n)),t(r)===!0)return r;return null},n.prototype._setRowInfo=function(e,i){var n="$rows"in i,o="data"in i,r,s;n&&(r=i.$rows,delete i.$rows),o&&(s=i.data,delete i.data),t.grid.dataPrefix(e,this._wijgrid._data$prefix,"rowInfo",i),n&&(i.$rows=r),o&&(i.data=s)},n.prototype._getRowInfo=function(e,n){"undefined"==typeof n&&(n=!0);var o=this._wijgrid,r=i(e[1]?e:e[0]),s=t.grid.dataPrefix(r,o._data$prefix,"rowInfo"),a;if(s.$rows=r,n&&s.dataItemIndex>=0&&s.type&t.grid.rowType.data)try{s.data=o._getDataItem(s.dataItemIndex)}catch(l){s.data=null}return s},n.prototype._getRowInfoBySketchRowIndex=function(t,e){if("undefined"==typeof e&&(e=!0),t>=0){var i=this._isRowRendered(t);if(!(i>=0)){var n=this._wijgrid.sketchTable.row(t),o=null;if(n&&(o=n.getRowInfo(),e&&o.dataItemIndex>=0&&n.isDataRow()))try{o.data=this._wijgrid._getDataItem(o.dataItemIndex)}catch(r){o.data=null}return o}var s=this.bodyRows().item(i);if(s)return this._getRowInfo(s,e)}return null},n.prototype._createRowInfo=function(e,n,o,r,s,a,l,h){var d,c={type:n,state:o,sectionRowIndex:r,dataRowIndex:s,dataItemIndex:a,virtualDataItemIndex:l,$rows:e?i(e):null};return void 0!==h&&(c.groupByValue=h),a>=0&&n&t.grid.rowType.data&&(c.data=this._wijgrid._getDataItem(a)),c},n.prototype._isRowRendered=function(t){var e=this._wijgrid._renderableBoundsCollection().getRenderedIndex(t);return e>=0&&e>=this._bounds.start&&e<=this._bounds.end?e-this._bounds.start:-1},n}();e.baseView=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(e){function n(t,i){e.call(this,t,i),this._dataTable=null,this._contentArea=null}return __extends(n,e),n.prototype.ensureWidth=function(t,n,o){var r=i(this._dataTable.element()),s=r.width()+n-o;e.prototype.ensureWidth.call(this,t,n,o),this._setTableWidth([r],s,n,t)},n.prototype.getVisibleAreaBounds=function(e){var i=t.grid.bounds(this._dataTable.element(),e);return i},n.prototype.getVisibleContentAreaBounds=function(){return this.getVisibleAreaBounds()},n.prototype.updateSplits=function(t){var e=this,n=this._wijgrid,o=n.options,r=n.element,s=[],a=[],l=[],h=n._field("visibleLeaves"),d=n.outerDiv,c,u;if(r.css({"table-layout":"",width:"auto"}),i.each(h,function(t,i){var n,r=i.width;(r||0===r)&&(n="string"==typeof r&&r.length>1&&"%"===r[r.length-1],r=n?d.width()*parseFloat(r)/100:parseFloat(r),(i.ensurePxWidth||void 0===i.ensurePxWidth&&o.ensureColumnsPxWidth)&&(i._realWidth=r),e._setColumnWidth(t,r))}),i.each(h,function(t,i){s.push(e._getColumnWidth(t))}),r.css("width","1px"),i.each(h,function(t,i){a.push(e._getColumnWidth(t))}),c=d.width(),l=this._adjustWidthArray(s,a,c,o.ensureColumnsPxWidth),i.each(l,function(t,i){var n=h[t];return void 0!==n._realWidth?void delete n._realWidth:void e._setColumnWidth(t,i.width)}),r.css("table-layout","fixed"),u=l.length-1,-1!==u){var p=d.width()-c;l[u].width+=p,this._setTableWidth([r],this._sumWidthArray(l,0,u),l[u].width,u)}},n.prototype.getInlineTotalWidth=function(){var t=this._dataTable.element(),e=t.style.width;return e&&"auto"!==e?e:""},n.prototype.forEachColumnCell=function(t,e,i){
return this._dataTable.forEachColumnCell(t,e,i)},n.prototype.forEachRowCell=function(t,e,i){return this._dataTable.forEachRowCell(t,e,i)},n.prototype.getAbsoluteCellInfo=function(e,i){return new t.grid.cellInfo(this.getColumnIndex(e),e.parentNode.rowIndex,this._wijgrid,!0,i)},n.prototype.getAbsoluteRowIndex=function(t){return t.rowIndex},n.prototype.getCell=function(t,e){var i=this._dataTable.getCellIdx(t,e),n;return i>=0&&(n=this.getJoinedRows(e,0),n[0])?n[0].cells[i]:null},n.prototype.getColumnIndex=function(t){return this._dataTable.getColumnIdx(t)},n.prototype.getHeaderCell=function(e){var i=this._wijgrid._field("visibleLeaves")[e],n;return i&&(n=this._wijgrid._headerRows())?t.grid.rowAccessor.getCell(n.item(i.thY),i.thX):null},n.prototype.getJoinedCols=function(t){var e=i(this._dataTable.element()).find("> colgroup");return e.length&&t<e[0].childNodes.length?[e[0].childNodes[t],null]:[null,null]},n.prototype.getJoinedRows=function(t,e){return[this._dataTable.getSectionRow(t,e),null]},n.prototype.getJoinedTables=function(t,e){return[this._dataTable,null,e]},n.prototype.subTables=function(){return[this._dataTable]},n.prototype._preRender=function(){e.prototype._preRender.call(this),this._dataTable=new t.grid.htmlTableAccessor(this._wijgrid.element[0],!0,!0,!0)},n.prototype._postRender=function(){this._wijgrid.element.find("> tbody").addClass(this._wijgrid.options.wijCSS.content),this._dataTable=new t.grid.htmlTableAccessor(this._wijgrid.element[0]),this._wijgrid._setAttr(this._wijgrid.element,{role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}),this._wijgrid.element.css("border-collapse","separate"),e.prototype._postRender.call(this)},n.prototype._insertRow=function(e,i,n){var o=t.grid.rowType,r;switch(e){case o.header:case o.filter:r=this._dataTable.ensureTHead();break;case o.footer:r=this._dataTable.ensureTFoot();break;default:r=this._dataTable.ensureTBody()}return n?[r.appendChild(n)]:(i>r.rows.length&&(i=-1),[r.insertRow(i)])},n.prototype._rowRendered=function(t,i,n){var o=t.$rows[0];!o.cells.length&&this._isBodyRow(t)?o.parentNode.removeChild(o):e.prototype._rowRendered.call(this,t,i,n)},n.prototype._appendCell=function(t,e,i){t.$rows[0].appendChild(i[0])},n.prototype._createCol=function(t,e){return[document.createElement("col")]},n.prototype._appendCol=function(t,e,i){this._dataTable.appendCol(t[0])},n}(e.baseView);e.flatView=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(e){function n(t,n){e.call(this,t,n),this._verScrollBarSize=18,this._viewTables={},this._splitAreas={},this.element=t.element,this._staticDataRowIndex=t._getStaticIndex(!0),this._staticRowIndex=t._getRealStaticRowIndex(),this._staticColumnIndex=t._getRealStaticColumnIndex(),this._staticAllColumnIndex=-1===this._staticColumnIndex?-1:t._field("visibleLeaves")[this._staticColumnIndex].leavesIdx,this._mouseWheelHandler=i.proxy(this._onMouseWheel,this)}return __extends(n,e),n.DEFAULT_ROW_HEIGHT_VIRTUAL=19,n.prototype.dispose=function(){e.prototype.dispose.call(this),this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)},n.prototype.ensureWidth=function(t,n,o){var r=this._wijgrid,s=r.options,a=this._staticColumnIndex,l=a>=t,h=i(this._viewTables.nw.element()),d=i(this._viewTables.ne.element()),c=i(this._viewTables.sw.element()),u=i(this._viewTables.se.element()),p=l?[h,c]:[d,u],g=(l?h.width():d.width())+n-o,f=this.getScrollValue();this._destroySuperPanel(),e.prototype.ensureWidth.call(this,t,n,o),this._setTableWidth(p,g,n,t);try{a>=0?s.splitDistanceX=h[0].offsetWidth:s.splitDistanceX=0}catch(m){}this._updateSplitAreaBounds(0),this._adjustRowsHeights();try{this._staticRowIndex>=0?s.splitDistanceY=Math.max(h[0].offsetHeight,d[0].offsetHeight):s.splitDistanceY=0}catch(m){}this._updateSplitAreaBounds(1),this.refreshPanel(f);var w=r._UIFrozener();w&&w.refresh()},n.prototype.ensureHeight=function(t){var e,n=this._wijgrid,o=n.options,r=i(this._viewTables.nw.element()),s=i(this._viewTables.ne.element()),a=i(this._viewTables.sw.element()),l=i(this._viewTables.se.element()),h=this.getScrollValue(),d;this._destroySuperPanel(),arguments.length>0&&(e=this.getJoinedRows(t,2),this._setRowHeight(e,this._getRowHeight(e))),l.css("height",""),a.css("height",""),d=Math.max(l.height(),a.height()),l.height(d),a.height(d);try{this._staticRowIndex>=0?o.splitDistanceY=Math.max(r[0].offsetHeight,s[0].offsetHeight):o.splitDistanceY=0}catch(c){}this._updateSplitAreaBounds(1),this.refreshPanel(h);var u=n._UIFrozener();u&&u.refresh()},n.prototype.getScrollValue=function(){var t=this._getSuperPanel();return t?{x:t.options.hScroller.scrollValue,y:t.options.vScroller.scrollValue}:null},n.prototype.getPanelContentWrapper=function(){return this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first")},n.prototype.getVisibleAreaBounds=function(e){var i=t.grid.bounds(this.getPanelContentWrapper(),e);return i||(i=t.grid.bounds(this._wijgrid.outerDiv,e)),i},n.prototype.getVisibleContentAreaBounds=function(){var e=this.getVisibleAreaBounds(),i=t.grid.bounds(this._viewTables.nw.element())||{},n=t.grid.bounds(this._viewTables.ne.element())||{},o=t.grid.bounds(this._viewTables.sw.element())||{},r=t.grid.bounds(this._viewTables.se.element())||{},s={top:e.top,left:e.left,width:Math.max(i.width+n.width,o.width+r.width),height:Math.max(i.height+o.height,n.height+r.height)};return s.width=Math.min(e.width,s.width),s.height=Math.min(e.height,s.height),s},n.prototype.getRowAreaHeight=function(){var t=this.getPanelContentWrapper();0==t.length&&(t=this._wijgrid.outerDiv);var e=t.height(),n=this._wijgrid.options.splitDistanceY;if(n&&(e-=n),this._wijgrid.options.showFooter){var o,r=this.isRendered()&&(o=this.footerRow())?i(o).height():this.getDefaultRowHeight();e-=r}return e},n.prototype.getVirtualPageSize=function(t){"undefined"==typeof t&&(t=!0);var e=this._wijgrid.rowOuterHeight&&this._wijgrid.rowOuterHeight>0?this._wijgrid.rowOuterHeight:this.getDefaultRowHeight(),i=this.getRowAreaHeight()/e;return t?Math.ceil(i):Math.floor(i)},n.prototype.getFixedAreaVisibleBounds=function(){var e=this.getVisibleAreaBounds(),i=t.grid.bounds(this._splitAreas.ne),n=t.grid.bounds(this._splitAreas.nw),o=null,r=null;return(i.height||n.height)&&(o={left:e.left,top:e.top,width:e.width,height:Math.min(i.height||n.height,e.height)}),n.width&&(r={left:n.left,top:e.top,width:Math.min(n.width,e.width),height:e.height}),[o,r]},n.prototype.getDefaultRowHeight=function(){return this._wijgrid.options.rowHeight>=0?this._wijgrid.options.rowHeight:n.DEFAULT_ROW_HEIGHT_VIRTUAL},n.prototype.refreshPanel=function(e){var n=this,o=this._wijgrid,r=o.options,s=this._getGridWidth(r.scrollMode),a=this._getMappedScrollMode(),l=this._testNeedVBar(o.outerDiv,o.element,i(this._viewTables.ne.element()),r.scrollMode,o._autoHeight),h=l&&!u,d=e?e.x:null,c=e?e.y:null,u=i.support.isTouchEnabled&&i.support.isTouchEnabled(),p=o._rows().item(0);o.rowOuterHeight=p&&p[0]?i(p[0]).outerHeight():this.getDefaultRowHeight(),this._splitAreas.ne.width(s-r.splitDistanceX-(h?this._verScrollBarSize:0)),"right"===r.staticColumnsAlignment&&(this._splitAreas.nw.css({left:"",right:h?this._verScrollBarSize:0}),this._splitAreas.sw.css({left:"",right:h?this._verScrollBarSize:0})),this._scroller.data("wijmo-wijsuperpanel")?this._scroller.wijsuperpanel("paintPanel"):(this._wijgrid._allowVirtualScrolling()&&(this.vsUI=new t.grid.uiVirtualScroller(o,this._splitAreas.se,r.splitDistanceY,o.rowOuterHeight)),this._scroller.wijsuperpanel({disabled:o.options.disabled,scroll:i.proxy(this._onScroll,this),bubbleScrollingEvent:!0,customScrolling:this._wijgrid._allowVirtualScrolling(),vScroller:{scrollBarVisibility:a.vScrollBarVisibility,scrollValue:e?e.y:null},hScroller:{scrollBarVisibility:a.hScrollBarVisibility,scrollValue:e?e.x:null},hScrollerActivating:function(t,e){var i;return o._autoHeight&&(i=o.element.height()+r.splitDistanceY-e.contentLength,i>0)?(n._scroller.height(n._scroller.height()+i),n._scroller.wijsuperpanel("paintPanel"),!1):void n._splitAreas.sw.height(e.contentLength-r.splitDistanceY)}}),this._wijgrid._allowVirtualScrolling()&&this.vsUI.attach(this._scroller)),this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5),this._wijgrid._allowVirtualScrolling()&&this._wijgrid._handleVirtualScrolling(this._bounds.start)},n.prototype.scrollTo=function(t){if(t.tableCell()){var e=this._wijgrid,n=e.options,o=this._getSuperPanel(),r=t.tableCell(),s=r.nodeType?i(r):r,a=null,l=null;if(o&&s.is(":visible")){var h=o.getContentElement(),d=h.parent(),c=-1*parseInt((h.css("left")+"").replace("px",""),10),u=-1*parseInt((h.css("top")+"").replace("px",""),10),p=d.outerWidth()-n.splitDistanceX,g=d.outerHeight()-n.splitDistanceY,f=s.position(),m=f.left,w=f.top,y=s.outerWidth(),v=s.outerHeight(),_=e._getStaticIndex(!0),S=e._getStaticIndex(!1),x=t.rowIndex(),b=t.cellIndex();_>=x?S>=b?(a=0,l=0):(m+=c,m+y>c+p&&(c=a=m+y-p),c>m&&(a=m),l=0):S>=b?(w+=this._splitAreas.sw.scrollTop(),w+v>u+g&&(u=l=w+v-g),u>w&&(l=w),a=0):(m-=n.splitDistanceX,w+v>u+g&&(u=l=w+v-g),m+y>c+p&&(c=a=m+y-p),u>w&&(l=w),c>m&&(a=m)),null!==a&&o.hScrollTo(a),null!==l&&(this._wijgrid._allowVirtualScrolling()||o.vScrollTo(l))}}},n.prototype.updateSplits=function(e){var n=this._wijgrid,o=n.options,r,s=this,a=[],l=[],h=[],d=this._staticColumnIndex,c,u=o.scrollMode,p=n._field("visibleLeaves"),g=i(this._viewTables.se.element()),f=i(this._viewTables.ne.element()),m=i(this._viewTables.sw.element()),w=i(this._viewTables.nw.element()),y=n.outerDiv,v,_,S;if(this._destroySuperPanel(),y.unbind("mousewheel",this._mouseWheelHandler),(v=s._viewTables.se.element().tBodies)&&(v=v[0])){for(S=!1,_=0;_<v.rows.length;_++)if(!i(v.rows[_]).hasClass(t.grid.wijgrid.CSS.groupHeaderRow)){S=!0;break}S||n.element.css("width","100%")}i.each([g,f,m,w],function(t,e){e.css({"table-layout":"",width:""})}),i.each(p,function(t,e){var i,n=e.width;(n||0===n)&&(i="string"==typeof n&&n.length>1&&"%"===n[n.length-1],n=i?y.width()*parseFloat(n)/100:parseFloat(n),(e.ensurePxWidth||void 0===e.ensurePxWidth&&o.ensureColumnsPxWidth)&&(e._realWidth=n),s._setColumnWidth(t,n))}),i.each(p,function(t,e){h.push(s._getColumnWidth(t))}),i.each([w,f,m,g],function(t,e){e.css({width:"1px"})}),i.each(p,function(t,e){l.push(s._getColumnWidth(t))}),r=y.width(),a=this._adjustWidthArray(h,l,r,o.ensureColumnsPxWidth),i.each(a,function(t,e){var i=p[t];return void 0!==i._realWidth?void delete i._realWidth:void s._setColumnWidth(t,e.width)}),d>=0&&(c=d,this._setTableWidth([w,m],this._sumWidthArray(a,0,c),a[c].width,c));try{d>=0?o.splitDistanceX=w[0].offsetWidth:o.splitDistanceX=0}catch(x){}this._updateSplitAreaBounds(0),o.ensureColumnsPxWidth||f.parent().width(r-o.splitDistanceX),c=a.length-1,-1!==c&&this._setTableWidth([f,g],this._sumWidthArray(a,d+1,c),a[c].width,c),this._adjustRowsHeights();try{this._staticRowIndex>=0?o.splitDistanceY=Math.max(w[0].offsetHeight,f[0].offsetHeight):o.splitDistanceY=0}catch(x){}if(this._updateSplitAreaBounds(1),!o.ensureColumnsPxWidth&&this._testNeedVBar(n.outerDiv,g,f,u,n._autoHeight)){r-=this._verScrollBarSize,a=this._adjustWidthArray(h,l,r,o.ensureColumnsPxWidth),i.each(a,function(t,e){e.real||s._setColumnWidth(t,e.width)}),d>=0&&(c=d,this._setTableWidth([w,m],this._sumWidthArray(a,0,c),a[c].width,c));try{d>=0?o.splitDistanceX=w[0].offsetWidth:o.splitDistanceX=0}catch(x){}this._updateSplitAreaBounds(0),f.parent().width(r-o.splitDistanceX),c=a.length-1,-1!==c&&this._setTableWidth([f,g],this._sumWidthArray(a,d+1,c),a[c].width,c),this._adjustRowsHeights();try{this._staticRowIndex>=0?o.splitDistanceY=Math.max(w[0].offsetHeight,f[0].offsetHeight):o.splitDistanceY=0}catch(x){}this._updateSplitAreaBounds(1)}this.refreshPanel(e),y.bind("mousewheel",i.proxy(this._mouseWheelHandler,this))},n.prototype.getInlineTotalWidth=function(){if(this._scroller){var t=this._scroller.find(".wijmo-wijsuperpanel-statecontainer");if(t.length){var e=t[0].style.width;if(e&&"auto"!==e)return e}}return""},n.prototype._clearBody=function(){e.prototype._clearBody.call(this)},n.prototype.bodyRows=function(){var t=e.prototype.bodyRows.call(this);return t},n.prototype.forEachColumnCell=function(t,e,i){var n=this.getJoinedTables(!0,t),o,r;if(null!==n[0]){if(o=n[2],r=n[0].forEachColumnCell(o,e,i),r!==!0)return r;if(null!==n[1]&&(r=n[1].forEachColumnCell(o,e,i),r!==!0))return r}return!0},n.prototype.forEachRowCell=function(t,e,i){var n=this.getJoinedTables(!1,t),o=n[0],r=n[1],s,a;if(null!==o){if(s=n[2],s<o.element().rows.length&&(a=o.forEachRowCell(s,e,i),a!==!0))return a;if(null!==r&&s<r.element().rows.length&&(a=r.forEachRowCell(s,e,i),a!==!0))return a}return!0},n.prototype.getAbsoluteCellInfo=function(e,i){return new t.grid.cellInfo(this.getColumnIndex(e),this.getAbsoluteRowIndex(e.parentNode),this._wijgrid,!0,i)},n.prototype.getAbsoluteRowIndex=function(t){for(var e=t.rowIndex,i=t.parentNode;i&&i.tagName&&"table"!==i.tagName.toLowerCase();)i=i.parentNode;return i===this._viewTables.nw.element()||i===this._viewTables.ne.element()?e:e+this._staticRowIndex+1},n.prototype.getCell=function(t,e){var i=this.getJoinedTables(!1,e),n,o,r,s,a;return null!==i[0]&&(n=this.getJoinedTables(!0,t),null!==n[0]&&(o=i[2],r=n[2],s=null,s=null!==i[1]?t===r?i[0]:i[1]:i[0],a=s.getCellIdx(r,o),a>=0))?s.element().rows[o].cells[a]:null},n.prototype.getColumnIndex=function(t){var e=null,i=null,n=!1,o;for(e=t.parentNode;"table"!==e.tagName.toLowerCase();e=e.parentNode);return null!==e&&(e===this._viewTables.nw.element()?i=this._viewTables.nw:e===this._viewTables.ne.element()?(i=this._viewTables.ne,n=!0):e===this._viewTables.sw.element()?i=this._viewTables.sw:e===this._viewTables.se.element()&&(i=this._viewTables.se,n=!0),null!==i)?(o=i.getColumnIdx(t),n&&(o+=this._staticColumnIndex+1),o):-1},n.prototype.getHeaderCell=function(e){var i=this._wijgrid._field("visibleLeaves")[e],n;return i&&(n=this._wijgrid._headerRows())?t.grid.rowAccessor.getCell(n.item(i.thY),i.thX):null},n.prototype.getJoinedCols=function(t){var e=[],n=this.getJoinedTables(!0,t),o=n[2];return n.splice(n.length-1,1),i.each(n,function(t,n){e.push(n?i(n.element()).find("col")[o]:null)}),e},n.prototype.getJoinedRows=function(t,e){var i=null,n=null,o=null,r=null,s=this._staticRowIndex,a=this._staticColumnIndex,l=this._wijgrid._field("visibleLeaves").length-1,h=this._rowsCountRaw()-1,d=s===h,c=0>s,u=!d&&!c,p=0;return(d||u)&&(a>=0&&l>a?(o=this._viewTables.nw,r=this._viewTables.ne):o=0>a?this._viewTables.ne:this._viewTables.nw,p=o.getSectionLength(e),p>t&&(i=o.getSectionRow(t,e),null!==r&&(n=r.getSectionRow(t,e)))),(c||u&&null===i)&&(c||(t-=p),a>=0&&l>a?(o=this._viewTables.sw,r=this._viewTables.se):o=0>a?this._viewTables.se:this._viewTables.sw,i=o.getSectionRow(t,e),null!==r&&(n=r.getSectionRow(t,e))),null===i&&null===n?null:[i,n]},n.prototype.getJoinedTables=function(t,e){var i=null,n=null,o=e,r=this._wijgrid,s=this._staticRowIndex,a=this._staticColumnIndex;return t?(a>=e?(i=this._viewTables.nw,n=this._viewTables.sw):(i=this._viewTables.ne,n=this._viewTables.se,o-=a+1),0>s&&(i=null),s===this._rowsCountRaw()-1&&(n=null)):(s>=e?(i=this._viewTables.nw,n=this._viewTables.ne):(i=this._viewTables.sw,n=this._viewTables.se,o-=s+1),0>a&&(i=null),a===r._field("leaves").length-1&&(n=null)),null===i&&(i=n,n=null),[i,n,o]},n.prototype.subTables=function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},n.prototype._getGridWidth=function(t){var e=this._wijgrid,n=e.element.outerWidth(!0)+e.options.splitDistanceX,o=e.outerDiv.innerWidth();return this._testNeedVBar(e.outerDiv,e.element,i(this._viewTables.ne.element()),t,e._autoHeight)&&(n+=this._verScrollBarSize),n>o&&(n=o),n},n.prototype._getSuperPanel=function(){return this._scroller?this._scroller.data("wijmo-wijsuperpanel"):null},n.prototype._ensureRenderBounds=function(){if(this._wijgrid._allowVirtualScrolling()){var t=this.getVirtualPageSize();if(this._wijgrid._ensureRenderableBounds(this._bounds),this._bounds.end=this._bounds.start+t-1,this._wijgrid._serverSideVirtualScrolling()){var i=this._bounds.end-this._bounds.start+1-this._wijgrid.sketchTable.count();i>0&&(this._bounds.end-=i)}if(this._wijgrid._ensureRenderableBounds(this._bounds),this._bounds.start>0&&this._bounds.end===this._wijgrid.sketchTable.count()-1){t=this.getVirtualPageSize(!1);var n=this._bounds.end-this._bounds.start+1;t>n&&(this._bounds.start=this._bounds.end-t+1),this._wijgrid._ensureRenderableBounds(this._bounds),this._bounds.start!==this._wijgrid._scrollingState.index&&(this._wijgrid._scrollingState.index=this._wijgrid._scrollingState.y=this._bounds.start)}}else e.prototype._ensureRenderBounds.call(this)},n.prototype._renderContent=function(){e.prototype._renderContent.call(this)},n.prototype._preRender=function(){e.prototype._preRender.call(this);var n=document.createDocumentFragment(),o=t.grid.htmlTableAccessor,r=t.grid.wijgrid.CSS,s=this._wijgrid.options.wijCSS;this._wijgrid.outerDiv.wrapInner('<div class="'+r.fixedView+" "+s.wijgridFixedView+'"><div class="'+r.scroller+" "+s.wijgridScroller+'"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>'),this._scroller=this._wijgrid.outerDiv.find("."+r.scroller),this._scroller.css("padding",0),this._scroller.after(this._splitAreas.nw=i('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.ne=i('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.sw=i('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first"),this._viewTables={nw:new o(n.appendChild(document.createElement("table")),!0,!0,!0),ne:new o(n.appendChild(document.createElement("table")),!0,!0,!0),sw:new o(n.appendChild(document.createElement("table")),!0,!0,!0),se:new o(n.appendChild(this._wijgrid.element[0]),!0,!0,!0)}},n.prototype._postRender=function(){var n,o,r,s,a=t.grid.htmlTableAccessor,l=this;this._viewTables={nw:new a(n=this._viewTables.nw.element()),ne:new a(o=this._viewTables.ne.element()),sw:new a(r=this._viewTables.sw.element()),se:new a(s=this._viewTables.se.element())},this._splitAreas.nw.empty().append(n),this._splitAreas.ne.empty().append(o),this._splitAreas.sw.empty().append(r),this._splitAreas.se.empty().append(s),i.each(this._viewTables,function(e,n){var o=i(n.element());l._wijgrid._setAttr(o,{role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}),o.addClass(t.grid.wijgrid.CSS.table).addClass(l._wijgrid.options.wijCSS.wijgridTable).css("border-collapse","separate").find("> tbody").addClass(l._wijgrid.options.wijCSS.content)}),e.prototype._postRender.call(this)},n.prototype._rowsCountRaw=function(){var t=this._viewTables.nw.element(),e=this._viewTables.ne.element(),i=this._viewTables.sw.element(),n=this._viewTables.se.element(),o;return o=Math.max(t.rows.length,e.rows.length)+Math.max(i.rows.length,n.rows.length)},n.prototype._createCol=function(t,e){return[document.createElement("col"),document.createElement("col")]},n.prototype._appendCol=function(t,e,i){i<=this._staticColumnIndex?(this._viewTables.nw.appendCol(t[0]),this._viewTables.sw.appendCol(t[1])):(this._viewTables.ne.appendCol(t[0]),this._viewTables.se.appendCol(t[1]))},n.prototype._insertRow=function(e,i,n){var o=t.grid.rowType,r,s,a=this._viewTables;switch(e){case o.header:case o.filter:r=a.nw.ensureTHead(),s=a.ne.ensureTHead();break;case o.footer:r=a.sw.ensureTFoot(),s=a.se.ensureTFoot();break;default:i<=this._staticDataRowIndex?(r=a.nw.ensureTBody(),s=a.ne.ensureTBody()):(i-=this._staticDataRowIndex+1,r=a.sw.ensureTBody(),s=a.se.ensureTBody())}return n?[r.appendChild(n),s.appendChild(n.cloneNode(!1))]:[r.insertRow(i>r.rows.length?-1:i),s.insertRow(i>s.rows.length?-1:i)]},n.prototype._rowRendered=function(t,n,o){var r=t.$rows[0],s=t.$rows[1];!r.cells.length&&this._isBodyRow(t)&&(r.parentNode.removeChild(r),r=null),!s.cells.length&&this._isBodyRow(t)&&(s.parentNode.removeChild(s),s=null),(r||s)&&(r&&s||(t.$rows=i(r?r:s)),e.prototype._rowRendered.call(this,t,n,o))},n.prototype._appendCell=function(e,i,n){var o=e.type!==t.grid.rowType.header?this._staticColumnIndex:this._staticAllColumnIndex;o>=i?e.$rows[0].appendChild(n[0]):e.$rows[1].appendChild(n[0])},n.prototype._getRowHeight=function(t,e){if(t[0]&&t[1]){var n=t[0],o=t[1],r=i(n),s=i(o),a,l,h,d=function(t){var e,n=t[0],o;for(e=0;e<n.cells.length;e++)if(o=n.cells[e],!o.rowSpan||1===o.rowSpan)return i(o).outerHeight();return t.height()};return(h=i.data(n,"customHeight"))?a=l=parseInt(h):(r.css("height",""),s.css("height",""),e?(a=d(r),l=d(s)):(a=r.height(),l=s.height())),Math.max(a,l)}return null},n.prototype._setRowHeight=function(t,e){if(t[0]&&t[1]){var n=[i(t[0]),i(t[1])],o;if(null===e)return;e+=1,i.each(n,function(t,i){i.height(e),o=e-i.height(),o&&i.height(e+o)})}},n.prototype._adjustRowHeight=function(){var t=this._wijgrid,e=this._staticColumnIndex,i=t._field("visibleLeaves").length-1,n,o,r,s,a,l,h,d,c,u,p,g,f,m,w,y,v=[];if(e>-1&&i>e){if(n=this._staticRowIndex,o=this._rowsCountRaw()-1,r=this._viewTables,n>-1&&o>=n)for(s=r.ne.element(),a=s.parentNode,l=r.nw.element(),h=l.parentNode,w=l.rows,y=s.rows,g=w.length,f=0;g>f;f++)v.push(this._getRowHeight([w[f],y[f]],!0));if(n>=-1&&o>n)for(d=r.se.element(),c=d.parentNode,u=r.sw.element(),p=u.parentNode,w=u.rows,y=d.rows,g=w.length,f=0;g>f;f++)v.push(this._getRowHeight([w[f],y[f]]));if(n>-1&&o>=n&&(h.removeChild(l),a.removeChild(s)),n>=-1&&o>n&&(p.removeChild(u),c.removeChild(d)),n>-1&&o>=n)for(w=l.rows,y=s.rows,g=w.length,f=0,m=0;g>f;f++)this._setRowHeight([w[f],y[f]],v[m++]);if(n>=-1&&o>n)for(w=u.rows,y=d.rows,g=w.length,f=0;g>f;f++)this._setRowHeight([w[f],y[f]],v[m++]);n>-1&&o>=n&&(h.appendChild(l),a.appendChild(s)),n>=-1&&o>n&&(p.appendChild(u),c.appendChild(d))}},n.prototype._adjustRowsHeights=function(){var t=i(this._viewTables.sw.element()),e=i(this._viewTables.se.element()),n;e.css("height",""),t.css("height",""),this._adjustRowHeight(),n=Math.max(e.height(),t.height()),t.height(n),e.height(n)},n.prototype._destroySuperPanel=function(){this._scroller.data("wijmo-wijsuperpanel")&&(this.vsUI&&this.vsUI.dispose(),this._scroller.wijsuperpanel("destroy"))},n.prototype._onScroll=function(t,e){var i=this._getSuperPanel();this._wijgrid._allowVirtualScrolling()?"h"===e.dir&&(this._setFixedAreaPosition(i.getContentElement(),e.dir,e.position,e.animationOptions,!1),this._setFixedAreaPosition(this._splitAreas.ne,e.dir,e.position,e.animationOptions,!0)):this._setFixedAreaPosition("h"===e.dir?this._splitAreas.ne:this._splitAreas.sw,e.dir,e.position,e.animationOptions,!0),this._wijgrid._trackScrollingPosition(i.options.hScroller.scrollValue,i.options.vScroller.scrollValue)},n.prototype._onMouseWheel=function(e,n){var o,r=n>0?"top":"bottom",s=!1,a;this._wijgrid._canInteract()&&(o=this.getFixedAreaVisibleBounds(),i.each(o,function(i,n){return n&&t.grid.isOver(e.pageY,e.pageX,n.top,n.left,n.height,n.width)?(s=!0,!1):void 0}),s&&this._scroller.data("wijmo-wijsuperpanel")&&(a=this._scroller.wijsuperpanel("option","vScroller").scrollValue,this._scroller.wijsuperpanel("doScrolling",r),a!==this._scroller.wijsuperpanel("option","vScroller").scrollValue&&(e.stopPropagation(),e.preventDefault())))},n.prototype._setFixedAreaPosition=function(t,e,i,n,o){var r={},s;s="h"===e?o?"scrollLeft":"left":o?"scrollTop":"top",o||(i=-i),n?(r[s]=i,t.animate(r,n)):o?t[0][s]=i:t.css(s,i)},n.prototype._testNeedVBar=function(t,e,i,n,o){var r=!1,s=this._wijgrid,a=i.width()+s.options.splitDistanceX,l=e.height()+s.options.splitDistanceY,h=t.width(),d=t.height(),c,u=0,p=0;switch(null!==s.$superPanelHeader&&(u=s.$superPanelHeader.outerHeight(!0)),null!==s.$bottomPagerDiv&&(p=s.$bottomPagerDiv.outerHeight(!0)),c=d-u-p,n){case"both":case"vertical":r=!0;break;case"auto":if(r=l>c||!o&&a>h&&l>c-this._verScrollBarSize,!r&&this._wijgrid._allowVirtualScrolling()){var g=s._view().getVirtualPageSize();r=g>0&&g<s._totalRowsCount()}}return r},n.prototype._updateSplitAreaBounds=function(t){var e=this._wijgrid,i=e.options,n,o,r=0,s=0;(0===t||2===t)&&(this._splitAreas.nw.width(i.splitDistanceX),this._splitAreas.sw.width(i.splitDistanceX),"right"===e.options.staticColumnsAlignment?(this._splitAreas.se.css("marginRight",i.splitDistanceX),this._splitAreas.ne.css("marginRight",i.splitDistanceX)):(this._splitAreas.se.css("marginLeft",i.splitDistanceX),this._splitAreas.ne.css("marginLeft",i.splitDistanceX))),(1===t||2===t)&&(this._scroller.css("height",""),this._splitAreas.se.css("marginTop",0),n=e.outerDiv.height(),e._autoHeight?this._scroller.height(n+i.splitDistanceY):this._scroller.height(n),this._splitAreas.nw.height(i.splitDistanceY),this._splitAreas.ne.height(i.splitDistanceY),null!==e.$superPanelHeader&&(r=e.$superPanelHeader.outerHeight(!0)),null!==e.$bottomPagerDiv&&(s=e.$bottomPagerDiv.outerHeight(!0)),o=n-r-s,null!==e.$superPanelHeader&&(this._splitAreas.nw.css("top",r+"px"),this._splitAreas.ne.css("top",r+"px")),e._autoHeight?this._splitAreas.sw.height(o):this._splitAreas.sw.height(o-i.splitDistanceY),this._splitAreas.sw.css("top",i.splitDistanceY+r),this._splitAreas.se.css("marginTop",i.splitDistanceY))},n}(e.baseView);e.fixedView=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function n(t){if(this._updates=0,this._selectedColumns=null,this._selectedRows=null,this._extend_rules={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]},!t)throw"invalid arguments";this._wijgrid=t,this._addedCells=new o(t),this._removedCells=new o(t),this._selectedCells=new o(t),this._addedDuringCurTransactionCells=new o(t)}return n.prototype.selectedCells=function(){return this._selectedCells},n.prototype.addColumns=function(t,e){!e&&0!==e&&(e=t),this.addRange(t,0,e,16777215)},n.prototype.addRange=function(e,i,n,o){if(!e&&1===arguments.length)throw"invalid argument";var r=4===arguments.length?new t.grid.cellInfoRange(new t.grid.cellInfo(e,i),new t.grid.cellInfo(n,o)):e._clone();if(r._normalize(),!r._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._selectRange(r,!1,!0,t.grid.cellRangeExtendMode.none,null),this.endUpdate()},n.prototype.addRows=function(t,e){!e&&0!==e&&(e=t),this.addRange(0,t,16777215,e)},n.prototype.removeRange=function(e,i,n,o){if(!e&&1===arguments.length)throw"invalid argument";var r=4===arguments.length?new t.grid.cellInfoRange(new t.grid.cellInfo(e,i),new t.grid.cellInfo(n,o)):e._clone();if(r._normalize(),!r._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._clearRange(r,t.grid.cellRangeExtendMode.none),this.endUpdate()},n.prototype.removeColumns=function(t,e){!e&&0!==e&&(e=t),this.removeRange(t,0,e,16777215)},n.prototype.removeRows=function(t,e){!e&&0!==e&&(e=t),this.removeRange(0,t,16777215,e)},n.prototype.clear=function(){this.beginUpdate(),this._removedCells._clear(),this._removedCells._addFrom(this._selectedCells),this.endUpdate()},n.prototype.selectAll=function(){this.beginUpdate(),this._selectRange(this._wijgrid._getDataCellsRange(e.dataRowsRangeMode.sketch),!1,!1,t.grid.cellRangeExtendMode.none,null),this.endUpdate()},n.prototype.beginUpdate=function(){this._updates++},n.prototype.endUpdate=function(){this._updates>0&&(this._updates--,0===this._updates&&(this.doSelection(),(this._addedCells.length()||this._removedCells.length())&&(null!==this._selectedColumns&&this._selectedColumns.UnderlyingDataChanged(),null!==this._selectedRows&&this._selectedRows.UnderlyingDataChanged(),this._wijgrid._trigger("selectionChanged",null,{addedCells:this._addedCells,removedCells:this._removedCells})),this._addedCells=new t.grid.cellInfoOrderedCollection(this._wijgrid),this._removedCells._clear()))},n.prototype._multipleRangesAllowed=function(){var t=this._wijgrid.options.selectionMode;return t&&("multicolumn"===(t=t.toLowerCase())||"multirow"===t||"multirange"===t)},n.prototype._anchorCell=function(){return this.__anchorCell},n.prototype._startNewTransaction=function(e){e&&(this.__anchorCell=e._clone(),this._addedDuringCurTransactionCells=new t.grid.cellInfoOrderedCollection(this._wijgrid))},n.prototype._clearRange=function(t,i){var n=this._wijgrid.options.selectionMode.toLowerCase(),o,r,s,a,l,h,d,c,u,p=this._wijgrid._getDataCellsRange(e.dataRowsRangeMode.sketch);if(t._isValid()&&"none"!==n&&this._selectedCells.length()>0){if(o=t._clone(),o._normalize(),o._clip(p),!t._isValid())return;for(o._extend(this._extend_rules[n][i],p),this.beginUpdate(),d=0,c=this._selectedCells.length();c>d;d++)u=this._selectedCells.item(d),o._containsCellInfo(u)&&this._removedCells._add(u);this.endUpdate()}},n.prototype._selectRange=function(i,n,o,r,s){var a=this._wijgrid.options.selectionMode.toLowerCase(),l,h=this._wijgrid._getDataCellsRange(e.dataRowsRangeMode.sketch);if("none"!==a&&i._isValid()){if(l=i._clone(),l._normalize(),l._clip(h),!l._isValid())return;switch(this.beginUpdate(),this._multipleRangesAllowed()&&(n||o)?o&&(this._removedCells._clear(),this._removedCells._addFrom(this._addedDuringCurTransactionCells)):this.clear(),a){case"singlecell":case"singlecolumn":case"singlerow":l=null===s?new t.grid.cellInfoRange(l.topLeft(),l.topLeft()):new t.grid.cellInfoRange(s,s)}l._extend(this._extend_rules[a][r],h),this.doRange(l,!0),this.endUpdate()}},n.prototype._ensureSelection=function(){for(var t=this._wijgrid._view(),e=-2,i,n=0;n<this._selectedCells.length();n++){var o=this._selectedCells.item(n);o._isRendered()&&(e!==o.rowIndex()&&(i=o.row(),e=o.rowIndex()),this.selectCell(o,i,t,!0))}},n.prototype.doSelection=function(){var e=this._wijgrid._view(),i,n,o,r,s,a,l=t.grid.renderState,h,d,c=-1;for(i=0,n=this._removedCells.length();n>i;i++)o=this._removedCells.item(i),this._addedCells.indexOf(o)<0?(c!==o.rowIndex()&&(h=o.row(),c=o.rowIndex()),this.selectCell(o,h,e,!1),this._selectedCells._remove(o),this._addedDuringCurTransactionCells._remove(o)):(this._removedCells._removeAt(i),i--,n--);for(c=-1,i=0,n=this._addedCells.length();n>i;i++)o=this._addedCells.item(i),a=this._selectedCells.indexOf(o),0>a?(c!==o.rowIndex()&&(h=o.row(),c=o.rowIndex()),this.selectCell(o,h,e,!0),this._selectedCells._insertUnsafe(o,~a),this._addedDuringCurTransactionCells._add(o)):(this._addedCells._removeAt(i),i--,n--)},n.prototype.selectCell=function(e,n,o,r){if(e._isRendered()){var s=this._wijgrid._viewPortBounds(),a=o.getCell(e.cellIndexAbs(),e.rowIndexAbs());if(a){var l=i(a),h=o._changeCellRenderState(l,t.grid.renderState.selected,r===!0);this._wijgrid.cellStyleFormatter.format(l,e.cellIndex(),e.column(),n,h)}}},n.prototype.doRange=function(e,i){var n=e.topLeft().cellIndex(),o=e.topLeft().rowIndex(),r=e.bottomRight().cellIndex(),s=e.bottomRight().rowIndex(),a,l,h,d,c=this._wijgrid._view(),u,p,g=this._wijgrid._viewPortBounds();if(i){for(a=this._addedCells.length(),p=this._wijgrid._rows(),l=o;s>=l;l++)if(u=c._getRowInfoBySketchRowIndex(l),u.type&t.grid.rowType.data)for(h=n;r>=h;h++)d=new t.grid.cellInfo(h,l),0===a?this._addedCells._appendUnsafe(d):this._addedCells._add(d)}else for(a=this._removedCells.length(),l=o;s>=l;l++)for(h=n;r>=h;h++)d=new t.grid.cellInfo(h,l),0===a?this._removedCells._appendUnsafe(d):this._removedCells._add(d)},n}();e.selection=n;var o=function(){function e(t){if(this._clear=function(){this._list.length=0},!t)throw"invalid arguments";this._wijgrid=t,this._list=[]}return e.prototype.item=function(t){return this._list[t]},e.prototype.length=function(){
return this._list.length},e.prototype.indexOf=function(t,e){1===arguments.length&&(e=t.rowIndex(),t=t.cellIndex());for(var i=0,n=this._list.length-1,o,r,s;n>=i;)if(o=i+(n-i>>1),r=this._list[o],s=r.rowIndex()-e,0===s&&(s=r.cellIndex()-t),0>s)i=o+1;else{if(!(s>0))return o;n=o-1}return~i},e.prototype.toString=function(){var t="",e,i;for(e=0,i=this._list.length;i>e;e++)t+=this._list[e].toString()+"\n";return t},e.prototype._add=function(t){var e=this.indexOf(t);return 0>e?(this._list.splice(~e,0,t),t._setGridView(this._wijgrid),!0):!1},e.prototype._addFrom=function(t){if(t){var e=t.length(),i=this._list.length,n;if(0===i)for(this._list.length=e,n=0;e>n;n++)this._list[n]=t.item(n),this._list[n]._setGridView(this._wijgrid);else for(n=0;e>n;n++)this._add(t.item(n))}},e.prototype._appendUnsafe=function(t){this._list[this._list.length]=t,t._setGridView(this._wijgrid)},e.prototype._insertUnsafe=function(t,e){this._list.splice(e,0,t)},e.prototype._remove=function(t){var e=this.indexOf(t);return e>=0?(this._list.splice(e,1),!0):!1},e.prototype._removeAt=function(t){this._list.splice(t,1)},e.prototype._getColumnsIndicies=function(){var t=[],e=this._list.length,i,n,o;if(e){for(i=[],n=0;e>n;n++)i[this._list[n].cellIndex()]=1;for(e=i.length,o=0,n=0;e>n;n++)i[n]&&(t[o++]=n)}return t},e.prototype._getSelectedRowsIndicies=function(){var t=[],e=this._list.length,i,n,o;if(e){for(i=[],n=0;e>n;n++)i[this._list[n].rowIndex()]=1;for(e=i.length,o=0,n=0;e>n;n++)i[n]&&(t[o++]=n)}return t},e.prototype._rectangulate=function(){var e=this._list.length,i=4294967295,n=4294967295,o=0,r=0,s,a;if(e){for(s=0;e>s;s++)a=this._list[s],i=Math.min(i,a.cellIndex()),n=Math.min(n,a.rowIndex()),o=Math.max(o,a.cellIndex()),r=Math.max(r,a.rowIndex());return new t.grid.cellInfoRange(new t.grid.cellInfo(i,n),new t.grid.cellInfo(o,r))}return null},e}();e.cellInfoOrderedCollection=o}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function n(e){this._gap_to_start=10,this._inProgress=!1,this._additionalEventsAttached=!1,this._wijgrid=e,this._evntFormat="{0}."+this._wijgrid.widgetName+".selectionui",this._addedCells=new t.grid.cellInfoOrderedCollection(this._wijgrid),this._view=this._wijgrid._view(),this._rootElement=this._view.focusableElement(),this._visLeavesLen=this._wijgrid._field("visibleLeaves").length,this._rootElement.bind(this._eventKey("mousedown"),i.proxy(this._onGridMouseDown,this))}return n.prototype.dispose=function(){this._rootElement.unbind(this._eventKey("mousedown"),this._onGridMouseDown),this._detachAdditionalEvents()},n.prototype._onGridMouseDown=function(e){if(this._wijgrid._canInteract()&&"none"!==this._wijgrid.options.selectionMode.toLowerCase()){var n=this._view.getVisibleContentAreaBounds(),o={x:e.pageX,y:e.pageY},r=e.target&&void 0!==e.target.tagName?e.target.tagName.toLowerCase():void 0,s=i(e.target),a=t.grid.wijgrid.CSS;(!r||s.is("td."+a.TD+", th."+a.TD+", div."+a.cellContainer))&&o.x>n.left&&o.x<n.left+n.width&&o.y>n.top&&o.y<n.top+n.height&&(this._attachAdditionalEvents(),this._startPos=o,this._startCellInfo=this._coordToDataCellInfo(this._startPos))}},n.prototype._onDocumentMouseMove=function(n){if(this._startCellInfo&&this._startCellInfo._isValid()){var o={x:n.pageX,y:n.pageY},r,s,a,l,h,d,c,u,p,g,f,m,w,y,v=this._wijgrid._view(),_=this._wijgrid._rows(),S=t.grid.renderState;if(this._inProgress||(this._inProgress=Math.abs(this._startPos.x-o.x)>this._gap_to_start||Math.abs(this._startPos.y-o.y)>this._gap_to_start),this._inProgress){if(r=this._coordToDataCellInfo(o),!r._isValid())return;if(this._endCellInfo=r,a=new t.grid.cellInfoRange(this._startCellInfo,this._endCellInfo),a._normalize(),a._clip(this._wijgrid._getDataCellsRange(e.dataRowsRangeMode.sketch)),a._isValid()&&!a.isEqual(this._prevMouseMoveRange)){for(this._prevMouseMoveRange=a,l=new t.grid.cellInfoOrderedCollection(this._wijgrid),h=a.bottomRight().rowIndex(),d=a.bottomRight().cellIndex(),c=a.topLeft().rowIndex();h>=c;c++)if(m=v._getRowInfoBySketchRowIndex(c),m.type&t.grid.rowType.data)for(u=a.topLeft().cellIndex();d>=u;u++)l._appendUnsafe(new t.grid.cellInfo(u,c));for(w=-1,p=0,g=this._addedCells.length();g>p;p++)s=this._addedCells.item(p),l.indexOf(s)<0&&(this._wijgrid.selection().selectedCells().indexOf(s)<0&&(u=this._view.getCell(s.cellIndexAbs(),s.rowIndexAbs()),u&&(w!==s.rowIndex()&&(m=s.row(),w=s.rowIndex()),f=i(u),y=v._changeCellRenderState(f,S.selected,!1),this._wijgrid.cellStyleFormatter.format(f,s.cellIndex(),s.column(),m,y))),this._addedCells._removeAt(p),p--,g--);for(w=-1,p=0,g=l.length();g>p;p++)s=l.item(p),this._addedCells.indexOf(s)<0&&this._wijgrid.selection().selectedCells().indexOf(s)<0&&this._addedCells._add(s)&&(u=this._view.getCell(s.cellIndexAbs(),s.rowIndexAbs()),u&&(w!==s.rowIndex()&&(m=s.row(),w=s.rowIndex()),f=i(u),y=v._changeCellRenderState(f,S.selected,!0),this._wijgrid.cellStyleFormatter.format(f,s.cellIndex(),s.column(),m,y)))}}}},n.prototype._onDocumentMouseUp=function(e){if(this._detachAdditionalEvents(),this._inProgress&&(this._inProgress=!1,this._prevMouseMoveRange&&this._prevMouseMoveRange._isValid())){this._wijgrid._changeCurrentCell(e,this._endCellInfo,{changeSelection:!1,setFocus:!1}),(!e.shiftKey||!this._wijgrid.selection()._multipleRangesAllowed()&&"singleRange"!==this._wijgrid.options.selectionMode.toLowerCase())&&this._wijgrid.selection()._startNewTransaction(this._startCellInfo),this._wijgrid.selection().beginUpdate(),this._wijgrid.selection()._selectRange(this._prevMouseMoveRange,e.shiftKey,e.ctrlKey,t.grid.cellRangeExtendMode.none,this._endCellInfo),this._wijgrid.selection().endUpdate();for(var n=this._wijgrid._view(),o=-1,r,s=t.grid.renderState,a=0,l=this._addedCells.length();l>a;a++){var h=this._addedCells.item(a);if(this._wijgrid.selection().selectedCells().indexOf(h)<0){var d=n.getCell(h.cellIndexAbs(),h.rowIndexAbs());if(null!==d){o!==h.rowIndex()&&(r=h.row(),o=h.rowIndex());var c=i(d),u=n._changeCellRenderState(c,s.selected,!1);this._wijgrid.cellStyleFormatter.format(c,h.cellIndex(),h.column(),r,u)}}}return this._addedCells._clear(),this._startCellInfo=this._endCellInfo=this._prevMouseMoveRange=null,!1}},n.prototype._attachAdditionalEvents=function(){if(!this._additionalEventsAttached)try{this._view.toggleDOMSelection(!1),i(document).bind(this._eventKey("mousemove"),i.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),i.proxy(this._onDocumentMouseUp,this))}finally{this._additionalEventsAttached=!0}},n.prototype._detachAdditionalEvents=function(){if(this._additionalEventsAttached)try{this._view.toggleDOMSelection(!0),i(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp)}finally{this._additionalEventsAttached=!1}},n.prototype._eventKey=function(e){return t.grid.stringFormat(this._evntFormat,e)},n.prototype._coordToDataCellInfo=function(e){for(var i=0,n=this._visLeavesLen-1,o=0,r=-1,s,a=new t.grid.rowAccessor(this._view,2,0,0),l,h,d,c;n>=i&&(o=(n-i>>1)+i,s=t.grid.bounds(this._view.getHeaderCell(o)),s||(h=a.item(0),s=t.grid.bounds(t.grid.rowAccessor.getCell(h,o))),s);)if(e.x<s.left)n=o-1;else{if(!(e.x>s.left+s.width)){r=o;break}i=o+1}if(-1===r)return t.grid.cellInfo.outsideValue;for(a=new t.grid.rowAccessor(this._view,0,0,0),l=-1,i=0,n=a.length()-1,o=0;n>=i;)if(o=(n-i>>1)+i,h=a.item(o),s=t.grid.bounds(t.grid.rowAccessor.getCell(h,0)),e.y<s.top)n=o-1;else{if(!(e.y>s.top+s.height)){l=o;break}i=o+1}return-1===l?t.grid.cellInfo.outsideValue:c=new t.grid.cellInfo(r,l,this._wijgrid,!0)},n}();e.uiSelection=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){"use strict";var e=jQuery,i=function(){function t(t,e,i,n){this._view=t,this._scope=e,this._offsetBottom=n,this._offsetTop=i}return t.prototype.item=function(t){var e=this.length();return t>=0&&e>t?this._view.getJoinedRows(t+this._offsetTop,this._scope):null},t.prototype.length=function(){var t=this._view.getJoinedTables(!0,0),e=0,i;return(i=t[0])&&(e=i.getSectionLength(this._scope)),(i=t[1])&&(e+=i.getSectionLength(this._scope)),e-=this._offsetTop+this._offsetBottom,0>e&&(e=0),e},t.iterateCells=function(t,e,i){if(t&&e){var n=0,o,r,s,a,l,h;for(o=0,r=t.length;r>o;o++)if(s=t[o])for(a=0,l=s.cells.length;l>a;a++)if(h=e(s.cells[a],n++,i),h!==!0)return}},t.getCell=function(t,e){var i,n;if(t&&(i=t[0])){if(n=i.cells.length,n>e)return i.cells[e];if(e-=n,(i=t[1])&&(n=i.cells.length,n>e))return i.cells[e]}return null},t.cellsCount=function(t){var e=0,i;return t&&(i=t[0])&&(e=i.cells.length,(i=t[1])&&(e+=i.cells.length)),e},t}();t.rowAccessor=i}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery;!function(t){t._map=[],t.error=0,t.continueEditing=1,t.success=2,t.cancel=4,t.notEdited=8}(e.updateCellResult||(e.updateCellResult={}));var n=e.updateCellResult,o=function(){function e(){this._timeout=25}return e.prototype.cellEditStart=function(e,n,o){var r=!1,s=e._view(),a,l,h,d;return n._isValid()&&!n._isEdit()&&n.column().dataIndex>=0&&(a=n.row(),a&&(d=a.type,d&t.grid.rowType.data&&(l={cell:n,event:o,handled:!1},(r=e._trigger("beforeCellEdit",null,l)||"row"===e.options.editingMode)&&(l.handled||(r=this._defaultBeforeCellEdit(e,l))),r&&(n._isEdit(!0),e._showRowHeader()&&(h=i(a.$rows[0].cells[0]).children("div."+t.grid.wijgrid.CSS.cellContainer),h.length&&(h.empty(),h.append(i("<div>&nbsp;</div>").addClass(e.options.wijCSS.icon+" "+e.options.wijCSS.iconPencil)))))))),r},e.prototype.updateCell=function(e,i,o){var r;if(i&&!i._isEdit())return n.success|n.notEdited;if(!(i&&i._isValid()&&(r=i.row())&&r.type&t.grid.rowType.data))return n.error;if(o&&o.which===t.getKeyCodeEnum().ESCAPE||!i._isRendered())return n.success|n.cancel;var s=n.success,a=i.column(),l={cell:i,value:void 0};if(!e._trigger("beforeCellUpdate",null,l)&&"row"!==e.options.editingMode)return n.continueEditing;void 0===l.value&&(l.value=this._getCellValue(e,i));var h=l.value,d=i.value();try{var c=this._getHTMLInputElementType(i);t.grid.HTML5InputSupport.isExtendSupportRequired(c)?(l.value=t.grid.HTML5InputSupport.parse(l.value,c),l.value=t.grid.HTML5InputSupport.extend(d,l.value,c)):l.value=e.parse(i.column(),l.value),h=l.value}catch(u){l.value=h}if("datetime"===t.grid.getDataType(a)&&(h instanceof Date&&(h=h.getTime()),d instanceof Date&&(d=d.getTime())),h!==d){try{i.value(l.value)}catch(u){var p={cell:i,value:l.value};s=n.error,e._trigger("invalidCellValue",null,p)}if(s&n.success){var g={cell:i};e._trigger("afterCellUpdate",null,g)}}return s},e.prototype.cellEditEnd=function(e,n,o){var r=n.row(),s={cell:n,event:o,handled:!1};n._isEdit(!1),n._isRendered()&&(e._trigger("afterCellEdit",null,s),s.handled||this._defaultAfterCellEdit(e,s),e._showRowHeader()&&i(r.$rows[0].cells[0]).children("div."+t.grid.wijgrid.CSS.cellContainer).html("&nbsp;"))},e.prototype._defaultBeforeCellEdit=function(e,n){var o=n.cell.column(),r=!1,s,a,l,h,d,c,u=t.getKeyCodeEnum(),p=t.grid.HTML5InputSupport.getDefaultInputType(e._isMobileEnv(),o);if(o.dataIndex>=0){s=n.cell.value(),r=!0;try{if(l=n.cell.container(),"boolean"===t.grid.getDataType(o)){var g=l.children("span");g.length&&g.prop("disabled")&&(i.data(g[0],"disabledSpan",!0),g.prop("disabled",!1)),h=l.find(":checkbox"),h.prop("disabled",!1),n.event&&"keypress"===n.event.type&&h.one("keyup",function(t){t.which===u.SPACE&&(t.preventDefault(),h[0].checked=!s)})}else{if(h=i("<input />").attr("type",p).addClass(t.grid.wijgrid.CSS.inputMarker).addClass("wijmo-wijinput "+e.options.wijCSS.stateFocus).bind("keydown",e,i.proxy(this._checkBoxOrInputKeyDown,this)),h.bind(i.support.selectstart?"selectstart":"mousedown",function(t){t.stopPropagation()}),!n.event||"keydown"!==n.event.type||113===n.event.which)switch(t.grid.getDataType(o)){case"currency":case"number":if(null!==s){h.val(s);break}case"datetime":if(t.grid.HTML5InputSupport.isExtendSupportRequired(p)){h.val(t.grid.HTML5InputSupport.toStr(s,p));break}default:h.val(e.toStr(o,s))}l.empty().append(h),d=h.val().length,"text"===p&&new t.grid.domSelection(h[0]).setSelection({start:d,end:d})}e._allowCellEditing()&&(h.focus(),setTimeout(function(){h.focus()},2*this._timeout))}catch(f){alert(f.message),r=!1}}return r},e.prototype._defaultAfterCellEdit=function(e,n){var o=n.cell.column(),r=!1,s,a,l,h,d;if(o.dataIndex>=0){r=!0,d=e._view();try{if(s=n.cell.container(),a=e.toStr(o,n.cell.value()),h=d._getRowInfoBySketchRowIndex(n.cell.rowIndex()),"boolean"===t.grid.getDataType(o)){var c=s.children("span"),u=c.length&&i.data(c[0],"disabledSpan");l=s.find(":checkbox"),"true"===a?l.attr("checked","checked"):l.removeAttr("checked"),u&&(c.prop("disabled",!0),l.prop("disabled",!0))}else e.cellFormatter.format(i(n.cell.tableCell()),s,o,a,h)}catch(p){alert("defaultAfterCellEdit: "+p.message),r=!1}}return r},e.prototype._checkBoxOrInputKeyDown=function(e){var i=t.getKeyCodeEnum();if(e.which===i.ENTER){var n=e.data;if(n)return n._endEditInternal(e),!1}},e.prototype._getCellValue=function(t,e){var i=e.container().find(":input:first"),n=null;return i.length&&(n="checkbox"===i.attr("type")?i[0].checked:i.val()),n},e.prototype._getHTMLInputElementType=function(t){return t.container().find(":input:first").attr("type")},e}();e.cellEditorHelper=o;var r=function(){function t(t,e){this.mGrid=t,this.mWrapper=i("<div />"),this.mWrapper.append(this.mElement=i('<input type="text" />').css("position","relative").keydown(i.proxy(this._onKeyDown,this))).css({position:"absolute",width:0,height:0,overflow:"hidden","z-index":999999}),e.append(this.mWrapper)}return t.prototype.focus=function(t){if(t&&t.length){var e=t.offset();this.mWrapper.offset({top:e.top,left:e.left}),this.mElement.focus()}},t.prototype.isHiddenInput=function(t){return t&&t[0]===this.mElement[0]},t.prototype.canHandle=function(t){return this.mGrid._allowCellEditing()&&this.isPrintableKeyCode(t)},t.prototype.isPrintableKeyCode=function(t){var e=t.keyCode;return!t.ctrlKey&&!t.altKey&&(e>=65&&90>=e||e>=48&&57>=e||e>=96&&105>=e||e>=186&&192>=e||e>=220&&222>=e||219===e||e>=106&&111>=e||32===e||61===e||173===e||229===e||0===t.keyCode)},t.prototype._onKeyDown=function(t){this.canHandle(t)&&this.mGrid._beginEditInternal(t)},t}();e.keyDownEventListener=r}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function n(){}return n._div=document.createElement("div"),n.prototype.format=function(e,n,o,r,s){s.type&t.grid.rowType.footer&&(r=o.aggregate&&"none"!==o.aggregate?t.grid.stringFormat(o.footerText||"{0}",o._totalsValue||""):o.footerText||o._footerTextDOM||"");var a=!0,l=null,h={$cell:e,$container:n,column:o,formattedValue:r,row:s,afterDefaultCallback:null},d=o.owner,c=t.grid.rowType,u=!0;if((s.type&c.data||s.type===c.groupFooter||s.type===c.groupHeader)&&d._allowVirtualScrolling()){var p=d._view().getDefaultRowHeight();n.css({overflow:"hidden",height:p})}if(i.isFunction(o.cellFormatter)&&(a=!o.cellFormatter(h)),a){switch(s.type&~c.dataAlt){case c.filter:l=this._formatFilterRowCell;break;case c.data:l=this._formatDataRowCell;break;default:l=this._formatDefRowCell}l&&(u=l.call(this,h),i.isFunction(h.afterDefaultCallback)&&h.afterDefaultCallback(h))}return u===!1?!1:!0},n.prototype._formatFilterRowCell=function(e){var i=e.column.owner,n=t.grid.wijgrid.CSS,o=i.options.wijCSS;e.$container.addClass(o.widget+" "+o.stateDefault),e.column.dataIndex>=0&&!e.column.isBand&&e.column.showFilter?e.$container.html('<table cellPadding="0" cellSpacing="0" class="'+n.filter+" "+o.wijgridFilter+" "+o.cornerAll+'"><tr><td style="width:100%"><input type="text" class="'+n.filterInput+" "+o.wijgridFilterInput+'" style="width:100%" /></td><td class="'+n.filterTrigger+" "+o.wijgridFilterTrigger+" "+o.cornerRight+" "+o.stateDefault+'"><span class="'+o.icon+" "+o.iconArrowDown+'"></span></td></tr></table>'):e.$container.html("&nbsp;")},n.prototype._formatDataRowCell=function(e){var i=e.column,n=i.owner,o=t.grid.getDataType(i),r=!0;return"c1btnfield"===i.clientType?this._c1btnFieldCellFormatter(e):"c1commandbtnfield"===i.clientType?this._c1commandBtnFieldCellFormatter(e):this._defFieldCellFormatter(e),r},n.prototype._formatDefRowCell=function(t){this._updateHTML(t)},n.prototype._defFieldCellFormatter=function(e){"boolean"===t.grid.getDataType(e.column)?this._boolCellFormatter(e):this._dataCellFormatter(e)},n.prototype._boolCellFormatter=function(e){var n=e.column.owner,o=n._allowCellEditing()&&e.column.readOnly!==!0,r,s,a=t.grid.rowType,l=t.getKeyCodeEnum(),h=i('<input class="'+t.grid.wijgrid.CSS.inputMarker+'" type="checkbox" />');o||h.prop("disabled",!0),n.parse(e.column,n._dataViewWrapper.getValue(e.row.data,e.column.dataKey))===!0&&h.prop("checked","checked"),e.$container.append(h),o&&e.$container.children("input").bind("mousedown",function(t){r=e.$container.parent()[0],s=n.currentCell(),s.tableCell()!==r&&n._onClick({target:r}),s._isEdit()||n.beginEdit()}).bind("keydown",function(t){return t.which===l.ENTER?(n._endEditInternal(t),!1):void 0})},n.prototype._dataCellFormatter=function(t){this._updateHTML(t)},n.prototype._c1btnFieldCellFormatter=function(t){var e=t.column,i={column:t.column,row:t.row};t.$container.append(this._buttonFactory(e.command,i,null))},n.prototype._c1commandBtnFieldCellFormatter=function(e){var i=e.column,n=i.owner,o={column:e.column,row:e.row},r=this;e.row.state&t.grid.renderState.editing?(e.$container.append(this._buttonFactory(i.updateCommand,o,function(t,e){n.updateRow()})),e.$container.append(document.createTextNode(" ")),e.$container.append(this._buttonFactory(i.cancelCommand,o,function(t,e){n.cancelRowEditing()}))):(i.showEditButton&&e.$container.append(this._buttonFactory(i.editCommand,o,function(t,e){n.editRow(o.row.dataItemIndex)})),i.showDeleteButton&&(i.showEditButton&&e.$container.append(document.createTextNode(" ")),e.$container.append(this._buttonFactory(i.deleteCommand,o,function(t,e){n.deleteRow(o.row.dataItemIndex)})))),e.$container.addClass("wijmo-wijgrid-innercell-command")},n.prototype._updateHTML=function(e){var i=e.$container[0];if(i.firstChild)for(;i.firstChild;)i.removeChild(i.firstChild);for(t.grid.cellFormatterHelper._div.innerHTML=e.formattedValue||"&nbsp;";t.grid.cellFormatterHelper._div.firstChild;)i.appendChild(t.grid.cellFormatterHelper._div.firstChild)},n.prototype._buttonFactory=function(t,n,o){var r=i.extend({},{text:t.text,iconClass:t.iconClass,disabled:n.column.owner.disabled,click:function(e){var r=!0;if(i.isFunction(t.click)){var s=t.click.apply(this,[e,n]);r=s!==!1&&!e.isDefaultPrevented()}r&&o&&o.apply(this,[e,n]),e.preventDefault()}}),s=null;switch(n.column.buttonType){case"link":s=new e.wijgridCommandLink(r).element();break;case"imageButton":s=new e.wijgridCommandImageButton(r).element();break;case"button":s=new e.wijgridCommandButton(r).element();break;case"image":s=new e.wijgridCommandImage(r).element();break;default:throw"Unknown buttonType"}return s},n}();e.cellFormatterHelper=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(t){this.MIN_WIDTH=5,this._elements=[],this._gap=10,this._step=1,this._inProgress=!1,this._hoveredField=null,this._startLocation=null,this._lastLocation=null,this._proxy=null,this._wijgrid=t,this._evntFormat="{0}."+this._wijgrid.widgetName+".resizer"}return e.prototype.addElement=function(t){t&&t.element&&(t.element.bind(this._eventKey("mousemove"),i.proxy(this._onMouseMove,this)).bind(this._eventKey("mousedown"),i.proxy(this._onMouseDown,this)).bind(this._eventKey("mouseout"),i.proxy(this._onMouseOut,this)),this._elements.push(t))},e.prototype.dispose=function(){var t=this;i.each(this._elements,function(e,i){i.element.unbind(t._eventKey("mousemove"),t._onMouseMove).unbind(t._eventKey("mousedown"),t._onMouseDown).unbind(t._eventKey("mouseout"),t._onMouseOut)}),this._detachDocEvents()},e.prototype.inProgress=function(){return this._inProgress},e.prototype._onMouseMove=function(t){if(!this._inProgress){var e=this._getFieldByPos({x:t.pageX,y:t.pageY});e&&e._canSize()&&this._wijgrid._canInteract()?(e.element.css("cursor","e-resize"),this._hoveredField=e,t.stopPropagation()):this._onMouseOut(t)}},e.prototype._onMouseOut=function(t){this._inProgress||this._hoveredField&&(this._hoveredField.element.css("cursor",""),this._hoveredField=null)},e.prototype._onMouseDown=function(e){if(this._hoveredField=this._getFieldByPos({x:e.pageX,y:e.pageY}),this._hoveredField&&this._hoveredField._canSize()&&this._wijgrid._canInteract())try{var n=this._wijgrid.options.wijCSS,o=t.grid.wijgrid.CSS;this._hoveredField.element.css("cursor",""),this._docCursor=document.body.style.cursor,document.body.style.cursor="e-resize",this._startLocation=this._lastLocation=t.grid.bounds(this._hoveredField.element),this._proxy=i('<div class="'+o.resizingHandle+" "+n.wijgridResizingHandle+" "+n.stateHighlight+'">&nbsp;</div>');var r=this._wijgrid._view().getVisibleAreaBounds();this._proxy.css({left:e.pageX,top:this._startLocation.top,height:r.height+r.top-this._startLocation.top}),i(document.body).append(this._proxy)}finally{this._attachDocEvents(),this._inProgress=!0,e.stopPropagation()}},e.prototype._onDocumentMouseMove=function(t){var e=this._step*Math.round((t.pageX-this._lastLocation.left)/this._step);this._lastLocation={left:this._lastLocation.left+e,top:t.pageY,width:void 0,height:void 0},this._proxy.css("left",this._lastLocation.left)},e.prototype._onDocumentMouseUp=function(t){try{document.body.style.cursor=this._docCursor,this._proxy.remove(),this._startLocation!==this._lastLocation&&this._wijgrid._fieldResized(this._hoveredField,this._startLocation.width,Math.max(this._lastLocation.left-this._startLocation.left,this.MIN_WIDTH))}finally{this._hoveredField=null,this._proxy=null,this._detachDocEvents(),this._inProgress=!1}},e.prototype._onSelectStart=function(t){t.preventDefault()},e.prototype._attachDocEvents=function(){this._inProgress||(i(document).bind(this._eventKey("mousemove"),i.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),i.proxy(this._onDocumentMouseUp,this)),i.fn.disableSelection&&i(document.body).disableSelection(),"onselectstart"in document&&i(document.body).bind("selectstart",this._onSelectStart))},e.prototype._detachDocEvents=function(){this._inProgress&&(i(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp),i.fn.enableSelection&&i(document.body).enableSelection(),"onselectstart"in document&&i(document.body).unbind("selectstart",this._onSelectStart))},e.prototype._getFieldByPos=function(e){var i,n,o,r,s;for(i=0,n=this._elements.length;n>i;i++)if(o=this._elements[i],r=t.grid.bounds(o.element),s=t.grid.isOver(e.y,e.x,r.top,r.left+r.width-this._gap,r.height,this._gap),s)return o;return null},e.prototype._eventKey=function(e){return t.grid.stringFormat(this._evntFormat,e)},e}();e.uiResizer=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(e){this._scope_guid="scope_"+t.grid.getUID(),this._dragEnd=!1,this.mZIndex=1e3;var i=t.grid.wijgrid.CSS;this._wijgrid=e,this._wijCSS=this._wijgrid.options.wijCSS,this._wrapHtml='<div class="'+this._wijCSS.widget+" "+i.wijgrid+" "+this._wijCSS.wijgrid+" "+this._wijCSS.content+" "+this._wijCSS.cornerAll+'"><table class="'+i.root+" "+i.table+" "+this._wijCSS.wijgridTable+'"><tr class="'+i.headerRow+" "+this._wijCSS.wijgridHeaderRow+'"></tr></table></div>'}return e.prototype.attachGroupArea=function(t){var e,n=this;i.ui.droppable&&i.ui.draggable&&t.droppable({scope:this._scope_guid,tolerance:"pointer",greedy:!0,accept:function(t){return n._wijgrid.options.allowColMoving&&(e=n._getWijFieldInstance(t))?e instanceof i.wijmo.c1groupedfield&&e.options.groupedIndex===n._wijgrid._groupedColumns().length-1?!1:!e.options.isBand&&(void 0===e.options.groupedIndex||e instanceof i.wijmo.c1groupedfield):!1},drop:function(t,i){!n._isInElement(t,i.draggable)&&(e=n._getWijFieldInstance(i.draggable))&&(n._dragEnd=!0)},over:function(e,i){var o=n._wijgrid._field("groupedWidgets").length;n._dropTargetRedirected=o>0,n._droppableWijField=o>0?n._wijgrid._field("groupedWidgets")[o-1]:t,t.data("thisDroppableWijField",n._droppableWijField)},out:function(e,i){n._droppableWijField===t.data("thisDroppableWijField")&&(n._droppableWijField=null)}})},e.prototype.attach=function(e){var n,o,r=t.grid.wijgrid.CSS,s=this;i.ui.droppable&&i.ui.draggable&&e&&(n=e.element)&&n.draggable({helper:function(o){var a;return a=e instanceof i.wijmo.c1groupedfield?n.clone():n.clone().wrap(s._wrapHtml).width(n.width()).height(n.height()).closest("."+r.wijgrid),a.addClass(r.dndHelper+" "+s._wijCSS.wijgridDndHelper).css("z-index",s.mZIndex=t.grid.getZIndex(s._wijgrid.outerDiv,1e3)),a},appendTo:"body",scope:s._scope_guid,drag:function(t,i){if(s._hideArrows(),s._droppableWijField&&!s._isInElement(t,n)){var o=s._droppableWijField.element;o||(o=s._droppableWijField),s._showArrows(o,s._getPosition(e,s._droppableWijField,t,i))}},start:function(n,o){if(s._wijgrid._canInteract()&&s._wijgrid.options.allowColMoving&&(null==s._wijgrid._UIResizer()||!s._wijgrid._UIResizer().inProgress())){var r=e.options,a=e.options.travIdx,l=e instanceof i.wijmo.c1groupedfield,h=l?"groupArea":"columns";if(l&&(r=t.grid.search(s._wijgrid.columns(),function(t){return t.options.travIdx===a}),r=r.found?r.found.options:t.grid.getColumnByTravIdx(s._wijgrid.options.columns,a).found),e._canDrag()&&s._wijgrid._trigger("columnDragging",null,{drag:r,dragSource:h}))return s._wijgrid._trigger("columnDragged",null,{drag:r,dragSource:h}),!0}return!1},stop:function(t,n){s._hideArrows();try{s._dragEnd&&(s._droppableWijField.element?s._wijgrid._handleDragnDrop(e.options.travIdx,s._droppableWijField.options.travIdx,s._getPosition(e,s._droppableWijField,t,n),e instanceof i.wijmo.c1groupedfield,s._droppableWijField instanceof i.wijmo.c1groupedfield):s._wijgrid._handleDragnDrop(e.options.travIdx,-1,"left",e instanceof i.wijmo.c1groupedfield,!0))}finally{s._droppableWijField=null,s._dragEnd=!1}}}).droppable({hoverClass:s._wijCSS.stateHover,scope:s._scope_guid,tolerance:"pointer",greedy:!0,accept:function(t){return s._wijgrid.options.allowColMoving&&n[0]!==t[0]&&(o=s._getWijFieldInstance(t))?o._canDropTo(e):!1},drop:function(t,e){(o=s._getWijFieldInstance(e.draggable))&&(s._dragEnd=!0)},over:function(t,i){s._dropTargetRedirected=!1,s._droppableWijField=e,n.data("thisDroppableWijField",s._droppableWijField)},out:function(t,i){s._droppableWijField===e.element.data("thisDroppableWijField")&&(s._droppableWijField=null)}})},e.prototype.detach=function(t){var e;t&&(e=t.element)&&(e.data("ui-draggable")&&e.draggable("destroy"),e.data("ui-droppable")&&e.droppable("destroy"))},e.prototype.dispose=function(){this._$topArrow&&(this._$topArrow.remove(),this._$topArrow=null),this._$bottomArrow&&(this._$bottomArrow.remove(),this._$bottomArrow=null)},e.prototype._getWijFieldInstance=function(e){var i=t.grid.widgetName(e);if(!i)throw"widgetName is undedined";return e.data(i)},e.prototype._showArrows=function(t,e){this._topArrow().css("z-index",this.mZIndex).show().position({my:"center",at:e+" top",of:t,collision:"none"}),this._bottomArrow().css("z-index",this.mZIndex).show().position({my:"center",at:e+" bottom",of:t,collision:"none"})},e.prototype._hideArrows=function(){this._topArrow().hide(),this._bottomArrow().hide()},e.prototype._topArrow=function(){return this._$topArrow||(this._$topArrow=i("<div />").addClass(t.grid.wijgrid.CSS.dndArrowTopContainer+" "+this._wijCSS.wijgridDndArrowTopContainer).append(i("<span />").addClass(this._wijCSS.icon+" "+this._wijCSS.iconArrowThickDown)).hide().appendTo(document.body)),this._$topArrow},e.prototype._bottomArrow=function(){return this._$bottomArrow||(this._$bottomArrow=i("<div />").addClass(t.grid.wijgrid.CSS.dndArrowBottomContainer+" "+this._wijCSS.wijgridDndArrowBottomContainer).append(i("<span />").addClass(this._wijCSS.icon+" "+this._wijCSS.iconArrowThickUp)).hide().appendTo(document.body)),this._$bottomArrow},e.prototype._isInElement=function(e,i){var n=t.grid.bounds(i,!1);return e.pageX>n.left&&e.pageX<n.left+n.width&&e.pageY>n.top&&e.pageY<n.top+n.height},e.prototype._getPosition=function(e,n,o,r){if(!n.element)return"left";if(this._dropTargetRedirected)return"right";var s=t.grid.bounds(n.element,!1),a=s.width/6,l=s.left+s.width/2,h="right",d;return o.pageX<l&&(h="left"),n instanceof i.wijmo.c1groupedfield?(e instanceof i.wijmo.c1groupedfield&&(d=n.options.groupedIndex-e.options.groupedIndex,1===Math.abs(d)&&(h=0>d?"left":"right")),h):(d=n.options.linearIdx-e.options.linearIdx,n.options.isBand&&e.options.parentIdx!==n.options.travIdx&&Math.abs(o.pageX-l)<a?"center":(e.options.parentIdx===n.options.parentIdx&&1===Math.abs(d)&&(h=0>d?"left":"right"),h))},e}();e.uiDragndrop=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(t){if(!t)throw"invalid arguments";this._wijgrid=t}return e.prototype.format=function(e,n,o,r,s,a,l){var h=t.grid.renderState,d=t.grid.rowType,c=r.type,u,p=null;0===n&&this._wijgrid._showRowHeader()&&(o=null),(c===d.groupHeader||c===d.groupFooter)&&(o=null,a&&(p=a.groupInfo)&&(o=this._wijgrid._field("leaves")[p.leafIndex])),u={$cell:e,state:s,row:r,column:o,_cellIndex:n,_purpose:p?p.purpose:void 0},s&h.rendering?this._renderingStateFormatter(u,a,l):(this._currentStateFormatter(u,s&h.current),this._selectedStateFormatter(u,s&h.selected),c!==d.header&&(s&h.current||s&h.selected?u.$cell.addClass(this._wijgrid.options.wijCSS.stateDefault):u.$cell.removeClass(this._wijgrid.options.wijCSS.stateDefault))),i.isFunction(this._wijgrid.options.cellStyleFormatter)&&this._wijgrid.options.cellStyleFormatter(u)},e.prototype._renderingStateFormatter=function(e,i,n){var o=t.grid.rowType,r,s,a=e.column,l=e.row.type,h=t.grid.wijgrid.CSS,d=this._wijgrid.options.wijCSS;switch(l){case o.header:e.$cell.addClass(h.TH+" "+d.wijgridTH);break;default:e.$cell.addClass(h.TD+" "+d.wijgridTD)}if(l&o.data&&a&&a.textAlignment)switch(a.textAlignment.toLowerCase()){case"left":e.$cell.addClass(h.cellAlignLeft+" "+d.wijgridCellAlignLeft);break;case"right":e.$cell.addClass(h.cellAlignRight+" "+d.wijgridCellAlignRight);break;case"center":e.$cell.addClass(h.cellAlignCenter+" "+d.wijgridCellAlignCenter)}if(i)for(r in i)if(i.hasOwnProperty(r)){if(s=i[r],!("groupInfo"!==r&&"colSpan"!==r&&"rowSpan"!==r||s>1))continue;"class"===r?e.$cell.addClass(s):e.$cell.attr(r,s)}if(n)for(r in n)if(n.hasOwnProperty(r)){if("paddingLeft"===r){e.$cell.children("."+h.cellContainer).css(r,n[r]);continue}e.$cell.css(r,n[r])}if(0===e._cellIndex&&this._wijgrid._showRowHeader())e.$cell.attr({role:"rowheader",scope:"row"}).addClass(d.stateDefault+" "+d.content+" "+h.rowHeader+" "+d.wijgridRowHeader);else switch(l){case o.header:e.$cell.attr({role:"columnheader",scope:"col"});break;case o.footer:e.$cell.attr({role:"columnfooter",scope:"col"});break;default:e.$cell.attr("role","gridcell")}l&o.data&&e._cellIndex>=0&&a&&(e.$cell.attr("headers",window.escape(a.headerText)),a.readOnly&&e.$cell.attr("aria-readonly",!0),a.dataIndex>=0&&e.$cell.addClass("wijdata-type-"+t.grid.getDataType(a))),(l===o.groupHeader||l===o.groupFooter)&&a&&e._purpose===t.grid.groupRowCellPurpose.aggregateCell&&e.$cell.addClass("wijdata-type-"+t.grid.getDataType(a))},e.prototype._currentStateFormatter=function(e,i){var n=t.grid.rowType,o=t.grid.wijgrid.CSS,r=this._wijgrid.options.wijCSS;i?(e.$cell.addClass(r.stateActive),e.row.type===n.header?e.$cell.addClass(o.currentHeaderCell+" "+r.wijgridCurrentHeaderCell):e.$cell.addClass(o.currentCell+" "+r.wijgridCurrentCell)):(e.$cell.removeClass(r.stateActive),e.row.type===n.header?e.$cell.removeClass(o.currentHeaderCell+" "+r.wijgridCurrentHeaderCell):e.$cell.removeClass(o.currentCell+" "+r.wijgridCurrentCell))},e.prototype._hoveredStateFormatter=function(t,e){},
e.prototype._selectedStateFormatter=function(t,e){var i=this._wijgrid.options.wijCSS;e?t.$cell.addClass(i.stateHighlight).attr("aria-selected","true"):t.$cell.removeClass(i.stateHighlight).removeAttr("aria-selected")},e}();e.cellStyleFormatterHelper=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(t){if(!t)throw"invalid arguments";this._wijgrid=t}return e.prototype.format=function(e,n,o){var r=t.grid.renderState,s=t.grid.rowType,a=e.state,l=e;a&r.rendering?this._renderingStateFormatter(l,n,o):(this._currentStateFormatter(l,0!==(a&r.current)),this._hoveredStateFormatter(l,0!==(a&r.hovered)),this._selectedStateFormatter(l,0!==(a&r.selected))),i.isFunction(this._wijgrid.options.rowStyleFormatter)&&this._wijgrid.options.rowStyleFormatter(l)},e.prototype._renderingStateFormatter=function(e,n,o){var r=t.grid.wijgrid.CSS,s=this._wijgrid.options.wijCSS,a,l=r.row+" "+s.wijgridRow+" "+s.content,h=t.grid.rowType,d;if(e.$rows.attr("role","row"),n)for(d in n)n.hasOwnProperty(d)&&("class"===d?e.$rows.addClass(n[d]):(e.$rows.attr(d,n[d]),e.$rows[0].style.height&&e.$rows.each(function(){return i.data(this,"customHeight",this.style.height),!0})));if(o)for(d in o)o.hasOwnProperty(d)&&e.$rows.css(d,o[d]);switch(e.type&~h.dataAlt){case h.header:a=r.headerRow+" "+s.wijgridHeaderRow;break;case h.data:a=l+" "+r.dataRow+" "+s.wijgridDataRow,e.type&h.dataAlt&&(a+=" "+r.altRow+" "+s.wijgridAltRow);break;case h.emptyDataRow:a=l+" "+r.emptyDataRow+" "+s.wijgridEmptyDataRow;break;case h.filter:a=r.filterRow+" "+s.wijgridFilterRow;break;case h.groupHeader:a=l+" "+r.groupHeaderRow+" "+s.wijgridGroupHeaderRow;break;case h.groupFooter:a=l+" "+r.groupFooterRow+" "+s.wijgridGroupFooterRow;break;case h.footer:a=r.footerRow+" "+s.wijgridFooterRow+" "+s.stateDefault+" "+s.stateHighlight;break;default:throw t.grid.stringFormat("unknown rowType: {0}",e.type)}e.$rows.addClass(a)},e.prototype._currentStateFormatter=function(e,n){if(this._wijgrid._showRowHeader()){var o=this._wijgrid.options.wijCSS,r=t.grid.wijgrid.CSS;n?i(e.$rows[0].cells[0]).addClass(o.stateActive+" "+r.currentRowHeaderCell+" "+o.wijgridCurrentRowHeaderCell):i(e.$rows[0].cells[0]).removeClass(o.stateActive+" "+r.currentRowHeaderCell+" "+o.wijgridCurrentRowHeaderCell)}},e.prototype._hoveredStateFormatter=function(t,e){var i=this._wijgrid.options.wijCSS;e?t.$rows.addClass(i.stateDefault+" "+i.stateHover):t.$rows.removeClass(i.stateDefault+" "+i.stateHover)},e.prototype._selectedStateFormatter=function(t,e){},e}();e.rowStyleFormatterHelper=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){"use strict";var e=jQuery,i=function(){function t(){this._sum=0,this._sum2=0,this._cntNumbers=0,this._cntStrings=0,this._cntDates=0,this._max=0,this._min=0,this._minDate=0,this._maxDate=0}return t.prototype.add=function(t){if(null!==t&&""!==t){var e,i=t instanceof Date?"datetime":typeof t;e=t.toString(),0===this._cntStrings++&&(this._minString=this._maxString=e),e<this._minString&&(this._minString=e),e>this._maxString&&(this._maxString=e),"number"===i?(0===this._cntNumbers++&&(this._min=this._max=t),this._sum+=t,this._sum2+=t*t,t<this._min&&(this._min=t),t>this._max&&(this._max=t)):"datetime"===i&&(e=t.getTime(),0===this._cntDates++&&(this._minDate=this._maxDate=e),e<this._minDate&&(this._minDate=e),e>this._maxDate&&(this._maxDate=e))}},t.prototype.getValueString=function(t){var e=t.owner;if(!this._cntNumbers||"number"!==t.dataType&&"currency"!==t.dataType){if(this._cntDates&&"datetime"===t.dataType)switch(t.aggregate){case"max":return e.toStr(t,new Date(this._maxDate));case"min":return e.toStr(t,new Date(this._minDate));case"count":return this._cntStrings+""}if(this._cntStrings)switch(t.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings+""}return""}var i=this._getValue(t.aggregate);return e.toStr(t,i)},t.prototype._getValue=function(t){switch(t){case"average":return 0===this._cntNumbers?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":return this._cntNumbers<=1?0:Math.sqrt(this._getValue("var"));case"stdPop":return this._cntNumbers<=1?0:Math.sqrt(this._getValue("varPop"));case"var":return this._cntNumbers<=1?0:this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1)return 0;var e=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-e*e}return 0},t}();t.tally=i}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(e){this._docEventsUID="wijgridfrozener"+t.grid.getUID(),this._docEventsAttached=!1,this._newStaticIndex=-1,this._staticColumnIndex=-1,this._staticRowIndex=-1,this._staticOffsetH=0,this._staticOffsetV=0,this._inProgress=!1,this._wijgrid=e,this.refresh()}return e.prototype.inProgress=function(){return this._inProgress},e.prototype.refresh=function(){this.dispose();var e=this._wijgrid.options.freezingMode;if("none"!==e){this._$outerDiv=this._wijgrid.outerDiv.find("."+t.grid.wijgrid.CSS.fixedView),this._superPanel=this._wijgrid._view()._getSuperPanel(),this._staticOffsetH=this._wijgrid._getStaticOffsetIndex(!1),this._staticOffsetV=this._wijgrid._getStaticOffsetIndex(!0),this._staticColumnIndex=this._wijgrid._getStaticIndex(!1),this._staticRowIndex=this._wijgrid._getStaticIndex(!0),this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds();var i=t.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw")),n=t.grid.bounds(this._$outerDiv);("both"===e||"columns"===e)&&("right"!==this._wijgrid.options.staticColumnsAlignment||this._staticColumnIndex>=0)&&this._createVBar(this._visibleBounds,i,n),("both"===e||"rows"===e)&&!this._wijgrid._serverSideVirtualScrolling()&&this._createHBar(this._visibleBounds,i,n)}},e.prototype.dispose=function(){this._$hBar&&(this._$hBar.remove(),this._$hBar=null),this._$vBar&&(this._$vBar.remove(),this._$vBar=null),this._$proxy&&(this._$proxy.remove(),this._$proxy=null),this._$outerDiv=null,this._superPanel=null,this._detachDocEvents()},e.prototype._createVBar=function(e,n,o){var r="right"!==this._wijgrid.options.staticColumnsAlignment,s=r?n.width+n.left:n.left-2,a=this;s<=e.left+e.width&&(this._$vBar=i("<div><div></div></div>").addClass(t.grid.wijgrid.CSS.freezingHandleV+" "+this._wijgrid.options.wijCSS.wijgridFreezingHandleV).addClass(r?"":"not-allowed").css({left:s-o.left,top:n.top-o.top,height:e.height+e.top-n.top}).bind("mousedown",function(t){t.data=!0,a._onBarMouseDown.apply(a,arguments)}).appendTo(this._$outerDiv),this._$vBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:0,height:"100%"}))},e.prototype._createHBar=function(e,n,o){var r=n.top+n.height,s="right"!==this._wijgrid.options.staticColumnsAlignment,a=this;r<=e.top+e.height&&(this._$hBar=i("<div><div></div></div>").addClass(t.grid.wijgrid.CSS.freezingHandleH+" "+this._wijgrid.options.wijCSS.wijgridFreezingHandleH).css({left:s?n.left-o.left:0,top:r-o.top,width:s?e.width+e.left-n.left:e.width}).bind("mousedown",function(t){t.data=!1,a._onBarMouseDown.apply(a,arguments)}).appendTo(this._$outerDiv),this._$hBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:"100%",height:0}))},e.prototype._onBarMouseDown=function(e){if(this._wijgrid.options.disabled||"right"===this._wijgrid.options.staticColumnsAlignment&&e.data)return!1;var n=t.grid.wijgrid.CSS,o=this._wijgrid.options.wijCSS;this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds(),this._newStaticIndex=e.data?this._staticColumnIndex:this._staticRowIndex,this._$proxy=i('<div class="'+n.resizingHandle+" "+o.wijgridResizingHandle+" "+o.header+'"></div>').appendTo(document.body),this._attachDocEvents(e.data),this._inProgress=!0,e.stopPropagation()},e.prototype._onDocumentMouseMove=function(t){t.data&&this._superPanel.options.hScroller.scrollValue?this._superPanel.hScrollTo(0):!t.data&&this._superPanel.options.vScroller.scrollValue&&this._superPanel.vScrollTo(0),this._showPosition(t)},e.prototype._onDocumentMouseUp=function(t){try{this._$proxy&&this._$proxy.remove(),this._detachDocEvents(),t.data?this._newStaticIndex!==this._staticColumnIndex&&this._wijgrid.option("staticColumnIndex",this._newStaticIndex):this._newStaticIndex!==this._staticRowIndex&&this._wijgrid.option("staticRowIndex",this._newStaticIndex)}finally{this._$proxy=null,this._inProgress=!1}},e.prototype._attachDocEvents=function(t){if(!this._docEventsAttached)try{i.fn.disableSelection&&i(document.body).disableSelection(),this._wijgrid._view().toggleDOMSelection(!1),i(document).bind(this._docEventKey("mousemove"),t,i.proxy(this._onDocumentMouseMove,this)).bind(this._docEventKey("mouseup"),t,i.proxy(this._onDocumentMouseUp,this))}finally{this._docEventsAttached=!0}},e.prototype._detachDocEvents=function(){if(this._docEventsAttached)try{i.fn.enableSelection&&i(document.body).enableSelection(),this._wijgrid._view().toggleDOMSelection(!0),i(document).unbind("."+this._docEventsUID)}finally{this._docEventsAttached=!1}},e.prototype._docEventKey=function(e){return t.grid.stringFormat("{0}.{1}",e,this._docEventsUID)},e.prototype._showPosition=function(e){var i,n,o,r,s,a,l,h,d="right"!==this._wijgrid.options.staticColumnsAlignment;if(e.data){if(h=t.grid.bounds(this._$vBar),Math.abs(e.pageX-(h.left+h.width/2))<h.width)return void this._$proxy.hide();if(i=this._getFieldByPos({x:e.pageX,y:e.pageY})){if(n=t.grid.bounds(i.element),o=n.left+n.width/2,r=i.options.visLeavesIdx-this._staticOffsetV,s=Math.max(r-1,-1),a=e.pageX<o?s!==this._staticColumnIndex:r===this._staticColumnIndex,l=a?n.left:n.left+n.width,!t.grid.isOverAxis(l,this._visibleBounds.left-1,this._visibleBounds.width+2))return;this._newStaticIndex=a?s:r,this._$proxy.show().css({left:l,top:n.top,width:3,height:this._visibleBounds.height+this._visibleBounds.top-n.top})}}else{if(h=t.grid.bounds(this._$hBar),Math.abs(e.pageY-(h.top+h.height/2))<h.height)return void this._$proxy.hide();if(i=this._getRowByPos({x:e.pageX,y:e.pageY})){if(n=t.grid.bounds(i),o=n.top+n.height/2,r=this._wijgrid._view().getAbsoluteRowIndex(i)-this._staticOffsetH,s=Math.max(r-1,-1),a=e.pageY<o?s!==this._staticRowIndex:r===this._staticRowIndex,l=a?n.top:n.top+n.height,!t.grid.isOverAxis(l,this._visibleBounds.top-1,this._visibleBounds.height+2))return;this._newStaticIndex=a?s:r,this._$proxy.show().css({left:d?n.left:this._visibleBounds.left,top:l,width:d?this._visibleBounds.width+this._visibleBounds.left-n.left:this._visibleBounds.width,height:3})}}},e.prototype._getFieldByPos=function(e){var i=this._wijgrid.columns(),n,o,r,s,a;for(n=0,o=i.length;o>n;n++)if(r=i[n],s=r.options,s.isLeaf&&(a=t.grid.bounds(r.element),t.grid.isOverAxis(e.x,a.left,a.width)))return r;return null},e.prototype._getRowByPos=function(e){var n=this._wijgrid._rows(),o,r,s,a;for(o=0,r=n.length();r>o;o++)if(s=n.item(o)[0],a=t.grid.bounds(i(s)),t.grid.isOverAxis(e.y,a.top,a.height))return s;return null},e}();e.uiFrozener=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(){function e(){}return e.generate=function(i,n,o){switch(i){case"append":e._processAppendMode(n,o);break;case"merge":e._processMergeMode(n,o);break;case"none":break;default:throw t.grid.stringFormat('Unsupported value: "{0}"',i)}},e._processAppendMode=function(n,o){var r={};t.grid.traverse(o,function(e){e.dynamic&&t.grid.validDataKey(e.dataKey)&&(r[e.dataKey]=!0)}),i.each(n,function(t,i){if("name"in i&&!r[i.name]){var n=e._createAutoField(i);o.push(n)}})},e._processMergeMode=function(n,o){var r=[],s;t.grid.traverse(o,function(e){if(e.isLeaf&&!e.isBand){var i=e.dataKey;t.grid.validDataKey(i)?void 0!==n[i]&&delete n[i]:null!==i&&r.push(e)}}),r.length&&(s=0,i.each(n,function(t,e){var i=r[s++];i&&(i.dataKey=e.name,delete n[t])})),i.each(n,function(t,i){var n=e._createAutoField(i);o.push(n)})},e._createAutoField=function(e){return t.grid.createDynamicField({dataKey:e.name})},e}();e.columnsGenerator=n}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){"use strict";var e=jQuery,i=function(){function t(t,e,i,n){this._timer=0,this._timeout=50,this._ignoreScrollEvents=!1,this._debounceScrolledEvent=!0,this._wijgrid=t,this._$content=e,this._view=this._wijgrid._view(),this._N=this._wijgrid._renderableRowsCount(),this._rowOuterHeight=n,this._updateContentHeight();var o=this._wijgrid.outerDiv.height()+this._N*this._rowOuterHeight;this._view._splitAreas.sw.height(o)}return t.prototype.scrollTo=function(t,e){this._debounceScrolledEvent=!1,this._completeListener=e,this._panelInst.vScrollTo(t*this._panelInst.options.vScroller.scrollSmallChange,!0)},t.prototype._updateContentHeight=function(){this._$content.height(this._rowOuterHeight*this._N)},t.prototype.attach=function(t){this._$scroller=t,this._panelInst=t.data("wijmo-wijsuperpanel"),this._updateContentHeight(),this._updateVerticalScroller(),t.bind("wijsuperpanelscrolled.wijgrid",e.proxy(this._onSuperpanelScrolled,this)),t.bind("wijsuperpanelscrolling.wijgrid",e.proxy(this._onSuperpanelScrolling,this)),t.bind("wijsuperpanelscrolled.wijgrid",e.proxy(this._onSuperpanelPostScrolled,this))},t.prototype._updateVerticalScroller=function(){var t=Math.max(0,this._N-(this._view.getVirtualPageSize()-1));this._setVerticalScrollerOptions(1,t)},t.prototype._setVerticalScrollerOptions=function(t,e){var i=this._panelInst.options.vScroller;i.scrollSmallChange=t,i.scrollLargeChange=4*t,e+=i.scrollLargeChange-1,i.scrollMax=e,this._panelInst.option("vScroller",i)},t.prototype._changeVisibleRowsCount=function(t){this._N=t,this._updateContentHeight(),this._updateVerticalScroller()},t.prototype.dispose=function(){this._$scroller.unbind(".wijgrid"),this._clearTimer()},t.prototype._clearTimer=function(){window.clearTimeout(this._timer),this._timer=0},t.prototype._onSuperpanelScrolling=function(t,e){return this._ignoreScrollEvents||"v"!==e.dir?void 0:-1===this._timer?!1:void 0},t.prototype._onSuperpanelScrolled=function(t,i){var n=this;this._ignoreScrollEvents||"v"!==i.dir||(this._timer>0&&this._clearTimer(),-1!==this._timer&&(this._timer=window.setTimeout(function(){n._timer=-1;var t=Math.floor(i.newValue/n._panelInst.options.vScroller.scrollSmallChange),o=n._view._bounds.start;0>t&&(t=0),t>=n._N&&(t=n._N-1),t!==o?(n._debounceScrolledEvent=!0,n._wijgrid._handleVirtualScrolling(t,null,e.proxy(n._scrollingCompleted,n))):(n._debounceScrolledEvent=!0,n._log(),n._clearTimer())},this._debounceScrolledEvent?this._timeout:0)))},t.prototype._scrollingCompleted=function(t){this._wijgrid._trackScrollingIndex(t),this._log(),this._completeListener&&(this._completeListener(),this._completeListener=null),this._clearTimer()},t.prototype._onSuperpanelPostScrolled=function(){e.isFunction(this._postScrolled)&&this._postScrolled.apply(this,arguments)},t.prototype._log=function(){},t}();t.uiVirtualScroller=i}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){var e=function(){function t(t){this._items=[],this._capacity=null,this._maxRowIndex=t}return t.prototype.add=function(t){this._capacity=null;var e=this._items.length,i;if(!e||(i=this._items[e-1]).end<t.start)e&&t.start-i.end===1?i.end=t.end:this._items.push(t);else{var n=this._binSearchByStartVal(t.start),o=this._binSearchByEndVal(t.end),r=0>n?~n:n,s=0>o?~o:o,a=n>=0||r>0&&t.start<=this._items[r-1].end,l=o>=0||e>s&&t.end<=this._items[s].end&&t.end>=this._items[s].start,h;a?l?n>=0?(this._items[s].start=this._items[r].start,(h=s-r)&&this._items.splice(r,h)):(this._items[s].start=this._items[r-1].start,(h=s-r+1)&&this._items.splice(r-1,h)):n>=0?(this._items[r].end=t.end,(h=s-r-1)&&this._items.splice(r,h)):(this._items[r-1].end=t.end,(h=s-r)&&this._items.splice(r,h)):l?(this._items[s].start=t.start,(h=s-r)&&this._items.splice(r,h)):this._items.splice(r,s-r,t)}},t.prototype.remove=function(t){this._capacity=null;var e=this._items.length;if(e){var i=this._binSearchByStartVal(t.start),n=this._binSearchByEndVal(t.end),o=0>i?~i:i,r=0>n?~n:n,s=i>=0||o>0&&t.start<=this._items[o-1].end,a=n>=0||e>r&&t.end<=this._items[r].end&&t.end>=this._items[r].start;if(s)if(a){var l=i>=0?i:o-1,h=n>=0?n:r;if(i>=0&&n>=0)this._items.splice(o,r-o+1);else if(i>=0)this._items[r].start=t.end+1,this._items.splice(o,r-o);else if(n>=0)l===h?this._items[o-1].end=t.start-1:(this._items[o].end=t.start-1,this._items.splice(o,r-o+1));else if(l===h){var d=this._items[o-1].end;this._items[o-1].end=t.start-1,this._items.splice(o,0,{start:t.end+1,end:d})}else this._items[o-1].end=t.start-1,this._items[r].start=t.end+1,this._items.splice(o,r-o)}else i>=0?this._items.splice(o,r-o):(this._items[o].end=t.start-1,this._items.splice(o,r-o-1));else a?n>=0?this._items.splice(o,r-o+1):(this._items[r].start=t.end+1,this._items.splice(o,r-o)):this._items.splice(o,r-o)}},t.prototype.clear=function(){this._capacity=0,this._items=[]},t.prototype.item=function(t){return this._items[t]},t.prototype.forEachIndex=function(t,e,i){if(!(0>t)){var n=this._items.length,o=this._getIteratorStateFor(t),r=0,s=!0,a=!1;if(o)for(var l=o.j,h=o.i;n>h&&!a;h++){var d=this._items[h];for(s||(l=d.start),l;l<=d.end&&!a;l++){if(++r>e&&-1!==e)return;a=i(l)===!1}s=!1}}},t.prototype.forEachIndexBackward=function(t,e,i){if(!(0>t)){var n=this._items.length,o=this._getIteratorStateFor(t),r=0,s=!0,a=!1;if(o)for(var l=o.j,h=o.i;h>=0&&!a;h--){var d=this._items[h];for(s||(l=d.end),l;l>=d.start&&!a;l--){if(++r>e&&-1!==e)return;a=i(l)===!1}s=!1}}},t.prototype._getIteratorStateFor=function(t){for(var e=this._items.length,i=0,n=0;e>n;n++){var o=this._items[n];i+=o.end-o.start+1;var r=i-t;if(r>=0)return{i:n,j:o.end-r+1}}return null},t.prototype.getAbsIndex=function(t){for(var e=0,i=this._items.length;i>e;e++){var n=this._items[e],o=n.end-n.start;if(o>=t)return n.start+t;t-=o+1}return-1},t.prototype.getRenderedIndex=function(t){var e=this.hasAbsIndex(t);if(e>=0){for(var i=0,n=0;e>n;n++){var o=this._items[n];i+=o.end-o.start+1}return i+(t-this._items[e].start)}return-1},t.prototype.hasAbsIndex=function(t){if(this._items.length){var e=this._binSearchByStartVal(t);if(e>=0)return e;if(e=~e,e>0&&t<=this._items[e-1].end)return e-1}return-1},t.prototype.length=function(){return this._items.length},t.prototype.capacity=function(){if(null===this._capacity){for(var t=0,e=0,i=this._items.length;i>e;e++){var n=this._items[e];t+=n.end-n.start+1}this._capacity=t}return this._capacity},t.prototype.truncate=function(t,e){this.truncateByStart(t),this.truncateByStart(e)},t.prototype.truncateByCount=function(t){var e=0;if(0===t)this._items=[];else for(var i=0,n=this._items.length;n>i;i++){var o=this._items[i];if(e+=o.end-o.start+1,e>=t){e>t&&(o.end-=e-t),this._items.splice(i+1,this._items.length-(i+1));break}}},t.prototype.truncateByStart=function(t,e){var i=this._binSearchByStartVal(t),n=this._items.length;0>i?(i=~i,n>i?i>0&&this._items[i-1].end>=t?(this._items[i-1].start=t,this._items.splice(0,i-1)):(e&&(this._items[i].start=t),this._items.splice(0,i)):this._items=[]):this._items.splice(0,i)},t.prototype.truncateByEnd=function(t,e){var i=this._binSearchByEndVal(t),n=this._items.length;0>i?(i=~i,n>i?(this._items[i].end=t,this._items.splice(i+1,this._items.length-i+1)):this._items=[]):this._items.splice(i+1,this._items.length-i+1)},t.prototype.deleteFromTop=function(t){var e=0,i=0;for(e=0;e<this._items.length;e++){var n=this._items[e];if(i+=n.end-n.start+1,i>=t)break}i>=t&&(this._items[e].start=i-t+1),this._items.splice(0,e)},t.prototype.deleteFromBottom=function(t){var e=0,i=0;for(e=this._items.length-1;e>=0;e--){var n=this._items[e];if(i+=n.end-n.start+1,i>=t)break}i>=t&&(this._items[e].start=i-t+1),this._items.splice(e,this._items.length-e)},t.prototype._binSearchByStartVal=function(t){for(var e=0,i=this._items.length-1;i>=e;){var n=i+e>>1,o=this._items[n].start-t;if(0===o)return n;0>o?e=n+1:i=n-1}return~e},t.prototype._binSearchByEndVal=function(t){for(var e=0,i=this._items.length-1;i>=e;){var n=i+e>>1,o=this._items[n].end-t;if(0>o)e=n+1;else{if(!o)return n;i=n-1}}return~e},t}();t.renderBoundsCollection=e}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){function e(e,i,o,r){function s(i){return r.parser=r.parser||t.defaultParsers[i],!r.parser&&null!=e&&t.errors.noParser(i),r.parser}var a=e;if(r=n.extend({nullString:"",format:""},r),i=i||null!=e&&typeof e,o=o||i,!o)return e;if("string"==o)return s(i),r.parser?r.parser.toStr(e,r.culture,r.format,r.nullString,!0):e;if(s(o),!r.parser)return e;if(e=r.parser.parse(e,r.culture,r.format,r.nullString,!0),isNaN(e)&&null!=e&&t.util.isNumeric(e)){if(r.ignoreError)return a;t.errors.cantConvert(o,a)}return e}function i(e){return function(){return o||t.util.logError(t.errors.noGlobalize.create().message),e.apply(this,arguments)}}var n=jQuery,o=Globalize;t.convert=e,t.defaultParsers={string:{parse:function(t,e,i,n,o){switch(t){case null:return null;case n:if(o)return null;case void 0:case"&nbsp":return"";default:return""+t}},toStr:function(t,e,i,n,o){return null===t&&o?n:""+t}},number:{parse:function(t,e,i,n,r){var s=typeof t;return"number"===s?isNaN(t)?NaN:t:!t&&0!==t||"&nbsp;"===t||t===n&&r?null:o.parseFloat(t,10,e.name)},toStr:function(t,e,i,n,r){return null===t&&r?n:o.format(t,i||"n",e.name)}},currency:{parse:function(t,e,i,n,r){var s=typeof t;return"number"===s?isNaN(t)?NaN:t:!t&&0!==t||"&nbsp;"===t||t===n&&r?null:("string"===s&&(t=t.replace(e.numberFormat.currency.symbol,"")),o.parseFloat(t,10,e.name))},toStr:function(t,e,i,n,r){return null===t&&r?n:o.format(t,i||"c",e.name)}},datetime:{parse:function(t,e,i,n,r){var s;if(t instanceof Date)return t;if(!t||"&nbsp;"===t||t===n&&r)return null;if(s=/^\/Date\((\d+)\)\/$/.exec(t))return new Date(parseInt(s[1],10));var a=o.parseDate(t,i,e.name);return(null==a||isNaN(a))&&(a=Date.parse(t),a=isNaN(a)?NaN:new Date(a)),a},toStr:function(t,e,i,n,r){return null===t&&r?n:o.format(t,i||"d",e.name)}},"boolean":{parse:function(t,e,i,o,r){var s=typeof t;if("number"===s)return 0!=t;if("boolean"===s)return t;if("string"===s&&(t=n.trim(t)),!t||"&nbsp;"===t||t===o&&r)return null;switch(t.toLowerCase()){case"true":return!0;case"false":return!1}return NaN},toStr:function(t,e,i,n,o){return null===t&&o?n:t?"true":"false"}}},n.each(t.defaultParsers,function(t,e){e.parse=e.parse&&i(e.parse),e.toStr=e.toStr&&i(e.toStr)})}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){!function(e){!function(i){function n(n){function o(n){var r=[];if(0===n.length)return r;var s=i.Connective.AND;return t.util.each(n,function(n,a){if(0==n&&t.util.isString(a)){var l=a.toLowerCase();if(l==i.Connective.AND||l==i.Connective.OR)return void(s=l)}if($.isArray(a)){if(a=o(a),!a)return;if(a[0]===s||2==a.length)return a.shift(),void(r=r.concat(a))}else{var h=e.normalizeCondition(a);if(!h)return;h.property=a.property,a=h}r.push(a)}),0==r.length?null:(r.unshift(s),r)}return o(n)}function o(e){if(!$.isArray(e))return null;var o={isEmpty:!0,original:e,normalized:n(e),func:null};return null==o.normalized?o.func=function(t){return!0}:(o.isEmpty=!1,o.func=function(e){function n(o){var r=o[0]===i.Connective.AND,s=r?t.util.every:t.util.some;return s(o,function(i,o){if(0===o)return r;if($.isArray(i))return n(i);var s=t.util.getProperty(e,i.property);return i.op.apply(s,i.value)})}return n(o.normalized)}),o}function r(e){return o(e)||t.filtering.compile(e)}i.Connective={AND:"and",OR:"or"},i.compile=r}(e.extended||(e.extended={}));var i=e.extended}(t.filtering||(t.filtering={}));var e=t.filtering}(t.data||(t.data={}));var e=t.data}(wijmo||(wijmo={}));var wijmo;!function(t){!function(e){var i=jQuery,n=t.data,o=n.filtering.extended,r=function(){function t(t){this.real=t,this._updatingFilter=!1,this._overrideFilter(),this._makeMemberProxies()}return t.prototype._overrideFilter=function(){var t=this;this.filter=n.observable(this.real.filter()),this.filter.subscribe(function(e){t.real.filter()!==e&&!t._updatingFilter&&t.refresh({filter:e})}),this.real.filter.subscribe(function(e){e!==t._lastSetFilter&&t.filter(e)})},t.prototype.refresh=function(t,e){"undefined"==typeof e&&(e=!1),t=i.extend({},t);var n=t.filter;t.filter=this._coerceFilter(t.filter),this._lastSetFilter=t.filter,this._updatingFilter=!0;try{i.isFunction(t.filter)&&!i.isFunction(n)?this.filter(n):this.filter(t.filter)}finally{this._updatingFilter=!1}return this.real.refresh(t,e)},t.prototype._makeMemberProxies=function(){var t=this;n.util.each(this.real,function(e,n){i.isFunction(n)&&!t[e]&&"_"!==e.charAt(0)&&(t[e]=i.isFunction(n.subscribe)?n:function(){return n.apply(t.real,arguments)})})},t.create=function(e){return new t(e)},t.prototype._convertComplexPropertyFilterToExtendedFilterFormat=function(t){var e=[];return i.each(t,function(t,r){if(i.isArray(r)){var s=n.util.isString(r[0])&&r[0].toLowerCase();if(s===o.Connective.AND||s===o.Connective.OR)return void e.push(r)}else r=[r];var a=[];i.each(r,function(e,i){var o=n.filtering.normalizeCondition(i);o&&(o.property=t,a.push(o))}),a.length>0&&e.push(a)}),e.length>0?e:null},t.prototype._coerceFilter=function(t){if(i.isArray(t))return o.compile(t).func;if(!i.isPlainObject(t))return t;t=i.extend(!0,{},t);var e={};if(i.each(t,function(o,r){if(i.isArray(r)||(r=[r]),e){var s=n.util.isString(r[0])&&r[0].toLowerCase();if(1==r.length||2==r.length&&("and"===s||"or"===s))return void(e[o]=r[r.length-1])}t[o]=r,e=null}),e)return e;var r=this._convertComplexPropertyFilterToExtendedFilterFormat(t);return o.compile(r).func},t.prototype._unsafeReplace=function(t,e){this.real.sourceArray[t]=e,this.real.local[t]=e},t.prototype._unsafeSplice=function(t,e,i){2===arguments.length?(this.real.sourceArray.splice(t,e),this.real.local.splice(t,e)):(this.real.sourceArray.splice(t,e,i),this.real.local.splice(t,e,i))},t.prototype._unsafePush=function(t){this.real.sourceArray.push(t),this.real.local.push(t)},t}();e.GridDataView=r}(t.grid||(t.grid={}));var e=t.grid}(wijmo||(wijmo={}));var wijmo;!function(t){var e=jQuery,i=function(){function t(){}return t.prototype.round=function(t,e){if(!t)return 0;var i=Math.pow(10,e||2);return Math.round(t*i)/i},t.prototype.toOADate=function(t){var e=864e5,i=t-new Date(1900,0,1)+2*e;return i},t.prototype.fromOADate=function(t){var e=864e5,i=new Date(t-2*e+new Date(1900,0,1).getTime());return i},t.prototype.arrayClone=function(t){var i=[];return e.each(t,function(t,n){i.push(e.extend(!0,{},n))}),i},t}(),n=function(){function t(){}return t.prototype.isSVGElem=function(t){var e="http://www.w3.org/2000/svg";return 1===t.nodeType&&t.namespaceURI===e},t.prototype.addClass=function(t,i){i=i||"";var n=this;e.each(t,function(){if(n.isSVGElem(this)){var t=this;e.each(i.split(/\s+/),function(i,n){var o=t.className?t.className.baseVal:t.getAttribute("class");-1===e.inArray(n,o.split(/\s+/))&&(o+=(o?" ":"")+n,t.className?t.className.baseVal=o:t.setAttribute("class",o))})}else e(this).addClass(i)})},t.prototype.clearRaphaelCache=function(){},t.prototype.getPositionByAngle=function(t,e,i,n){var o={x:0,y:0},r=Raphael.rad(n);return o.x=t+i*Math.cos(-1*r),o.y=e+i*Math.sin(-1*r),o},t.prototype.hasClass=function(t,i){if(!i||0===i.length)return!1;if(this.isSVGElem(t)){var n=t.className?t.className.baseVal:t.getAttribute("class"),o=!1;return e.each(n.split(/\s+/),function(t,e){return e===i?(o=!0,!1):void 0}),o}return e(t).hasClass(i)},t.prototype.sector=function(t,e,i,n,o){var r=this.getPositionByAngle(t,e,i,n),s=this.getPositionByAngle(t,e,i,o);return["M",t,e,"L",r.x,r.y,"A",i,i,0,+(o-n>180),0,s.x,s.y,"z"]},t}();e.extend(i.prototype),e.extend({wijraphael:n.prototype});var o="[\\x20\\t\\r\\n\\f]",r=e.expr.filter.CLASS,s=function(t,e){var i=t.split("."),n=e.split("."),o=Math.max(i.length,n.length),r=0,s,a,l;for(s=0;o>s;s++){if(a=i[s]?parseInt(i[s]):0,l=n[s]?parseInt(n[s]):0,a>l){r=1;break}if(l>a){r=-1;break}}return r};e.expr.filter.CLASS=function(t,i){if(s(e.fn.jquery,"1.8")<0){var n=e.wijraphael&&e.wijraphael.isSVGElem(t)?t.className?t.className.baseVal:t.getAttribute("class"):t.className;return(" "+n+" ").indexOf(i)>-1}var r=new RegExp("(^|"+o+")"+t+"("+o+"|$)");return function(t){var i=e.wijraphael&&e.wijraphael.isSVGElem(t)?t.className?t.className.baseVal:t.getAttribute("class"):t.className;return r.test(i)}},s(e.fn.jquery,"1.8")<0&&(e.expr.preFilter.CLASS=function(t,i,n,o,r,s){var a=0,l=null,h=null;if(t=" "+t[1].replace(/\\/g,"")+" ",s)return t;for(a=0,l={};l;a++){if(l=i[a],!l)try{l=i.item(a)}catch(d){}l&&(h=e.wijraphael&&e.wijraphael.isSVGElem(l)?(l.className?l.className.baseVal:"")||l.getAttribute("class"):l.className,r^(h&&(" "+h+" ").indexOf(t)>-1)?n||o.push(l):n&&(i[a]=!1))}return!1}),Raphael.fn.tri=function(t,e,i){var n=t,o=e-i,r=Math.cos(30*Math.PI/180)*i,s=Math.tan(60*Math.PI/180)*r,a=t+r,l=e+s,h=t-r,d=e+s,c=["M",n.toString(),o.toString(),"L",a.toString(),l.toString(),"L",h.toString(),d.toString(),"z"];return this.path(c.join(" "))},Raphael.fn.invertedTri=function(t,e,i){var n=t,o=e+i,r=Math.cos(30*Math.PI/180)*i,s=Math.tan(60*Math.PI/180)*r,a=t+r,l=e-s,h=t-r,d=e-s,c=["M",n.toString(),o.toString(),"L",a.toString(),l.toString(),"L",h.toString(),d.toString(),"z"];return this.path(c.join(" "))},Raphael.fn.box=function(t,e,i){var n=Math.cos(45*Math.PI/180)*i,o=["M",t-n,e-n,"L",t+n,e-n,"L",t+n,e+n,"L",t-n,e+n,"z"];return this.path(o.join(" "))},Raphael.fn.diamond=function(t,e,i){var n=["M",t,e-i,"L",t+i,e,"L",t,e+i,"L",t-i,e,"z"];return this.path(n.join(" "))},Raphael.fn.cross=function(t,e,i){var n=Math.cos(45*Math.PI/180)*i,o=["M",t-n,e-n,"L",t+n,e+n,"M",t-n,e+n,"L",t+n,e-n];return this.path(o.join(" "))},Raphael.fn.paintMarker=function(t,e,i,n){var o=this,r=null;switch(t||(t="circle"),t){case"circle":r=o.circle(e,i,n);break;case"tri":r=o.tri(e,i,n);break;case"invertedTri":r=o.invertedTri(e,i,n);break;case"box":r=o.box(e,i,n);break;case"diamond":r=o.diamond(e,i,n);break;case"cross":r=o.cross(e,i,n)}return r},Raphael.fn.htmlText=function(t,i,n,o,r,s){var a=function(t,e,i){var n=/<(b|strong)>/,o=/<(i|em)>/,r=/href=[\"\']([^\"\']+)[\"\']/,s=/<a/;i&&t.attr(i),n.test(e)&&t.attr("font-weight","bold"),o.test(e)&&t.attr("font-style","italic"),s.test(e)&&e.match(r)[1]&&t.attr("href",e.match(r)[1])},l=n.toString().split(/<br\s?\/>|\\r/i),h=this,d=h.set(),c=0,u=0;return r=r||3,s=s||5,e.each(l,function(t,i){var n=0,l=i.split("|||");i=i.replace(/<([A-Za-z]+(.|\n)*?)>/g,"|||<$1>").replace(/<\/([A-Za-z]*)>/g,"</$1>|||"),e.each(l,function(t,i){var s=null,l=null,p=0,g,f=0;""!==i&&(s=i,s=e.trim(s.replace(/<(.|\n)*?>/g,"")),g=h.text(0,0,s),a(g,i,o),l=g.wijGetBBox(),p=l.width/2+c,f=-l.height/2+u,c=c+l.width+r,g.translate(p,f),d.push(g),n<l.height&&(n=l.height))}),u+=n+s,c=n=0}),u=0,d.transform(Raphael.format("...t{0},{1}",t-d.getBBox().x,i-d.getBBox().y)),d},Raphael.fn.line=function(t,e,i,n){return this.path(["M",t.toString(),e.toString(),"L",i.toString(),n.toString()])},Raphael.fn.roundRect=function(t,i,n,o,r,s,a,l){var h=[],d=[-1,1,1,1,1,-1,-1,-1],c=["v","h","v","h"],u=null,p=null;return e.each([r,s,a,l],function(t,e){h="number"==typeof e?h.concat([{x:e,y:e}]):"object"==typeof e?h.concat(e):h.concat([{x:0,y:0}])}),u=["M",t+h[0].x,i],p=[o-h[0].y-h[1].y,n-h[1].x-h[2].x,h[2].y+h[3].y-o,h[3].x+h[0].x-n],e.each(h,function(t,e){e.x&&e.y&&(u=u.concat("a",e.x,e.y,0,0,0,d[2*t]*e.x,d[2*t+1]*e.y)),u=u.concat(c[t],p[t])}),u.push("z"),this.path(u)},Raphael.fn.wrapText=function(t,i,n,o,r,s){function a(t,e,i){for(var n=null,o=null,r=t.toString().split(" "),s=[],a=[],h="";r.length;)h+=" "+r[0],n=l.text(-1e3,-1e3,h),n.attr(i),o=n.wijGetBBox(),o.width>e?(a.length&&(s.push(a),h=r[0]),a=[r.shift()]):a.push(r.shift()),0===r.length&&s.push(a),n.wijRemove(),n=null;return s}var l=this,h=s.rotation,d=h?e.extend(!0,{},s,{rotation:0}):s,c=i,u=l.set(),p=null,g=null,f=[];return"undefined"==typeof n&&(n=""),e.each(a(n,o,d),function(e,i){var n=i.join(" "),s=r||"near",a=l.text(t,c,n),g=0,m=0;
switch(a.attr(d),p=a.wijGetBBox(),s){case"near":g=o-p.width/2;break;case"center":g+=o/2;break;case"far":g+=p.width/2}h?(m+=p.height/2/Math.abs(Math.sin(h)),c+=p.height/Math.abs(Math.sin(h))):(m+=p.height/2,c+=p.height),p.x+=g,p.y+=m,h?a.attr({x:a.attr("x")+g,y:a.attr("y")+m}):a.transform(Raphael.format("...T{0},{1}",g,m)),u.push(a),f.push(p)}),h&&(p=u.wijGetBBox(),u.length>1?(e.each(u,function(t,e){e.attr({y:e.attr("y")-p.height/2}),f[t].y-=p.height/2}),g={x:p.x+p.width/2,y:p.y+p.height/2},e.each(u,function(t,i){var n=Math,o=f[t],r={x:o.x+o.width/2,y:o.y+o.height/2},s=n.sqrt(n.pow(r.x-g.x,2)+n.pow(r.y-g.y,2)),a=0,l=null,d=null;return i.attr({rotation:h}),0===s?!0:(l=i.wijGetBBox(),a=Raphael.deg(n.asin(n.abs(r.y-g.y)/s)),r.y>g.y?r.x>g.x?a-=360:a=-1*(a+180):r.x>g.x?a*=-1:a=-1*(180-a),d=e.wijraphael.getPositionByAngle(g.x,g.y,s,-1*(h+a)),i.attr({y:i.attr("y")+d.y-l.y-l.height/2}),void 0)})):u[0].transform(Raphael.format("...R{0}",h))),u},Raphael.fn.getSVG=function(){function t(t,i){var n="<"+t+" ",o=null,r=!1;return e.each(i,function(t,e){return"text"===t||"opacity"===t||"transform"===t||"path"===t||"w"===t||"h"===t||"translation"===t?!0:void(e&&("stroke"===t&&0===e&&(e="none"),n+=t+"='"+e+"' "))}),i.opacity&&(o=i.opacity,n+="opacity='"+o+"' style='opacity:"+o+";",r=!0),i.transform&&i.transform.length>0&&(o=i.transform,r?n+="transform:"+o:(n+="style='transform:"+o,r=!0)),r&&(n+="'"),i.text?(o=i.text,n+="><tspan>"+o+"</tspan>"):n+=">",n+="</"+t+">"}var i=this,n='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+i.canvas.offsetWidth+'" height="'+i.canvas.offsetHeight+'"><desc>Created with Raphael</desc><defs></defs>',o,r="",s,a,l,h=0,d=0,c=0,u=0;for(o=i.bottom;o;o=o.next)if(o&&o.type)switch(o.type){case"path":for(h=0,d=o.attrs.path.length;d>h;h++)for(a=o.attrs.path[h],c=0,u=a.length;u>c;c++)l=a[c],r+=1>c?l:c===u-1?l:l+",";r&&r.length>0&&(o.attrs.d=r.replace(/,/g," "));break;case"text":o.attrs["text-anchor"]||(o.attrs["text-anchor"]="middle");break;case"image":s=o.transformations,o.attrs.transform=s?s.join(" "):"";break;case"ellipse":case"rect":n+=t(o.type,o.attrs)}return n+="</svg>"},Raphael.el.wijRemove=function(){var t=this,i;t.removed||t.node.parentNode&&(i=e(t.node),t.stop().remove(),i.remove())},Raphael.el.wijGetBBox=function(){return this.getBBox()},Raphael.el.wijAnimate=function(t,i,n,o){if(t&&!e.isEmptyObject(t)){var r=this.shadow,s=0,a={easeInCubic:">",easeOutCubic:"<",easeInOutCubic:"<>",easeInBack:"backIn",easeOutBack:"backOut",easeOutElastic:"elastic",easeOutBounce:"bounce"};a[n]&&(n=a[n]),this.animate(t,i,n,o),a=null,r&&r.offset&&(s=r.offset,t.x&&(t.x+=s),t.y&&(t.y+=s),this.shadow.animate(t,i,n,o))}},Raphael.el.wijAttr=function(t,i){if(this.attr(t,i),this.shadow)if("object"==typeof t){var n=e.extend(!0,{},t);n.fill&&delete n.fill,n.stroke&&delete n.stroke,n["stroke-width"]&&delete n["stroke-width"],this.shadow.attr(n,i)}else if("string"==typeof t)switch(t){case"clip-rect":case"cx":case"cy":case"fill-opacity":case"font":case"font-family":case"font-size":case"font-weight":case"height":case"opacity":case"path":case"r":case"rotation":case"rx":case"ry":case"scale":case"stroke-dasharray":case"stroke-linecap":case"stroke-linejoin":case"stroke-miterlimit":case"stroke-opacity":case"stroke-width":case"translation":case"width":this.shadow.attr(t,i);break;case"x":this.shadow.attr(t,i),this.shadow.attr("transform","...t1,0");break;case"y":this.shadow.attr(t,i),this.shadow.attr("transform","...t0,1")}},Raphael.st.wijRemove=function(){e.each(this,function(t,e){e.wijRemove&&!e.removed&&e.wijRemove()})},Raphael.st.wijAttr=function(t,i){return e.each(this.items,function(e,n){n.wijAttr(t,i)}),this},Raphael.st.wijAnimate=function(t,e,i,n){var o=0,r=0,s=null;for(o=0,r=this.items.length;r>o;o++)s=this.items[o],s.removed||s.wijAnimate(t,e,i,n);return this},Raphael.st.wijGetBBox=function(){var t=[],e=[],i=[],n=[],o,r,s=Math.max,a=Math.min,l="push",h="apply",d=null,c=0;for(c=this.items.length-1;c>=0;c--)d=this.items[c].wijGetBBox(),t[l](d.x),e[l](d.y),i[l](d.x+d.width),n[l](d.y+d.height);return o=a[h](0,t),r=a[h](0,e),{x:o,y:r,x2:void 0,y2:void 0,width:s[h](0,i)-o,height:s[h](0,n)-r}};var a=Raphael.el.attr;Raphael.el.attr=function(t,i){return e.isPlainObject(t)&&e.each(t,function(e,i){("width"===e||"height"===e||"r"===e)&&!isNaN(i)&&0>i&&(t[e]=0)}),("width"===t||"height"===t||"r"===t)&&!isNaN(i)&&0>i&&(i=0),a.apply(this,arguments)}}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){var i=jQuery,n=function(){function t(){}return t.getDiffAttrs=function(t,e){var n={};return i.each(e,function(i,o){return"undefined"==typeof t?!0:void("undefined"==typeof t[i]?n[i]=e[i]:t[i]!==e[i]&&(n[i]=e[i]))}),n},t.paintShadow=function(t,e,n){if(!t.removed&&0!==i(t.node).parent().length){var o=t.clone(),r=e||1,s=n||"#cccccc";o.insertBefore(t),o.attr({transform:Raphael.format("...T{0},{1}",r,r),stroke:s,fill:"none","stroke-width":r}),o.toBack(),o.offset=r,t.shadow=o}},t.getScaling=function(t,e,i,n){var o=e-i;return 0===o&&(o=1),t&&(o=-o),n/o},t.getTranslation=function(t,e,i,n,o){var r=0;return t?(r=e.y,r-=o*i):(r=e.x,r-=o*n),r},t.getXSortedPoints=function(t){function e(t,e){return t-e}var n=t.data.x,o=[].concat(n),r=[].concat(t.data.y),s=[],a=n;if(void 0!==n&&0!==n.length)return"number"==typeof n[0]&&(a=[].concat(n).sort(e)),i.each(a,function(t,e){i.each(o,function(i,n){return e===n?("number"!=typeof n&&(n=t),s.push({x:n,y:r[i]}),o.splice(i,1),r.splice(i,1),!1):void 0})}),s},t.sector=function(t,e,n,o,r){var s=i.wijraphael.getPositionByAngle(t,e,n,o),a=i.wijraphael.getPositionByAngle(t,e,n,r);return["M",t,e,"L",s.x,s.y,"A",n,n,0,+(r-o>180),0,a.x,a.y,"z"]},t.donut=function(t,e,n,o,r,s){var a=i.wijraphael.getPositionByAngle(t,e,n,r),l=i.wijraphael.getPositionByAngle(t,e,n,s),h=i.wijraphael.getPositionByAngle(t,e,o,r),d=i.wijraphael.getPositionByAngle(t,e,o,s),c=s-r>180;return["M",a.x,a.y,"A",n,n,0,+c,0,l.x,l.y,"L",d.x,d.y,"A",o,o,0,+c,1,h.x,h.y,"L",a.x,a.y,"z"]},t.getFirstValidListValue=function(t){var e;return i.each(t,function(t,i){return null===i?!0:"undefined"==typeof i?!0:"number"==typeof i&&isNaN(i)?!0:(e=i,!1)}),e},t.getLastValidListValue=function(e){var i=[].concat(e).reverse();return t.getFirstValidListValue(i)},t.isHolefunction=function(t,e){return null===t?!0:"undefined"==typeof t?!0:"number"==typeof t&&isNaN(t)?!0:null===e?!1:"undefined"!=typeof t&&t-e===0?!0:!1},t}();e.ChartUtil=n;var o=function(){function t(){}return t.roundTime=function(t,e,n){var o=this,r=e,s=i.fromOADate(t),a,l,h,d;return r>0?(a={year:s.getFullYear(),month:s.getMonth(),day:s.getDate(),hour:s.getHours(),minute:s.getMinutes(),second:s.getSeconds()},r<o.tmInc.minute?(a.second=o.tround(a.second,r,n),o.getTimeAsDouble(a)):(a.second=0,r<o.tmInc.hour?(r/=o.tmInc.minute,a.minute=o.tround(a.minute,r,n),o.getTimeAsDouble(a)):(a.minute=0,r<o.tmInc.day?(r/=o.tmInc.hour,a.hour=o.tround(a.hour,r,n),o.getTimeAsDouble(a)):(a.hour=0,r<o.tmInc.month?(r/=o.tmInc.day,a.day=o.tround(a.day,r,n),o.getTimeAsDouble(a)):(a.day=1,r<o.tmInc.year?(r/=o.tmInc.month,a.month=o.tround(a.month,r,n),o.getTimeAsDouble(a)):(a.month=0,r/=o.tmInc.year,a.year=o.tround(a.year,r,n),o.getTimeAsDouble(a))))))):(l=s,h=l-r,d=parseInt((h/e).toString(),10)*e,n&&d!==h&&(d+=e),l=r+d)},t.tround=function(t,e,i){var n=parseInt((t/e*e).toString(),10);return i&&n!==t&&(n+=parseInt(e,10)),n},t.getTimeAsDouble=function(t){var e=0,n=0,o=null;return t.day<1?(n=-1-t.day,t.day=1):t.day>28&&(n=t.day-28,t.day=28),t.month<0?(e=-1-t.day,t.month=0):t.month>11&&(e=t.month-11,t.month=11),o=new Date(t.year,t.month,t.day,t.hour,t.minute,t.second),o.setDate(o.getDate()+n),o.setMonth(o.getMonth()+e),i.toOADate(o)},t.getTimeDefaultFormat=function(t,e){var i=this,n=t-e,o="d";return n>2*i.tmInc.year?o="yyyy":n>i.tmInc.year?o="MMM yy":n>3*i.tmInc.month?o="MMM":n>2*i.tmInc.week?o="MMM d":n>2*i.tmInc.day?o="ddd d":n>i.tmInc.day?o="ddd H:mm":n>i.tmInc.hour?o="H:mm":n>=1e3&&(o="H:mm:ss"),o},t.niceTimeUnit=function(t,e){var i=this,n=t;return n=i.niceTimeSpan(n,e)},t.niceTimeSpan=function(t,e){var i=this,n=i.manualTimeInc(e),o=0,r=0;if(o=Math.ceil(t),0===o)return i.timeSpanFromTmInc(n);if(r=1,n<i.tmInc.minute){if(o<i.tmInc.minute&&(r=i.getNiceInc([1,2,5,10,15,30],o,n),0!==r))return r;n=i.tmInc.minute}if(n<i.tmInc.hour){if(o<i.tmInc.hour&&(r=i.getNiceInc([1,2,5,10,15,30],o,n),0!==r))return r;n=i.tmInc.hour}if(n<i.tmInc.day){if(o<i.tmInc.day&&(r=i.getNiceInc([1,3,6,12],o,n),0!==r))return r;n=i.tmInc.day}if(n<i.tmInc.month){if(o<i.tmInc.month&&(r=i.getNiceInc([1,2,7,14],o,n),0!==r))return r;n=i.tmInc.month}if(n<i.tmInc.year){if(o<i.tmInc.year&&(r=i.getNiceInc([1,2,3,4,6],o,n),0!==r))return r;n=i.tmInc.year}return r=100*i.tmInc.year,r>o&&(r=i.getNiceInc([1,2,5,10,20,50],o,n),0===r&&(r=100*i.tmInc.year)),r},t.getNiceInc=function(t,e,i){var n=0,o=0,r=t.length;for(n=0;r>n;n++)if(o=t[n]*i,o>=e)return o;return 0},t.timeSpanFromTmInc=function(t){var e=1e3,i=t,n=1;if(t!==this.tmInc.maxtime)if(t>this.tmInc.tickf1)e=t;else{for(t+=7;i>0;)n*=10,i--;e=n}return e},t.manualTimeInc=function(t){var e=this,i=e.tmInc.second;return t&&0!==t.length?(t.indexOf("s")>=0?i=e.tmInc.second:t.indexOf("m")>=0?i=e.tmInc.minute:t.indexOf("h")>=0||t.indexOf("H")>=0?i=e.tmInc.hour:t.indexOf("d")>=0?i=e.tmInc.day:t.indexOf("M")>=0?i=e.tmInc.month:t.indexOf("y")>=0&&(i=e.tmInc.year),i):i},t.tmInc={tickf7:-7e3,tickf6:-6e3,tickf5:-5e3,tickf4:-4e3,tickf3:-3e3,tickf2:-2e3,tickf1:-1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:26784e5,year:31536e6,maxtime:2147483647},t.niceTickNumber=function(t){if(0===parseFloat(t))return t;0>t&&(t=-t);var e=Math.log(t)/Math.log(10),i=parseInt(this.signedFloor(e).toString(),10),n=t/Math.pow(10,i),o=10;return 1>=n?o=1:2>=n?o=2:5>=n&&(o=5),o*Math.pow(10,i)},t.niceNumber=function(t,e,i){if(0===parseFloat(t))return t;0>t&&(t=-t);var n=t/Math.pow(10,e),o=10;return i?1.5>n?o=1:3>n?o=2:7>n&&(o=5):1>=n?o=1:2>=n?o=2:5>=n&&(o=5),o*Math.pow(10,e)},t.nicePrecision=function(t){if(0>=t||"number"!=typeof t)return 0;var e=Math.log(t)/Math.log(10),i=parseInt(this.signedFloor(e).toString(),10),n=t/Math.pow(10,i);return 3>n&&(i=-i+1),i},t.precCeil=function(t,e){var i=Math.pow(10,t),n=e/i;return n=Math.ceil(n),n*i},t.precFloor=function(t,e){var i=Math.pow(10,t),n=e/i;return n=Math.floor(n),n*i},t.signedCeiling=function(t){return 0>t?Math.floor(t):Math.ceil(t)},t.signedFloor=function(t){return 0>t?Math.ceil(t):Math.floor(t)},t}();e.ChartDataUtil=o,Raphael.fn.closeBtn=function(t,e,i){var n=Math.cos(45*Math.PI/180)*i,o=this.set(),r=["M",t-n,e-n,"L",t+n,e+n,"M",t-n,e+n,"L",t+n,e-n],s=this.path(r.join(" ")),a=null;return s.attr({cursor:"pointer"}),o.push(s),a=this.rect(t-i,e-i,2*i,2*i),a.attr({fill:"white","fill-opacity":0,cursor:"pointer",stroke:"none"}),o.push(a),o};var r=function(){function t(t,e,n){this.options={content:"",contentStyle:{},title:"",titleStyle:{},style:{fill:"white","fill-opacity":.5},closeBehavior:"auto",mouseTrailing:!0,triggers:"hover",animated:"fade",showAnimated:null,hideAnimated:null,duration:500,showDuration:500,hideDuration:500,easing:null,showEasing:null,hideEasing:null,showDelay:150,hideDelay:150,relativeTo:"mouse",compass:"east",offsetX:0,offsetY:0,showCallout:!0,calloutFilled:!1,calloutFilledStyle:{fill:"black"},calloutLength:12,calloutOffset:0,calloutAnimation:{easing:null,duration:500},windowCollisionDetection:"flip",calloutSide:null,width:null,height:null,beforeShowing:null},this.paper=t,this.targets=e,i.extend(this.options,n),this.init()}return t.prototype.init=function(){var t=this.options;this.calloutOffset=t.calloutOffset,this.offsetLength=0,this.gapLength=t.calloutLength/2,this.width=t.width,this.height=t.height,this.offset={x:0,y:0},this.targets&&this._bindLiveEvent(this.targets),this.selector&&this._bindLiveEventBySelector(this.selector)},t.prototype._getShowPoint=function(t,e){var i=t.getBBox(),n={x:0,y:0};switch(e.toLowerCase()){case"east":n.x=i.x+i.width,n.y=i.y+i.height/2;break;case"eastnorth":n.x=i.x+i.width,n.y=i.y;break;case"eastsouth":n.x=i.x+i.width,n.y=i.y+i.height;break;case"west":n.x=i.x,n.y=i.y+i.height/2;break;case"westnorth":n.x=i.x,n.y=i.y;break;case"westsouth":n.x=i.x,n.y=i.y+i.height;break;case"north":n.x=i.x+i.width/2,n.y=i.y;break;case"northeast":n.x=i.x+i.width,n.y=i.y;break;case"northwest":n.x=i.x,n.y=i.y;break;case"south":n.x=i.x+i.width/2,n.y=i.y+i.height;break;case"southeast":n.x=i.x+i.width,n.y=i.y+i.height;break;case"southwest":n.x=i.x,n.y=i.y+i.height}return n},t.prototype._clearIntentTimer=function(t){t&&(window.clearTimeout(t),t=null)},t.prototype._removeTooltip=function(e){var i=this,n=this,o=this.elements,r=n.options,s,a,l;o&&((r.hideAnimated||r.animated)&&(s=r.hideAnimated,s||(s=r.animated),s&&t.animations[s]&&(l={animated:s,duration:r.hideDuration||r.duration,easing:r.hideEasing||r.easing,context:o,show:!1},t.animations[s](l))),a=r.hideDuration||r.duration,e&&(a=e),window.setTimeout(function(){var t,e;if(i.content&&(i.content.wijRemove(),i.content=null),i.title&&(i.title.wijRemove(),i.title=null),i.container&&(i.container.wijRemove(),i.container=null),i.closeBtn){for(t=0,e=i.closeBtn.length;e>t;t++)i.closeBtn[t].unclick();i.closeBtn.wijRemove(),i.closeBtn=null}i.callout&&(i.callout.wijRemove(),i.callout=null),n.lastPoint=null,o=null},a))},t.prototype._clearTimers=function(){this.intentShowTimer&&this._clearIntentTimer(this.intentShowTimer),this.intentHideTimer&&this._clearIntentTimer(this.intentHideTimer)},t.prototype._hide=function(t){var e=this;e._clearTimers(),e.options.hideDelay?e.intentHideTimer=window.setTimeout(function(){e._removeTooltip()},e.options.hideDelay):e._removeTooltip()},t.prototype._convertCompassToPosition=function(t){var e="",i={x:0,y:0};switch(t.toLowerCase()){case"east":e="right-middle",i.x=2,i.y=0;break;case"eastnorth":e="right-top",i.x=2,i.y=-2;break;case"eastsouth":e="right-bottom",i.x=2,i.y=2;break;case"west":e="left-middle",i.x=-2,i.y=0;break;case"westnorth":e="left-top",i.x=-2,i.y=-2;break;case"westsouth":e="left-bottom",i.x=-2,i.y=2;break;case"north":e="top-middle",i.x=0,i.y=-2;break;case"northeast":e="top-right",i.x=2,i.y=-2;break;case"northwest":e="top-left",i.x=-2,i.y=-2;break;case"south":e="bottom-middle",i.x=0,i.y=2;break;case"southeast":e="bottom-right",i.x=2,i.y=2;break;case"southwest":e="bottom-left",i.x=-2,i.y=2}return this.offset=i,e},t.prototype._getCalloutArr=function(t,e){var i=[],n=this.options,o=n.compass;switch(n.calloutSide&&(o=n.calloutSide),o.toLowerCase()){case"east":case"eastsouth":case"eastnorth":i=["M",t.x+e,t.y+e,"l",-e,-e,"l",e,-e,"Z"];break;case"west":case"westsouth":case"westnorth":i=["M",t.x-e,t.y-e,"l",e,e,"l",-e,e,"Z"];break;case"north":case"northeast":case"northwest":i=["M",t.x-e,t.y-e,"l",e,e,"l",e,-e,"Z"];break;case"south":case"southeast":case"southwest":i=["M",t.x-e,t.y+e,"l",e,-e,"l",e,e,"Z"]}return i},t.prototype._getFuncText=function(t,e){if(i.isFunction(t)){var n=null,o,r={target:null,fmt:t},s;return e&&e.target&&(s=e.target,s.raphael&&s.raphaelid||(s=s.parentNode),s.raphael&&s.raphaelid?(o=this.paper.getById(s.raphaelid),r.target=o):r.target=e.target),n=i.proxy(r.fmt,r),n().toString()}return t},t.prototype._translateCallout=function(t){var e=this.options,i=this.width,n=this.height,o=this.gapLength,r=this.offsetLength,s=this.calloutOffset,a=this.tooltipElements.callout;if(e.calloutSide){var l=o||r;switch(e.calloutSide){case"south":case"north":t?a.animate({translation:-i/2+l+s+",0"},t):a.translate(-i/2+l+s,0);break;case"east":case"west":t?a.animate({translation:"0,"+(-n/2+l+s)},t):a.translate(0,-n/2+l+s)}}},t.replacer=function(t,e,i){var n=i,o=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;return e.replace(o,function(t,e,i,o,r){e=e||o,n&&("string"!==n[e]&&(n=n[e]),"function"==typeof n&&r&&(n=n()))}),n=(null===n||n===i?t:n).toString()},t.fill=function(e,i){var n=/\{([^\}]+)\}/g;return String(e).replace(n,function(e,n){return t.replacer(e,n,i)})},t.prototype._createPath=function(e,i,n){var o=i.split("-"),r=5,s=n.getBBox(),a=this.options,l=a.padding,h=this.gapLength,d=this.offsetLength,c=l&&!isNaN(l)?parseInt(l):0,u=Math.round(s.width+2*c),p=Math.round(s.height+2*c),g=Math.round(s.x-c)-r,f=Math.round(s.y-c)-r,m=0,w=0,y=0,v=0,_=null,S=null,x=null;switch(a.width&&(u=u>a.width?u:a.width),a.height&&(p=p>a.height?p:a.height),this.width=u,this.height=p,m=Math.min(p/4,u/4,h),d&&(d=Math.min(p/4,u/4,d)),d?(w=d,_={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{offset},0,-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{offset},0,{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom},0-{offset},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},0,{offset},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}):_={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"},S=[{x:g+r,y:f,w:u,w4:u/4,h4:p/4,left:0,right:u-2*m-2*w,top:0,bottom:p-2*m-2*w,r:r,h:p,gap:m,offset:2*w},{x:g+r,y:f,w:u,w4:u/4,h4:p/4,left:u/2-m-w,right:u/2-m-w,top:p/2-m-w,bottom:p/2-m-w,r:r,h:p,gap:m,offset:2*w},{x:g+r,y:f,w:u,w4:u/4,h4:p/4,right:0,left:u-2*m-2*w,bottom:0,top:p-2*m-2*w,r:r,h:p,gap:m,offset:2*w}]["middle"===o[1]?1:2*("left"===o[1]||"top"===o[1]?1:0)],x=this.paper.path(t.fill(_[o[0]],S)),o[0]){case"top":y=e.x-(g+r+S.left+m+d),v=e.y-(f+r+p+r+m+d);break;case"bottom":y=e.x-(g+r+S.left+m+d),v=e.y-(f-m-d);break;case"left":y=e.x-(g+r+u+r+m+d),v=e.y-(f+r+S.top+m+d);break;case"right":y=e.x-(g-m-w),v=e.y-(f+r+S.top+m+w)}return x.translate(y,v),n.transform(Raphael.format("...t{0},{1}",y,v)),x},t.prototype._isWindowCollision=function(t,e,n,o,r,s,a){var l=t.getBBox(),h=0,d=e.toLowerCase(),c=l.x+r,u=l.y+s,p=this.paper.width,g=this.paper.height,f=n,m=o,w=t.attr("stroke-width"),y=a===!0||"flip"===a;return Raphael.vml&&(p=i(this.paper.canvas).width(),g=i(this.paper.canvas).height()),0>c-w&&(y?-1===d.toLowerCase().indexOf("west")?c+l.width/2+l.width-n<=p&&(h++,d=d.toLowerCase()+"east",f=0-n):c+l.width+l.width-n<=p&&(h++,d=d.toLowerCase().replace("west","east"),f=0-n):(h++,f=0-c+w+n)),0>u-w&&(y?-1===d.toLowerCase().indexOf("north")?u+l.height/2+l.height-o<=g&&(h++,d=d.toLowerCase()+"south",m=0-o):u+l.height+l.height-o<=g&&(h++,d=d.toLowerCase().replace("north","south"),m=0-o):(h++,m=0-u+w+o)),c+l.width+w>p&&(y?-1===d.toLowerCase().indexOf("east")?c-l.width/2-n>=0&&(h++,d=d.toLowerCase()+"west",f=0-n):c-l.width-n>=0&&(h++,d=d.toLowerCase().replace("east","west"),f=0-n):(h++,f=p-(c+l.width+w)+n)),u+l.height+w>g&&(y?-1===d.toLowerCase().indexOf("south")?u-l.height/2-o>=0&&(h++,d=d.toLowerCase()+"north",m=0-o):u-l.height-o>=0&&(h++,d=d.toLowerCase().replace("south","north"),m=0-o):(h++,m=g-(u+l.height+w)+o)),h?{compass:d,offsetX:f,offsetY:m}:!1},t.prototype._createTooltipEles=function(e,n,o,r,s,a,l){var h=this,d,c,u,p=this.paper.set(),g=null,f=null,m=this.options,w=this.closeBtnLength,y=this.calloutOffset,v=null,_=0,S=0,x=250,b=0,C=0,D,I={x:e.x,y:e.y},j=this.offset,T=null,E=null;if(i.wijraphael.clearRaphaelCache(),u=this._convertCompassToPosition(s),I.x+=a+j.x,I.y+=l+j.y,this.elements=this.paper.set(),this.title&&(i.each(this.title,function(t,e){i(e.node).unbind(".Rtooltip")}),this.title.wijRemove()),n&&n.length>0?(this.title=this.paper.htmlText(-1e3,-1e3,n,m.titleStyle),this.elements.push(this.title),d=this.title.getBBox()):d={left:-1e3,top:-1e3,width:0,height:0},this.content&&(i.each(this.content,function(t,e){i(e.node).unbind(".Rtooltip")}),this.content.wijRemove()),o&&o.length>0?(this.content=this.paper.htmlText(-1e3,-1e3,o,m.contentStyle),this.elements.push(this.content),c=this.content.getBBox()):c={left:-1e3,top:-1e3,width:0,height:0},this.closeBtn){for(b=0,C=this.closeBtn.length;C>b;b++)this.closeBtn[b].unclick();this.closeBtn.wijRemove()}if(this.content&&this.content.transform(Raphael.format("T0,{0}",d.height/2+c.height/2)),this.title&&this.title.transform(Raphael.format("T0,{0}",0)),"sticky"===m.closeBehavior&&(this.closeBtn=this.paper.closeBtn(-1e3,-1e3,w),this.elements.push(this.closeBtn),m.width&&m.width>d.width+2*w&&m.width>c.width+2*w?this.closeBtn.transform(Raphael.format("T{0},{1}",m.width-w,w)):d.width>=c.width-2*w?this.closeBtn.transform(Raphael.format("T{0},{1}",d.width+w,w)):this.closeBtn.transform(Raphael.format("T{0},{1}",c.width-w,w)),i.each(this.closeBtn,function(t,e){var i=h;e.click(function(t){i._hide(t)})})),this.title&&(p.push(this.title),m.relatedElement&&this.title.insertBefore(m.relatedElement)),this.content&&(p.push(this.content),m.relatedElement&&this.content.insertBefore(m.relatedElement)),this.closeBtn&&(p.push(this.closeBtn),m.relatedElement&&this.closeBtn.insertBefore(m.relatedElement)),m.showCallout||(this.gapLength=0),(m.calloutSide||m.calloutFilled)&&(this.gapLength=0,this.offsetLength=m.calloutLength/2,m.calloutSide&&(u=this._convertCompassToPosition(m.calloutSide))),m.calloutSide&&0===p.length&&(this.content=this.paper.htmlText(-1e3,-1e3," "),p.push(this.content),m.relatedElement&&this.content.insertBefore(m.relatedElement)),this.callout&&(i(this.callout.node).unbind(".Rtooltip"),this.callout.wijRemove()),this.container&&(i(this.container.node).unbind(".Rtooltip"),this.container.wijRemove()),this.lastPoint){if(m.showCallout&&(m.calloutSide||m.calloutFilled)&&(g=this._getCalloutArr(this.lastPoint,this.offsetLength),this.callout=this.paper.path(g.concat(" ")),m.relatedElement&&this.callout.insertBefore(m.relatedElement),m.calloutFilled&&this.callout.attr(m.calloutFilledStyle),m.calloutSide&&this._translateCallout(0)),this.container=this._createPath(this.lastPoint,u,p),m.relatedElement&&this.container.insertBefore(m.relatedElement),r&&(D=this._isWindowCollision(this.container,s,a,l,I.x-this.lastPoint.x,I.y-this.lastPoint.y,r)))return void this._createTooltipEles(e,n,o,!1,D.compass,D.offsetX,D.offsetY);this.elements.push(this.callout),this.elements.push(this.container),_=I.x-this.lastPoint.x,S=I.y-this.lastPoint.y,E=Raphael.format("...T{0},{1}",_,S),T=Raphael.animation({transform:E},x),this.container&&(m.showAnimated||m.animated?this.container.animate(T):this.container.attr("transform",E)),this.title&&(m.showAnimated||m.animated?this.title.animate(T):this.title.attr("transform",E)),this.content&&(m.showAnimated||m.animated?this.content.animate(T):this.content.attr("transform",E)),this.closeBtn&&(m.showAnimated||m.animated?this.closeBtn.animate(T):this.closeBtn.attr("transform",E)),this.callout&&(m.showAnimated||m.animated?this.callout.animate(T):this.callout.attr("transform",E))}else{if(m.showCallout&&(m.calloutSide||m.calloutFilled)&&(g=this._getCalloutArr(I,this.offsetLength),this.callout=this.paper.path(g.concat(" ")),m.relatedElement&&this.callout.insertBefore(m.relatedElement),m.calloutFilled&&this.callout.attr(m.calloutFilledStyle),m.calloutSide&&this._translateCallout(0)),this.container=this._createPath(I,u,p),m.relatedElement&&this.container.insertBefore(m.relatedElement),r&&(D=this._isWindowCollision(this.container,s,a,l,0,0,r)))return void this._createTooltipEles(e,n,o,!1,D.compass,D.offsetX,D.offsetY);this.elements.push(this.callout),this.elements.push(this.container),(m.showAnimated||m.animated)&&(f=m.showAnimated,f||(f=m.animated),f&&t.animations[f]&&(v={animated:f,duration:m.showDuration||m.duration,easing:m.showEasing||m.easing,context:this.elements,show:!0},t.animations[f](v)))}this.lastPoint=I,this.container.attr(m.style),m.relatedElement?(this.title&&this.title.insertBefore(m.relatedElement),this.content&&this.content.insertBefore(m.relatedElement),this.closeBtn&&this.closeBtn.insertBefore(m.relatedElement)):p.toFront()},t.prototype._createTooltip=function(t,e){var n=null,o=null,r=null,s=null,a=this.options,l,h;i.isFunction(a.beforeShowing)&&(r=null,s={target:null,options:a,fmt:a.beforeShowing},e&&e.target&&(h=e.target,h.raphael&&h.raphaelid||(h=h.parentNode),h.raphael&&h.raphaelid?(l=this.paper.getById(h.raphaelid),s.target=l):(l=e.target,s.target=l)),r=i.proxy(s.fmt,s),r()===!1)||(n=a.title,o=a.content,n=this._getFuncText(n,e),o=this._getFuncText(o,e),(n||o)&&this._createTooltipEles(t,n,o,a.windowCollisionDetection,a.compass,a.offsetX,a.offsetY))},t.prototype._showAt=function(t,e){var i=this.options,n=this;this._clearTimers(),i.showDelay?this.intentShowTimer=window.setTimeout(function(){n._createTooltip(t,e)},i.showDelay):this._createTooltip(t,e)},t.prototype._show=function(t){var e=i(this.paper.canvas.parentNode).offset(),n=e.left,o=e.top,r=this.options,s=r.relativeTo,a={x:0,y:0},l=null,h=t.target;switch(s){case"mouse":a.x=t.pageX-n,a.y=t.pageY-o;break;case"element":h.raphael&&h.raphaelid||(h=h.parentNode),h.raphael&&h.raphaelid&&(l=this.paper.getById(h.raphaelid),a=this._getShowPoint(l,r.compass))}this._showAt(a,t)},t.prototype._bindEvent=function(t){var e=this.options,n=this;switch(e.triggers){case"hover":i(t.node).bind("mouseover.Rtooltip",function(t){n._show(t)}).bind("mouseout.Rtooltip",function(t){"auto"===e.closeBehavior&&n._hide(t)}),e.mouseTrailing&&"mouse"===e.relativeTo&&i(t.node).bind("mousemove.Rtooltip",function(t){n._show(t)});break;case"click":i(t.node).bind("click.Rtooltip",function(t){n._show(t)});break;case"custom":}},t.prototype._bindLiveEvent=function(t){var e,i;if(t)if(t.length)for(e=0,i=t.length;i>e;e++)this._bindEvent(t[e]);else this._bindEvent(t)},t.prototype._bindLiveEventBySelector=function(t){var e=this.options,i=this;if(t)switch(e.triggers){case"hover":t.on("mouseover.Rtooltip",function(t){i._show(t)}).on("mouseout.Rtooltip",function(t){"auto"===e.closeBehavior&&i._hide(t)}),e.mouseTrailing&&"mouse"===e.relativeTo&&t.on("mousemove.Rtooltip",function(t){i._show(t)});break;case"click":t.on("click.Rtooltip",function(t){i._show(t)});break;case"custom":}},t.prototype._unbindLiveEvent=function(t,e){var n,o;if(t)if(t.length)for(n=0,o=t.length;o>n;n++)i(t[n].node).unbind(".Rtooltip");else i(t.node).unbind(".Rtooltip");e&&e.off("Rtooltip").off(".Rtooltip")},t.prototype._destroy=function(){this._unbindLiveEvent(this.targets,this.selector),this._removeTooltip(0)},t.prototype.hide=function(){this._hide()},t.prototype.showAt=function(t,e){this._showAt(t,e)},t.prototype.resetCalloutOffset=function(t){var e=this.options,i=e.calloutOffset,n=e.calloutSide,o=e.calloutAnimation,r=this.tooltipElements;r.callout&&("south"===n||"north"===n?r.callout.animate({translation:t-i+",0"},o.duration,o.easing):("east"===n||"west"===n)&&r.callout.animate({translation:"0,"+(t-i)},o.duration,o.easing)),e.calloutOffset=t},t.prototype.destroy=function(){this._destroy()},t.prototype.getOptions=function(){return this.options},t.prototype.setTargets=function(t){this.targets=t,this._bindLiveEvent(t)},t.prototype.setSelector=function(t){this.selector=t,this._bindLiveEventBySelector(t)},t.prototype.setOptions=function(t){i.extend(!0,this.options,t)},t.animations={fade:function(t){var e=t.context;t.show?(e.attr({opacity:0}),e.wijAnimate({opacity:1},t.duration,t.easing)):e.wijAnimate({opacity:0},t.duration,t.easing)}},t}();e.ChartTooltip=r,Raphael.fn.tooltip={animations:r.animations};var s=function(){function t(t){this.labels=[],this.crossLabels={},this.bBox=t}return t.prototype.push=function(t){var e=t.wijGetBBox();this.labels.push({ele:t,x:e.x,y:e.y,width:e.width,height:e.height,overlaps:[],bakBBox:e})},t.prototype.pushCross=function(t,e){var i,n,o,r,s;!this.crossLabels[Raphael.format("{0}-{1}",t,e)]&&!this.crossLabels[Raphael.format("{0}-{1}",e,t)]&&(i=this.labels[t],n=this.labels[e],this.crossLabels[Raphael.format("{0}-{1}",t,e)]={label1:i,label2:n,dx:this._getAdjust(i,n,"h"),dy:this._getAdjust(i,n,"v")})},t.prototype._detect=function(t,e){return(t.x+t.width>e.x&&t.x<e.x||e.x+e.width>t.x&&e.x<t.x)&&(t.y+t.height>e.y&&t.y<e.y||e.y+e.height>t.y&&e.y<t.y)},t.prototype._resetOverlaps=function(){this.crossLabels={}},t.prototype._detects=function(){for(var t=this.labels.length,e,i,n=0;t>n;n++)for(var o=n+1;t>o;o++)e=this.labels[n],i=this.labels[o],this._detect(e,i)&&this.pushCross(n,o)},t.prototype._getAdjust=function(t,e,i){var n={dx:0,needRevert:!1};return"h"===i?t.x<e.x?n.dx=t.x+t.width-e.x:(n.dx=e.x+e.width-t.x,n.needRevert=!0):t.y<e.y?n.dx=t.y+t.height-e.y:(n.dx=e.y+e.height-t.y,n.needRevert=!0),n},t.prototype._adjustlabel=function(t,e,i,n){"h"===n?(t.x-=i/2,e.x+=i/2,this.bBox&&(t.x<this.bBox.x?(t.x=this.bBox.x,e.x=e.x+(this.bBox.x-t.x)):e.x>this.bBox.x+this.bBox.width&&(e.x=this.bBox.x+this.bBox.width,t.x-=e.x-this.bBox.x+this.bBox.width))):(t.y-=i/2,e.y+=i/2,this.bBox&&(t.y<this.bBox.y?(t.y=this.bBox.y,e.y=e.y+(this.bBox.y-t.y)):e.y>this.bBox.y+this.bBox.height&&(e.y=this.bBox.y+this.bBox.height,t.y-=e.y-this.bBox.y+this.bBox.height)))},t.prototype._adjustInternal=function(){var t=this;i.each(this.crossLabels,function(e,i){var n=i.label1,o=i.label2,r=i.dx,s=i.dy;r.dx<s.dx?s.needRevert?t._adjustlabel(o,n,s.dx,"v"):t._adjustlabel(n,o,s.dx,"v"):r.needRevert?t._adjustlabel(o,n,r.dx,"h"):t._adjustlabel(n,o,r.dx,"h")})},t.prototype._adjustTheEdge=function(){var t=this;this.bBox&&i.each(this.labels,function(e,i){i.x<t.bBox.x?i.x=t.bBox.x:i.x+i.width>t.bBox.x+t.bBox.width&&(i.x=t.bBox.x+t.bBox.width-i.width),i.y<t.bBox.y?i.y=t.bBox.y:i.y+i.height>t.bBox.y+t.bBox.height&&(i.y=t.bBox.y+t.bBox.height-i.height)})},t.prototype._translateLabels=function(){i.each(this.labels,function(t,e){e.x!==e.bakBBox.x&&(e.ele.attr("x",e.x+e.width/2),e.bakBBox.x=e.x),e.y!==e.bakBBox.y&&(e.ele.attr("y",e.y+e.height/2),e.bakBBox.y=e.y)})},t.prototype.adjust=function(){for(var t=1e3;t>0&&(this._resetOverlaps(),this._adjustTheEdge(),this._detects(),!i.isEmptyObject(this.crossLabels));)t--,this._adjustInternal();this._translateLabels()},t}();e.AdjustLabel=s;var a=function(t){function e(){t.apply(this,arguments),this.innerState={}}return __extends(e,t),e.prototype._setOption=function(n,o){var r=this,s=r.options,a=null,l=0,h=0,d=s.axis.x.tickMajor.factor,c=s.axis.x.tickMinor.factor,u,p,g,f,m,w=e.prototype.options.axis,y,v;if("dataSource"===n)r.seriesTransition=!0,s.dataSource=o,r.seriesList&&(s.seriesList=i.arrayClone(r.seriesList)),r._init();else if("data"===n)r.seriesTransition=!0,s.data=o,r.seriesList&&(s.seriesList=i.arrayClone(r.seriesList)),r._init();else if("seriesList"===n){if(o||(o=[]),a=i.Event("beforeserieschange"),r._trigger("beforeSeriesChange",a,{oldSeriesList:s.seriesList,newSeriesList:o})===!1)return!1;s.seriesList=o,r.seriesList=i.arrayClone(o),r._trigger("seriesChanged",null,o),r.seriesTransition=!0,r._init()}else i.isPlainObject(s[n])?("axis"===n&&(g=i.isArray(s.axis.y)?i.arrayClone(s.axis.y):i.extend(!0,{},s.axis.y)),"axis"===n?(v=i.extend(!0,{},o),r._verifyAxisAutoMinMax(v),i.extend(!0,s.axis.x,v.x||{}),y=i.isArray(s.axis.y)||i.isArray(v.y)?{}:s.axis.y,i.isArray(v.y)?(i.each(v.y,function(t,e){v.y[t]=i.extend(!0,{},w.y,y,e)}),s.axis.y=v.y):s.axis.y=i.extend(!0,{},w.y,y,v.y)):i.extend(!0,s[n],o),
"indicator"===n&&(this._unbindCanvasEvents(),this._bindCanvasEvents()),"axis"===n&&(f=s.axis.y,s.axis.x.tickMajor.factor<0&&(s.axis.x.tickMajor.factor=d),s.axis.x.tickMinor.factor<0&&(s.axis.x.tickMinor.factor=c),i.isArray(f)?(i.isArray(g)||(g=[g]),i.each(f,function(t,e){var i=g[t]||{};i.tickMajor&&i.tickMajor.factor&&e.tickMajor&&e.tickMajor.factor&&e.tickMajor.factor<0&&(e.tickMajor.factor=i.tickMajor.factor),i.tickMinor&&i.tickMinor.factor&&e.tickMinor&&e.tickMinor.factor&&e.tickMinor.factor<0&&(e.tickMinor.factor=i.tickMinor.factor)})):(i.isArray(g)?(u=g[0].tickMajor.factor,p=g[0].tickMinor.factor):(d=g.tickMajor.factor,c=g.tickMinor.factor),s.axis.y.tickMajor&&void 0!==s.axis.y.tickMajor.factor&&s.axis.y.tickMajor.factor<0&&(s.axis.y.tickMajor.factor=u),s.axis.y.tickMinor&&void 0!==s.axis.y.tickMinor.factor&&s.axis.y.tickMinor.factor<0&&(s.axis.y.tickMinor.factor=p)))):t.prototype._setOption.call(this,n,o);if("disabled"===n&&r._handleDisabledOption(o,r.chartElement),"seriesTransition"!==n&&"animation"!==n){if("hint"===n)return void r._resetTooltip();if(l=s.seriesList.length,("seriesList"===n||"seriesStyles"===n||"seriesHoverStyles"===n)&&("seriesList"!==n&&r._handleChartStyles(),r.styles={style:[].concat(s.seriesStyles.slice(0,s.seriesStyles.length)),hoverStyles:[].concat(s.seriesHoverStyles.slice(0,s.seriesHoverStyles.length))},r._initStyles()),"seriesList"===n||"seriesHoverStyles"===n)for(m=s.seriesHoverStyles.length,h=m;l>h;h++)s.seriesHoverStyles[h]=s.seriesHoverStyles[h%m];("height"===n||"width"===n)&&r.chartElement[n](o),r.redraw()}},e.prototype._preHandleSeriesData=function(){},e.prototype._initStyles=function(){var t=this.options,e=t.seriesStyles,i=t.seriesHoverStyles,n,o,r,s;if(t.seriesList&&(o=t.seriesList.length||0),t.seriesStyles&&(n=t.seriesStyles.length||0),t.seriesHoverStyles&&(r=t.seriesHoverStyles.length||0),o>n&&n)for(s=n;o>s;s++)e[s]=e[s%n];if(o>r&&r)for(s=r;o>s;s++)i[s]=i[s%r]},e.prototype._verifyAxisAutoMinMax=function(t){var e=function(t){return null===t||"undefined"==typeof t};t.x&&(e(t.x.min)?t.x.autoMin=!0:t.x.autoMin=!1,e(t.x.max)?t.x.autoMax=!0:t.x.autoMax=!1),t.y&&(i.isArray(t.y)?i.each(t.y,function(t,i){e(i.min)?i.autoMin=!0:i.autoMin=!1,e(i.max)?i.autoMax=!0:i.autoMax=!1}):(e(t.y.min)?t.y.autoMin=!0:t.y.autoMin=!1,e(t.y.max)?t.y.autoMax=!0:t.y.autoMax=!1))},e.prototype._create=function(){var t=this,e=t.options,n=e.width||t.element.width(),o=e.height||t.element.height(),r=null,s;if(window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t._verifyAxisAutoMinMax(e.axis),t.updating=0,t.innerState={},t.axisCompass={},t.element.is(":hidden")&&t.element.wijAddVisibilityObserver&&t.element.wijAddVisibilityObserver(function(){t.redraw(),t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijchart"),i.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(e),t.styles={style:[].concat(e.seriesStyles.slice(0,e.seriesStyles.length)),hoverStyles:[].concat(e.seriesHoverStyles.slice(0,e.seriesHoverStyles.length))},e.hint&&"string"==typeof e.hint.content&&window[e.hint.content]&&(e.hint.content=window[e.hint.content]),e.hint&&"string"==typeof e.hint.title&&window[e.hint.title]&&(e.hint.title=window[e.hint.title]),t.headerEles=[],t.footerEles=[],t.legendEles=[],t.axisEles=[],t.legends=[],t.legendIcons=[],t.legendDots=[],t.chartLabelEles=[],t.seriesEles=[],t.element.length>0){t.element.is("table")?(t._parseTable(),r=i("<div></div>"),n&&r.css("width",n),o&&r.css("height",o),t.element.after(r),t.chartElement=r):t.chartElement=t.element,t._initStyles(),t.chartElement.addClass("ui-widget");try{s=Raphael(t.chartElement[0],n,o)}catch(a){var l=t.chartElement.css("display");r=i("<div></div>").insertBefore(t.chartElement).append(t.chartElement),t.chartElement.addClass("ui-helper-hidden-accessible").appendTo(i("body")),"none"===l&&t.chartElement.css("display","block"),s=Raphael(t.chartElement[0],n,o),t.chartElement.appendTo(r).unwrap().removeClass("ui-helper-hidden-accessible"),"none"===l&&t.chartElement.css("display","none")}t.canvas=s,0===o&&0!==e.height&&t.element.height(s.height),e.disabled&&t.disable(),s.customAttributes.rotation=function(t){this.transform("...R"+t)},s.customAttributes.scale=function(t){this.transform("...S"+t)},s.customAttributes.translation=function(t,e){this.transform(Raphael.format("...T{0},{1}",t,e))},t._bindLiveEvents()}},e.prototype._handleChartStyles=function(){this._extendArrayFromBase("seriesStyles"),this._extendArrayFromBase("seriesHoverStyles");var t=this.options,e=this._getDefFill();i.each(t.seriesStyles,function(t,i){i.fill||(i.fill=e[t])})},e.prototype._extendArrayFromBase=function(t){var n=i.extend(!0,{},e.prototype.options[t],this.options[t]),o=[];i.each(n,function(t,e){o.push(e)}),this.options[t]=o},e.prototype._getDefFill=function(){var t=["#00cc00","#0099cc","#0055cc","#2200cc","#8800cc","#d9007e","#ff0000","#ff6600","#ff9900","#ffcc00","#ffff00","#ace600"];return t},e.prototype._getCulture=function(t){return Globalize.findClosestCulture(t||this.options.culture)},e.prototype._handleDisabledOption=function(t,e){var i=this;t?(i.disabledDiv||(i.disabledDiv=i._createDisabledDiv(e)),i.disabledDiv.appendTo("body")):i.disabledDiv&&(i.disabledDiv.remove(),i.disabledDiv=null)},e.prototype._createDisabledDiv=function(t){var e=this,n=e.options,o=t||e.element,r=o.offset(),s=n.width||o.outerWidth(),a=n.height||o.outerHeight(),l;return l=i("<div></div>").css({"z-index":"99999",position:"absolute",width:s,height:a,left:r.left,top:r.top}),Raphael.vml&&l.addClass(n.wijCSS.stateDisabled).css("background-color","#fff"),l},e.prototype._bindData=function(){var t=this,e=t.options,n=e.dataSource,o=e.seriesList,r=e.data,s;i.each(o,function(e,i){var o=i.data,a,l,h,d=i.dataSource||n;d&&o&&(a=o.x,l=o.y,h=o.y1,a&&a.bind?o.x=t._getBindData(d,a.bind):r&&r.x&&r.x.bind&&(void 0===s&&(s=t._getBindData(d,r.x.bind)),o.x=s),l&&l.bind&&(o.y=t._getBindData(d,l.bind)),h&&h.bind&&(o.y1=t._getBindData(d,h.bind)))})},e.prototype._getBindData=function(t,e){if(i.isArray(t)){var n=[];return i.each(t,function(t,i){i&&void 0!==i[e]&&n.push(i[e])}),n}return null},e.prototype._hanldSharedXData=function(){var t=this,e=t.options,n=e.seriesList,o=e.data;o&&i.each(n,function(t,e){var n=e.data;(void 0===n.x||null===n.x&&i.isArray(o.x))&&(n.x=o.x)})},e.prototype._init=function(){var t=this,e=t.options;t.rendered||(t.seriesList=i.arrayClone(e.seriesList)),t._bindData(),t._hanldSharedXData(),i.each(e.seriesList,function(t,n){var o=n.data,r;("undefined"==typeof o||null===o)&&(r=i.inArray(n,e.seriesList),e.seriesList.splice(r,1))}),t.rendered||t._paint()},e.prototype.destroy=function(){var e=this,n=e.options;e._unbindLiveEvents(),e._clearChartElement(),e.chartElement.removeClass("ui-widget"),i("."+n.wijCSS.canvasObject,e.chartElement[0]).off(e.widgetName).off("."+e.widgetName),e.element!==e.chartElement&&e.chartElement.remove(),e.element.empty(),e.styles&&(e.styles=null),e.disabledDiv&&(e.disabledDiv.remove(),e.disabledDiv=null),t.prototype.destroy.call(this)},e.prototype.getCanvas=function(){return this.canvas},e.prototype.addSeriesPoint=function(t,e,i){var n=this.options.seriesList,o=null,r=null;t>=n.length||(o=n[t],r=o.data||[],r.x.push(e.x),r.y.push(e.y),i&&(r.x.shift(),r.y.shift()),this._setOption("seriesList",n))},e.prototype.beginUpdate=function(){var t=this;t.updating++},e.prototype.endUpdate=function(){var t=this;t.updating--,t.redraw()},e.prototype.redraw=function(t){var e=this,i=e.options,n=0,o=0;e.updating>0||t&&e.rendered||(n=i.width||e.element.width(),o=i.height||e.element.height(),1>n||1>o||(e.canvas.setSize(n,o),e._paint()))},e.prototype._parseTable=function(){if(this.element.is("table")){var t=this,e=t.element,n=t.options,o=i("caption",e),r=i("thead th",e),s=[],a=i("tbody tr",e);o.length&&(n.header=i.extend({visible:!0,text:i.trim(i(o[0]).text())},n.header),o.length>1&&(n.footer=i.extend({visibel:!0,text:i.trim(i(o[1]).text())},n.footer))),n.legend=i.extend({visible:!0},n.legend),t._getSeriesFromTR(r,a,s),t.options.seriesList=s}},e.prototype._getSeriesFromTR=function(t,e,n){var o=[],r=null,s=null;t.length&&t.each(function(){r=i.trim(i(this).text()),o.push(r)}),e.length&&e.each(function(){var t=i("th",i(this)),e=i.trim(t.text()),r=[],a=i("td",i(this));a.length&&a.each(function(t,e){var n=i(this);r.push(parseFloat(i.trim(n.text())))}),s={label:e,legendEntry:!0,data:{x:o,y:r}},n.push(s)})},e.prototype._destroyRaphaelArray=function(t){if(t)for(var e=t.length,n=0,o,r;e&&e>n;n++)o=t[n],o&&o[0]&&(r=i(o.node),r.unbind().removeData(),o.wijRemove(),r.remove(),r=null),t[n]=null},e.prototype._clearChartElement=function(){var t=this,e=t.chartElement.data("fields");t._destroyRaphaelArray(t.headerEles),t._destroyRaphaelArray(t.footerEles),t._destroyRaphaelArray(t.legendEles),t._destroyRaphaelArray(t.legends),t._destroyRaphaelArray(t.legendIcons),t._destroyRaphaelArray(t.legendDots),t._destroyRaphaelArray(t.axisEles),t._destroyRaphaelArray(t.chartLabelEles),t.tooltip&&(t.tooltip.destroy(),t.tooltip=null),t.dataPoints=null,t.pointXs=null,e&&e.trackers&&(t._destroyRaphaelArray(e.trackers),e.trackers=null),t.headerEles=[],t.footerEles=[],t.legendEles=[],t.legends=[],t.legendIcons=[],t.legendDots=[],t.axisEles=[],t.chartLabelEles=[],e&&e.chartElements&&(i.each(e.chartElements,function(e,i){t._destroyRaphaelArray(i)}),e.chartElements=null),e&&e.seriesEles&&(e.seriesEles=null),t.seriesEles&&(t.seriesEles=[]),t.canvas.clear(),t.innerState=null,t.axisInfo=null,t.seriesGroup=null,t.lastAxisOffset=null,t.innerState={}},e.prototype._text=function(t,e,i){var n=this.canvas.text(t,e,i);return this.options.disableDefaultTextStyle&&(n.node.style.cssText=""),n},e.prototype._paint=function(){var t=this,e=t.options,i=t.element,n="none"===i.css("display")||"hidden"===i.css("visibility"),o={},r=null;return n&&(o=i.css("left"),r=i.css("position"),i.css("left","-10000px"),i.css("position","absolute"),i.show()),i.is(":hidden")?void(n&&(i.css("left",o),i.css("position",r),i.hide())):(t._clearChartElement(),void(t._trigger("beforePaint")!==!1&&(t._preHandleSeriesData(),t.canvasBounds={startX:0,endX:e.width||i.width(),startY:0,endY:e.height||i.height()},t._paintHeader(),t._paintFooter(),t._paintLegend(),t._paintChartArea(),e.indicator&&e.indicator.visible&&this.pointXs&&(this.pointXs=this.pointXs.sort(function(t,e){return t-e})),t._paintTooltip(),t._trigger("painted"),t.rendered=!0,t.styles&&(e.seriesStyles=t.styles.style,e.seriesHoverStyles=t.styles.hoverStyles),n&&(i.css("left",o),i.css("position",r),i.hide()))))},e.prototype._paintIndicater=function(){},e.prototype._calculatePosition=function(t,e,i){var n={x:0,y:0},o=5,r=5,s=this.canvasBounds;switch(t){case"north":n.x=(s.endX-s.startX)/2,n.y=s.startY+i/2+r,s.startY=s.startY+2*r+i;break;case"south":n.x=(s.endX-s.startX)/2,n.y=s.endY-i/2-r,s.endY=s.endY-2*r-i;break;case"east":n.x=s.endX-e/2-o,n.y=(s.endY-s.startY)/2,s.endX=s.endX-2*o-e;break;case"west":n.x=s.startX+e/2+o,n.y=(s.endY-s.startY)/2,s.startX=s.startX+2*o+e}return n},e.prototype._paintHeader=function(){var t=2,e=this,n=e.options,o=n.header,r=null,s=null,a=null,l=null,h=null,d=null,c=0,u=null;o.text&&o.text.length>0&&o.visible&&(r=o.compass,s=e._text(0,0,o.text),i.wijraphael.addClass(i(s.node),n.wijCSS.headerText),c=e._getRotationByCompass(r),a=i.extend(!0,{},n.textStyle,o.textStyle),s.attr(a),s.transform("...R"+c),l=s.wijGetBBox(),h=e._calculatePosition(r,l.width,l.height),s.transform(Raphael.format("...T{0},{1}",h.x,h.y)),d=s.wijGetBBox(),u=e.canvas.rect(d.x-t,d.y-t,d.width+2*t,d.height+2*t),i.wijraphael.addClass(i(u.node),n.wijCSS.headerContainer),u.attr(o.style),u.toBack(),e.headerEles.push(s),e.headerEles.push(u))},e.prototype._paintFooter=function(){var t=2,e=this,n=e.options,o=n.footer,r=null,s=null,a=null,l=null,h=null,d=null,c=0,u=null;o.text&&o.text.length>0&&o.visible&&(r=o.compass,s=e._text(0,0,o.text),i.wijraphael.addClass(i(s.node),n.wijCSS.footerText),c=e._getRotationByCompass(r),a=i.extend(!0,{},n.textStyle,o.textStyle),s.attr(a),s.transform("...R"+c),l=s.wijGetBBox(),h=e._calculatePosition(r,l.width,l.height),s.transform(Raphael.format("...T{0},{1}",h.x,h.y)),d=s.wijGetBBox(),u=e.canvas.rect(d.x-t,d.y-t,d.width+2*t,d.height+2*t),i.wijraphael.addClass(i(u.node),n.wijCSS.footerContainer),u.attr(o.style),u.toBack(),e.footerEles.push(s),e.footerEles.push(u))},e.prototype._getRotationByCompass=function(t){var e=0;return"east"===t?e=90:"west"===t&&(e=-90),e},e.prototype._paintLegendIcon=function(t,e,n,o,r,s,a,l,h,d){var c=this,u=c.canvas.rect(t,e,n,o);return i(u.node).data("legendIndex",s).data("index",a),c.legendIcons.push(u),r&&u.attr(r),i.wijraphael.addClass(i(u.node),l),u},e.prototype._paintLegend=function(){if(this.options.legend.visible){var t=this,e=t.options,n=i.extend(!0,{size:{width:22,height:10}},e.legend),o=2,r=e.seriesStyles,s=[].concat(e.seriesList),a=n.compass,l=n.orientation,h,d,c,u,p=t.canvasBounds,g=p.endX-p.startX,f=p.endY-p.startY,m=n.size.width,w=n.size.height,y,v=0,_=0,S=0,x=0,b=0,C=0,D=1,I=0,j=0,T=0,E=0,k=0,L,P,M,F,A=[],B=0,R=0,O=0,G=[];n.text&&n.text.length&&(h=t._text(0,0,n.text),i.wijraphael.addClass(i(h.node),e.wijCSS.legendTitle),d=i.extend(!0,{},e.textStyle,n.textStyle,n.titleStyle),h.attr(d),t.legendEles.push(h)),n.reversed&&(s=s.reverse()),O=s.length,"wijcompositechart"===t.widgetName&&(O=0,i.each(s,function(t,e){"pie"===e.type?O+=e.data.length:O++})),i.each(s,function(o,s){function a(o){var s=n.reversed?O-1-B:B,a=r[s],l=i.extend(!0,{fill:"none",opacity:1,stroke:"black"},a),h,d,c,u=!1,p=o.type,g;o.legendEntry&&"exclude"!==o.display&&(d=i.extend(!0,{},e.textStyle,n.textStyle),n.textWidth?h=t.canvas.wrapText(0,0,o.label,n.textWidth,"far",d):(h=t._text(0,0,o.label),h.attr(d)),i.wijraphael.addClass(i(h.node),e.wijCSS.legendText+" "+e.wijCSS.legend),t.legends.push(h),c=i.extend(l,{"stroke-width":1}),A.push(c),G.push(o),u="wijcompositechart"===t.widgetName?"line"===p||"spline"===p||"bezier"===p||"area"===p:"wijlinechart"===t.widgetName,n.textWidth?i.each(h,function(t,n){o.visible===!1&&(!u||u&&(!o.markers||!o.markers.visible))&&(i(n.node).data("hidden",!0).data("textOpacity",n.attr("opacity")||1),n.attr("opacity",.3)),i.wijraphael.addClass(i(n.node),e.wijCSS.legendText+" "+e.wijCSS.legend),i(n.node).data("legendIndex",R).data("index",B)}):(o.visible===!1&&(!u||u&&(!o.markers||!o.markers.visible))&&(i(h.node).data("hidden",!0).data("textOpacity",h.attr("opacity")||1),h.attr("opacity",.3)),i.wijraphael.addClass(i(h.node),e.wijCSS.legendText+" "+e.wijCSS.legend),i(h.node).data("legendIndex",R).data("index",B)),R++),B++}if(s=i.extend(!0,{legendEntry:!0,display:"show"},s),"pie"===s.type&&s.legendEntry)i.each(s.data,function(t,e){e=i.extend({legendEntry:s.legendEntry},e),a(e)});else if(t._isPieChart())a(s);else if(t._isStockChart()&&t._validateSeriesData(s))a(s);else{if(void 0===s.data.x&&void 0===s.data.xy||void 0===s.data.xy&&void 0===s.data.y)return!0;a(s)}}),c=t.legends.length,u=n.textMargin,h&&(y=h.wijGetBBox(),v=y.height,_=y.width),i.each(t.legends,function(t,e){var i=e.wijGetBBox();i.width>S&&(S=i.width),i.height>x&&(x=i.height)}),"east"===a||"west"===a?"horizontal"===l?(b=c*(S+m+o)+c*(u.left+u.right),b>g/2?(D=Math.floor(g/2/S),1>D&&(D=1)):D=c):"vertical"===l&&(C=x*c+v+c*(u.top+u.bottom),D=C>f?Math.ceil(C/f):1):("south"===a||"north"===a)&&("horizontal"===l?(b=(S+m+o)*c+c*(u.left+u.right),b>g?(D=Math.floor(c/b*g),1>D&&(D=1)):D=c):"vertical"===l&&(C=x*c+v+c*(u.top+u.bottom),C>f/2?(I=Math.floor(f-v)/2/x,D=Math.ceil(c/I)):D=1)),0===D&&(D=1),j=D*(S+m+o)+D*(u.left+u.right),T=x*Math.ceil(c/D)+v+Math.ceil(c/D)*(u.top+u.bottom),j=j>_?j:_,L=t._calculatePosition(a,j,T),P=L.x-j/2,M=L.y-T/2,F=t.canvas.rect(P-o,M-o,j+2*o,T+2*o),i.wijraphael.addClass(i(F.node),e.wijCSS.legendContainer),F.attr(n.style),F.toBack(),t.legendEles.push(F),h&&h.transform(Raphael.format("...T{0},{1}",P+j/2,M+v/2)),E=v,i.each(t.legends,function(r,s){g=A[r];var a=s.wijGetBBox(),l,h=g["stroke-width"]||0,d=P+k*(m+2*h+S+o)+(k+1)*u.left+k*u.right,c=M+E+a.height/2+u.top+x/2-a.height/2,p=c-w/2-h,g,f,y=s;n.textWidth&&(y=s[0]),l=t._paintLegendIcon(d,p,m,w,g,i(y.node).data("legendIndex"),i(y.node).data("index"),e.wijCSS.legendIcon+" "+e.wijCSS.legend,G[i(y.node).data("legendIndex")],y),i(y.node).data("hidden")===!0&&(i(y.node).data("iconOpacity",l.attr("opacity")||1),l.attr("opacity",.3)),"start"===n.textStyle["text-anchor"]&&(d-=a.width/2),n.textWidth?s.transform(Raphael.format("...T{0},{1}",d+m+o,c-a.height/2)):s.transform(Raphael.format("...T{0},{1}",d+m+o+a.width/2,c)),Raphael.vml&&(f=t.canvas.rect(d+m+o,c-a.height/2,a.width,a.height).attr({stroke:"none",fill:"#000000",opacity:.01}),i.wijraphael.addClass(i(f.node),e.wijCSS.legendTextCover+" "+e.wijCSS.legend),i(f.node).data("legendIndex",i(y.node).data("legendIndex")),i(f.node).data("index",i(y.node).data("index")),t.legendEles.push(f)),s.toFront(),k++,k===D&&(k=0,E+=x+u.top+u.bottom)})}},e.prototype._getLegendStyle=function(t){return t},e.prototype._hasAxes=function(){return"wijpiechart"===this.widgetName?!1:!0},e.prototype._applyAxisText=function(t,e){var n=this,o=t.text,r=null,s=null,a=null,l=0,h=0,d=e.bounds||n.canvasBounds;if(null!==o&&void 0!==o&&o.length>0){switch(s=n._text(-100,-100,o),a=i.extend(!0,{},n.options.textStyle,t.textStyle),s.attr(a),r=s.wijGetBBox(),a["margin-left"]&&(h+=parseFloat(a["margin-left"])),a["margin-top"]&&(l+=parseFloat(a["margin-top"])),a["margin-right"]&&(h+=parseFloat(a["margin-right"])),a["margin-bottom"]&&(l+=parseFloat(a["margin-bottom"])),t.compass){case"north":d.startY+=r.height+l;break;case"south":d.endY-=r.height+l;break;case"east":d.endX-=r.height+h;break;case"west":d.startX+=r.height+h}s.wijRemove(),s=null}return r},e.prototype._isSeriesDataEmpty=function(){var t=this,e=t.options.seriesList;return e&&0!==e.length?(i.each(e,function(t,e){return e.data&&(e.data.x&&e.data.y||e.data.xy)?void 0:!0}),!1):!0},e.prototype._setTooltipContent=function(t){var e=this,n,o,r,s=e.tooltip,a,l={},h=e.options.hint,d=i.isFunction;s&&(n=[],i.each(t,function(t,e){var o=e.valX,r=e.valY;o&&r?n.push(i.extend({},e,{x:o,y:r})):n.push(e)}),a=s.getOptions(),o=h.title,r=h.content,d(o)&&(l.title=function(){return o.call(n)}),d(r)&&(l.content=function(){return r.call(n)}),s.setOptions(l))},e.prototype._setTooltip=function(){var t=this,e=t.options,i=t.tooltip,n;i&&(n={closeBehavior:"none",style:{stroke:e.indicator.style.stroke},animated:!1,showDelay:0,hideDelay:0,windowCollisionDetection:"fit",beforeShowing:function(e,i){return this.target&&t.indicatorLine?!1:void 0}},e.horizontal&&(n.compass="east"),i.setOptions(n))},e.prototype._resetTooltip=function(){var t=this,e=t.options,n=e.hint,o=n.title,r=n.content,s=t.tooltip,a=i.isFunction,l=i.extend(!0,{},this.options.hint);s&&(l.animated=n.animated,l.showDelay=n.showDelay,l.hideDelay=n.hideDelay,l.title=n.title,l.content=n.content,l.closeBehavior=n.closeBehavior||"auto",l.windowCollisionDetection="fit",a(o)&&(l.title=function(){return t._getTooltipText(o,this.target)}),a(r)&&(l.content=function(){return t._getTooltipText(r,this.target)}),l.beforeShowing=function(){t._onBeforeTooltipShowing(this)},s.setOptions(l))},e.prototype._fotmatTooltip=function(t){var e=this;return e._isDate(t)?Globalize.format(t,"f",e._getCulture()):isNaN(t)?t:Globalize.format(parseFloat(t),"n",e._getCulture())},e.prototype._paintTooltip=function(){var t=this,e=t.options,n=e.hint,o=!e.disabled&&n.enable,s=n,a,l,h=i.isFunction;o&&!t.tooltip&&(s=i.extend(!0,{},n,{}),a=n.title,l=n.content,l||(l=n.content=function(){var e;if(i.isArray(this)){var n="";return i.each(this,function(i,o){e=o.label,o.lineSeries&&o.lineSeries.label&&(e=o.lineSeries.label),n+=e+":"+t._fotmatTooltip(o.y)+"\n"}),n}return e=this.label,this.lineSeries&&this.lineSeries.label&&(e=this.lineSeries.label),e+":"+t._fotmatTooltip(this.y)}),h(a)&&(s.title=function(){return t._getTooltipText(a,this.target)}),h(l)&&(s.content=function(){return t._getTooltipText(l,this.target)}),s.beforeShowing=function(){t._onBeforeTooltipShowing(this)},t.tooltip=new r(t.canvas,null,s))},e.prototype._getTooltipText=function(t,e){var n=i(e.node).data("wijchartDataObj"),o={data:n,label:n.label,x:n.x,y:n.y,target:e,fmt:t};return i.proxy(t,o)()},e.prototype._onBeforeTooltipShowing=function(t){var e=t.target,i=this.options.hint.style;e&&(t.options.style.stroke=i.stroke||e.attrs.stroke||e.attrs.fill)},e.prototype._paintChartArea=function(){var t=this,e=t.options,n=e.axis,o=2,r=null,s=null,a={},l=5,h=0,d=0,c=i.isArray(n.y),u=0,p,g,f;if(t._applyMargins(),t.isMultiYAxis=c,!t._isSeriesDataEmpty())if(c&&i.each(n.y,function(t,e){n.y[t]=i.extend(!0,{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!1,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"center",width:null},compass:"west",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!0,style:{stroke:"#999999","stroke-width":"0.5","stroke-dasharray":"none"}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]},e)}),t._hasAxes()){if(t.innerState.axisInfo)t.axisInfo=t.innerState.axisInfo,t.canvasBounds=t.innerState.canvasBounds;else{for(r=t._applyAxisText(n.x,{}),t.axisInfo={x:{id:"x",tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,originalMax:0,originalMin:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:r,axisTextOffset:o,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:n.x.annoMethod,valueLabels:n.x.valueLabels||[]},y:{}},t.axisCompass[n.x.compass]=!0,c?i.each(n.y,function(e,i){s=t._applyAxisText(i,{}),t.axisInfo.y[e.toString()]={id:"y"+e,tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:s,axisTextOffset:o,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:i.annoMethod,valueLabels:i.valueLabels||[]},t.axisCompass[i.compass]||(t.axisCompass[i.compass]=!0)}):(s=t._applyAxisText(n.y,{}),t.axisInfo.y[0]={id:"y",tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:s,axisTextOffset:o,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:n.y.annoMethod,valueLabels:n.y.valueLabels||[]},t.axisCompass[n.y.compass]||(t.axisCompass[n.y.compass]=!0)),t._getSeriesGroup(c),a=t._getDataExtreme(c),t.extremeValue=a,n.x.autoMin&&t.axisInfo.x.autoMin?n.x.min=a.txn:n.x.min&&t._isDate(n.x.min)&&(n.x.min=i.toOADate(n.x.min)),n.x.autoMax&&t.axisInfo.x.autoMax?n.x.max=a.txx:n.x.max&&t._isDate(n.x.max)&&(n.x.max=i.toOADate(n.x.max)),i.each(a.y,function(t,e){u++}),p=0;p<(n.y.length||1);p++){g=n.y[p]||n.y,f=p.toString(),g.autoMin&&t.axisInfo.y[f].autoMin&&a.y[f]?g.min=a.y[f].tyn:g.min&&t._isDate(g.min)&&(g.min=i.toOADate(g.min)),g.autoMax&&t.axisInfo.y[f].autoMax&&a.y[f]?g.max=a.y[f].tyx||0:g.max&&t._isDate(g.max)&&(g.max=i.toOADate(g.max));do{if(d=t._autoPosition(t.axisInfo,n,"y",f),h=t._autoPosition(t.axisInfo,n,"x",f),d===t.axisInfo.y[f].offset&&h===t.axisInfo.x.offset){l=0;break}!isNaN(h)&&!isNaN(d)&&(d!==t.axisInfo.y[f].offset&&0!==d&&(t.axisInfo.y[f].offset=d,t.axisInfo.y[f].vOffset=h),h!==t.axisInfo.x.offset&&0!==h&&(t.axisInfo.x.offset=h,t.axisInfo.x.vOffset=d)),l--}while(l>0)}t._adjustPlotArea(n.x,t.axisInfo.x),t._adjustPlotArea(n.y,t.axisInfo.y,!0),t.innerState.axisInfo=t.axisInfo,t.innerState.canvasBounds=t.canvasBounds}t._paintAxes(),t._paintPlotArea()}else t._paintPlotArea()},e.prototype._getSeriesGroup=function(t){var e=this,n=e.options,o={};i.each(n.seriesList,function(e,i){i.yAxis&&t?o[i.yAxis.toString()]?o[i.yAxis.toString()].push(i):o[i.yAxis.toString()]=[i]:o[0]?o[0].push(i):o[0]=[i]}),e.seriesGroup=o},e.prototype._adjustPlotArea=function(t,e,n){var o=this.canvasBounds,r,s={east:Number.MIN_VALUE,west:Number.MIN_VALUE,south:Number.MIN_VALUE,north:Number.MIN_VALUE};if(n)i.each(e,function(t,e){r=t}),i.each(e,function(e,i){var n=t[e]||t,o=n.compass;switch(n.max=i.max,n.min=i.min,o){case"north":s.north=Math.max(i.offset,s.north);break;case"south":s.south=Math.max(i.offset,s.south);break;case"east":s.east=Math.max(i.offset,s.east);break;case"west":s.west=Math.max(i.offset,s.west)}}),s.north!==Number.MIN_VALUE&&(o.startY+=s.north),s.south!==Number.MIN_VALUE&&(o.endY-=s.south),s.east!==Number.MIN_VALUE&&(o.endX-=s.east),s.west!==Number.MIN_VALUE&&(o.startX+=s.west);else switch(t.max=e.max,t.min=e.min,t.compass){case"north":o.startY+=e.offset;break;case"south":o.endY-=e.offset;break;case"east":o.endX-=e.offset;break;case"west":o.startX+=e.offset}},e.prototype._autoPosition=function(t,e,i,n){return this._autoPositionCartesianAxis(t,e,i,n)},e.prototype._autoPositionCartesianAxis=function(t,e,n,o){var r=this,s=null,a,l,h,d,c,u,p,g,f=r.lastAxisOffset||{},m,w;switch("y"===n?(a=t.y[o],l=e.y[o]||e.y,d=e.x,h=t.x):(a=t.x,l=e.x,h=t.y[o],d=e.y[o]||e.y),c=l.compass,u=d.origin,p=h.max,g=h.min,null!==u&&r._isDate(u)&&(u=i.toOADate(u)),r._calculateParameters(a,l),s=r._getMaxExtents(a,l),c){case"north":case"south":m=s.height,a.maxExtent=m;break;case"east":case"west":m=s.width,a.maxExtent=m}return"y"===n&&f[c]&&(i.each(f[c],function(t,e){t!==o&&(w=e)}),w&&!a.isPartAxis&&(a.preStartOffset=w,m+=w)),"y"===n&&(void 0===f[c]&&(f[c]={}),f[c][o]=m+r._getAxisLabelBox(l).width,r.lastAxisOffset=f),m},e.prototype._getAxisLabelBox=function(t){var e=this,n=e.options,o=t.text,r=0,s=0,a=0,l=0,h,d,c=e._isVertical(t.compass),u=i.extend(!0,{},n.textStyle,t.textStyle);return u["margin-top"]&&(r=parseFloat(u["margin-top"])),u["margin-left"]&&(a=parseFloat(u["margin-left"])),u["margin-right"]&&(s=parseFloat(u["margin-right"])),u["margin-bottom"]&&(l=parseFloat(u["margin-bottom"])),h=e._text(0,0,o),h.attr(u),c&&h.transform("...R-90"),d=h.wijGetBBox(),h.wijRemove(),h=null,{width:d.width+a+s,height:d.height+l+r}},e.prototype._getMaxExtents=function(t,e,n){var o=this,r=o.options,s=null,a={width:0,height:0},l=t.min,h=t.max,d=t.isTime,c=e.annoFormatString,u=r.is100Percent,p=0,g=e.compass,f=e.labels,m,w=!1,y=t.bounds||o.canvasBounds,v,_;return t.majorTickRect=o._getTickRect(t,e,!0,!0,n),t.minorTickRect=o._getTickRect(t,e,!1,!0,n),s=o._getMajorTickValues(t,e),e.textVisible?(c&&0!==c.length||(c=t.annoFormatString),m=i.extend(!0,{},r.textStyle,e.textStyle,f.style),_=m.transform,w=_&&/r/i.test(_),m=i.extend(!0,m,t.textStyle),v=y.endX-y.startX-t.vOffset-t.axisTextOffset,s&&s.length&&(v/=s.length-1,i.each(s,function(e,n){var r,s,y;if(l>n||n>h)return!0;if("valueLabels"===t.annoMethod){if(0>n)return!0;if(p>=t.valueLabels.length)return!1;n=t.valueLabels[p],n.text?n=n.text:"undefined"!=typeof n.value&&(n=n.value,c&&c.length&&(n=Globalize.format(n,c,o._getCulture())))}else"values"===t.annoMethod&&(c&&c.length?(d&&(n=i.fromOADate(n)),n=Globalize.format(n,c,o._getCulture())):u&&"y"===t.id&&(n=Globalize.format(n,"p0",o._getCulture())));r=f.width?o.canvas.wrapText(-100,-100,n,f.width,f.textAlign,m):o._text(-100,-100,n).attr(m),s=r.wijGetBBox(),!o._isVertical(g)&&!w&&"valueLabels"===t.annoMethod&&s.width>v&&(r.attr({transform:"r-45"}),s=r.wijGetBBox(),0===e&&(m.transform="r-45",t.textStyle={transform:"r-45"},y=r.clone(),y.attr({transform:"r0"}),s=y.wijGetBBox(),Math.sqrt(2)*s.height>v&&(r.attr({transform:"r-90"}),m.transform="r-90",t.textStyle={transform:"r-90"}),y.wijRemove(),y=null,s=r.wijGetBBox())),r.wijRemove(),r=null,s.width>a.width&&(a.width=s.width),s.height>a.height&&(a.height=s.height),p++})),a.width<f.width&&(a.width=f.width),t.labelWidth=a.width,a):a},e.prototype._getMajorTickValues=function(t,e){var n=[],o=e.autoMajor,r=e.unitMajor,s,a,l=t.valueLabels;return l&&l.length>0&&i.each(l,function(t,e){return"undefined"!=typeof e.text||"undefined"!=typeof e.value?!1:void("string"==typeof e?l[t]={text:e,gridLine:!1}:l[t]={value:e,gridLine:!1})}),"valueLabels"===t.annoMethod&&l&&l.length>0&&"undefined"!=typeof l[0].value?n=this._getSortedDataValues(t,e):("x"===t.id?(s=o?t.max:t.originalMax,a=o?t.min:t.originalMin):(s=t.max,a=t.min),n=this._getTickValues(s,a,r,t.tprec,!t.isTime,o))},e.prototype._getSortedDataValues=function(t,e){var n=this,o=[],r=t.valueLabels;return i.each(r,function(t,e){var r=e.value;n._isDate(r)?o.push(i.toOADate(r)):"number"==typeof r?o.push(r):o.push(t)}),o},e.prototype._getMinorTickValues=function(t,e){var i=[],n=e.autoMinor,o=e.unitMinor,r,s;return"x"===t.id?(r=n?t.max:t.originalMax,s=n?t.min:t.originalMin):(r=t.max,s=t.min),i=this._getTickValues(r,s,o,t.tprec,!t.isTime,n)},e.prototype._getTickValues=function(t,e,n,r,s,a){var l=this,h=[],d=e,c=0,u=0,p=0,g=0,f=0,m=0;try{if(0===n)h=[t,e];else for(a?(0>r+1?r=-1:r+1>15&&(r=14),m=i.round(o.signedCeiling(e/n)*n,r+1),t>m&&(e=m),p=parseInt(i.round(t/n,5).toString(),10),g=parseInt(i.round(e/n,5).toString(),10),f=parseInt((p-g+1).toString(),10),f>1&&(u=g*n,e>u&&(f--,e+=n),u=e+(f-1)*n,u>t&&f--),1>f&&(f=2,e=d,n=t-e)):(f=parseInt(((t-e)/n+1).toString(),10),f>1&&(u=e+(f-1)*n,u>t&&f--),1>f&&(f=2,n=t-e)),c=0;f>c;c++)s&&a?h[c]=i.round(e+c*n,r+1):h[c]=e+c*n}catch(w){}return h},e.prototype._getTickRect=function(t,e,i,n,o){var r=e.compass,s=0,a=null,l=3,h=2,d=2,c=e.tickMajor.factor,u=e.tickMinor.factor,p={x:0,y:0,width:0,height:0};return i?(a=e.tickMajor.position,c=c>0?c:1,s=l*c):(a=e.tickMinor.position,u=u>0?u:1,s=h*u),("none"===a||"inside"===a&&n)&&(s=0),"east"===r||"west"===r?(p={x:0,y:-1,width:s*d,height:d},"east"===r&&("outside"===a||"cross"===a&&n)||"west"===r&&"inside"===a?p.width+=2:n||("cross"===a&&(p.width<<=1),p.width+=2)):(p={x:-1,y:0,width:d,height:s*d},"south"===r&&("outside"===a||"corss"===a&&n)||"north"===r&&"inside"===a?p.height+=2:n||("cross"===a&&(p.height<<=1),p.height+=2)),p},e.prototype._applyMargins=function(){var t=this,e=t.options,i=t.canvasBounds;i.startX+=e.marginLeft,i.endX-=e.marginRight,i.startY+=e.marginTop,i.endY-=e.marginBottom},e.prototype._paintAxes=function(){var t=this,e=t.options.axis,n=t.axisInfo,o=e.x,r=e.y,s=n.x,a=n.y,l;l=t._paintAxis(o,s),i.each(a,function(e,i){var n=r[e]||r;null!==n.origin&&t._translateAxisIfNeeded(l,o.compass,n.origin,n.compass,i.max,i.min)}),i.each(a,function(e,i){var n=r[e]||r;l=t._paintAxis(n,i),null!==o.origin&&t._translateAxisIfNeeded(l,n.compass,o.origin,o.compass,s.max,s.min)})},e.prototype._translateAxisIfNeeded=function(t,e,n,o,r,s){var a=this,l="west"===o||"east"===o,h=a.canvasBounds,d=n,c;a._isDate(d)&&(d=i.toOADate(d)),l?(c="south"===e?(s-d)/(r-s)*(h.endY-h.startY):(r-d)/(r-s)*(h.endY-h.startY),i.each(t,function(t,e){e.transform(Raphael.format("...T{0},{1}",0,c))})):(c="west"===e?(d-s)/(r-s)*(h.endX-h.startX):(d-r)/(r-s)*(h.endX-h.startX),i.each(t,function(t,e){e.transform(Raphael.format("...T{0},{1}",c,0))}))},e.prototype._paintAxis=function(t,e){var n=this,o=n.options,r=e.bounds||n.canvasBounds,s={x:0,y:0},a={x:0,y:0},l=t.compass,h=2,d=!0,c=null,u=[],p=[],g=[],f=e.max,m=e.min,w=t.unitMajor,y=t.unitMinor,v=t.tickMajor.position,_=t.tickMinor.position,S=e.maxExtent,x=t.tickMajor.style,b=t.tickMinor.style,C=e.majorTickRect,D=e.minorTickRect,I=e.axisTextOffset,j=t.gridMajor,T=t.gridMinor,E=t.labels,k=0,L=[],P=0,M=t.annoFormatString,F=null,A=[];switch(C=n._getTickRect(e,t,!0,!1),D=n._getTickRect(e,t,!1,!1),M&&0!==M.length||(M=e.annoFormatString),u=n._getMajorTickValues(e,t),p=n._getMinorTickValues(e,t),g=n._resetMinorTickValues(p,u),l){case"south":s.x=r.startX,s.y=r.endY,a.x=r.endX,a.y=r.endY,d=!1;break;case"north":s.x=r.startX,s.y=r.startY-h,a.x=r.endX,a.y=r.startY-h,d=!1;break;case"east":s.x=r.endX-h,s.y=r.endY,a.x=r.endX-h,a.y=r.startY,e.preStartOffset&&(s.x+=e.preStartOffset,a.x+=e.preStartOffset);break;case"west":s.x=r.startX,s.y=r.endY,a.x=r.startX,a.y=r.startY,e.preStartOffset&&(s.x-=e.preStartOffset,a.x-=e.preStartOffset)}return t.visible&&(c=n.canvas.line(s.x,s.y,a.x,a.y).attr(t.style),i.wijraphael.addClass(i(c.node),o.wijCSS.axis),n.axisEles.push(c),A.push(c)),i.each(u,function(r,h){
var d=h,c=e.isTime,u=o.is100Percent,p,g,y=!1,_={};if(m>h||h>f)return P++,!0;if("valueLabels"===e.annoMethod){if(P>=e.valueLabels.length)return!1;d=e.valueLabels[P],y=d.gridLine,_=d.gridLineStyle,d.text?d=d.text:"undefined"!=typeof d.value&&(d=d.value,M&&M.length&&(d=Globalize.format(d,M,n._getCulture())))}else"values"===e.annoMethod&&(M&&M.length?(c&&(d=i.fromOADate(h)),d=Globalize.format(d,M,n._getCulture())):u&&"y"===e.id&&(d=Globalize.format(h,"p0",n._getCulture())));F=i.extend(!0,{},o.textStyle,t.textStyle,E.style,e.textStyle),"x"===e.id&&(d=n._getTickText(d)),p=n._paintMajorMinor(t.origin,f,m,h,v,w,C,l,s,a,S,I,x,d,j,t.textVisible,F,E.textAlign,E.width?e.labelWidth:null,y,_),p&&(p.elements&&(A=A.concat(p.elements)),g=p.textInfo),g&&(L.push(g),k<g.len&&(k=g.len)),P++}),E.width||i.each(L,function(t,e){var i=e.text,n=(e.len-k)/2;n="near"===E.textAlign?-1*n:n,d?i.transform(Raphael.format("...T{0},{1}",n,0)):i.transform(Raphael.format("...T{0},{1}",0,n))}),i.each(g,function(i,o){var r;o>m&&f>o&&(r=n._paintMajorMinor(t.origin,f,m,o,_,y,D,l,s,a,S,I,b,null,T,t.textVisible,F,E.textAlign,E.width?e.labelWidth:null),r&&r.elements&&(A=A.concat(r.elements)))}),t.text&&t.text.length>0&&A.push(n._paintAxisText(t,e)),e.isPartAxis&&!e.isLastAxis&&A.push(n.canvas.path(["M",s.x.toString(),s.y.toString()+(e.vOffset/2).toString,"H",(s.x+2*e.maxExtent).toString()].join())),A},e.prototype._paintAxisText=function(t,e){if(t.text&&0!==t.text.length){var n=this,o=n.options,r=t.text,s=t.compass,a=t.alignment,l=e.bounds||n.canvasBounds,h=l.startX,d=l.startY,c=l.endX,u=l.endY,p=h,g=d,f=e.textBounds,m=n._isVertical(s),w=e.axisTextOffset,y=e.majorTickRect,v=t.tickMajor.position,_=m?y.width:y.height,S=null,x=null,b=0,C=0,D=0,I=0;if(S=i.extend(!0,{},n.options.textStyle,t.textStyle),S["margin-top"]&&(b=parseFloat(S["margin-top"])),S["margin-left"]&&(C=parseFloat(S["margin-left"])),S["margin-right"]&&(D=parseFloat(S["margin-right"])),S["margin-bottom"]&&(I=parseFloat(S["margin-bottom"])),"cross"===v?_/=2:"inside"===v&&(_=0),m){switch(a){case"near":g=u-f.width/2;break;case"center":g=(d+u)/2;break;case"far":g=d+f.width/2}p="west"===s?h-(e.offset+w+_+f.height/2+D):c+e.offset+w+_+f.height/2+C}else{switch(a){case"near":p=h+f.width/2;break;case"center":p=(h+c)/2;break;case"far":p=c-f.width/2}g="north"===s?d-(e.offset+w+_+f.height/2+I):u+e.offset+w+_+f.height/2+b}return x=n._text(p,g,r),i.wijraphael.addClass(i(x.node),o.wijCSS.axisText),n.axisEles.push(x),x.attr(S),m&&x.transform("...R-90"),x}},e.prototype._resetMinorTickValues=function(t,e){var i=0,n=0,o=null,r=null;for(i=t.length-1;i>=0;i--)for(o=t[i],n=e.length-1;n>=0;n--)r=e[n],o===r&&t.splice(i,1);return t},e.prototype._getTickText=function(t){return t},e.prototype._paintMajorMinor=function(t,e,n,o,r,s,a,l,h,d,c,u,p,g,f,m,w,y,v,_,S){var x=this,b=h.x,C=h.y,D=x.options,I=-1,j=-1,T=!0,E=x.canvasBounds,k=null,L=null,P=[],M=[],F=null,A={"stroke-width":2},B={text:null,len:0},R=null,O={},G=[],U=x.axisCompass;switch(l){case"south":"inside"===r?C-=a.height:"cross"===r&&(C-=a.height/2),j=v?C+u+a.height:C+u+a.height+c/2,T=!1;break;case"west":"outside"===r?b-=a.width:"cross"===r&&(b-=a.width/2),I=v?b-(u+c):b-(u+c/2);break;case"north":"outside"===r?C-=a.height:"cross"===r&&(C-=a.height/2),j=v?C-(u+c):C-(u+c/2),T=!1;break;case"east":"inside"===r?b-=a.width:"cross"===r&&(b-=a.width/2),I=v?b+u+a.width:b+u+a.width+c/2}return T?(C+=(o-n)/(e-n)*(d.y-h.y),M=["M",E.startX,C,"H",E.endX],f.visible&&((C!==E.startY||!U.north)&&(C!==E.endY||!U.south)||t!==o)&&(F=x.canvas.path(M.join(" ")),i.wijraphael.addClass(i(F.node),D.wijCSS.axisGridLine),F.attr(f.style),x.axisEles.push(F)),_&&((C!==E.startY||!U.north)&&(C!==E.endY||!U.south)||t!==o)&&(F=x.canvas.path(M.join(" ")),i.wijraphael.addClass(i(F.node),D.wijCSS.axisGridLine),F.attr(i.extend(!0,f.style,S)),x.axisEles.push(F)),j=C,"none"!==r&&(P=["M",b,C,"h",a.width],p["stroke-width"]=a.height)):(b+=(o-n)/(e-n)*(d.x-h.x),M=["M",b,E.startY,"V",E.endY],f.visible&&((b!==E.startX||!U.west)&&(b!==E.endX||!U.east)||t!==o)&&(F=x.canvas.path(M.join(" ")),i.wijraphael.addClass(i(F.node),D.wijCSS.axisGridLine),F.attr(f.style),x.axisEles.push(F)),_&&((b!==E.startX||!U.west)&&(b!==E.endX||!U.east)||t!==o)&&(F=x.canvas.path(M.join(" ")),i.wijraphael.addClass(i(F.node),D.wijCSS.axisGridLine),F.attr(i.extend(!0,{},f.style,S)),x.axisEles.push(F)),I=v?b-v/2:b,"none"!==r&&(P=["M",b,C,"v",a.height],p["stroke-width"]=a.width)),"none"!==r&&(L=x.canvas.path(P.join(" ")),i.wijraphael.addClass(i(L.node),D.wijCSS.axisTick),A=i.extend(A,p),L.attr(A),x.axisEles.push(L),G.push(L)),null!==g&&m&&(v?(B=x.canvas.wrapText(I,j,g.toString(),v,y,w),i.wijraphael.addClass(i(B.node),D.wijCSS.axisLabel)):(B=x._text(I,j,g.toString()),i.wijraphael.addClass(i(B.node),D.wijCSS.axisLabel),B.attr(w)),x.axisEles.push(B),G.push(B),m||B.hide(),"center"!==y&&(R=B.getBBox(),k={text:B,len:T?R.width:R.height})),O={textInfo:k,elements:G}},e.prototype._paintPlotArea=function(){},e.prototype._paintChartLabels=function(){var t=this,e=t.options.chartLabels;e&&e.length&&i.each(e,function(e,n){var o;if(n=i.extend(!0,{compass:"east",attachMethod:"coordinate",attachMethodData:{seriesIndex:-1,pointIndex:-1,x:-1,y:-1},offset:0,visible:!1,text:"",connected:!1},n),n.visible){if(o=t._getChartLabelPointPosition(n),"number"!=typeof o.x||"number"!=typeof o.y)return!1;t._setChartLabel(n,o)}})},e.prototype._getChartLabelPointPosition=function(t){},e.prototype._setChartLabel=function(t,e,n,o){var r=this,s=t.compass,a=r.options,l=i.extend(!0,{},a.textStyle,a.chartLabelStyle),h=r._text(0,0,t.text).attr(l),d=t.offset,c=0,u=0,p=null,g=null;i.wijraphael.addClass(i(h.node),a.wijCSS.labelText),r.chartLabelEles.push(h),p=r._getCompassTextPosition(s,h.wijGetBBox(),d,e,n),d&&t.connected&&(g=r.canvas.path("M"+e.x+" "+e.y+"L"+p.endPoint.x+" "+p.endPoint.y),i.wijraphael.addClass(i(g.node),a.wijCSS.labelConnect),g.attr(o),r.chartLabelEles.push(g)),c=p.endPoint.x+p.offsetX,u=p.endPoint.y+p.offsetY,h.transform(Raphael.format("...T{0},{1}",c,u)).toFront()},e.prototype._getCompassTextPosition=function(t,e,n,o,r){var s=0,a=0,l={x:0,y:0};switch(t.toLowerCase()){case"east":r=0;break;case"west":r=180;break;case"north":r=90;break;case"south":r=270;break;case"northeast":r=45;break;case"northwest":r=135;break;case"southeast":r=315;break;case"southwest":r=225}return r>=0&&22.5>r||r>337.5&&360>r?s=e.width/2:r>=22.5&&67.5>r?(s=e.width/2,a=-1*e.height/2):r>=67.5&&112.5>r?a=-1*e.height/2:r>=112.5&&157.5>r?(s=-1*e.width/2,a=-1*e.height/2):r>=157.5&&202.5>r?s=-1*e.width/2:r>=202.5&&247.5>r?(s=-1*e.width/2,a=e.height/2):r>=247.5&&292.5>r?a=e.height/2:(s=e.width/2,a=e.height/2),l=i.wijraphael.getPositionByAngle(o.x,o.y,n,r),{endPoint:l,offsetX:s,offsetY:a}},e.prototype._mouseDown=function(t,e){this._trigger("mouseDown",t,e)},e.prototype._mouseUp=function(t,e){this._trigger("mouseUp",t,e)},e.prototype._mouseOver=function(t,e){this._trigger("mouseOver",t,e)},e.prototype._mouseOut=function(t,e){this._trigger("mouseOut",t,e)},e.prototype._mouseMove=function(t,e){this._trigger("mouseMove",t,e)},e.prototype._click=function(t,e){this._trigger("click",t,e)},e.prototype._mouseMoveInsidePlotArea=function(t,e){var n=this,o=n.options,r=o.indicator,s=n.canvas,a,l,h,d=0,c=[],u=o.horizontal;r&&r.visible&&this.isPlotAreaMouseDown&&(a=u?this._calculatePositionByX(e.top):this._calculatePositionByX(e.left),a&&this.indicatorLine&&a.x!==this.lastIndicatorPosition&&(i.each(a.data,function(t,e){e.visible&&c.push(e)}),c.length>0&&(l=n.canvasBounds,u?this.indicatorLine.transform("T0 "+a.x):this.indicatorLine.transform("T"+a.x+" 0"),this._setTooltipContent(c),u?this.tooltip.showAt({x:l.endX,y:a.x}):this.tooltip.showAt({x:a.x,y:l.startY}),this.lastIndicatorPosition=a.x,n._indicatorLineShowing(c),this.lastIndicatorObjects=c)))},e.prototype._calculatePositionByX=function(t){var e=this,i=e.pointXs,n,o=e.dataPoints;return i&&i.length>0&&(n=this._calculatePositionByXInternal(t,i)),o?{x:n,data:o[n.toString()]}:null},e.prototype._calculatePositionByXInternal=function(t,e){var i=e.length,n,o;return 1===i?e[0]:2===i?Math.abs(t-e[0])>Math.abs(t-e[1])?e[1]:e[0]:(n=parseInt((i/2).toString()),o=t>e[n]?e.slice(n):e.slice(0,n+1),this._calculatePositionByXInternal(t,o))},e.prototype._mouseMoveOutsidePlotArea=function(t,e){this.indicatorLine&&(this.indicatorLine.wijRemove(),this.indicatorLine=null,this.tooltip&&this.tooltip.hide(),this._resetTooltip())},e.prototype._mouseDownInsidePlotArea=function(t,e){this.isPlotAreaMouseDown=!0;var n=this,o=n.options,r=o.indicator,s=n.canvas,a,l,h,d=[],c=o.horizontal;r&&r.visible&&this.isPlotAreaMouseDown&&(n._setTooltip(),a=c?this._calculatePositionByX(e.top):this._calculatePositionByX(e.left),a&&(i.each(a.data,function(t,e){e.visible&&d.push(e)}),d.length>0&&(l=n.canvasBounds,h=c?["M",l.startX,0,"H",l.endX]:["M",0,l.startY,"V",l.endY],this.indicatorLine&&this.indicatorLine.wijRemove(),this.indicatorLine=s.path(h),this.indicatorLine.attr(r.style),c?this.indicatorLine.transform("T0 "+a.x):this.indicatorLine.transform("T"+a.x+" 0"),this._setTooltipContent(d),c?this.tooltip.showAt({x:l.endX,y:a.x}):this.tooltip.showAt({x:a.x,y:l.startY}),this.lastIndicatorPosition=a.x,n._indicatorLineShowing(d),this.lastIndicatorObjects=d)),t.preventDefault())},e.prototype._indicatorLineShowing=function(t){this.lastIndicatorObjects&&this._removeIndicatorStyles(this.lastIndicatorObjects)},e.prototype._removeIndicatorStyles=function(t){},e.prototype._mouseUpInsidePlotArea=function(t,e){this.isPlotAreaMouseDown=!1,this.indicatorLine&&(this.indicatorLine.wijRemove(),this.indicatorLine=null,this.tooltip&&this.tooltip.hide(),this._resetTooltip()),this.lastIndicatorObjects&&(this._removeIndicatorStyles(this.lastIndicatorObjects),this.lastIndicatorObjects=null)},e.prototype._bindLiveEvents=function(){this._bindLegendEvents(),this._bindCanvasEvents()},e.prototype._bindCanvasEvents=function(){var t=this,e=t.chartElement,n="",o="."+this.widgetName;window.navigator.msPointerEnabled&&e.css("-ms-touch-action","none"),i.support.isTouchEnabled&&i.support.isTouchEnabled()&&(n="wij"),e.bind(n+"mousemove"+o,function(i){var n=e.offset(),o=t.canvasBounds,r={left:i.pageX-n.left,top:i.pageY-n.top},s=t.options.disabled;s||(r.left>=o.startX&&r.left<=o.endX&&r.top>=o.startY&&r.top<=o.endY?t._mouseMoveInsidePlotArea(i,r):t._mouseMoveOutsidePlotArea(i,r))}),t.options.indicator&&t.options.indicator.visible&&e.bind(n+"mousedown"+o,function(i){var n=e.offset(),o=t.canvasBounds,r={left:i.pageX-n.left,top:i.pageY-n.top},s=t.options.disabled;s||r.left>=o.startX&&r.left<=o.endX&&r.top>=o.startY&&r.top<=o.endY&&t._mouseDownInsidePlotArea(i,r)}).bind(n+"mouseup"+o,function(i){var n=e.offset(),o=t.canvasBounds,r={left:i.pageX-n.left,top:i.pageY-n.top},s=t.options.disabled;s||r.left>=o.startX&&r.left<=o.endX&&r.top>=o.startY&&r.top<=o.endY&&t._mouseUpInsidePlotArea(i,r)})},e.prototype._unbindCanvasEvents=function(){window.navigator.msPointerEnabled&&this.element.css("-ms-touch-action",""),this.element.unbind("."+this.widgetName)},e.prototype._bindLegendEvents=function(){var t=this,e=t.chartElement;e.delegate("."+t.options.wijCSS.legend,"click.wijchartcore",function(e){if(!t.options.disabled){var n=i(e.target);n[0].tagName&&"tspan"===n[0].tagName&&(n=n.parent()),t._legendClick(n)}})},e.prototype._legendClick=function(t){if("undefined"!=typeof t.data("index")){var e=this,n=e.options.legend,o=t.data("index"),r=t.data("legendIndex"),s=e.chartElement.data("fields"),a=e.seriesEles,l,h=e.legendIcons[r],d=e.legends[r],c=i(n.textWidth?d[0].node:d.node),u=o,p;s&&s.seriesEles&&(a=s.seriesEles),e.legendDots&&e.legendDots.length>o&&(p=e.legendDots[o]),n.reversed&&(u=e.legends.length-1-o),l=a[u],l&&(c.data("hidden")?(e._showSerieEles(l),d.attr("opacity",c.data("textOpacity")),h.attr("opacity",c.data("iconOpacity")),p&&p.attr("opacity",c.data("dotOpacity")),c.data("hidden",!1)):(e._hideSerieEles(l),c.data("textOpacity")||(n.textWidth?c.data("textOpacity",d[0].attr("opacity")||1):c.data("textOpacity",d.attr("opacity")||1)),c.data("iconOpacity")||c.data("iconOpacity",h.attr("opacity")||1),p&&!c.data("dotOpacity")&&c.data("dotOpacity",h.attr("opacity")||1),d.attr("opacity","0.3"),h.attr("opacity","0.3"),p&&p.attr("opacity","0.3"),c.data("hidden",!0)))}},e.prototype._showSerieEles=function(t){},e.prototype._hideSerieEles=function(t){},e.prototype._unbindLiveEvents=function(){var t=this,e=t.options,i=this.chartElement,n=t.widgetName;i.undelegate("."+e.wijCSS.legend,".wijchartcore").undelegate("."+e.wijCSS.legend,"wijchartcore"),this._unbindCanvasEvents()},e.prototype._isBarChart=function(){return!1},e.prototype._isPieChart=function(){},e.prototype._isStockChart=function(){},e.prototype._validateSeriesData=function(t){return!1},e.prototype._calculateParameters=function(t,e){var i=this,n=e.max,r=e.min,s=e.autoMax&&t.autoMax,a=e.autoMin&&t.autoMin,l=e.autoMajor&&t.autoMajor,h=e.autoMinor&&t.autoMinor,d=null,c=null,u="valueLabels"===t.annoMethod,p=0,g=0,f=0,m=0,w=0,y=t.isTime,v=i.options.adjustMinValue;s&&n!==Number.MIN_VALUE&&"x"!==t.id&&i._isBarChart()&&0>n&&.5*(n-r)>-n&&(n=0),a&&r!==Number.MAX_VALUE&&"x"!==t.id&&i._isBarChart()&&r>0&&.5*(n-r)>r&&(r=0),n===r&&(0!==r&&(r-=1),n+=1),m=n-r,y&&(d=e.annoFormatString,d&&0!==d.length||(d=o.getTimeDefaultFormat(n,r),t.annoFormatString=d),w=o.niceTimeUnit(0,d)),c=o.nicePrecision(m),t.tprec=c,s&&(y?(g=o.roundTime(n,w,!0),n=n>g?g+w:g):(g=o.precCeil(-c,n),"number"==typeof g&&(n=g))),a&&(y?(f=o.roundTime(r,w,!1),r=f>r?f-w:f):(f=o.precFloor(-c,r),"number"==typeof f&&(r=f))),t.max=n,t.min=r,t.originalMax=n,t.originalMin=r,t.annoFormatString=d,t.tinc=w,(l||h)&&(m=n-r,i._calculateMajorMinor(e,t),p=e.unitMajor,s&&0!==p&&!y&&!u&&(m=n-parseInt((n/p).toString(),10)*p,0!==m&&(n+=p-m,n=o.precCeil(-c,n))),a&&0!==p&&!y&&!u&&(m=r-parseInt((r/p).toString(),10)*p,0!==m&&(0>m&&(m+=p),r-=Math.abs(m),r=o.precFloor(-c,r))),a&&0!==p&&!u&&("undefined"==typeof v||v===!1)&&a&&r===e.min&&r-p>=0&&"y"===t.id&&(r-=p)),t.max=n,t.min=r,t.originalMax=n,t.originalMin=r},e.prototype._supportStacked=function(){return!1},e.prototype._getDataExtreme=function(t){var e={txx:0,txn:0,tyx:0,tyn:0},i;return i=this._getDataExtremes(e,t),i?(i.txn>i.txx&&(i.txn=0,i.txx=1),i):(e.txn>e.txx&&(e.txn=0,e.txx=1),e)},e.prototype._getDataExtremes=function(t,e){var o=this,r=o.options,s=r.seriesList,a=r.stacked&&o._supportStacked(),l=r.is100Percent,h=r.axis,d=o.axisInfo,c=[],u=[],p=[],g,f={y:{}},m=h.x.valueLabels,w=d.x.annoMethod,y=d.y.annoMethod;return s&&0!==s.length?(i.each(s,function(t,e){var n=e.data,o=[],r=[],s,a=0;if(n.xy&&i.isArray(n.xy)){for(s=n.xy.length;s>a;)o.push(n.xy[a]),r.push(n.xy[a+1]),a+=2;n.x=o,n.y=r}}),o.seriesGroup&&i.each(o.seriesGroup,function(e,r){var s=[],m=parseInt(e,10);if(i.each(r,function(e,n){if("pie"===n.type)return!0;n=i.extend(!0,{display:"show"},n);var r=n.data,l=0,h=0,d=[].concat(r.xy),p=d.length,g,f;if("exclude"===n.display)return!0;if(c=[].concat(r.x),s=[].concat(r.y),r.xy&&p)for(c=[],s=[];p>h;)c[l]=d[h],s[l]=d[h+1],h+=2,l++,r.x=c,r.y=s;else r.x||(c=[],i.each(s,function(t){c.push(t)}),r.x=c);a&&e>0&&i.each(s,function(t){s[t]+=u[t]}),u=s,g=o._getMinMaxValue(c),f=o._getMinMaxValue(s),0===e?(t.txx=g.max,t.txn=g.min,t.tyx=f.max,t.tyn=f.min):(t.txx<g.max&&(t.txx=g.max),t.txn>g.min&&(t.txn=g.min),t.tyx<f.max&&(t.tyx=f.max),t.tyn>f.min&&(t.tyn=f.min)),e++}),l&&(t.tyx=1,t.tyn=0),f.y[e]={tyx:t.tyx,tyn:t.tyn},f.txx=t.txx,f.txn=t.txn,t.tyx=0,t.tyn=0,s.length)if(g=n.getFirstValidListValue(s),o._isDate(g))d.y[e].isTime=!0;else{if("undefined"==typeof g)return!0;"number"!=typeof g&&(i.each(s,function(t,e){var i=h.y.annoFormatString,n=e;n=i&&i.length>0?Globalize.format(n,i,o._getCulture()):n.toString(),p.push({text:n,value:e,gridLine:!1})}),d.y[e].annoMethod="valueLabels",h.y[m].valueLabels||0!==h.y[m].valueLabels.length?d.y[e].valueLabels=h.y[m].valueLabels:d.y[e].valueLabels=p,h.x.max=s.length-1,h.x.min=0,h.y[m].unitMajor=1,h.x.unitMinor=.5,d.y[e].autoMax=!1,d.y[e].autoMin=!1,d.y[e].autoMajor=!1,d.y[e].autoMinor=!1)}}),c.length&&(g=n.getFirstValidListValue(c),"valueLabels"===w&&m&&m.length>0&&(d.x.valueLabels=m),o._isDate(g)?d.x.isTime=!0:"number"!=typeof g&&(i.each(c,function(t,e){var n={},r,s;"valueLabels"===w&&m&&m.length&&t<m.length&&(r=m[t],s=typeof r,"string"===s?r={text:r}:("number"===s||o._isDate(r))&&(r={value:r})),n=i.extend({text:e,value:t,gridLine:!1},r),p.push(n)}),h.x.max=c.length-1,h.x.min=0,h.x.unitMajor=1,h.x.unitMinor=.5,d.x.annoMethod="valueLabels",d.x.valueLabels=p,d.x.autoMax=!1,d.x.autoMin=!1,d.x.autoMajor=!1,d.x.autoMinor=!1)),f):t},e.prototype._isVertical=function(t){return"west"===t||"east"===t},e.prototype._isDate=function(t){return t?"object"==typeof t&&t.constructor===Date:!1},e.prototype._getMinMaxValue=function(t){var e=this,o={min:0,max:0},r=0,s;if(!t.length)return o;if(s=n.getFirstValidListValue(t),"number"!=typeof s){if(!e._isDate(s))return o.min=0,o.max=t.length-1,o;o.min=s,o.max=s}else o.min=s,o.max=s;for(r=0;r<t.length;r++)null!==t[r]&&"undefined"!=typeof t[r]&&("number"==typeof t[r]&&isNaN(t[r])||(t[r]<o.min?o.min=t[r]:t[r]>o.max&&(o.max=t[r])));return e._isDate(o.min)&&(o.min=i.toOADate(o.min),o.max=i.toOADate(o.max)),o},e.prototype._calculateMajorMinor=function(t,e){var n=this,r=n.options,s=e.bounds||n.canvasBounds,a=t.autoMajor,l=t.autoMinor,h=e.max,d=e.min,c=e.isTime,u=e.tinc,p=e.annoFormatString,g=null,f=null,m=null,w=null,y=null,v=null,_=null,S=null,x=null,b=h-d,C=0,D=0,I=0,j=0;a&&(x=i.extend(!0,{},r.textStyle,t.textStyle,t.labels.style),c?(g=Globalize.format(i.fromOADate(h),p,n._getCulture()),f=Globalize.format(i.fromOADate(d),p,n._getCulture()),y=n._text(-1e3,-1e3,g).attr(x),v=n._text(-1e3,-1e3,f).attr(x),m=y.wijGetBBox(),w=v.wijGetBBox(),y.wijRemove(),y=null,v.wijRemove(),v=null):(_=o.nicePrecision(b),S=_+1,(0>S||S>15)&&(S=0),y=n._text(-1e3,-1e3,i.round(h,S).toString()).attr(x),v=n._text(-1e3,-1e3,i.round(d,S).toString()).attr(x),m=y.wijGetBBox(),w=v.wijGetBBox(),y.wijRemove(),y=null,v.wijRemove(),v=null),m.width<w.width&&(m.width=w.width),m.height<w.height&&(m.height=w.height),n._isVertical(t.compass)?(D=s.endY-s.startY-e.vOffset-e.axisTextOffset,j=D/m.height,I=Number.POSITIVE_INFINITY===j?0:parseInt(j.toString(),10)):(C=s.endX-s.startX-e.vOffset-e.axisTextOffset,j=C/m.width,I=Number.POSITIVE_INFINITY===j?0:parseInt(j.toString(),10)),j=b,I>0&&(b/=I,c?j=u>b?u:o.niceTimeUnit(b,e.annoFormatString):(e.tprec=o.nicePrecision(b),j=o.niceNumber(2*b,-_,!0),b>j&&(j=o.niceNumber(b,-_+1,!1)),b>j&&(j=o.niceTickNumber(b)))),t.unitMajor=j),l&&t.unitMajor&&!isNaN(t.unitMajor)&&(t.unitMinor=t.unitMajor/2)},e}(t.wijmoWidget);e.wijchartcore=a;var l=function(){function t(){this.width=null,this.height=null,this.wijCSS={headerText:"wijchart-header-text",headerContainer:"wijchart-header-container",footerText:"wijchart-footer-text",footerContainer:"wijchart-footer-container",legendTitle:"wijchart-legend-title",legendText:"wijchart-legend-text",legend:"wijchart-legend",legendDot:"chart-legend-dot",legendIcon:"wijchart-legend-icon",legendContainer:"wijchart-legend-container",legendTextCover:"wijchart-legend-textCover",axis:"wijchart-axis",axisText:"wijchart-axis-text",axisGridLine:"wijchart-axis-gridline",axisTick:"wijchart-axis-tick",axisLabel:"wijchart-axis-label",labelText:"wijchart-label-text",labelConnect:"wijchart-label-connect",canvasObject:"wijchart-canvas-object"},this.culture="",this.seriesList=[],this.seriesStyles=[{stroke:"#00cc00",opacity:.9,"stroke-width":1},{stroke:"#0099cc",opacity:.9,"stroke-width":1},{stroke:"#0055cc",opacity:.9,"stroke-width":1},{stroke:"#2200cc",opacity:.9,"stroke-width":1},{stroke:"#8800cc",opacity:.9,"stroke-width":1},{stroke:"#d9007e",opacity:.9,"stroke-width":1},{stroke:"#ff0000",opacity:.9,"stroke-width":1},{stroke:"#ff6600",opacity:.9,"stroke-width":1},{stroke:"#ff9900",opacity:.9,"stroke-width":1},{stroke:"#ffcc00",opacity:.9,"stroke-width":1},{stroke:"#ffff00",opacity:.9,"stroke-width":1},{stroke:"#ace600",opacity:.9,"stroke-width":1}],this.seriesHoverStyles=[{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5}],this.marginTop=25,this.marginRight=25,this.marginBottom=25,this.marginLeft=25,this.textStyle={fill:"#888","font-size":10,stroke:"none"},this.header={text:"",style:{fill:"none",stroke:"none"},textStyle:{"font-size":18,fill:"#666",stroke:"none"},compass:"north",visible:!0},this.footer={text:"",style:{fill:"#fff",stroke:"none"},textStyle:{fill:"#000",stroke:"none"},compass:"south",visible:!1},this.legend={text:"",textMargin:{left:2,top:2,right:2,bottom:2},style:{fill:"none",stroke:"none"},textWidth:null,textStyle:{fill:"#333",stroke:"none"},titleStyle:{"font-weight":"bold",fill:"#000",stroke:"none"},compass:"east",orientation:"vertical",visible:!0},this.axis={x:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!0,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"near",width:null},compass:"south",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]},y:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!1,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"center",width:null},compass:"west",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!0,style:{stroke:"#999999","stroke-width":.5,"stroke-dasharray":"none"}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]}},this.hint={enable:!0,content:null,contentStyle:{fill:"#d1d1d1","font-size":16},title:null,titleStyle:{fill:"#d1d1d1","font-size":16},style:{fill:"#000000","stroke-width":2},animated:"fade",showAnimated:"fade",hideAnimated:"fade",duration:120,showDuration:120,hideDuration:120,easing:"",showEasing:"",hideEasing:"",showDelay:0,hideDelay:150,compass:"north",offsetX:0,offsetY:0,showCallout:!0,calloutFilled:!1,calloutFilledStyle:{fill:"#000"}},this.indicator={visible:!1,style:{stroke:"#000000"}},this.showChartLabels=!0,this.chartLabelStyle={},this.chartLabelFormatString="",this.disableDefaultTextStyle=!1,this.shadow=!0,this.dataSource=null,this.data=null,this.beforeSeriesChange=null,this.seriesChanged=null,this.beforePaint=null,this.painted=null}return t}();a.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new l)}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){var e=this,i=e.options,n=e._getDefFill(),o;i.horizontal&&(o=i.axis.y.compass||"south",i.axis.y.compass=i.axis.x.compass||"west",i.axis.x.compass=o),$.extend(!0,{compass:"east"},i.hint),e._handleChartStyles(),n=null,t.prototype._create.call(this),e.chartElement.addClass(i.wijCSS.barChart)},e.prototype._setOption=function(e,i){"horizontal"===e&&$.extend(!0,this.options.axis,{x:{compass:i?"west":"south"},y:{compass:i?"south":"west"}}),t.prototype._setOption.call(this,e,i)},e.prototype.destroy=function(){var e=this,i=e.options,n=e.chartElement,o=n.data("fields"),r=o&&o.bars;n.removeClass(i.wijCSS.barChart),t.prototype.destroy.call(this),r&&r.length&&$.each(r,function(t,e){e=null}),n.data("fields",null)},e.prototype._clearChartElement=function(){var e=this,i=e.options,n=e.chartElement.data("fields");t.prototype._clearChartElement.call(this),e.element.removeData("plotInfos"),i.seriesTransition.enabled||n&&n.aniBarsAttr&&(n.aniBarsAttr=null)},e.prototype._isBarChart=function(){return!0},e.prototype.getBar=function(t){var e=this.chartElement,i=e.data("fields");return i.chartElements.bars[t]},e.prototype._paintTooltip=function(){var e=this,i=e.chartElement,n=i.data("fields");t.prototype._paintTooltip.call(this),e.tooltip&&n&&n.trackers&&n.trackers.length&&(e.tooltip.setTargets(n.trackers),e.tooltip.setOptions({relatedElement:n.trackers[0]}))},e.prototype._getTooltipText=function(t,e){var i=$(e.node),n,o;return i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),o={data:n,value:n.value,label:n.label,total:n.total,target:e,fmt:t,x:n.x,y:n.y},$.proxy(t,o)()},e.prototype._preHandleSeriesData=function(){t.prototype._preHandleSeriesData.call(this);var e=this,i=e.options,n=i.seriesList;$.each(n,function(t,i){var n=i.data;n.y&&$.each(n.y,function(t,i){try{e._isDate(i)||(n.y[t]=parseFloat(i))}catch(o){n.y[t]=1}})})},e.prototype._paintPlotArea=function(){var t=this,e=t.options;this.barchartRender=new o(this.chartElement,{canvas:t.canvas,bounds:t.canvasBounds,tooltip:t.tooltip,widgetName:t.widgetName,horizontal:e.horizontal,stacked:e.stacked,axis:e.axis,seriesList:e.seriesList,seriesStyles:e.seriesStyles,seriesHoverStyles:e.seriesHoverStyles,seriesTransition:e.seriesTransition,showChartLabels:e.showChartLabels,textStyle:e.textStyle,chartLabelStyle:e.chartLabelStyle,chartLabelFormatString:e.chartLabelFormatString,shadow:e.shadow,disabled:e.disabled,clusterOverlap:e.clusterOverlap,clusterWidth:e.clusterWidth,clusterSpacing:e.clusterSpacing,is100Percent:e.is100Percent,clusterRadius:e.clusterRadius,animation:e.animation,culture:t._getCulture(),isYTime:t.axisInfo.y[0].isTime,isXTime:t.axisInfo.x.isTime,mouseDown:$.proxy(t._mouseDown,t),mouseUp:$.proxy(t._mouseUp,t),mouseOver:$.proxy(t._mouseOver,t),mouseOut:$.proxy(t._mouseOut,t),mouseMove:$.proxy(t._mouseMove,t),click:$.proxy(t._click,t),wijCSS:e.wijCSS,widget:this}),this.barchartRender.render()},e.prototype._showSerieEles=function(t){var e=this.options.stacked,i=-1;$.each(t,function(t,e){e&&e.bar&&(e.bar.show(),e.bar.shadow&&e.bar.shadow.show(),e.bar.tracker&&e.bar.tracker.show(),$(e.bar.node).data("wijchartDataObj")&&($(e.bar.node).data("wijchartDataObj").visible=!0)),e&&e.dcl&&e.dcl.show(),e&&e.animatedBar&&!e.animatedBar.removed&&e.animatedBar.show(),e.sIndex&&(i=e.sIndex)}),e&&this.stackedSeriesObjs&&this._handleStackedVisible(t.length)},e.prototype._hideSerieEles=function(t){var e=this.options.stacked,i=-1,n=t.length;$.each(t,function(t,e){e&&e.bar&&(e.bar.hide(),e.bar.shadow&&e.bar.shadow.hide(),e.bar.tracker&&e.bar.tracker.hide(),$(e.bar.node).data("wijchartDataObj")&&($(e.bar.node).data("wijchartDataObj").visible=!1)),e&&e.dcl&&e.dcl.hide(),e&&e.animatedBar&&!e.animatedBar.removed&&e.animatedBar.hide(),e.sIndex&&(i=e.sIndex)}),e&&this.stackedSeriesObjs&&this._handleStackedVisible(t.length)},e.prototype._handleStackedVisible=function(t){function e(t){return $(t.bar.node).data("wijchartDataObj").visible!==!1}function i(t,e,i){t&&(t.bar&&(t.bar.attr("x",e),t.bar.attr("width",i)),t.bar.shadow&&(t.bar.shadow.attr("x",e),t.bar.shadow.attr("width",i)),t.bar.tracker&&(t.bar.tracker.attr("x",e),t.bar.tracker.attr("width",i)))}function n(t,e,i){t&&(t.bar&&(t.bar.attr("y",e),t.bar.attr("height",i)),t.bar.shadow&&(t.bar.shadow.attr("y",e),t.bar.shadow.attr("height",i)),t.bar.tracker&&(t.bar.tracker.attr("y",e),t.bar.tracker.attr("height",i)))}function o(t){if(t){var e=t.rect.x,i=t.rect.width;t.bar&&(t.bar.attr("x",e),t.bar.attr("width",i)),t.bar.shadow&&(t.bar.shadow.attr("x",e),t.bar.shadow.attr("width",i)),t.bar.tracker&&(t.bar.tracker.attr("x",e),t.bar.tracker.attr("width",i))}}function r(t){if(t){var e=t.rect.y,i=t.rect.height;t.bar&&(t.bar.attr("y",e),t.bar.attr("height",i)),t.bar.shadow&&(t.bar.shadow.attr("y",e),t.bar.shadow.attr("height",i)),t.bar.tracker&&(t.bar.tracker.attr("y",e),t.bar.tracker.attr("height",i))}}var s=this;if(this.stackedSeriesObjs){$.each(this.stackedSeriesObjs,function(t,e){s.options.horizontal?o(e):r(e)});for(var a=[],l=this.element.data("fields").seriesEles.length,h=0;l>h;h++)a.push(e(this.stackedSeriesObjs[h+"0"]));for(var d=[],c=-1,u=-1,p=-1,h=a.length-1;h>=0;h--)a[h]&&(p-h>1&&d.push({start:p,end:h+1}),p=h);p>0&&d.push({start:p,end:0}),$.each(d,function(e,o){for(var r=o.start,a=o.end,l,h,d,c,u,p,e=0;t>e;e++)l=s.stackedSeriesObjs[r+""+e],h=s.stackedSeriesObjs[a+""+e],s.options.horizontal?(d=h.rect.x,u=l.rect.width+l.rect.x-h.rect.x,i(l,d,u)):(d=l.rect.y,u=h.rect.height+h.rect.y-l.rect.y,n(l,d,u))})}},e.prototype._indicatorLineShowing=function(e){t.prototype._indicatorLineShowing.call(this,e),$.each(e,function(t,e){e.bar&&e.bar.attr(e.hoverStyle)})},e.prototype._removeIndicatorStyles=function(t){$.each(t,function(t,e){e.bar&&e.bar.attr(e.style)})},e.prototype._supportStacked=function(){return!0},e.prototype._calculateParameters=function(e,i){if(t.prototype._calculateParameters.call(this,e,i),"x"===e.id){var n=i.unitMinor,o=this._getBarAdjustment(e);0===o?o=n:o>n&&0!==n&&(o=Math.floor(o/n)*n),e.min-=o,e.max+=o,this._calculateMajorMinor(i,e)}},e.prototype._getBarAdjustment=function(t){var e=0,i=this.options,n=t.max,o=t.min,r=i.seriesList,s=0,a=0;for(s=0;s<r.length&&r[s].data.x;s++)a=r[s].data.x.length,a>e&&(e=a);return e>1?(n-o)/e*i.clusterWidth*.0125:1===e?(0===o&&1===n&&(o=-1,t.min=o),.0125*(n-o)):0},e}(t.wijchartcore);t.wijbarchart=e;var i=function(){function t(){this.initSelector=":jqmData(role='wijbarchart')",this.wijCSS={barChart:"wijmo-wijbarchart",barLabel:"wijbarchart-label",barElement:"wijbarchart",barTracker:"bartracker"},this.horizontal=!0,this.stacked=!1,this.is100Percent=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return t}();e.prototype.options=$.extend(!0,{},t.wijchartcore.prototype.options,new i),e.prototype.widgetEventPrefix="wijbarchart",$.wijmo.registerWidget("wijbarchart",e.prototype);var n=function(){function t(t){this.x=t,this.paSpec=[]}return t.prototype.stackValues=function(){var t=this,e=t.paSpec.length,i;e>1&&(i=t.paSpec[0],$.each(t.paSpec,function(t,e){return 0===t?!0:(e.y+=i.y,void(i=e))}))},t}(),o=function(){function e(t,e){this.options=e,this.element=t,this._init()}return e.prototype._init=function(){var e=this.options,i=e.horizontal,n=e.axis.x,o=e.bounds;this.startLocation={x:o.startX,y:o.startY},this.width=o.endX-this.startLocation.x,this.height=o.endY-this.startLocation.y,this.nSeries=e.seriesList.length,this.seriesList=$.arrayClone(e.seriesList),this.seriesStyles=[].concat(e.seriesStyles.slice(0,this.nSeries)),this.seriesHoverStyles=[].concat(e.seriesHoverStyles.slice(0,this.nSeries)),this.xscale=t.ChartUtil.getScaling(i,n.max,n.min,i?this.height:this.width),this.xlate=t.ChartUtil.getTranslation(i,this.startLocation,n.max,n.min,this.xscale),this.fields=this.element.data("fields")||{},this.chartElements=this.fields.chartElements||{},this.aniBarsAttr=this.fields.aniBarsAttr,this.canvas=e.canvas},e.prototype._paintShadow=function(e,i,n){this.options.shadow&&t.ChartUtil.paintShadow(e,i,n)},e.prototype.getMinDX=function(t){var e=Number.MAX_VALUE,i=t.length,n,o;for(n=1;i>n;n++)o=t[n].x-t[n-1].x,e>o&&o>0&&(e=o);return e===Number.MAX_VALUE?2:e},e.prototype.stackValues=function(t){return $.each(t,function(t,e){e.stackValues()}),t},e.prototype.barPointList=function(e){
function i(t,e){var i=r(e),s=e.length,a=null,l=0,h=0,d=0,c=!0,u=0,p=!1;i&&(l=i.length),o&&(d=o.length),void 0!==i&&$.each(i,function(e,i){for(c?(c=!1,u=i.x):(p=u===i.x?!0:!1,u=i.x);d>h&&o[h].x<i.x;)h++;d>h?o[h].x!==i.x?(a=new n(i.x),o.splice(h,0,a),d=o.length):a=o[h]:(a=new n(i.x),o.push(a),d=o.length),a.paSpec.push({y:i.y,sIdx:t,pIdx:e,dupl:p})})}var o=[],r=t.ChartUtil.getXSortedPoints;return $.each(e,function(t,e){i(t,e)}),o},e.prototype.adjustToLimits=function(t,e,i){return e>t?e:t>i?i:t},e.prototype.transformPoints=function(t,e,i,n,o,r){return $.each(r,function(r,s){var a=s.x,l=s.y,h=0;s.x=e*a+n,s.y=i*l+o,t&&(h=s.x,s.x=s.y,s.y=h)}),r},e.prototype.paintDefaultChartLabel=function(t,e,i,n){var o=this.options,r=o.horizontal,s=o.canvas,a=o.wijCSS,l=o.culture,h=$.extend(!0,{},o.textStyle,o.chartLabelStyle),d=r?{x:t.x+t.width,y:t.y+t.height/2}:{x:t.x+t.width/2,y:t.y},c=o.chartLabelFormatString,u,p,g=this.options.widget,f=e;return n&&(h=$.extend(!0,h,n)),i&&(f=$.fromOADate(e)),c&&c.length?f=Globalize.format(f,o.chartLabelFormatString,l):i||(f=$.round(f,2)),p=g._text.call(g,d.x,d.y,f).attr(h),$.wijraphael.addClass($(p.node),a.barLabel),u=p.getBBox(),r?p.attr({x:d.x+u.width/2}):p.attr({y:d.y-u.height/2}),p},e.prototype.paintBar=function(t,e,i,n,o,r,s,a,l,h,d,c,u,p,g){var f=this.options,m=f.stacked,w=f.horizontal,y=f.is100Percent,v=n.min,_=n.max,S=o.min,x=o.max,b=n.scale,C=n.late,D=o.scale,I=o.late,j,T,E,k,L=null,P,M=r,F=r["stroke-width"],A=r.stroke,B,R,O,G,U=-1;return null!==g.origin&&(U=D*g.origin+I),m?y?(c>0&&(t.height=e/c),(d||0===d)&&(t.y=d/c,t.height-=t.y)):(t.height=e,(d||0===d)&&(t.height-=d,t.y=d)):(d||0===d)&&(t.x+=t.width*(1-h),t.height=e),T=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y+t.height}],E=(v<=T[0].x&&T[0].x<=_||v<=T[1].x&&T[1].x<=_)&&(S<=T[0].y&&T[0].y<=x||S<=T[1].y&&T[1].y<=x),T[0].x=this.adjustToLimits(T[0].x,v,_),T[0].y=this.adjustToLimits(T[0].y,S,x),T[1].x=this.adjustToLimits(T[1].x,v,_),T[1].y=this.adjustToLimits(T[1].y,S,x),T=this.transformPoints(w,b,D,C,I,T),T[0].x>T[1].x&&(j=T[0].x,T[0].x=T[1].x,T[1].x=j),T[0].y>T[1].y&&(j=T[0].y,T[0].y=T[1].y,T[1].y=j),k={x:T[0].x,y:T[0].y,width:T[1].x-T[0].x,height:T[1].y-T[0].y},E&&!m&&(0===k.width&&(k.width=1),0===k.height&&(k.height=1,k.y-=1)),f.showChartLabels&&(L=this.paintDefaultChartLabel(k,e,u,p)),P=r.r?r.r:f.clusterRadius,P&&(M=$.extend(!0,{},r,{r:0})),"none"!==A&&F&&(F=parseInt(F,10)),(!F||isNaN(F))&&(F=0),R=k.width,O=k.height,F>1&&(F--,R=k.width-F,O=k.height-F/2,k.x+=F/2),0>R&&(R=0),0>O&&(O=0),s?(-1===U&&(U=w?l.x+F/2:l.y+i-F/2),P?(w?(B=e>g.origin?this.canvas.roundRect(k.x,k.y,R,O,0,0,P,P).hide():this.canvas.roundRect(k.x,k.y,R,O,P,P,0,0).hide(),G=this.canvas.rect(U,k.y,k.width,k.height)):(B=e>g.origin?this.canvas.roundRect(k.x,k.y,R,O,P,0,0,P).hide():this.canvas.roundRect(k.x,k.y,R,O,0,P,P,0).hide(),G=this.canvas.rect(k.x,U,k.width,k.height)),this._paintShadow(G,a),G.wijAttr(M),G.bar=B):(B=w?this.canvas.rect(U,k.y,k.width,O):this.canvas.rect(k.x,U,R,k.height),G=B),L&&(L.attr({opacity:0}),G.chartLabel=L),G.left=k.x,G.top=k.y,G.width=R,G.height=O,G.r=P):B=P?w?e>g.origin?this.canvas.roundRect(k.x,k.y,R,O,0,0,P,P):this.canvas.roundRect(k.x,k.y,R,O,P,P,0,0):e>g.origin?this.canvas.roundRect(k.x,k.y,R,O,P,0,0,P):this.canvas.roundRect(k.x,k.y,R,O,0,P,P,0):this.canvas.rect(k.x,k.y,R,O),this._paintShadow(B,a),s&&P&&B.shadow&&B.shadow.hide(),B.wijAttr(r),{rect:k,dcl:L,animatedBar:G,bar:B}},e.prototype.paintClusters=function(e,i,n,o,r,s,a,l,h,d){var c=this,u=c.options,p=u.clusterOverlap/100,g=u.clusterWidth/100,f=1,m=u.clusterSpacing+f,w=e.length,y=u.canvas,v=u.stacked,_=u.horizontal,S=u.axis.y,x=u.widget,b=u.wijCSS,C=u.animation&&u.animation.enabled,D,I,j,T=[],E=[],k=[],L=[],P=[],M=[],F=y.set(),A,B=0;return h||d?($.each(e,function(t,e){var i=$.extend(!0,{},e);i.data&&i.data.y&&i.data.y.length&&h&&$.each(i.data.y,function(t,e){i.data.y[t]=$.toOADate(e)}),i.data&&i.data.x&&i.data.x.length&&d&&$.each(i.data.x,function(t,e){i.data.x[t]=$.toOADate(e)}),P.push(i)}),D=c.barPointList(P)):D=c.barPointList(e),v&&(D=c.stackValues(D)),I=c.getMinDX(D)*g,$.each(i,function(t,e){e["stroke-width"]&&!isNaN(e["stroke-width"])&&(B=0!==B?Math.min(parseFloat(e["stroke-width"]),B):parseFloat(e["stroke-width"]))}),w>1&&!v&&(p-=D.length*(w-1)*(m+2*B)/(_?a:s),I/=w*(1-p)+p),$.each(D,function(d,g){var m=g.paSpec,w=m.length,y,D,P,B;y=v?I:I*(w*(1-p)+p),D={x:g.x-y/2,y:0,width:I,height:m[0].y},$.each(m,function(d,g){if(void 0===D.height)return!0;var w=g.sIdx,y=g.pIdx,v=i[w],I=e[w],R,O=I.yAxis||0,G=S[O]||S,U=r[O]||r;L[w]||(L[w]=[]),M[w]||(M[w]=[]),c.yscale=t.ChartUtil.getScaling(!_,G.max,G.min,_?s:a),c.ylate=t.ChartUtil.getTranslation(!_,l,G.max,G.min,c.yscale),U.late=c.ylate,U.scale=c.yscale,B=c.paintBar(D,g.y,a,o,U,v,C,f,l,p,d>0?m[d-1].y:null,m[m.length-1].y,h,I.textStyle,G),P=B.bar,R=P.clone().attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}),I.visible===!1&&(P.hide(),B.dcl&&B.dcl.hide(),R.hide(),P.shadow&&P.shadow.hide()),$.wijraphael.addClass($(P.node),b.canvasObject+" "+b.barElement),A=$.extend(!1,{index:y,bar:P,type:"bar",style:v,hoverStyle:n[w],x:I.data.x[y],y:I.data.y[y],visible:!0},I),$(P.node).data("wijchartDataObj",A),x.dataPoints=x.dataPoints||{},x.pointXs=x.pointXs||[],j=u.horizontal?$.round(B.rect.y+B.rect.height/2,2):$.round(B.rect.x+B.rect.width/2,2),x.dataPoints[j.toString()]||(x.dataPoints[j.toString()]=[],x.pointXs.push(j)),x.dataPoints[j.toString()].push(A),$(R.node).data("owner",$(P.node)),$.wijraphael.addClass($(R.node),b.barElement+" "+b.barTracker),B.bar.tracker=R,F.push(R),E.push(P),B.animatedBar&&k.push(B.animatedBar),B.dcl&&T.push(B.dcl),L[w][y]=B.rect,M[w][y]=B,P=null,R=null})}),$.each(T,function(t,e){e.toFront()}),F.toFront(),{bars:E,animatedBars:k,rects:L,chartLabels:T,seriesEles:M,trackers:F}},e.prototype.processStackedElement=function(t){var e={};$.each(t,function(t,i){$.each(i,function(i,n){n.sIndex=t,n.stackIndex=i,e[t+""+i]=n})}),this.options.widget.stackedSeriesObjs=e},e.prototype.playAnimation=function(e){var i=this,n=i.options,o=n.animation,r=o&&o.enabled,s=n.horizontal,a=n.seriesTransition,l,h,d=[],c,u=n.chartLabelStyle;r&&(l=o.duration||2e3,h=o.easing||"linear",$.each(e,function(e,n){var o;s?(n.wijAttr({width:0}),o={width:n.width,x:n.left}):(n.wijAttr({height:0}),o={height:n.height,y:n.top}),i.aniBarsAttr&&a.enabled&&i.aniBarsAttr.length>e&&(c=t.ChartUtil.getDiffAttrs(i.aniBarsAttr[e],n.attr()),s?(c.x=i.aniBarsAttr[e].x,c.width=i.aniBarsAttr[e].width):(c.y=i.aniBarsAttr[e].y,c.height=i.aniBarsAttr[e].height),c.path&&delete c.path,n.attr(c),l=a.duration,h=a.easing),d.push($.extend(!0,{},n.attr(),o)),n.tracker&&n.tracker.hide(),n.stop().wijAnimate(o,l,h,function(){var t=this,e=t.r,i=t;t.chartLabel&&(u&&u.opacity?t.chartLabel.wijAnimate({opacity:u.opacity},250):t.chartLabel.wijAnimate({opacity:1},250)),t.tracker&&(t.tracker.show(),t.tracker.attr({width:t.width,height:t.height,x:t.attr("x"),y:t.attr("y")})),e&&(i=t.bar,i.show(),i.shadow&&i.shadow.show(),t.shadow&&(t.shadow.wijRemove(),t.shadow=null),t.wijRemove(),t=null)})}),i.aniBarsAttr=d)},e.prototype.bindLiveEvents=function(){var t=this.options,e=t.wijCSS,i=t.widgetName,n=t.disabled,o=t.mouseDown,r=t.mouseUp,s=t.mouseOver,a=t.mouseOut,l=t.mouseMove,h=t.click,d=this.element,c=$.isFunction,u="";$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(u="wij"),$("."+e.barElement,d[0]).on(u+"mousedown."+i,function(t){if(!n&&c(o)){var e=$(t.target),i;e.data("owner")&&(e=e.data("owner")),i=e.data("wijchartDataObj"),o.call(d,t,i),i=null}}).on(u+"mouseup."+i,function(t){if(!n&&c(r)){var e=$(t.target),i;e.data("owner")&&(e=e.data("owner")),i=e.data("wijchartDataObj"),r.call(d,t,i),i=null}}).on(u+"mouseover."+i,function(t){if(!n&&c(s)){var e=$(t.target),i,o;e.data("owner")&&(e=e.data("owner")),i=e.data("wijchartDataObj"),o=i.bar,i.hoverStyle?(i.initTransform=o.matrix.toTransformString(),o.wijAttr(i.hoverStyle)):o&&o.wijAttr({opacity:"0.8"}),s.call(d,t,i),i=null}}).on(u+"mouseout."+i,function(t){if(!n){var e=$(t.target),i,o;e.data("owner")&&(e=e.data("owner")),i=e.data("wijchartDataObj"),o=i.bar,i.hoverStyle?(o.transform(""),o.shadow&&o.shadow.transform(""),o.wijAttr(i.style)):o&&o.wijAttr({opacity:"1"}),c(a)&&a.call(d,t,i),i=null}}).on(u+"mousemove."+i,function(t){if(!n){var e=$(t.target),i,o;e.data("owner")&&(e=e.data("owner")),i=e.data("wijchartDataObj"),o=i.bar,c(l)&&l.call(d,t,i),i=null}}).on(u+"click."+i,function(t){if(!n&&c(h)){var e=$(t.target),i;e.data("owner")&&(e=e.data("owner")),i=e.data("wijchartDataObj"),h.call(d,t,i)}})},e.prototype.unbindLiveEvents=function(){var t=this.options,e=t.widgetName,i=t.wijCSS,n=this.element;$("."+i.barElement,n[0]).off(e).off("."+e)},e.prototype.render=function(){var t=this.options,e=t.horizontal,i=t.stacked,n=this.seriesList,o=this.seriesStyles,r=this.seriesHoverStyles,s=t.axis.x,a=t.axis.y,l=t.isYTime,h=t.isXTime,d;this.unbindLiveEvents(),e&&!i&&(n.reverse(),o.reverse(),r.reverse()),0!==this.nSeries&&(d=this.paintClusters(n,o,r,{min:s.min,max:s.max,late:this.xlate,scale:this.xscale},a,this.width,this.height,this.startLocation,l,h),this.element.data("plotInfos",{xscale:this.xscale,xlate:this.xlate,yscale:this.yscale,ylate:this.ylate,rects:d.rects}),this.playAnimation(d.animatedBars),this.chartElements.bars=d.bars,this.chartElements.animatedBars=d.animatedBars,this.chartElements.chartLabels=d.chartLabels,this.fields.seriesEles=d.seriesEles,this.fields.trackers=d.trackers,this.fields.chartElements||(this.fields.chartElements={}),e&&!i&&this.fields.seriesEles.reverse(),i&&this.processStackedElement(this.fields.seriesEles),$.extend(!0,this.fields.chartElements,this.chartElements),this.fields.aniBarsAttr=this.aniBarsAttr,this.element.data("fields",this.fields),this.bindLiveEvents())},e}();t.BarChartRender=o}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){var e=this.options;this._handleChartStyles(),t.prototype._create.call(this),this.chartElement.addClass(e.wijCSS.lineChart),"area"===e.type&&this.chartElement.addClass(e.wijCSS.areaChart)},e.prototype.destroy=function(){var e=this.options;this.chartElement.removeClass(e.wijCSS.lineChart),"area"===e.type&&this.chartElement.removeClass(e.wijCSS.areaChart),t.prototype.destroy.call(this),this.aniPathsAttr&&this.aniPathsAttr.length&&($.each(this.aniPathsAttr,function(t,e){e=null}),this.aniPathsAttr=null)},e.prototype.getLinePath=function(t){var e=this.chartElement.data("fields"),i,n;return e&&e.chartElements&&(i=e.chartElements,i.paths&&i.paths.length)?i.paths[t]:n},e.prototype.getLineMarkers=function(t){var e=this.options,i=this.chartElement.data("fields"),n,o;return e.seriesList&&e.seriesList[t].markers&&e.seriesList[t].markers.visible&&i&&i.chartElements&&(n=i.chartElements,n.markersSet&&n.markersSet.length)?n.markersSet[t]:o},e.prototype._showSerieEles=function(t){var e=this.options,i;t.markers&&$.each(t.markers,function(t,e){var i=$(e.node).data("wijchartDataObj");return i&&i.lineSeries&&i.lineSeries.markers&&!i.lineSeries.markers.visible?!0:void e.show()}),t.dcl&&$.each(t.dcl,function(t,i){e.showChartLabels&&i.show()}),t.path&&(i=$(t.path.node).data("wijchartDataObj"),!i.visible&&i.markers&&i.markers.visible||(t.path.show(),t.path.shadow&&t.path.shadow.show(),t.path.area&&t.path.area.show(),t.path.tracker&&t.path.tracker.show()),$(t.path.node).data("wijchartDataObj")&&$(t.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(t.path.node).data("wijchartDataObj").virtualMarkers,function(t,e){e.visible=!0}))},e.prototype._hideSerieEles=function(t){t.markers&&$.each(t.markers,function(t,e){e.hide()}),t.dcl&&$.each(t.dcl,function(t,e){e.hide()}),t.path&&(t.path.hide(),t.path.shadow&&t.path.shadow.hide(),t.path.area&&t.path.area.hide(),t.path.tracker&&t.path.tracker.hide(),$(t.path.node).data("wijchartDataObj")&&$(t.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(t.path.node).data("wijchartDataObj").virtualMarkers,function(t,e){e.visible=!1}))},e.prototype._supportStacked=function(){return!0},e.prototype._indicatorLineShowing=function(e){t.prototype._indicatorLineShowing.call(this,e),$.each(e,function(t,e){e.marker&&e.marker.attr(e.markerHoverStyle)})},e.prototype._removeIndicatorStyles=function(t){$.each(t,function(t,e){e.marker&&(e.marker.attr(e.markerStyle),e.marker.transform("s1"))})},e.prototype._mouseDownInsidePlotArea=function(e,i){t.prototype._mouseDownInsidePlotArea.call(this,e,i),this._clearHoverState(!0)},e.prototype._mouseDown=function(e,i){t.prototype._mouseDown.call(this,e,i)},e.prototype._mouseUp=function(e,i){t.prototype._mouseUp.call(this,e,i)},e.prototype._mouseOver=function(e,i){!i||"line"!==i.type&&"marker"!==i.type||this.indicatorLine||(t.prototype._mouseOver.call(this,e,i),"marker"===i.type&&(i=i.lineSeries),i.path.removed||(this.hoverLine!==i||null===this.hoverLine)&&(this.isNewLine=!0,this.hoverLine&&(this.hoverLine.path.removed||("line"===this.options.type&&this.hoverLine.lineStyle.fill&&delete this.hoverLine.lineStyle.fill,this.hoverLine.path.wijAttr(this.hoverLine.lineStyle),this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1")))),i.lineHoverStyle&&i.path.wijAttr(i.lineHoverStyle),this.hoverLine=i,this.hoverPoint=null,this.hoverVirtualPoint=null))},e.prototype._mouseOut=function(e,i){t.prototype._mouseOut.call(this,e,i)},e.prototype._mouseMove=function(e,i){t.prototype._mouseMove.call(this,e,i)},e.prototype._click=function(e,i){t.prototype._click.call(this,e,i)},e.prototype._mouseMoveInsidePlotArea=function(e,i){var n=this,o=this.tooltip,r=this.options.hint,s,a,l=0,h,d,c,u,p=null,g=null,f=null,m=r.title,w=r.content,y=$.isFunction(m),v=$.isFunction(w),_=0;if(o&&(f=o.getOptions()),this.hoverLine&&!this.indicatorLine){if(this.isNewLine&&(r.enable&&o&&o.hide(),this.isNewLine=!1),s=this.hoverLine.lineMarkers,a=this.hoverLine.virtualMarkers,l=-1,h={x:0,y:0},s&&s.length){if($.each(s,function(t,e){if(e.removed)return!0;var n=e.wijGetBBox(),o=n.x+n.width/2,r=Math.abs(o-i.left);(0===t||_>r)&&(_=r,l=t,h={x:o,y:n.y+n.height/2})}),this.hoverPoint&&this.hoverPoint.index===l)return;if(l>-1){if(s[l].removed)return;d=$(s[l].node).data("wijchartDataObj"),d&&(this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.removed||(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1"))),d.isSymbol||d.marker.removed||d.marker.wijAttr(d.markerHoverStyle)),this.hoverPoint=d,this.hoverVirtualPoint=a[l]}}else{if($.each(a,function(t,e){var n=Math.abs(e.x-i.left);(0===t||_>n)&&(_=n,l=t,h={x:e.x,y:e.y})}),this.hoverVirtualPoint&&this.hoverVirtualPoint.index===l)return;l>-1&&(this.hoverPoint=null,this.hoverVirtualPoint=a[l])}o&&(g=this.hoverVirtualPoint,c=g.valX,u=g.valY,(y||v)&&(y&&(f.title=function(){var t={pointIndex:l,lineIndex:n.hoverLine.index,x:c,y:u,label:n.hoverLine.label,data:g,fmt:m},e=$.proxy(t.fmt,t),i=e();return i}),v&&(f.content=function(){var t={pointIndex:l,lineIndex:n.hoverLine.index,x:c,y:u,label:n.hoverLine.label,data:g,fmt:w},e=$.proxy(t.fmt,t),i=e();return i})),p=$.extend({stroke:this.hoverLine.path.attr("stroke")},r.style),f.style.stroke=p.stroke,o.showAt(h))}t.prototype._mouseMoveInsidePlotArea.call(this,e,i)},e.prototype._mouseMoveOutsidePlotArea=function(e,i){this._clearHoverState(!1),t.prototype._mouseMoveOutsidePlotArea.call(this,e,i)},e.prototype._clearHoverState=function(t){var e=this.tooltip,i=this.options.hint;i.enable&&e&&!t&&e.hide(),this.hoverLine&&(this.hoverLine.path.removed||("line"===this.options.type&&this.hoverLine.lineStyle.fill&&delete this.hoverLine.lineStyle.fill,this.hoverLine.path.wijAttr(this.hoverLine.lineStyle),this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1")))),this.hoverLine=null,this.hoverPoint=null,this.hoverVirtualPoint=null},e.prototype._paintLegendIcon=function(t,e,i,n,o,r,s,a,l,h){var d=this,c=this.options,u=d.canvas.path(Raphael.format("M{0},{1}L{2},{3}",t,e+n/2,t+i,e+n/2)),p;$(u.node).data("legendIndex",r).data("index",s),d.legendIcons.push(u),o&&u.attr($.extend(!0,{},o,{"stroke-width":c.legend.size.height})),$.wijraphael.addClass($(u.node),a);var g=l.markerStyle;if(g=$.extend({fill:o.stroke,stroke:o.stroke,opacity:1},g),o["stroke-dasharray"]&&u.attr({"stroke-width":1,"stroke-dasharray":o["stroke-dasharray"]}),l.markers&&l.markers.visible){var f=l.markers.type;f||(f="circle"),p=this.canvas.paintMarker(f,t+i/2,e+n/2,3),$.wijraphael.addClass($(p.node),Raphael.format("{0} {1} {2}",c.wijCSS.legend,c.wijCSS.legendDot,c.wijCSS.canvasObject)),p.attr(g),$(p.node).data("index",s).data("legendIndex",r),this.legendDots.push(p)}return u},e.prototype._paintLegend=function(){var e=this.options,i=0,n=0,o=0,r=null,s=e.seriesList,a=e.seriesStyles,l=null,h=null,d=null,c=0,u=0,p=null,g=null,f=null;$.extend(!0,e,{legend:{size:{width:30,height:3}}}),t.prototype._paintLegend.call(this)},e.prototype._paintPlotArea=function(){var t=this.options,e;this.aniPathsAttr||(this.aniPathsAttr=[]),this.linechartRender=new n(this.chartElement,{bounds:this.canvasBounds,widgetName:this.widgetName,canvas:this.canvas,tooltip:this.tooltip,wijCSS:t.wijCSS,stacked:t.stacked,hole:t.hole,type:t.type,axis:t.axis,animation:t.animation,seriesTransition:t.seriesTransition,seriesList:t.seriesList,seriesStyles:t.seriesStyles,seriesHoverStyles:t.seriesHoverStyles,showChartLabels:t.showChartLabels,chartLabelStyle:t.chartLabelStyle,chartLabelFormatString:t.chartLabelFormatString,isXTime:this.axisInfo.x.isTime,isYTime:this.axisInfo.y.isTime||this.axisInfo.y[0].isTime,disabled:t.disabled,culture:this._getCulture(),hint:t.hint,aniPathsAttr:this.aniPathsAttr,chartLabelEles:this.chartLabelEles,mouseDown:$.proxy(this._mouseDown,this),mouseUp:$.proxy(this._mouseUp,this),mouseOver:$.proxy(this._mouseOver,this),mouseOut:$.proxy(this._mouseOut,this),mouseMove:$.proxy(this._mouseMove,this),click:$.proxy(this._click,this),widget:this,extremeValue:{txx:this.extremeValue.txx,txn:this.extremeValue.txn,tyx:this.extremeValue.y[0].tyx,tyn:this.extremeValue.y[0].tyn}}),this.linechartRender.render()},e.prototype._clearChartElement=function(){t.prototype._clearChartElement.call(this),this.hoverLine=null,this.hoverPoint=null,this.hoverVirtualPoint=null},e}(t.wijchartcore);t.wijlinechart=e;var i=function(){function t(){this.initSelector=":jqmData(role='wijlinechart')",this.wijCSS={lineChart:"wijmo-wijlinechart",areaChart:"wijmo-wijareachart",lineLabel:"wijlinechart-label",lineElement:"wijlinechart",areaElement:"wijlinechart-area",lineTracker:"linetracker",canvasMarker:"wijchart-canvas-marker"},this.stacked=!1,this.hole=null,this.type="line",this.animation={enabled:!0,direction:"horizontal",duration:2e3,easing:"easeInCubic"},this.seriesTransition={enabled:!0,duration:2e3,easing:"easeInCubic"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return t}();e.prototype.options=$.extend(!0,{},t.wijchartcore.prototype.options,new i),$.wijmo.registerWidget("wijlinechart",e.prototype);var n=function(){function e(t,e){this.options=e,this.element=t}return e.prototype.render=function(){var t=this.element,e=this.options,i=e.wijCSS,n=e.bounds,o=e.widgetName,r=e.canvas,s=e.animation,a=e.seriesTransition,l=e.hint,h=e.tooltip,d=e.mouseDown,c=e.mouseUp,u=e.mouseOver,p=e.mouseOut,g=e.mouseMove,f=e.click,m=[],w=[],y=[],v=[],_=[],S=e.disabled,x=r.set(),b=e.aniPathsAttr,C=[],D,I=t.data("fields")||{},j=[],T=e.culture,E=e.widget,k=e.extremeValue,L={enable:!1,left:-10,top:-10,right:10,bottom:10};this.widget=E,this.renderLineChart(e,C,b,v,_,m,x,w,y,j,T),!e.axis.x.autoMax&&e.axis.x.max<k.txx&&(L.enable=!0,L.right=0),!e.axis.x.autoMin&&e.axis.x.min>k.txn&&(L.enable=!0,L.left=0),!e.axis.y.autoMax&&e.axis.y.max<k.tyx&&(L.enable=!0,L.top=0),!e.axis.y.autoMin&&e.axis.y.min>k.tyn&&(L.enable=!0,L.bottom=0),s.enabled||a.enabled?this.playAnimation(s,a,x,n,v,b,L):L.enable&&this.setClipRect(L,x,n),b.length=0,$.each(C,function(t,e){b.push(e)}),this.unbindLiveEvents(t,o,i),this.bindLiveEvents(t,r,n,o,d,c,u,p,g,f,S,l,y,h,i),D={paths:v,shadowPaths:_,markersSet:m,animationSet:x,symbols:w},I.chartElements||(I.chartElements={}),I.seriesEles=j,$.extend(!0,I.chartElements,D),t.data("fields",I)},e.prototype.setClipRect=function(t,e,i){var n=i.endX-i.startX-t.left+t.right,o=i.endY-i.startY-t.top+t.bottom;e.wijAttr("clip-rect",Raphael.format("{0} {1} {2} {3}",i.startX+t.left,i.startY+t.top,n,o))},e.prototype.playAnimation=function(t,e,i,n,o,r,s){var a=this,l=t.duration,h=t.easing;"horizontal"===t.direction?(r&&r.length&&e.enabled&&(l=e.duration,h=e.easing),this.playHAnimation(l,h,i,n,o,s)):(s.enable&&this.setClipRect(s,i,n),$.each(o,function(t,i){return"undefined"==typeof i||null===i?!0:void(r&&r.length>t&&e.enabled?(l=e.duration,h=e.easing,a.playVAnimation(i,r,t,l,h)):i.straight&&a.playVStraightAnimation(i,l,h))}))},e.prototype.playVAnimation=function(e,i,n,o,r){var s,a;e.shadow&&e.shadow.hide(),e.tracker&&e.tracker.hide(),s=i[n],s&&s.path&&(a=t.ChartUtil.getDiffAttrs(s.path,e.attr())),$.isEmptyObject(a)||(e.attr(s.path),e.wijAnimate(a,o,r,function(){e.shadow&&e.visible!==!1&&e.shadow.show(),e.tracker&&e.visible!==!1&&e.tracker.show()})),$.each(e.markers,function(e,i){var n=t.ChartUtil.getDiffAttrs(s.markers[e],i.attr());$.isEmptyObject(n)||(i.attr(s.markers[e]),i.wijAnimate(n,o,r))}),e.labels&&$.each(e.labels,function(e,i){var n=t.ChartUtil.getDiffAttrs(s.labels[e],i.attr()),a=s.labels[e];a&&a.text&&delete a.text,$.isEmptyObject(n)||(i.attr(a),i.wijAnimate(n,o,r))}),e.area&&(a=t.ChartUtil.getDiffAttrs(s.area,e.area.attr()),$.isEmptyObject(a)||(e.area.attr(s.area),e.area.wijAnimate(a,o,r)))},e.prototype.playVStraightAnimation=function(t,e,i){var n,o,r;t.shadow&&t.shadow.hide(),t.tracker&&t.tracker.hide(),n=t.straight,o=t.attr().path,t.attr({path:n}),t.wijAnimate({path:o},e,i,function(){t.shadow&&t.visible!==!1&&t.shadow.show(),t.tracker&&t.visible!==!1&&t.tracker.show()}),$.each(t.markers,function(t,n){if(n.straight){var o=n.attr().cy;n.attr({cy:n.straight}),n.wijAnimate({cy:o},e,i)}}),t.area&&(r=t.area,n=r.straight,o=r.attr().path,r.attr({path:n}),r.wijAnimate({path:o},e,i))},e.prototype.playHAnimation=function(t,e,i,n,o,r){$.each(o,function(t,e){e.tracker&&e.tracker.hide()});var s=r.enable,a=n.endX-n.startX-r.left+r.right,l=n.endY-n.startY-r.top+r.bottom;i.wijAttr("clip-rect",Raphael.format("{0} {1} 0 {2}",n.startX+r.left,n.startY+r.top,l)),i.wijAnimate({"clip-rect":Raphael.format("{0} {1} {2} {3}",n.startX+r.left,n.startY+r.top,a,l)},t,e,function(){if(this.tracker&&this.visible!==!1&&this.tracker.show(),Raphael.vml&&!s){var t=null,e=null,i=this.node;i&&i.clipRect&&(t=this.attrs,delete t["clip-rect"],i.clipRect=null,e=$(i).parent(),e.before(i),e.remove(),this.attr(t),t.src&&t.src.length&&this.attr({src:t.src}),t.gradient&&t.gradient.length&&"none"===t.fill&&this.attr({fill:t.gradient}))}})},e.prototype.renderLineChart=function(e,i,n,o,r,s,a,l,h,d,c){var u=this,p=e.wijCSS,g=e.bounds,f=e.canvas,m=e.stacked,w=e.hole,y=e.type,v=e.axis,_=e.animation,S=e.seriesTransition,x=!1,b=e.seriesList,C=e.seriesStyles,D=e.seriesHoverStyles,I=e.showChartLabels,j=e.chartLabelStyle,T=e.chartLabelFormatString,E=e.isXTime,k=e.isYTime,L=e.chartLabelEles,P,M,F,A,B,R,O=[],G=[],U,N,V,H,W;$.each(b,function(e,z){var K=[],Y=[],q=[],X,J,Q,Z,tt,et,it=[];return"exclude"===z.display?!0:(et=C[e],z=$.extend(!0,{display:"show",fitType:"line",markers:{visible:!1,type:"circle"},visible:!0},z),X=z.data,J=$.extend({stroke:"black",opacity:1,fill:"none","stroke-linejoin":"round","stroke-linecap":"round"},et),Z=z.markerStyle,Z=$.extend({fill:J.stroke,stroke:J.stroke,opacity:1,width:3},Z),Q=D[e],tt=$.extend(!0,{},Q,{transform:"s1.5","stroke-width":1},b.markerHoverStyle),B=[].concat(X.x),R=[].concat(X.y),V=f.set(),N=[],A=z.fitType,H=!1,z.markers.symbol&&z.markers.symbol.length&&(H=!0),P=f.set(),(!n||n.length<=e||_.enabled&&!S.enabled)&&(x=!0),x&&R.length>0&&(M=t.ChartUtil.getFirstValidListValue(R),k&&(M=$.toOADate(M)),F=t.ChartUtil.getLastValidListValue(R),k&&(F=$.toOADate(F))),W=u.processYValues(R,z.display,w,m,O),$.each(R,function(t,e){if(U=B[t],E&&(U=$.toOADate(U)),e=R[t],W[t].isHole){if("excludeHole"===z.display)return!0;if(!W[t].isValue)return!0}return k&&(e=$.toOADate(e)),void 0===U?!1:void(N=u.renderPoint(g,f,q,N,V,K,a,P,Y,L,T,x,M,F,U,e,X.y[t],v,A,E,k,t,Z,tt,z,H,I,l,B,R,W,z.display,m,it,c,p))}),u.renderPath(f,g,z,o,r,h,Q,Z,tt,V,s,a,N,i,q,J,j,K,Y,P,e,y,G,m,it,p),d.push({markers:V,path:o[o.length-1],shadowPath:r[r.length-1],dcl:P}),void 0)}),$.each($.merge([],o).reverse(),function(t,e){e.toFront(),e.area&&e.area.toFront()}),$.each(o,function(t,e){e.tracker&&e.tracker.toFront()}),$.each(o,function(t,e){e.markers&&e.markers.toFront()})},e.prototype.renderPath=function(e,i,n,o,r,s,a,l,h,d,c,u,p,g,f,m,w,y,v,_,S,x,b,C,D,I){var j,T,E,k,L,P,M,F,A,B,R,O,G,U,N;j=e.path(p.join(" ")),j.straight=f.join(" "),t.ChartUtil.paintShadow(j,1,"#cccccc"),0===S&&(b.length=0,p.length>1?(P=p[1],M=p[p.length-2]):(P=i.startX,M=i.endX),$.merge(b,["L",P,i.endY,"L",M,i.endY])),F=e.path(p.join(" ")),j.tracker=F,A=m["stroke-width"]?10+parseFloat(m["stroke-width"]):10,F.attr({"stroke-width":A,stroke:"#C0C0C0",opacity:.01}),$.wijraphael.addClass($(F.node),Raphael.format("{0} {1} {2}",I.canvasObject,I.lineElement,I.lineTracker)),$(F.node).data("owner",$(j.node)),"area"===x?(m.fill&&"none"!==m.fill?(T=m.fill,delete m.fill):T=m.stroke,E=.5,k=1,m["fill-opacity"]&&"none"!==m["fill-opacity"]&&(E=m["fill-opacity"]),m.opacity&&"none"!==m.opacity&&(k=m.opacity),j.wijAttr(m),P=p.length>1?p[1]:i.startX,C?(p.push("V"),p.push(i.endY),p.push("H"),p.push(P),p.push("Z")):(G=Raphael.parsePathString(j.attr("path")),G&&G.length>0&&(p=[],$.each(G,function(t,e){$.each(e,function(t,e){p.push(e)}),"M"===e[0]&&(P=e[1]),t<G.length-1&&"M"===G[t+1][0]&&(p.push("V"),p.push(i.endY),p.push("H"),p.push(P),p.push("Z")),t===G.length-1&&(p.push("V"),p.push(i.endY),p.push("H"),p.push(P),p.push("Z"))}))),L=e.path(p.join(" ")),$.wijraphael.addClass($(L.node),I.areaElement),L.wijAttr({fill:T,opacity:k,"fill-opacity":E,stroke:"none"}),f.push("V"),f.push(i.endY),f.push("H"),f.push(P),f.push("Z"),L.straight=f.join(" "),j.area=L,u.push(L),g.push({path:$.extend(!0,{},j.attr()),area:$.extend(!0,{},L.attr()),markers:y,labels:v})):(N=$.extend(!0,{},m),N.fill&&delete N.fill,j.wijAttr(N),g.push({path:$.extend(!0,{},j.attr()),markers:y,labels:v})),j.markers=d,o.push(j),j.shadow&&(r[S]=j.shadow),u.push(j),s[S]={lineStyle:m,lineHoverStyle:a,markerStyle:l,markerHoverStyle:h},(!n.markers.visible||"hide"===n.display)&&d.hide(),n.visible&&"hide"!==n.display||(j.hide(),j.tracker&&j.tracker.hide(),j.shadow&&j.shadow.hide(),j.area&&j.area.hide(),j.visible=!1),n.markers.style&&d.attr(n.markers.style),d.toFront(),_.length&&(B=$.extend(!0,{},w),n.textStyle&&(B=$.extend(!0,B,n.textStyle)),_.attr(B),_.toFront(),j.labels=_),c[S]=d,n.index=S,n.type="line",n.path=j,n.lineMarkers=d,n.lineStyle=m,n.lineHoverStyle=a,n.virtualMarkers=D,$.wijraphael.addClass($(j.node),Raphael.format("{0} {1}",I.canvasObject,I.lineElement)),$(j.node).data("wijchartDataObj",n)},e.prototype.renderPoint=function(t,e,i,n,o,r,s,a,l,h,d,c,u,p,g,f,m,w,y,v,_,S,x,b,C,D,I,j,T,E,k,L,P,M,F,A){var B=t.endX-t.startX,R=t.endY-t.startY,O=w.x.min,G=w.y.min,U=w.x.max,N=w.y.max,V=B/(U-O),H=R/(N-G),W,z,K,Y=0,q,X,J,Q,Z=C.markers.visible,tt=this.widget,et;return K=isNaN(g)||"string"==typeof g?S:g,Y=t.startX+(K-O)*V,q=t.endY-(f-G)*H,k[S].x=Y,k[S].y=q,c&&(X=u+(p-u)/(U-O)*(K-O),X=t.endY-(X-G)*H,i.push(k[S].idx?"L":"M"),i.push(Y),i.push(X)),k[S].isHole?n:(n=this.getPathArrByFitType(n,y,S,E.length,t,T,E,Y,q,v,_,g,f,V,H,O,G,k,L,P),I&&(Q=this.renderChartLabel(e,_,f,d,Y,q,F,A),h.push(Q),a.push(Q),l.push($.extend(!0,{},Q.attr()))),Z&&(W=this.renderMarker(e,j,D,C.markers,S,Y,q,x,A),z=W.dot,c&&(z.straight=X)),J={},J.valX=T[S],J.valY=m,J.index=S,J.type="marker",J.lineSeries=C,J.x=Y,J.y=q,J.markerStyle=x,J.markerHoverStyle=b,J.visible=!0,Z&&(J.marker=z,J.isSymbol=W.isSymbol,$(z.node).data("wijchartDataObj",J),o.push(z),r.push($.extend(!0,{},z.attr())),s.push(z)),tt.dataPoints=tt.dataPoints||{},tt.pointXs=tt.pointXs||[],et=$.round(Y,2),tt.dataPoints[et.toString()]||(tt.dataPoints[et.toString()]=[],tt.pointXs.push(et)),tt.dataPoints[et.toString()].push(J),M.push(J),n)},e.prototype.processYValues=function(e,i,n,o,r){var s=[],a=0,l=0;return $.each(e,function(h,d){a||(l=h);var c={isHole:!1,isValue:!0,idx:a,firstYIdx:l,x:0,y:0};a++,t.ChartUtil.isHolefunction(d,n)&&(o?e[h]=0:(c.isHole=!0,"excludeHole"===i?(a--,c.idx=0):(a=0,c.idx=0),t.ChartUtil.isHolefunction(n,void 0)||d!==n?c.isValue=!1:c.isValue=!0)),s.push(c),o&&h<r.length&&(e[h]+=r[h])}),r.length=0,$.merge(r,e),s},e.prototype.renderMarker=function(t,e,i,n,o,r,s,a,l){var h,d=null,c=!1,u,p;return i&&(h=n.symbol,$.each(h,function(i,n){return n.index===o?(d=t.image(n.url,r-n.width/2,s-n.height/2,n.width,n.height),e.push(d),c=!0,!1):void 0})),null===d&&(u=n.type,p=a.width,d=t.paintMarker(u,r,s,p),n.visible&&d.attr(a)),$.wijraphael.addClass($(d.node),Raphael.format("{0} {1} {2}",l.canvasObject,l.lineElement,l.canvasMarker)),{dot:d,isSymbol:c}},e.prototype.renderChartLabel=function(t,e,i,n,o,r,s,a){var l,h,d,c=this.options.widget;return l=e?$.fromOADate(i):i,n&&n.length&&(l=Globalize.format(l,n,s)),h=c._text.call(c,o,r,l),$.wijraphael.addClass($(h.node),a.lineLabel),d=h.wijGetBBox(),h.transform(Raphael.format("...T{0},{1}",0,-d.height)),h},e.prototype.getAnchors=function(t,e,i,n,o,r){var s=(i-t)/2,a=(o-i)/2,l=Math.atan((i-t)/Math.abs(n-e)),h=Math.atan((o-i)/Math.abs(n-r)),d=0,c=0,u=0,p=0,g=0;return l=n>e?Math.PI-l:l,h=n>r?Math.PI-h:h,d=Math.PI/2-(l+h)%(2*Math.PI)/2,c=s*Math.sin(d+l),u=s*Math.cos(d+l),p=a*Math.sin(d+h),g=a*Math.cos(d+h),{x1:i-c,y1:n+u,x2:i+p,y2:n+g}},e.prototype.getPathArrByFitType=function(t,e,i,n,o,r,s,a,l,h,d,c,u,p,g,f,m,w,y,v){var _=null,S=0,x=0,b=0,C=0,D=null,I=null,j=w[i],T=!1,E=j.idx,k,L=i-1,P=i+1;if("excludeHole"!==y||v)n-1>i&&(T=w[P].isHole),i>0&&n-1>i&&(b=w[L].x,S=w[L].y);else if(i>0&&n-1>i){for(P=-1,L=-1,k=i+1;n>k;k++)if(T=!0,!w[k].isHole){P=k,T=!1;break}for(k=i-1;k>=0;k--)if(!w[k].isHole){L=k;break}L>-1&&(b=w[L].x,S=w[L].y)}return v&&(e="line"),"line"===e?t=t.concat([E?"L":"M",a,l]):"spline"===e?E?E&&n-1>i&&!T?(_=s[P],d&&(_=$.toOADate(_)),x=o.endY-(_-m)*g,isNaN(c)||"string"==typeof c?C=o.startX+(P-f)*p:(D=r[P],h&&(D=$.toOADate(D)),C=o.startX+(D-f)*p),I=this.getAnchors(b,S,a,l,C,x),t=t.concat([I.x1,I.y1,a,l,I.x2,I.y2])):t=t.concat([a,l,a,l]):t=i===n-1?t.concat(["M",a,l]):T?t.concat(["M",a,l]):t.concat(["M",a,l,"C",a,l]):"bezier"===e&&(t=E?n-1>i&&w[i+1].isHole&&E%2===1||i===n-1&&E%2===1?t.concat(["Q",a,l,a,l]):E%2===0?t.concat([a,l]):t.concat(["Q",a,l]):t.concat(["M",a,l])),t},e.prototype.bindLiveEvents=function(t,e,i,n,o,r,s,a,l,h,d,c,u,p,g){var f="",m={element:t,mousedown:function(e){if(!d){var i=$(e.target),n,r=null;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),i.hasClass(g.canvasMarker)?(r=n.lineSeries,r.markers.visible?o.call(t,e,n):o.call(t,e,r)):o.call(t,e,n)}},mouseup:function(e){if(!d){var i=$(e.target),n,o=null;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),i.hasClass(g.canvasMarker)?(o=n.lineSeries,o.markers.visible?r.call(t,e,n):r.call(t,e,o)):r.call(t,e,n)}},mouseover:function(e){if(!d){var i=$(e.target),n,o=null;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),i.hasClass(g.canvasMarker)?(o=n.lineSeries,o.markers.visible?s.call(t,e,n):s.call(t,e,o)):s.call(t,e,n)}},mouseout:function(e){if(!d){var i=$(e.target),n,o=null;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),i.hasClass(g.canvasMarker)?(o=n.lineSeries,o.markers.visible?a.call(t,e,n):a.call(t,e,o)):a.call(t,e,n)}},mousemove:function(e){if(!d){var i=$(e.target),n,o=null;
i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),i.hasClass(g.canvasMarker)?(o=n.lineSeries,o.markers.visible?l.call(t,e,n):l.call(t,e,o)):l.call(t,e,n)}},click:function(e){if(!d){var i=$(e.target),n,o=null;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),i.hasClass(g.canvasMarker)?(o=n.lineSeries,o.markers.visible?h.call(t,e,n):h.call(t,e,o)):h.call(t,e,n)}}};$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(f="wij"),t.on(f+"mousedown."+n,"."+g.lineElement,$.proxy(m.mousedown,m)).on(f+"mouseup."+n,"."+g.lineElement,$.proxy(m.mouseup,m)).on(f+"mouseover."+n,"."+g.lineElement,$.proxy(m.mouseover,m)).on(f+"mouseout."+n,"."+g.lineElement,$.proxy(m.mouseout,m)).on(f+"mousemove."+n,"."+g.lineElement,$.proxy(m.mousemove,m)).on(f+"click."+n,"."+g.lineElement,$.proxy(m.click,m))},e.prototype.unbindLiveEvents=function(t,e,i){t.off("."+e,"."+i.lineElement)},e}();t.LineChartRender=n}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){this._handleChartStyles(),t.prototype._create.call(this),this.chartElement.addClass(this.options.wijCSS.pieChart)},e.prototype.destroy=function(){var e=this.options.wijCSS,i=this.chartElement,n=i.data("fields"),o=n&&n.sectors,r=n&&n.labels;i.removeClass(e.pieChart),t.prototype.destroy.call(this),o&&o.length&&$.each(o,function(t,e){e=null}),r&&r.length&&$.each(r,function(t,e){e=null}),i.data("fields",null)},e.prototype._isPieChart=function(){return!0},e.prototype.getSector=function(t){var e=this.chartElement.data("fields");return e&&e.chartElements?e.chartElements.sectors[t]:null},e.prototype._bindData=function(){var t=this.options,e=t.dataSource,i=t.data,n=[],o,r,s;e&&i&&(o=i.label,r=i.value,s=i.offset,o&&o.bind&&(o=this._getBindData(e,o.bind)),r&&r.bind&&(r=this._getBindData(e,r.bind)),s&&s.bind&&(s=this._getBindData(e,s.bind)),o&&$.isArray(o)&&o.length&&r&&$.isArray(r)&&r.length&&($.each(r,function(t,e){var i,a=0;t>=0&&t<o.length&&(i=o[t]),s&&$.isArray(r)&&s.length&&t>=0&&t<s.length&&(a="undefined"==typeof s[t]?0:s[t]),n.push({data:e,label:i,offset:a,legendEntry:!0})}),t.seriesList=n))},e.prototype._hanldSharedXData=function(){},e.prototype._getSeriesFromTR=function(t,e,i){var n=null,o=null,r=null,s=null,a=null;e.length&&e.each(function(){o=$("th",$(this)),n=$.trim(o.text()),r=$("td",$(this)),r.length&&(s=parseFloat($.trim($(r[0]).text()))),a={label:n,legendEntry:!0,data:s},i.push(a)})},e.prototype._showSerieEles=function(t){var e=this.options.showChartLabels;t.sector&&(t.sector.show(),t.sector.shadow&&t.sector.shadow.show(),t.sector.tracker&&t.sector.tracker.show()),t.label&&e&&(t.label.show(),t.label.connector&&t.label.connector.show(),$(t.label.node).data("legendHide",!1))},e.prototype._hideSerieEles=function(t){t.sector&&(t.sector.hide(),t.sector.shadow&&t.sector.shadow.hide(),t.sector.tracker&&t.sector.tracker.hide()),t.label&&(t.label.hide(),t.label.connector&&t.label.connector.hide(),$(t.label.node).data("legendHide",!0))},e.prototype._hasAxes=function(){return!1},e.prototype._mouseMoveInsidePlotArea=function(e,i){if(t.prototype._mouseMoveInsidePlotArea.call(this,e,i),this.isTapAndHold){var n=this.previousAngle,o=0,r="",s=this.chartElement,a=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},l=a.pieID||"",h=s.data("fields").chartElements["sectors"+l],d=this.canvasBounds,c=(d.startX+d.endX)/2,u=(d.startY+d.endY)/2,p=Raphael.angle(i.left,i.top,c,u);n&&(o=Math.round(p-n),Math.abs(p-n)>180&&(p>n?o-=360:o+=360),o&&(r=Raphael.format("...r{0},{1},{2}",o,c,u),$.each(h,function(t,e){e.transform(r)}),this.tooltip&&this._setTouchTooltip(null))),this.previousAngle=p}},e.prototype._mouseMoveOutsidePlotArea=function(e,i){t.prototype._mouseMoveOutsidePlotArea.call(this,e,i),this.isTapAndHold&&this._rotateToSectorCenter(null)},e.prototype._rotateToSectorCenter=function(t){var e=this,i=this.options.animation,n=this.chartElement,o=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},r=o.pieID||"",s=n.data("fields").chartElements["sectors"+r],a=n.data("fields").chartElements["labels"+r],l=this.canvasBounds,h=(l.startX+l.endX)/2,d=(l.startY+l.endY)/2,c,u,p,g=this;this._hideSectorElements(s,a),this.tooltip&&(u=this._getTouchttSector(t)),this.touchttSector&&this.touchttSector===u&&Math.abs(this.targetCenterAngle)>=.01?(p=this.targetCenterAngle>180?this.targetCenterAngle-360:this.targetCenterAngle<-180?this.targetCenterAngle+360:this.targetCenterAngle,c=Raphael.animation({transform:Raphael.format("...r{0},{1},{2}",p,h,d)},i.duration,i.easing,function(){g._rotateCallback(this,a)}),$.each(s,function(t,e){e.animate(c)})):$.each(s,function(t,i){e._rotateCallback(i,a)}),this.previousAngle=null,this.isTapAndHold=!1,this.tapTarget=null},e.prototype._rotateCallback=function(t,e){var i=this.canvasBounds,n=(i.startX+i.endX)/2,o=(i.startY+i.endY)/2,r=t.index,s=0,a=t.attr("transform"),l;if($.each(a,function(t,e){return"r"!==e[0]?!0:void(e.length>=4&&(s+=e[1]))}),n>0&&(s%=360,t.attr("transform",Raphael.format("r{0},{1},{2}",s,n,o))),t.tracker&&(t.tracker.attr("transform",Raphael.format("r{0},{1},{2}",s,n,o)),t.tracker.show()),t.shadow&&(t.shadow.attr("transform",Raphael.format("r{0},{1},{2}",s,n,o)),t.shadow.show()),e&&e.length&&e.length>r){if(l=e[r],l.attr("transform",Raphael.format("r{0},{1},{2}r{3}",s,n,o,0-s)),$(l.node).data("legendHide"))return;l.show()}},e.prototype._getTouchttSector=function(t){var e=this,i=this.chartElement,n=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},o=n.pieID||"",r=i.data("fields").chartElements["sectors"+o],s=this.tooltip.getOptions(),a=s.compass,l=90,h;switch(a){case"east":l=0;break;case"south":l=270;break;case"west":l=180;break;case"north":default:l=90}return $.each(r,function(i,n){var o=n.attr("transform"),r=0,s=n.angles;if($.each(o,function(t,e){return"r"!==e[0]?!0:void(e.length>=4&&(r+=e[1]))}),r%=360,0>r&&(r=360+r),r=(l+r)%360,t){if(n===t)return e.targetCenterAngle=(s.start+s.end)/2-r,h=t,!1}else if(s.start<=r&&s.end>=r)return e.targetCenterAngle=(s.start+s.end)/2-r,h=n,!1}),h},e.prototype._setTouchTooltip=function(t){var e=this.tooltip.getOptions(),i=e.compass,n=this._getTouchttSector(t),o=this.options.hint,r=o.title,s=o.content,a=$.isFunction(r),l=$.isFunction(s),h,d;!n||this.touchttSector&&this.touchttSector===n||(h=$(n.node).data("wijchartDataObj"),d={data:h,value:h.value,label:h.label,total:h.total,y:h.value},(a||l)&&(a&&(e.title=function(){d.fmt=r;var t=$.proxy(d.fmt,d),e=t();return e}),l&&(e.content=function(){d.fmt=s;var t=$.proxy(d.fmt,d),e=t();return e})),this._showTouchTooltip(i),this.touchttSector=n)},e.prototype._showTouchTooltip=function(t){var e=this.chartElement,i=this.canvasBounds,n={x:0,y:0};switch(t){case"east":n={x:e.width(),y:(i.startY+i.endY)/2};break;case"south":n={x:(i.startX+i.endX)/2,y:e.height()};break;case"west":n={x:0,y:(i.startY+i.endY)/2};break;case"north":default:n={x:(i.startX+i.endX)/2,y:0}}this.tooltip.showAt(n)},e.prototype._isTouchEnabled=function(){return $.support.isTouchEnabled&&$.support.isTouchEnabled()&&this.options.enableTouchBehavior},e.prototype._mouseDown=function(e,i){var n=$(e.target),o=this.chartElement,r,s,a;t.prototype._mouseDown.call(this,e,i),this._isTouchEnabled()&&(this.isTapAndHold=!0,n.data("owner")&&(n=n.data("owner")),this.tapTarget=n,r=i.pieID||"",s=o.data("fields").chartElements["sectors"+r],a=o.data("fields").chartElements["labels"+r],this._hideSectorElements(s,a))},e.prototype._hideSectorElements=function(t,e){$.each(t,function(t,i){if(i.stop(),i.tracker&&i.tracker.hide(),i.shadow&&i.shadow.hide(),e&&e.length){var n=e[t];n.hide()}})},e.prototype._mouseUp=function(e,i){t.prototype._mouseUp.call(this,e,i),this._isTouchEnabled()&&this.isTapAndHold&&this._rotateToSectorCenter(null)},e.prototype._mouseOver=function(e,i){t.prototype._mouseOver.call(this,e,i)},e.prototype._mouseOut=function(e,i){t.prototype._mouseOut.call(this,e,i)},e.prototype._mouseMove=function(e,i){t.prototype._mouseMove.call(this,e,i)},e.prototype._click=function(e,i){var n=this.chartElement,o,r,s;t.prototype._click.call(this,e,i),this._isTouchEnabled()&&this.tooltip&&(o=i.pieID||"",r=n.data("fields").chartElements["sectors"+o],r.length&&r.length>i.index&&(s=r[i.index],this._setTouchTooltip(s),this._rotateToSectorCenter(s)))},e.prototype._paintTooltip=function(){var e=this.options.wijCSS,i=this.chartElement,n=i.data("fields");t.prototype._paintTooltip.call(this),this.tooltip&&n&&(this._isTouchEnabled()?(this.tooltip.setOptions({closeBehavior:"none",mouseTrailing:!1,animated:null,showAnimated:null,windowCollisionDetection:"fit"}),this._setTouchTooltip(null),this._rotateToSectorCenter(null)):n.trackers&&n.trackers.length&&(this.tooltip.setSelector($("."+e.canvasObject,i[0])),this.tooltip.setOptions({relatedElement:n.trackers[0]})))},e.prototype._paintPlotArea=function(){var t=this.options,e=this.canvasBounds,i=e.endX-e.startX,o=e.endY-e.startY,r=t.radius;r?(2*r>i&&(r=i/2),2*r>o&&(r=o/2)):r=Math.min(i,o)/2,e.startX+=i/2-r,e.endX=e.startX+2*r,e.startY+=o/2-r,e.endY=e.startY+2*r,this.chartElement.data("fields")&&(this.chartElement.data("fields").seriesEles=null),this.piechartRender=new n(this.chartElement,{canvas:this.canvas,tooltip:this.tooltip,bounds:e,wijCSS:t.wijCSS,radius:r,startAngle:t.startAngle,widgetName:this.widgetName,innerRadius:t.innerRadius,seriesList:t.seriesList,seriesStyles:t.seriesStyles,seriesHoverStyles:t.seriesHoverStyles,seriesTransition:t.seriesTransition,showChartLabels:t.showChartLabels,disabled:t.disabled,textStyle:t.textStyle,chartLabelStyle:t.chartLabelStyle,chartLabelFormatString:t.chartLabelFormatString,chartLabelFormatter:t.chartLabelFormatter,labels:t.labels,shadow:t.shadow,animation:t.animation,culture:this._getCulture(),mouseDown:$.proxy(this._mouseDown,this),mouseUp:$.proxy(this._mouseUp,this),mouseOver:$.proxy(this._mouseOver,this),mouseOut:$.proxy(this._mouseOut,this),mouseMove:$.proxy(this._mouseMove,this),click:$.proxy(this._click,this),widget:this,enableTouchBehavior:t.enableTouchBehavior,availableWidth:i,availableHeight:o}),this.piechartRender.render(!t.radius)},e.prototype._getTooltipText=function(t,e){var i=$(e.node),n,o;return i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),o={data:n,value:n.value,label:n.label,total:n.total,target:e,y:n.value,fmt:t},$.proxy(t,o)()},e}(t.wijchartcore);t.wijpiechart=e;var i=function(){function t(){this.initSelector=":jqmData(role='wijpiechart')",this.wijCSS={pieChart:"wijmo-wijpiechart",pieLabel:"wijpiechart-label",pieElement:"wijpiechart",pieTracker:"pietracker"},this.startAngle=0,this.radius=null,this.innerRadius=0,this.chartLabelFormatter=null,this.labels={style:{},formatString:"",formatter:null,connectorStyle:{},position:"inside",offset:10},this.animation={enabled:!0,duration:400,easing:"easeInCubic",offset:10},this.seriesTransition={enabled:!0,duration:1e3,easing:"bounce"},this.seriesList=[],this.enableTouchBehavior=!0,this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return t}();e.prototype.options=$.extend(!0,{},t.wijchartcore.prototype.options,new i),$.wijmo.registerWidget("wijpiechart",e.prototype);var n=function(){function e(t,e){this.options=e,this.element=t}return e.prototype.render=function(e){var i=this.element,n=this.options,o=function(e,i,o){n.shadow&&t.ChartUtil.paintShadow(e,i,o)},r=t.ChartUtil.getDiffAttrs,s=n.canvas,a=$.wijraphael.getPositionByAngle,l=n.seriesList,h=n.seriesStyles,d=n.seriesHoverStyles,c=h.length,u=n.textStyle,p=n.labels||{style:{},formatString:"",formatter:null,connectorStyle:{},position:"inside",offset:10},g=$.extend(!0,{},u,n.chartLabelStyle,p.style),f=p.formatString||n.chartLabelFormatString,m=p.formatter||n.chartLabelFormatter,w=n.culture,y=n.bounds,v=y.startX,_=y.startY,S=n.radius,x=n.showChartLabels,b=n.animation,C=n.seriesTransition,D=n.innerRadius,I=i.data("fields")||{},j=I.chartElements||{},T=I.aniSectorAttrs,E=I.aniLabelAttrs,k=0,L=n.startAngle||0,P=n.wijCSS,M,F,A,B=[],R=[],O=[],G=[],U=[],N=[],V=s.set(),H=this.options.widget,W=L,z=n.availableWidth,K=n.availableHeight,Y=n.radius;s.customAttributes.segment=function(e,i,n,o,r,s){var a=null,l=.01;return o-n>360-l?o-=l:l>o-n&&(o+=l),a=s?t.ChartUtil.donut(e,i,r,s,n,o):t.ChartUtil.sector(e,i,r,n,o),{path:a}},$.each(l,function(t,e){e&&"number"==typeof e.data&&(k+=e.data)}),e&&x&&"outside"===p.position&&($.each(l,function(t,e){var i,n,o,r,s,l,h=S,d=0,c=0,u=360*e.data/k,y=u/2+W;return e=$.extend(!0,{offset:0},e),n=$.extend(!0,{},n,g),e.textStyle&&(n=$.extend(!0,n,e.textStyle)),o=e.label,f&&f.length>0&&(o=Globalize.format(o,f,w)),m&&$.isFunction(m)&&(r={index:t,value:e.data,y:e.data,total:k,chartLabel:o,chartLabelFormatter:m},o=$.proxy(m,r)()),E&&C.enabled&&t<E.length?(A=E[t],A.text=o,s=H._text.call(H,0,0,"").attr(A)):s=H._text.call(H,0,0,o).attr(n),l=s.wijGetBBox(),i=a(0,0,e.offset+p.offset+S,y),d=l.width+Math.abs(i.x),c=l.height/2+Math.abs(i.y),d>z/2&&(S=h-(d-z/2)/Math.abs(Math.cos(Raphael.rad(y)))),c>K/2&&(S=Math.min(S,h-(K/2-c)/Math.abs(Math.sin(Raphael.rad(y))))),W+=u,s.remove(),D>S?(S=D,!1):void 0}),S!=Y&&(n.bounds.startX=n.bounds.startX+Y-S,n.bounds.endX=n.bounds.startX+2*S,n.bounds.startY=n.bounds.startY+Y-S,n.bounds.endY=n.bounds.startY+2*S,v=y.startX,_=y.startY)),$.each(l,function(t,e){var i=$.extend({opacity:1,stroke:"gray","stroke-width":1},h[t%c]),n=360*e.data/k,l=v+S,u=_+S,y,b,I,j,W,z,K,Y,q,X=p.position,J=p.connectorStyle,Q=p.offset,Z,tt,et,it=!1;M=e.pieID,e=$.extend(!0,{offset:0},e),e.offset&&(y=a(l,u,e.offset,L+n/2),l=y.x,u=y.y),F=[l,u,L,L+n,S,D],T&&C.enabled?(i.segment=F,t<T.length?A=T[t]:(A=$.extend(!0,{},i),A.segment=[l,u,0,360,S,D]),b=s.path().attr(A),i=r(A,i),b.removed||b.wijAnimate(i,C.duration,C.easing,function(){o(b,1,"#cccccc"),K&&!K.removed&&!b.removed&&K.attr({path:b.attr("path")}),delete i.segment})):(b=s.path().attr({segment:F}),o(b,1,"#ccccc"),b.wijAttr(i)),b.angles={start:L,end:L+n},b.index=t,b.getOffset=function(t){var e=a(l,u,t,(b.angles.start+b.angles.end)/2);return{x:e.x-l,y:e.y-u}},b.center={x:l,y:u},b.radius=S,D&&(b.innerRadius=D),K=b.clone(),Raphael.vml?K.attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}):K.attr({opacity:.01,fill:"white","fill-opacity":.01}),$.wijraphael.addClass($(K.node),Raphael.format("{0} {1} {2} wijchart-tracker"+t,P.canvasObject,P.pieElement,P.pieTracker)),$(K.node).data("owner",$(b.node)),b.tracker=K,V.push(K),$.wijraphael.addClass($(b.node),Raphael.format("{0} {1} wijmo-wijpiechart-series-"+t,P.canvasObject,P.pieElement)),$(b.node).data("wijchartDataObj",e),x&&("outside"===X?(z=a(l,u,S,L+n/2),j=a(l,u,S+Q,L+n/2)):j=a(l,u,e.offset+2*S/3,L+n/2),W=$.extend(!0,{},W,g),e.textStyle&&(W=$.extend(!0,W,e.textStyle)),Y=e.label,f&&f.length>0&&(Y=Globalize.format(Y,f,w)),m&&$.isFunction(m)&&(q={index:t,value:e.data,y:e.data,total:k,chartLabel:Y,chartLabelFormatter:m},Y=$.proxy(m,q)()),E&&C.enabled&&t<E.length?(it=!0,A=E[t],A.text=Y,I=H._text.call(H,0,0,"").attr(A),W=r(A,W),W.x=j.x,W.y=j.y,I.wijAnimate(W,C.duration,C.easing,function(){et&&et.show()})):I=H._text.call(H,j.x,j.y,Y).attr(W),"outside"===X&&(Z=(L+n/2)%360,tt=I.wijGetBBox(),Z>=90&&270>=Z?I.transform(Raphael.format("T{0},{1}",-tt.width/2,0)):I.transform(Raphael.format("T{0},{1}",tt.width/2,0)),et=s.path(Raphael.format("M{0} {1}L{2} {3}",z.x,z.y,j.x,j.y)).attr(J),it&&et.hide(),I.connector=et),$.wijraphael.addClass($(I.node),Raphael.format("{0} {1} {2}",P.canvasObject,P.pieElement,P.pieLabel)),$(I.node).data("wijchartDataObj",e),U.push(I),G.push(I),R[t]=I.attr()),N.push({label:G[t],sector:b}),e.visible===!1&&(b.hide(),G[t]&&G[t].hide(),et&&et.hide(),b.shadow&&b.shadow.hide(),K.hide()),B[t]=b.attr(),O.push(b),U.push(b),e.style=i,e.hoverStyle=d[t],e.index=t,e.value=e.data,e.y=e.data,e.total=k,e.type="pie",L+=n}),G&&G.length&&$.each(G,function(t,e){e.toFront()}),j.sectors=O,M&&(j["sectors"+M]=O,j["labels"+M]=G),j.labels=G,I.chartElements||(I.chartElements={}),V.toFront(),$.extend(!0,I.chartElements,j),I.aniSectorAttrs=B,I.aniLabelAttrs=R,I.seriesEles=N,I.trackers=V,i.data("fields",I),this.unbindLiveEvents(),this.bindLiveEvents()},e.prototype._isTouchEnabled=function(){return $.support.isTouchEnabled&&$.support.isTouchEnabled()&&this.options.enableTouchBehavior===!0},e.prototype.bindLiveEvents=function(){var t=this,e=this.options,i=this.element,n=e.tooltip,o={x:0,y:0},r="",s=$.isFunction,a=e.disabled,l=e.animation;this._isTouchEnabled()&&(r="wij"),n&&n.setTargets(this.tooltipTars),i.on(r+"mousedown."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(!a){var n=e.mouseDown,o=$(t.target),r;o.data("owner")&&(o=o.data("owner")),r=o.data("wijchartDataObj"),r&&s(n)&&n.call(i,t,r)}}).on(r+"mouseup."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(!a){var n=e.mouseUp,o=$(t.target),r;o.data("owner")&&(o=o.data("owner")),r=o.data("wijchartDataObj"),r&&s(n)&&n.call(i,t,r)}}).on(r+"mouseover."+e.widgetName,"."+e.wijCSS.pieElement,function(n){if(!a){var r=e.mouseOver,h=$(n.target),d=l&&l.enabled,c,u,p,g,f,m,w;if(h.data("owner")&&(h=h.data("owner")),c=h.data("wijchartDataObj"),c&&(u=c.pieID||"",p=c.index,g=i.data("fields").chartElements["sectors"+u][p],f=g.showAnimationTimer,m=g.hideAnimationTimer,w=g.explodeAnimationShowing,s(r)&&r.call(i,n,c),!t._isTouchEnabled()&&!g.removed&&(g.wijAttr(c.hoverStyle),d))){if(m&&(window.clearTimeout(m),m=null,g.hideAnimationTimer=m),f&&(window.clearTimeout(f),f=null,g.showAnimationTimer=null),w)return;f=window.setTimeout(function(){var t=l.duration,e=l.easing;g.removed||(o=g.getOffset(l.offset||10),g.offset=o,g.shadow&&!g.shadow.removed&&g.shadow.hide(),g.wijAnimate({transform:Raphael.format("t{0},{1}",o.x,o.y)},t,e),g.tracker&&!g.tracker.removed&&g.tracker.wijAnimate({transform:Raphael.format("t{0},{1}",o.x,o.y)},t,e),w=!0,g.explodeAnimationShowing=w)},150),g.showAnimationTimer=f}}}).on(r+"mouseout."+e.widgetName,"."+e.wijCSS.pieElement,function(n){if(!a){var r=e.mouseOut,h=$(n.target),d=l&&l.enabled,c,u,p,g,f,m,w;if(h.data("owner")&&(h=h.data("owner")),c=h.data("wijchartDataObj"),c&&(u=c.pieID||"",p=c.index,g=i.data("fields").chartElements["sectors"+u][p],f=g.showAnimationTimer,m=g.hideAnimationTimer,w=g.explodeAnimationShowing,s(r)&&r.call(i,n,c),!t._isTouchEnabled()&&!g.removed&&(c.style.segment&&delete c.style.segment,g.wijAttr(c.style),d))){if(m&&(window.clearTimeout(m),m=null,g.hideAnimationTimer=m),f&&(window.clearTimeout(f),f=null,g.showAnimationTimer=f),!w)return;m=window.setTimeout(function(){var t=l.duration,e=l.easing;o=g.offset,g.shadow&&!g.shadow.removed&&g.shadow.show(),g.removed||g.wijAnimate({transform:"t0,0"},t,e),g.tracker&&!g.tracker.removed&&g.tracker.wijAnimate({transform:"t0,0"},t,e),g.shadow&&!g.shadow.removed&&g.shadow.wijAnimate({transform:"t0,0"},t,e),o={x:0,y:0},w=!1,g.explodeAnimationShowing=w},150),g.hideAnimationTimer=m}}}).on(r+"mousemove."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(!a){var n=e.mouseMove,o=$(t.target),r;o.data("owner")&&(o=o.data("owner")),r=o.data("wijchartDataObj"),r&&s(n)&&n.call(i,t,r)}}).on(r+"click."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(!a){var n=e.click,o=$(t.target),r;o.data("owner")&&(o=o.data("owner")),r=o.data("wijchartDataObj"),r&&s(n)&&n.call(i,t,r)}})},e.prototype.unbindLiveEvents=function(){var t=this.element,e=this.options;t.off("."+e.widgetName,"."+e.wijCSS.pieElement)},e}();t.PieChartRender=n}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijtree",o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),this._useDOMInit=!0,this._initState(),this._createTree(),this._attachEvent(),this._attachNodeEvent()},e.prototype._setOption=function(t,e){var n=this,o=!1,r=n.options,s,a;switch(t){case"allowDrag":n._setAllowDrag(e);break;case"allowDrop":n._setAllowDrop(e);break;case"showCheckBoxes":n._setCheckBoxes(e);break;case"showExpandCollapse":n.options.showExpandCollapse!==e&&(o=!0);break;case"disabled":s=n.element.find(":wijmo-wijtreecheck"),s.length&&s.wijtreecheck("option","disabled",e),n._setAllowDrag(!e)}i.Widget.prototype._setOption.apply(n,arguments),"nodes"===t&&(e&&e.length&&(n._useDOMInit=!1),n._createChildNodes()),o===!0&&n._setHitArea(e)},e.prototype._initState=function(){var t=this,e=t.options;t._selectedNodes=[],t._checkedNodes=[],e.nodes||(e.nodes=[]),e.nodes&&e.nodes.length&&(t._useDOMInit=!1),t._enabled=!0,t._insertPosition="unKnown",t.nodeWidgetName="wijtreenode"},e.prototype._createTree=function(){var t=this,e=t.options,n=[],o=["wijmo-wijtree",e.wijCSS.widget,e.wijCSS.content,e.wijCSS.helperClearFix,e.wijCSS.cornerAll].join(" ");t.element.is("ul")?(t.$nodes=t.element,t.element.wrap("<div></div>"),t.widgetDom=t.element.parent()):t.element.is("div")&&(t.widgetDom=t.element,t.$nodes=t.widgetDom.children("ul:eq(0)")),t.$nodes.length&&(t.widgetDom.addClass(o).attr({role:"tree","aria-multiselectable":!0}),t.$nodes.addClass("wijmo-wijtree-list").addClass(e.wijCSS.helperReset),e.showExpandCollapse===!1&&t.$nodes.addClass("wijmo-wijtree-allexpanded"),t._createChildNodes(),t.widgetDom.append(i("<div>").css("clear","both"))),e.disabled&&t.disable()},e.prototype._createChildNodes=function(){var t=this,e={nIndex:void 0},n=[],o=t.$nodes,r=t.options.nodes,s=o.children("li");!t._useDOMInit||r.length?(o.empty(),i.each(r,function(i,r){var s=t._generateMarkup(r);o.append(s),e.nIndex=i,t._createNodeWidget(s,e),n.push(t._getNodeWidget(s))})):s.each(function(o,s){var a=i(s),l;t._createNodeWidget(a,e),l=t._getNodeWidget(a),n.push(l),r.push(l.options)}),t._hasChildren=n.length>0,t._setField("nodes",n),t.nodes=n},e.prototype._generateMarkup=function(t){var e,n,o=t.navigateUrl||"";if(i.isPlainObject(t))return e=i("<li></li>"),n=i("<a>").attr("src","string"==typeof o&&o?o:"#"),n.appendTo(e),"string"==typeof t.text&&t.text&&i("<span>").html(t.text).appendTo(n),e},e.prototype._createNodeWidget=function(t,e){var n=this,o=n.nodeWidgetName;return i.fn[o]&&(t.data("owner",this),e&&i.isPlainObject(e)?(i.extend(e,{treeClass:this.widgetFullName}),t[o](e)):t[o]({treeClass:this.widgetFullName})),t},e.prototype._attachEvent=function(){var t=this;t.element.bind(i.browser.msie?"focusin.":"focus."+t.widgetName,i.proxy(t._onFocus,t)).bind("mouseover."+this.widgetName,i.proxy(t._onMouseOver,t)),t.options.allowDrop&&t._attachDroppable()},e.prototype._attachDroppable=function(){var t=this,e=t.options,n={accept:"li",scope:"tree",drop:void 0},o=function(i){e.showCheckBoxes&&e.allowTriState&&!i.element.is(":"+t.widgetFullName)&&i._getField("nodes").length>0&&i._getField("nodes")[0]._setParentCheckState()},r=e.droppable;i.extend(n,r),n.drop=function(n,s){var a=s.draggable,l=t._getNodeWidget(a),h,d,c,u,p,g,f,m=-1;return t._trigger("nodeBeforeDropped",n,s)===!1||!l||e.disabled?void(t._isDragging=!1):(h=l._dropTarget,d=l._insertPosition,void(h&&"unKnown"!==d&&(c=a.data("owner"),c&&(f=a.index()),"end"===d?(m=h._getField("nodes").length,u=h):("before"===d||"after"===d)&&(u=h._getField("owner"),p=u._getField("nodes"),g=i.inArray(h,p),-1!==g&&(m="before"===d?g:g+1)),r&&i.isFunction(r.drop)?(s.oldParent=c.element,s.newParent=u.element,s.oldIndex=f,s.newIndex=m,r.drop.call(t.element,n,s)):(c&&c.remove(a),-1!==m&&(("before"===d||"after"===d)&&g!=i.inArray(h,p)&&m--,t.$nodes.children("li").length?u.add(a,m):t.add(a,m))),i("a:eq(0)",a).blur(),l._tree._isDragging=!1,l.options.selected&&l._setSelected(!1),o(c),o(u),i.extend(s,{sourceParent:c?c.element:null,sIndex:f,targetParent:u.element,tIndex:m,widget:l}),t._trigger("nodeDropped",n,s))))},i.fn.droppable&&t.widgetDom.droppable(n)},e.prototype._attachNodeEvent=function(){this.element.bind("click."+this.widgetName,i.proxy(this._onClick,this)).bind("mouseout."+this.widgetName,i.proxy(this._onMouseOut,this)).bind("keydown."+this.widgetName,i.proxy(this._onKeyDown,this))},e.prototype._onClick=function(t){this._callEvent(t,"_onClick"),i.browser.webkit&&this.widgetDom.focus()},e.prototype._onFocus=function(t){this._callEvent(t,"_onFocus")},e.prototype._onKeyDown=function(t){this._callEvent(t,"_onKeyDown")},e.prototype._onMouseOut=function(t){this._callEvent(t,"_onMouseOut")},e.prototype._onMouseOver=function(t){this._callEvent(t,"_onMouseOver")},e.prototype._callEvent=function(t,e){var i=t.target,n;if(i){if(n=this._getNodeWidgetByDom(i),null===n)return;n[e](t)}},e.prototype._nodeSelector=function(){return":wijmo-wijtreenode"},e.prototype.getSelectedNodes=function(){return this._selectedNodes},e.prototype.getCheckedNodes=function(){var t=this,e=[],n=t.nodeWidgetName;return i(t._nodeSelector(),t.element).each(function(t,o){i(o)[n]("option","checked")&&"indeterminate"!==i(o)[n]("option","checkState")&&e.push(i(o))}),e},e.prototype.destroy=function(){var e=this,n=e.$nodes,o=e.options,r=["wijmo-wijtree",o.wijCSS.widget,o.wijCSS.content,o.wijCSS.helperClearFix,o.wijCSS.cornerAll].join(" ");e.widgetDom.removeClass(r).removeAttr("role").removeAttr("aria-multiselectable"),e.widgetDom.data("uiDroppable")&&e.widgetDom.droppable("destroy"),e.widgetDom.children("div[style]:last").remove(),n.removeData("nodes").removeClass("wijmo-wijtree-list").removeClass(o.wijCSS.helperReset),n.children("li").each(function(t,n){var o=e._getNodeWidget(i(n));o&&o.destroy()}),i.wijmo.wijtree.prototype.options.nodes=null,t.prototype.destroy.call(this)},e.prototype.add=function(t,e){var n=null,o={},r,s,a=this,l,h,d="<li><a href='{0}'>{1}</a></li>",c;if("string"==typeof t?(r=i(d.replace(/\{0\}/,"#").replace(/\{1\}/,t)),a._createNodeWidget(r,o),n=r.data(r.data("widgetName"))):t.jquery?(t.data("widgetName")||a._createNodeWidget(t,o),n=t.data(t.data("widgetName"))):t.nodeType?(r=i(t),a._createNodeWidget(r,o),n=r.data(r.data("widgetName"))):i.isPlainObject(t)&&(r=i(d.replace(/\{0\}/,t.url?t.url:"#").replace(/\{1\}/,t.text)),a._createNodeWidget(r,t),n=r.data(r.data("widgetName"))),null!==n){for(s=a._getField("nodes"),(!e||e>s.length)&&0!==e&&(e=s.length),c=n._getField("nodes"),n._tree=a,l=0;l<c.length;l++)c[l]._tree=a;n._setField("owner",this),h=s.length,h>0&&h!==e?n.element.get(0)!==s[e].element.get(0)&&n.element.insertBefore(s[e].element):a.$nodes.append(n.element),a._changeCollection(e,n),n._initNodeClass()}},e.prototype.remove=function(t){var e=-1,i,n;t&&t.jquery?e=t.index():"number"==typeof t&&(e=t),n=this._getField("nodes"),0>e||e>=n.length||(i=n[e],i.element.detach(),this._changeCollection(e))},e.prototype._changeCollection=function(t,e){var i=this._getField("nodes"),n=this.options.nodes;e?(i.splice(t,0,e),n.splice(t,0,e.options)):(i.splice(t,1),n.splice(t,1))},e.prototype.getNodes=function(){return this.nodes},e.prototype.findNodeByText=function(t){var e=i(".wijmo-wijtree-node a>span",this.$nodes).filter(function(){return i(this).text()===t});return e.length?this._getNodeWidgetByDom(e.get(0)):null},e.prototype._setAllowDrag=function(t){var e=this,n,o=e._nodeSelector(),r="wijmoWijtreenode";i.fn.draggable&&(t?(n=e.element.find(o),n.each(function(){var t=i(this).data(r);(!i(this).data("uiDraggable")&&!t.$navigateUrl.data("events")||!t.$navigateUrl.data("events").mousedown)&&t.$navigateUrl.one("mousedown",t,t._onMouseDown)})):(n=e.element.find(o+":ui-draggable"),n.draggable("destroy")))},e.prototype._setAllowDrop=function(t){i.fn.droppable&&(t?this.widgetDom.data("uiDroppable")||this._attachDroppable():this.widgetDom.droppable&&this.widgetDom.droppable("destroy"))},e.prototype._setCheckBoxes=function(t){var e=this;e.$nodes.children("li").each(function(n,o){var r=e._getNodeWidget(i(o));null!==r&&r._setCheckBoxes(t)})},e.prototype._setHitArea=function(t){var e=this;e.$nodes[t?"addClass":"removeClass"]("wijmo-wijtree-allexpanded"),e.$nodes.children("li").each(function(n,o){var r=e._getNodeWidget(i(o));null!==r&&r._setHitArea(t)})},e.prototype._getNodeWidget=function(t){if(t.is(this._nodeSelector())){var e=t.data(t.data("widgetName"));return e}return null},e.prototype._getNodeWidgetByDom=function(t){var e=this._getNodeByDom(t);return this._getNodeWidget(e)},e.prototype._getNodeByDom=function(t){return i(t).closest(this._nodeSelector())},e.prototype._refreshNodesClass=function(){var t=this._getField("nodes"),e;for(e=0;e<t.length;e++)t[e]._initNodeClass()},e.prototype._getField=function(t){return this.element.data(t)},e.prototype._setField=function(t,e){return this.element.data(t,e)},e}(t.wijmoWidget);e.wijtree=o;var r=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._setOption=function(t,e){var n=this,o,r;switch(t){case"accessKey":null!==n.$navigateUrl&&n.$navigateUrl.attr("accesskey",e);break;case"checked":n._checkState=e?"checked":"unChecked",n._setChecked(e);break;case"collapsedIconClass":case"expandedIconClass":case"itemIconClass":n.options[t]=e,n._initNodeImg();break;case"expanded":n._setExpanded(e);break;case"selected":n._setSelected(e);break;case"text":n._setText(e);break;case"toolTip":n._setToolTip(e);break;case"navigateUrl":n._setNavigateUrlHref(e);break;case"disabled":if(n._isClosestDisabled()&&e===!0)return;o=n.element.find(":wijmo-wijtreecheck"),o.length&&o.wijtreecheck("option","disabled",e)}"nodes"===t?(n.options.nodes.length=0,i.each(e,function(t,e){n.options.nodes.push(e)}),n.options.nodes.concat(),n._hasChildren=n._getChildren(),n._createChildNodes(n.element),n._initNodeClass()):i.Widget.prototype._setOption.apply(n,arguments)},n.prototype._initState=function(){this._tree=null,this._dropTarget=null,this._checkState="unChecked",this._value=this._text=this._navigateUrl="",this._insertPosition="unKnown",this._hasNodes=!1},n.prototype._create=function(){var t=this,e=t.options;t._initState(),t._createTreeNode(),t._initNode(),t.element.data("widgetName","wijmoWijtreenode"),e.selected&&t._tree._selectedNodes.push(t),e.checked&&(t._checkState="checked",t.$checkBox&&("indeterminate"===e.checkState?t.$checkBox.wijtreecheck("option","checkState","triState"):t.$checkBox.wijtreecheck("option","checkState","check")))},n.prototype._createTreeNode=function(){var t=this.element,e,n,o=this,r,s=o.options,a=[];this.$navigateUrl=t.children("a"),null===o._tree&&(o._tree=o._getTree()),isNaN(s.nIndex)?s.nodes||(s.nodes=[]):(r=o._getOwner().options,n=r.nodes[s.nIndex],n&&!n.nodes&&(n.nodes=[]),i.extend(s,n),r.nodes[s.nIndex]=s),o.$nodeBody=null,o.$checkBox=null,o.$hitArea=null,o.$nodes=null,o.$nodeImage=i("<span>"),o.$nodeBody=i("<div>").attr({role:"treeitem","aria-expanded":!1,"aria-checked":!1,"aria-selected":!1}),o._tree.options.showCheckBoxes===!0&&(o.$checkBox=i("<div>")),0===o.$navigateUrl.length&&(o.$navigateUrl=t.children("div"),o.$navigateUrl.addClass("wijmo-wijtree-template"),o._isTemplate=!0),0===o.$navigateUrl.length&&(o.$navigateUrl=i("<a>"),o.$navigateUrl.attr("href","#")),o._isTemplate||(o.$text=o.$navigateUrl.find("span:eq(0)"),0===o.$text.length&&(o.$navigateUrl.wrapInner("<span></span>"),o.$text=o.$navigateUrl.find("span:eq(0)"))),o._hasChildren=o._getChildren(),o.$inner=i("<span></span>").addClass(s.wijCSS.helperClearFix).addClass("wijmo-wijtree-inner").addClass(s.wijCSS.cornerAll),o._createChildNodes(t),o.$inner.append(o.$nodeImage),null!==o.$checkBox&&(o.$inner.append(o.$checkBox),o.$checkBox.wijtreecheck()),o.$inner.append(o.$navigateUrl),o.$nodeBody.append(o.$inner),t.prepend(o.$nodeBody)},n.prototype._createChildNodes=function(t){var e=this,n=[],o=e.options;e._hasChildren?(t.addClass("wijmo-wijtree-parent"),e.$nodeBody.addClass("wijmo-wijtree-node").addClass("wijmo-wijtree-header").addClass(o.wijCSS.stateDefault),e.$hitArea=i("<span>"),e.$inner.prepend(e.$hitArea),e.$nodes=t.find("ul:eq(0)"),n=e._createChildNode(),e.$nodes.addClass("wijmo-wijtree-list").addClass(o.wijCSS.helperReset).addClass("wijmo-wijtree-child")):(t.addClass("wijmo-wijtree-item"),
e.$nodeBody.addClass("wijmo-wijtree-node").addClass(o.wijCSS.stateDefault)),t.css("list-style-type","none"),e._setField("nodes",n)},n.prototype._createChildNode=function(){var t=this,e=t.options,n=[],o={nIndex:void 0,treeClass:void 0,cfli:void 0,nodes:void 0};return e.nodes&&e.nodes.length?(t.$nodes&&t.$nodes.length?t.$nodes.empty():t.$nodes=i("<ul>").appendTo(t.element),i.each(e.nodes,function(i,r){var s=t._generateMarkup(r),a;t.$nodes.append(s),s.data("owner",t),o.nIndex=i,o.treeClass=e.treeClass,s.wijtreenode(o),a=t._getNodeWidget(s),a._index=i,n.push(a)})):(e.nodes||(e.nodes=[]),t.$nodes.children("li").each(function(r,s){var a=i(s),l;a.data("owner",t),o.cfli=!0,o.nIndex=r,o.treeClass=e.treeClass,o.nodes=[],a.wijtreenode(o),l=t._getNodeWidget(a),l._index=r,n.push(l)})),n},n.prototype._generateMarkup=function(t){var e,n,o=t.navigateUrl||"";if(i.isPlainObject(t))return e=i("<li></li>"),n=i("<a>").attr("src","string"==typeof o&&o?o:"#"),n.appendTo(e),"string"==typeof t.text&&t.text&&i("<span>").html(t.text).appendTo(n),e},n.prototype._initNode=function(){var t=this,e=t.options;t._initialized||(t._initialized=!0,t._initNavigateUrl(),!t._isTemplate&&t.$text&&(t._text=t.$text.html(),e.text=t.$text.html()),t._hasChildren=t._getChildren(),t._initNodesUL(),t._initNodeClass(),t._initNodeImg(),t._initCheckBox(),t.$navigateUrl.one("mousedown",t,t._onMouseDown))},n.prototype._initNodeClass=function(){var t=this,e=t.options,n,o="wijmo-wijtree-item",r=e.wijCSS.icon+" "+(e.expanded?e.wijCSS.iconArrowRightDown:e.wijCSS.iconArrowRight);t._tree.options.showExpandCollapse&&(t._hasChildren||e.hasChildren?(t.$nodeBody.removeClass("wijmo-state-expanded").removeClass("wijmo-state-collapsed"),e.expanded?t.$nodeBody.addClass("wijmo-state-expanded"):t.$nodeBody.addClass("wijmo-state-collapsed"),null!==t.$hitArea?t.$hitArea.removeClass([e.wijCSS.icon,e.wijCSS.iconArrowRightDown,e.wijCSS.iconArrowRight].join(" ")).addClass(r):(t.$hitArea=i("<span>").addClass(r).prependTo(t.$inner),t.element.removeClass(o).addClass("wijmo-wijtree-parent")),t._hasChildren&&(n=e.expanded?"":"none",t.$nodes.css({display:n}))):t.$hitArea&&(t.$hitArea.remove(),t.$hitArea=null,t.element.removeClass("wijmo-wijtree-parent").addClass(o))),!t._hasChildren&&t.$nodes&&t.$nodes.css({display:"none"}),e.selected&&t.$inner&&t.$inner.addClass(e.wijCSS.stateActive)},n.prototype._initCheckBox=function(){var t=this,e=t.options;if(t.$checkBox&&e.checkState)switch(e.checkState){case"checked":t.$checkBox.wijtreecheck("option","checkState","check");break;case"indeterminate":t.$checkBox.wijtreecheck("option","checkState","triState");break;case"unChecked":t.$checkBox.wijtreecheck("option","checkState","unCheck");break;default:t.$checkBox.wijtreecheck("option","checkState","unCheck")}},n.prototype._initNodesUL=function(){var t=this;t._tree.options.showExpandCollapse&&t._hasChildren&&t.$nodes[t._expanded?"show":"hide"]()},n.prototype._initNavigateUrl=function(){var t=this,e=t.$navigateUrl.attr("href");t.$navigateUrl.bind("blur."+t.widgetName,t,t._onBlur),this._isTemplate||(t._navigateUrl=e?e:"",t._setNavigateUrlHref(e))},n.prototype._applyIconClass=function(t,e){t.attr("expandediconclass")&&(e.expandedIconClass=t.attr("expandediconclass"),t.removeAttr("expandediconclass")),t.attr("collapsediconclass")&&(e.collapsedIconClass=t.attr("collapsediconclass"),t.removeAttr("collapsediconclass")),t.attr("itemiconclass")&&(e.itemIconClass=t.attr("itemiconclass"),t.removeAttr("itemiconclass"))},n.prototype._initNodeImg=function(){var t=this,e=t.options,n=t.element;null!==t.$nodeImage&&t.$nodeImage.length||(t.$nodeImage=i("<span>")),t._applyIconClass(n,e),""!==e.collapsedIconClass&&""!==e.expandedIconClass?(t.$nodeImage.removeClass().addClass(e.wijCSS.icon).addClass(e.expanded?e.expandedIconClass:e.collapsedIconClass),t._tree.options.showExpandCollapse||t.$nodeImage.addClass(e.expandedIconClass),t.$nodeImage.insertBefore(t.$checkBox)):""!==e.itemIconClass&&(t.$nodeImage.removeClass().addClass(e.wijCSS.icon),t.$nodeImage.addClass(e.itemIconClass),t.$nodeImage.insertBefore(t.$checkBox))},n.prototype._setNavigateUrlHref=function(t){this.$navigateUrl&&((""===t||"undefined"==typeof t)&&(t="#"),this.$navigateUrl.attr("href",t))},n.prototype._editNode=function(){this._tree._editMode=!0,this.$navigateUrl.hide(),this.$editArea||(this.$editArea=i('<input type="text">').wijtextbox()),this.$editArea.val(this.$text.html()),this.$editArea.insertBefore(this.$navigateUrl),this.$editArea.bind("blur",this,this._editionComplete),this.$editArea.focus()},n.prototype._editionComplete=function(t){var e=t.data,i;e._tree._editMode=!1,e.$editArea&&(i=e.$editArea.val(),e.$editArea.remove()),e.$navigateUrl.show(),e.$editArea=null,e._changeText(i)},n.prototype._changeText=function(t){var e=this,i=e.options;null!==e.$text&&""!==t&&(e.$text.text(t),i.text=t,e._tree._trigger("nodeTextChanged",null,e))},n.prototype._expandCollapseItem=function(){var t=this,e=t.options;!t._tree.options.disabled&&!t._isClosestDisabled()&&(t._hasChildren||e.hasChildren)&&t._setExpanded(!e.expanded)},n.prototype._expandNode=function(t){var e=this,i=e._tree.options,n=t?"nodeExpanding":"nodeCollapsing";e._tree._trigger(n,null,{node:this,params:this.options.params})!==!1&&(e.$nodeBody.attr("aria-expanded",t),e._expanded=t,e.options.expanded=t,!i.disabled&&!e._isClosestDisabled()&&(t?i.expandDelay>0?("undefined"!=typeof e._expandTimer&&(e._expandTimer=window.clearTimeout(e._expandTimer)),e._expandTimer=window.setTimeout(function(){e._expandNodeVisually()},i.expandDelay)):e._expandNodeVisually():i.collapseDelay>0?(e._collapseTimer=window.clearTimeout(e._collapseTimer),e._collapseTimer=window.setTimeout(function(){e._collapseNodeVisually()},i.collapseDelay)):e._collapseNodeVisually()))},n.prototype._expandNodeVisually=function(){var t=this,e,n=t.options;t._tree.options.autoCollapse&&(e=t.element.siblings(":"+this.widgetFullName),i.each(e,function(i){var n=t._getNodeWidget(e[i]);n.options.expanded&&n._setExpanded(!1)})),""!==n.collapsedIconClass&&""!==n.expandedIconClass&&t.$nodeImage.removeClass(n.collapsedIconClass).addClass(n.expandedIconClass),t._internalSetNodeClass(!0),t._show()},n.prototype._collapseNodeVisually=function(){var t=this;""!==t.options.collapsedIconClass&&""!==t.options.expandedIconClass&&t.$nodeImage.removeClass(t.options.expandedIconClass).addClass(t.options.collapsedIconClass),t._internalSetNodeClass(!1),t._hide()},n.prototype._internalSetNodeClass=function(t){var e=this.options.wijCSS,i=[e.icon,e.iconArrowRightDown,e.iconArrowRight].join(" ");this.$hitArea&&(this.$hitArea.removeClass(i).addClass(e.icon).addClass(t?e.iconArrowRightDown:e.iconArrowRight),this.$nodeBody.removeClass("wijmo-state-expanded").removeClass("wijmo-state-collapsed"),t?this.$nodeBody.addClass("wijmo-state-expanded"):this.$nodeBody.addClass("wijmo-state-collapsed"))},n.prototype._show=function(){this._animation(!0)},n.prototype._hide=function(){this._animation(!1)},n.prototype._animation=function(t){var e=this,n=e.$nodes,o=t?"expandAnimation":"collapseAnimation",r=t?"nodeExpanded":"nodeCollapsed",s,a=e._tree.options[o];n&&(n.css("opacity",1),i.browser.msie&&parseInt(i.browser.version)<9&&n.css("filter","alpha(opacity=1); ZOOM: 1"),a?(s=a.animated||a.effect,i.effects&&s?n[t?"show":"hide"](s,{easing:a.easing},a.duration,function(){e._tree._trigger(r,null,e)}):n[t?"show":"hide"](a.duration,function(){e._tree._trigger(r,null,e)})):(n[t?"show":"hide"](),e._tree._trigger(r,null,e)))},n.prototype._getBounds=function(t){var e=t.height(),i=t.width(),n=t.offset().top,o=t.offset().left;return{h:e,w:i,t:n,l:o}},n.prototype._isMouseInsideRect=function(t,e){return t.x<e.l||t.x>=e.l+e.w?!1:t.y<=e.t+1||t.y>=e.t+e.h?!1:!0},n.prototype._getNodeByMouseOn=function(t){return i("li").each(function(){var e=this._getBounds(i(this));return i.ui.isOver(t.y,t.x,e.t,e.l,e.h,e.w)?i(this):void 0}),null},n.prototype._drowTemplate=function(t,e,i){var n="unKnown",o=i.is(".wijmo-wijtree-node")?i:i.children(".wijmo-wijtree-node"),r=this._getBounds(o);return e.width(o.width()),t.y>r.t&&t.y<r.t+r.h/2?(e.offset({left:r.l,top:r.t}),n="before"):t.y>r.t+r.h/2&&t.y<r.t+r.h&&(e.offset({left:r.l,top:r.t+r.h}),n="after"),n},n.prototype._beginDrag=function(t){var e=this,n=e.element,o,r=e._tree.options,s=r.draggable,a={cursor:"point",cursorAt:{top:15,left:-25},helper:function(){return i("<div>"+e.$navigateUrl.html()+"</div>").addClass(r.wijCSS.header).addClass(r.wijCSS.cornerAll)},distance:i.browser.msie?1:10,handle:e.$navigateUrl,scope:"tree",stop:void 0,start:void 0,drag:void 0},l=i("<div>").addClass("wijmo-wijtree-insertion").addClass(r.wijCSS.stateDefault);"string"==typeof r.dropVisual?(o=i(r.dropVisual),l=o.length?o:l):i.isFunction(r.dropVisual)&&(o=i(r.dropVisual.call()),l=o.length?o:l),l.hide(),i.extend(a,s),a.start=function(t,o){e._tree._isDragging=!0,e._tree.widgetDom.prepend(l),e._tree._trigger("nodeDragStarted",t,e),s&&i.isFunction(s.start)?s.start.call(e.element,t,o):n.hide()},a.drag=function(t,n){var o=t.srcElement||t.originalEvent.target,r=i(o),a,h={x:t.pageX,y:t.pageY};l&&l.hide(),r&&(a=e._getNodeWidget(r),a&&!a._tree.options.disabled?(r.closest(".wijmo-wijtree-inner",e.element).length?e._insertPosition="end":(l.show(),e._insertPosition=e._drowTemplate(h,l,a.element)),a!=e&&(e._dropTarget=a)):r.is(":"+e.options.treeClass)&&(e._dropTarget=r.data(e.options.treeClass),e._insertPosition="end")),e._tree._trigger("nodeDragging",t,e),s&&i.isFunction(s.drag)&&s.drag.call(e.element,t,n)},a.stop=function(t,o){l.remove(),e._dropTarget=null,e._insertPosition="unKnown",e._tree._isDragging=!1,s&&i.isFunction(s.stop)?s.stop.call(e.element,t,o):(n.show(),e._resetDrag())},i.fn.draggable&&(n.draggable(a).trigger(t),i.browser.mozilla&&e._setFocused(!0))},n.prototype._resetDrag=function(){var t=this,e,i;for(!t._tree.options.allowDrag&&t.element.data("uiDraggable")&&t.element.draggable("destroy"),e=t._getField("nodes"),i=0;i<e.length;i++)e[i]._resetDrag()},n.prototype._checkClick=function(){var t=this,e=t.options;!t._tree.options.disabled&&!t._isClosestDisabled()&&(e.checked&&"indeterminate"===t._checkState?(t._checkState="checked",t._checkItem()):(t._checkState=e.checked?"unChecked":"checked",t._setChecked(!e.checked)),t._tree._trigger("nodeCheckChanged",null,t))},n.prototype._checkItem=function(){var t=this,e=!1,i=t._tree;null!==i&&i.options.showCheckBoxes&&(i.options.autoCheckNodes&&"indeterminate"!==t._checkState&&(e=!0,t._changeCheckState(t.options.checked)),i.options.allowTriState&&t._setParentCheckState(),t[t.options.checked?"_checkNode":"_unCheckNode"](e))},n.prototype._checkNode=function(t){var e=this,i=e.options,n=this._getField("nodes"),o;if("checked"===e._checkState?(e.$checkBox.wijtreecheck("option","checkState","check"),i.checkState="checked"):"indeterminate"===e._checkState&&(e.$checkBox.wijtreecheck("option","checkState","triState"),i.checkState="indeterminate"),t)for(o=0;o<n.length;o++)n[o]._checkNode(!0)},n.prototype._unCheckNode=function(t){var e=this._getField("nodes"),i=this.options,n;if(this.$checkBox.wijtreecheck("option","checkState","unCheck"),i.checkState="unChecked",t)for(n=0;n<e.length;n++)e[n]._unCheckNode(!0)},n.prototype._changeCheckState=function(t){var e=this._getField("nodes");i.each(e,function(e,i){i.options.checked=t,i.$nodeBody.attr("aria-checked",t),i._checkState=t?"checked":"unChecked",i._changeCheckState(t)})},n.prototype._setParentCheckState=function(){var t=this._getOwner(),e,i=!0,n=!1,o=!1,r,s=this;if(!t.element.is(":"+s.options.treeClass)){for(e=t._getField("nodes"),r=0;r<e.length&&("indeterminate"===e[r]._checkState&&(o=!0),e[r].options.checked?n=!0:i=!1,i||!n);r++);o?(t._checkState="indeterminate",t._setChecked(!0)):n?(i?(t._checkState="checked",t._checkNode(!1)):t._checkState="indeterminate",t._setChecked(!0)):(t._checkState="unChecked",t._setChecked(!1),t._unCheckNode(!1)),t._setParentCheckState()}},n.prototype._onKeyDown=function(t){var e=i(t.target),n=this;e.closest(".wijmo-wijtree-inner",n.element).length>0&&n._keyAction(t)},n.prototype._onClick=function(t){var e=i(t.target),n=this;e.closest(".wijmo-checkbox",n.element).length>0?(n._checkClick(),t.preventDefault(),t.stopPropagation()):n.$hitArea&&n.$hitArea[0]===e[0]?(n._expandCollapseItem(),t.preventDefault(),t.stopPropagation()):e.closest(".wijmo-wijtree-inner",n.element).length>0&&n._click(t)},n.prototype._onMouseDown=function(t){var e=i(t.target),n=t.data;!n._tree.options.disabled&&n._tree.options.allowDrag&&e.closest(".wijmo-wijtree-node",n.element).length>0&&n._beginDrag(t)},n.prototype._onMouseOver=function(t){var e=i(t.target),n=this,o=i(t.relatedTarget);e.closest(".wijmo-wijtree-inner",n.element).length>0&&(this._tree._overNode!==n||o.is(":"+this.widgetFullName))&&(n._mouseOver(t),this._tree._overNode=n),n._mouseOverHitArea(t)},n.prototype._onMouseOut=function(t){var e=i(t.target),n=this,o=i(t.relatedTarget),r=this._getNodeWidget(o);e.closest(".wijmo-wijtree-inner",n.element).length>0&&(this._tree._overNode!==r||o.is(":"+this.widgetFullName)||o.is(".wijmo-wijtree-list")||o.is(".ui-effects-wrapper"))&&(n._mouseOut(t),r||(this._tree._overNode=null)),n._mouseOutHitArea(t)},n.prototype._onFocus=function(t){var e=i(t.target),n=this,o=n.options.wijCSS;e.closest(".wijmo-wijtree-inner",n.element).length>0&&!n._tree.options.disabled&&!n._isClosestDisabled()&&!e.hasAllClasses(o.iconArrowRightDown)&&!e.hasAllClasses(o.iconArrowRight)&&!e.closest(".wijmo-checkbox",n.element).length&&(n._tree._focusNode&&n._tree._focusNode.$navigateUrl.blur(),n._focused=!0,n._tree._focusNode=this,n.$inner.addClass(o.stateFocus),n._tree._trigger("nodeFocus",t,n))},n.prototype._onBlur=function(t){var e=i(t.target),n=t.data,o=n.options.wijCSS;!n._tree.options.disabled&&!n._isClosestDisabled()&&(n._focused=!1,e.closest(".wijmo-wijtree-inner",n.element).length>0&&n.$inner.removeClass(o.stateFocus),n._tree._trigger("nodeBlur",t,n))},n.prototype._click=function(t){var e=this,n=e.options,o=e._tree,r=e.$navigateUrl.attr("href");if(o.options.disabled||e._isClosestDisabled())e._setNavigateUrlHref("");else{if(!/^[#,\s]*$/.test(r)){if(!i.browser.msie||!/^7\.[\d]*/.test(i.browser.version))return;if(r.indexOf(window.location.href)<0)return}e._isClick=!0,o._ctrlKey=t.ctrlKey,n.selected&&o._ctrlKey?e._setSelected(!1):n.selected&&!e._tree._editMode&&o.options.allowEdit&&!e._isTemplate?e._editNode():e._setSelected(!n.selected),e._isTemplate||(t.preventDefault(),t.stopPropagation())}},n.prototype._selectNode=function(t,e){var n=this,o=n.options,r,s;!n._tree.options.disabled&&!n._isClosestDisabled()&&!n._tree._isDragging&&(r=n._tree._ctrlKey,r?(s=i.inArray(n,n._tree._selectedNodes),-1!==s&&!t&&(n._tree._selectedNodes.splice(s,1),n.$inner.removeClass(o.wijCSS.stateActive))):(i.each(n._tree._selectedNodes,function(t,e){e.$inner.removeClass(o.wijCSS.stateActive),e.options.selected=!1,e.$nodeBody.attr("aria-selected",!1)}),n._tree._selectedNodes=[]),t?(s=i.inArray(n,n._tree._selectedNodes),-1===s&&this._tree._selectedNodes.push(n),n.$inner.addClass(o.wijCSS.stateActive)):n.$inner.removeClass(o.wijCSS.stateActive),n._isClick&&n._tree._trigger("nodeClick",e,n),n._isClick=!1,n._tree._ctrlKey=!1,n._tree._trigger("selectedNodeChanged",e,n))},n.prototype._keyAction=function(e){var i=e.target,n=this,o=!1,r=t.getKeyCodeEnum();if(!n._tree.options.disabled&&!n._isClosestDisabled()&&i){if(n._tree._editMode&&e.keyCode!==r.ENTER)return;switch(e.keyCode){case r.UP:n._moveUp();break;case r.DOWN:n._moveDown();break;case r.RIGHT:n._tree.options.showExpandCollapse&&n._moveRight();break;case r.LEFT:n._tree.options.showExpandCollapse&&n._moveLeft();break;case 83:!n._tree._editMode&&n._tree.options.allowSorting&&n.sortNodes();break;case 113:n._tree.options.allowEdit&&n._editNode();break;case 109:n._tree.options.showExpandCollapse&&this._expanded&&n._setExpanded(!1);break;case 107:n._tree.options.showExpandCollapse&&!this._expanded&&n._setExpanded(!0);break;case r.ENTER:n._tree._editMode&&(e.data=n,n._editionComplete(e),n._setFocused(!0),o=!0,e.preventDefault());break;case r.SPACE:n._tree.options.showCheckBoxes&&(n._checkState=n.options.checked?"unChecked":"checked",n._setChecked(!n.options.checked))}n._customKeyDown(e.keyCode,o),!n._isTemplate&&e.keyCode!==r.ENTER&&(e.preventDefault(),e.stopPropagation())}},n.prototype._customKeyDown=function(t,e){},n.prototype._prevNode=function(t){var e=t.element;return e.prev().length>0?e.prev().data(e.data("widgetName")):void 0},n.prototype._nextNode=function(t){var e=t.element;return e.next().length>0?e.next().data(e.data("widgetName")):void 0},n.prototype._getNextExpandedNode=function(t){var e=t,i=t._getField("nodes"),n;return t._expanded&&i.length>0&&(n=i[i.length-1],null!==n&&(e=this._getNextExpandedNode(n))),e},n.prototype._getNextNode=function(t){var e=null,i=this;return t.element.is(":"+i.options.treeClass)?null:(e=i._nextNode(t),e?e:i._getNextNode(t._getOwner()))},n.prototype._moveUp=function(){var t=this._getCurrentLevel(),e=this._prevNode(this);e?this._getNextExpandedNode(e)._setFocused(!0):t>0&&this._getOwner()._setFocused(!0)},n.prototype._moveDown=function(){var t=this._getField("nodes"),e,i,n;this._expanded&&t.length>0?t[0]._setFocused(!0):(e=this._nextNode(this),e?e._setFocused(!0):(i=this._getOwner(),n=this._getNextNode(i),n&&n._setFocused(!0)))},n.prototype._moveLeft=function(){var t=this._getOwner();this._expanded?this._setExpanded(!1):null!==t&&!t.element.is(":"+this.options.treeClass)&&t._setFocused(!0)},n.prototype._moveRight=function(){if(this._hasChildren)if(this._expanded){var t=this._getField("nodes")[0];null!==t&&t._setFocused(!0)}else this._setExpanded(!0)},n.prototype._mouseOver=function(t){var e=this,i=e._tree;!i.options.disabled&&!e._isClosestDisabled()&&!i._editMode&&(e._mouseOverNode(),i._isDragging||i._trigger("nodeMouseOver",t,e))},n.prototype._mouseOut=function(t){var e=this,i=e._tree;!i.options.disabled&&!e._isClosestDisabled()&&!i._editMode&&(e._mouseOutNode(),i._isDragging||i._trigger("nodeMouseOut",t,e))},n.prototype._mouseOverNode=function(){null!==this.$inner&&!this._isOverNode&&(this.$inner.addClass(this.options.wijCSS.stateHover),this._isOverNode=!0)},n.prototype._mouseOutNode=function(){null!==this.$inner&&this._isOverNode&&(this.$inner.removeClass(this.options.wijCSS.stateHover),this._isOverNode=!1)},n.prototype._mouseOverHitArea=function(t){var e,i,n=this,o=n._tree;!o.options.disabled&&!n._isClosestDisabled()&&o.options.expandCollapseHoverUsed&&n._hasChildren&&!n._isOverHitArea&&(e=n._getBounds(n.element),i={x:t.pageX,y:t.pageY},n._isMouseInsideRect(i,e)&&(n._isOverHitArea=!0,n._setExpanded(!0)))},n.prototype._mouseOutHitArea=function(t){var e={x:t.pageX,y:t.pageY},i,n=this,o=n._tree;!o.options.disabled&&!n._isClosestDisabled()&&o.options.expandCollapseHoverUsed&&(n._hasChildren&&n._isOverHitArea?(i=n._getBounds(n.element),n._isMouseInsideRect(e,i)||(n._isOverHitArea=!1,n._setExpanded(!1))):n._getOwner().element.is(":"+n.widgetFullName)&&(i=n._getBounds(n._getOwner().element),n._isMouseInsideRect(e,i)||(n._getOwner()._isOverHitArea=!1,n._getOwner()._setExpanded(!1))))},n.prototype.destroy=function(){var t=this,e,n=t.options;t.element.data("uiDraggable")&&t.element.draggable("destroy"),t.$hitArea&&t.$hitArea.remove(),t.$checkBox&&t.$checkBox.remove(),t.$nodeImage&&t.$nodeImage.remove(),t.$navigateUrl.unwrap().unwrap().removeClass(n.wijCSS.stateDefault).removeClass(n.wijCSS.stateActive).unbind("mousedown").unbind("blur"),e=this.element.find("ul:first").show(),e.removeClass(),e.children("li").each(function(){var e=t._getNodeWidget(i(this));e.destroy()}),t.element.removeData("nodes").removeData("owner").removeData("widgetName").removeClass(),i.Widget.prototype.destroy.apply(this)},n.prototype.add=function(t,e){var n=null,o,r,s=this,a,l,h="<li><a href='{0}'>{1}</a></li>",d;if("string"==typeof t?(o=i(h.replace(/\{0\}/,"#").replace(/\{1\}/,t)),s._createNodeWidget(o),n=o.data(o.data("widgetName"))):t.jquery?(t.data("widgetName")||s._createNodeWidget(t),n=t.data(t.data("widgetName"))):t.nodeType?(o=i(t),s._createNodeWidget(o),n=o.data(o.data("widgetName"))):i.isPlainObject(t)&&(o=i(h.replace(/\{0\}/,t.url?t.url:"#").replace(/\{1\}/,t.text)),s._createNodeWidget(o,t),n=o.data(o.data("widgetName"))),null!==n){for(r=s._getField("nodes"),(!e||e>r.length)&&0!==e&&(e=r.length),i.mobile&&n.element.find("a").addClass("ui-link"),a=n._getField("nodes"),n._tree=s._tree,l=0;l<a.length;l++)a[l]._tree=s._tree;n._setField("owner",s),d=r.length,s.$nodes||(s.$nodes=i("<ul></ul>").addClass("wijmo-wijtree-list").addClass(s.options.wijCSS.helperReset).addClass("wijmo-wijtree-child"),s.element.append(s.$nodes)),d>0&&d!==e?n.element.get(0)!==r[e].element.get(0)&&n.element.insertBefore(r[e].element):s.$nodes.append(n.element),s._changeCollection(e,n),s._collectionChanged(),n._initNodeClass()}},n.prototype.remove=function(t){var e=-1,i,n=this,o=this._getField("nodes");t.jquery?e=t.index():"number"==typeof t&&(e=t),0>e||e>=o.length||(i=o[e],i.element.detach(),n._changeCollection(e),n._collectionChanged())},n.prototype.getNodes=function(){return this._getField("nodes")},n.prototype._changeCollection=function(t,e){var i=this._getField("nodes"),n=this.options.nodes;e?(i.splice(t,0,e),n.splice(t,0,e.options)):(i.splice(t,1),n.splice(t,1))},n.prototype.sortNodes=function(){var t=this._getField("nodes");this._sort(),i.each(t,function(t,e){e._index=t,e._insertBefore(t)}),this._refreshNodesClass()},n.prototype.check=function(t){this._setOption("checked",t)},n.prototype.select=function(t){this._setOption("selected",t)},n.prototype.getOwner=function(){var t=this._getOwner();return t&&t.element.is("li")?t:null},n.prototype.expand=function(){this._setOption("expanded",!0)},n.prototype.collapse=function(){this._setOption("expanded",!1)},n.prototype._insertBefore=function(t){var e=this.element.parent().children("li");this.element.index()!==t&&this.element.insertBefore(e.eq(t))},n.prototype._sort=function(){var t=this._getField("nodes");this._isSorted?this._isDecsSort?(t.sort(this._compare2NodeTextDesc),this._isDecsSort=!1):(t.sort(this._compare2NodeTextAcs),this._isDecsSort=!0):(t.sort(this._compare2NodeTextAcs),this._isSorted=!0,this._isDecsSort=!0)},n.prototype._compare2NodeTextAcs=function(t,e){return null!==t&&null!==e?t._text.localeCompare(e._text):void 0},n.prototype._compare2NodeTextDesc=function(t,e){return null!==t&&null!==e?-1*t._text.localeCompare(e._text):void 0},n.prototype._collectionChanged=function(){this._hasChildren=this._getChildren(),this._initNodeClass()},n.prototype._refreshNodesClass=function(){var t=this._getField("nodes"),e;for(e=0;e<t.length;e++)t[e]._initNodeClass()},n.prototype._setChecked=function(t){var e=this;(e.options.checked!==t||"indeterminate"===e._checkState)&&(e.options.checked=t,e.$nodeBody.attr("aria-checked",t),this._checkItem())},n.prototype._isClosestDisabled=function(){var t=this;return t.element.closest(".wijmo-wijtree-disabled,.wijmo-wijtreenode-disabled",t._tree.element).length?!0:!1},n.prototype._setExpanded=function(t){var e=this,i=e.options;e._expanded!==t&&(e._hasChildren||i.hasChildren)&&e._expandNode(t)},n.prototype._setFocused=function(t){t?(this.$navigateUrl.focus(),this._setFocusNode()):this.$navigateUrl.blur()},n.prototype._setFocusNode=function(){this._tree._focusNode&&i.browser.webkit&&this._tree._focusNode.$navigateUrl.blur(),this._focused=!0,this._tree._focusNode=this,this.$inner.addClass(this.options.wijCSS.stateFocus),this._tree._trigger("nodeFocus",null,this)},n.prototype._setToolTip=function(t){t.length?this.element.attr("title",t):this.element.removeAttr("title")},n.prototype._setText=function(t){this._text!==t&&t.length&&(this._text=t,this._changeText(t))},n.prototype._setSelected=function(t){var e=this,i=e.options;i.selected!==t&&(i.selected=t,e.$nodeBody.attr("aria-selected",t),e._selectNode(t),e._setFocused(t))},n.prototype._setCheckBoxes=function(t){var e=this;e.$checkBox?e.$checkBox[t?"show":"hide"]():t&&(e.$checkBox=i("<div>"),e.$checkBox.insertBefore(e.$navigateUrl),e.$checkBox.wijtreecheck()),e.$nodes&&e.$nodes.children("li").each(function(n,o){var r=e._getNodeWidget(i(o));null!==r&&r._setCheckBoxes(t)})},n.prototype._setHitArea=function(t){var e=this;e._hasChildren&&(t?(e._initNodeClass(),e.$hitArea&&e.$hitArea.show()):(e._expanded=!0,e.options.expanded=!0,e.$nodeBody.attr("aria-expanded",!0),e.$nodes&&e.$nodes.show(),e._initNodeClass(),e.$hitArea&&e.$hitArea.hide())),e.$nodes&&e.$nodes.children("li").each(function(n,o){var r=e._getNodeWidget(i(o));null!==r&&r._setHitArea(t)})},n.prototype._getOwner=function(){return this._getField("owner")},n.prototype._getTree=function(){var t=this._getOwner();return t?t.element.is(":"+this.options.treeClass)?t:t._getTree():null},n.prototype._getInitElement=function(){var t=i("<li>"),e=this,n=i("<ul>"),o=e._getField("nodes");return t.append(e.$navigateUrl.clone()),o.length&&(t.append(n),i.each(o,function(t,e){var i=e._getInitElement();n.append(i)})),t},n.prototype._getChildren=function(){return this.element.find(">ul:first>li").length>0&&this.element.children("ul:first")||!!this.options.nodes&&!!this.options.nodes.length},n.prototype._getNodeWidget=function(t){var e=this._getNodeByDom(t),i;return e.length>0?i=e.data(e.data("widgetName")):null},n.prototype._createNodeWidget=function(t,e){return i.fn.wijtreenode&&(t.data("owner",this),e&&i.isPlainObject(e)?(i.extend(e,{treeClass:this.options.treeClass}),t.wijtreenode(e)):t.wijtreenode({treeClass:this.options.treeClass})),t},n.prototype._getNodeByDom=function(t){return i(t).closest(":"+this.widgetFullName)},n.prototype._getCurrentLevel=function(){return this.element.parentsUntil(":"+this.options.treeClass).length-1},n.prototype._getField=function(t){return this.element.data(t)},n.prototype._setField=function(t,e){return this.element.data(t,e)},n}(t.wijmoWidget);e.wijtreenode=r;var s="",a="",l=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._initCSS=function(t){var e=t.wijCSS;s=e.icon+" "+e.iconCheck,a=e.icon+" "+e.iconStop},e.prototype._create=function(){var t=this,e=this.options,n=e.wijCSS;t._initCSS(e),t.element.is("div")&&(t.element.addClass("wijmo-checkbox").addClass(n.widget).attr("role","checkbox"),t.$icon=i("<span>"),t.$icon.addClass("wijmo-checkbox-icon"),"check"===e.checkState?t.$icon.addClass(s):"triState"===e.checkState&&t.$icon.addClass(a),t.$body=i("<div></div>").addClass(["wijmo-checkbox-box",n.widget,n.cornerAll,n.stateDefault].join(" ")).css({position:"relative"}).append(t.$icon),t.element.append(t.$body),t.element.bind("mouseover.wijtreecheck",function(){t.options.disabled||t.$body.addClass(n.stateHover)}).bind("mouseout.wijtreecheck",function(){t.options.disabled||t.$body.removeClass(n.stateHover).not(n.stateFocus).addClass(n.stateDefault)}))},e.prototype._setOption=function(t,e){var n=this,o=n.options.wijCSS;"checkState"===t&&("unCheck"===e?(n.$body.removeClass(o.stateActive),n.$icon.removeClass(s).removeClass(a).removeClass(o.stateActive)):"check"===e?(n.$body.addClass(o.stateActive),n.$icon.removeClass(a).addClass(s)):"triState"===e&&(n.$body.addClass(o.stateActive),n.$icon.removeClass(s).addClass(a))),i.Widget.prototype._setOption.apply(n,arguments)},e.prototype.destory=function(){this.element.children().remove(),this.element.removeClass("wijmo-checkbox").removeClass(this.options.wijCSS.widget),i.Widget.prototype.destroy.apply(this)},e}(t.wijmoWidget);e.wijtreecheck=l,l.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-b"},checkState:"unCheck"});var h=function(){function t(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-b"},this.treeClass="wijmo-wijtree",this.initSelector=":jqmData(role='wijtreenode')",this.accessKey="",this.checked=!1,this.collapsedIconClass="",this.expanded=!1,this.expandedIconClass="",this.itemIconClass="",this.navigateUrl="",this.selected=!1,this.text="",this.toolTip="",this.hasChildren=!1,this.params={},this.nodes=null}return t}(),d=function(){function t(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-c"},this.allowDrag=!1,this.allowDrop=!1,this.allowEdit=!1,this.allowSorting=!0,this.allowTriState=!0,this.autoCheckNodes=!0,this.autoCollapse=!1,this.disabled=!1,this.expandCollapseHoverUsed=!1,this.showCheckBoxes=!1,this.showExpandCollapse=!0,this.expandAnimation={effect:"blind",easing:"linear",duration:200},this.expandDelay=0,this.collapseAnimation={effect:"blind",easing:"linear",duration:200},this.collapseDelay=0,this.draggable=null,this.droppable=null,this.dropVisual=null,this.nodes=null,this.nodeBlur=null,this.nodeFocus=null,this.nodeClick=null,this.nodeCheckChanged=null,this.nodeCollapsed=null,this.nodeExpanded=null,this.nodeDragging=null,this.nodeDragStarted=null,this.nodeBeforeDropped=null,this.nodeDropped=null,this.nodeMouseOver=null,this.nodeMouseOut=null,this.nodeTextChanged=null,this.selectedNodeChanged=null,this.nodeExpanding=null,this.nodeCollapsing=null}return t}();r.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new h),o.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new d),i.wijmo.registerWidget("wijtree",o.prototype),i.wijmo.registerWidget("wijtreenode",r.prototype),i.wijmo.registerWidget("wijtreecheck",l.prototype)}(t.tree||(t.tree={}));var e=t.tree}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijupload",o="wijmo-wijupload",r="wijmo-wijupload-fileRow",s="."+r,a="wijmo-wijupload-filesList",l="wijmo-wijupload-commandRow",h="wijmo-wijupload-uploadAll",d="wijmo-wijupload-cancelAll",c="wijmo-wijupload-buttonContainer",u="wijmo-wijupload-upload",p="."+u,g="wijmo-wijupload-cancel",f="."+g,m="wijmo-wijupload-file",w="wijmo-wijupload-progress",y="wijmo-wijupload-loading",v,_,S=function(t){return t.indexOf("\\")>-1&&(t=t.substring(t.lastIndexOf("\\")+1)),t},x=function(t){var e=t.files,n="";return e?(i.each(e,function(t,e){n+=S(e.name)+"; "}),n.length&&(n=n.substring(0,n.lastIndexOf(";")))):n=S(t.value),n},b=function(t){var e=t.files,n=0;return e&&e.length>0&&i.each(e,function(t,e){e.size&&(n+=e.size)}),n};v=function(t,e,n){var o,r=i("input",e),s=function(t){t&&(t.abort(),t=null)},a=function(t){t&&(t=null)},l=function(){var t=this,o=r.get(0).files,l=[],h=0,d=0,c=function(e,n){var s=new XMLHttpRequest;return s.open("POST",n,!0),s.setRequestHeader("Wijmo-RequestType","XMLHttpRequest"),s.setRequestHeader("Cache-Control","no-cache"),s.setRequestHeader("Wijmo-FileName",e),s.setRequestHeader("Content-Type","application/octet-stream"),s.upload.onprogress=function(e){if(e.lengthComputable){var n;i.isFunction(t.onProgress)&&(n={supportProgress:!0,loaded:d+e.loaded,total:b(r[0]),fileName:S(t.currentFile.name),fileNameList:x(r[0]).split("; ")},t.onProgress(n))}},s.onreadystatechange=function(e){if(4===this.readyState){var n=this.responseText,r;d+=o[h].size,h++,o.length>h?u(o[h]):i.isFunction(t.onComplete)&&(r={e:e,response:n,supportProgress:!0},t.onComplete(r))}},l.push(s),s},u=function(e){var i=S(e.name),o=c(i,n);t.handleRequest(o,e),t.currentFile=e,o.send(e)};t.fileRow=e,t.inputFile=r,t.upload=function(){u(o[h])},t.cancel=function(){i.each(l,function(t,e){s(e)}),i.isFunction(t.onCancel)&&t.onCancel()},t.destroy=function(){i.each(l,function(t,e){a(e)})},t.updateAction=function(t){n=t},t.handleRequest=null,t.onCancel=null,t.onComplete=null,t.onProgress=null};return o=new l},_=function(t,e,n){var o,r=i("input",e),s=r.attr("id"),a="wijUploadForm_"+t,l=i("#"+a),h="wijUploadIfm_"+s,d=!0,c=i('<iframe id="'+h+'" name="'+h+'">'),u=function(t,e){l.empty(),l.attr("target",t.attr("name")),e&&(e.parent().append(e.clone()),l.append(e)),l.submit()},p=function(t){t.attr("src","javascript".concat(":false;"));
},g=function(t,e){e&&l&&(l.remove(),l=null),t&&(t.remove(),t=null)},f;return 0===l.length&&(l=i('<form method="post" enctype="multipart/form-data"></form>'),l.attr("action",n).attr("id",a).attr("name",a).appendTo("body")),c.css("position","absolute").css("top","-1000px").css("left","-1000px"),c.appendTo("body"),f=function(){var t=this;t.fileRow=e,t.iframe=c,t.inputFile=r,t.upload=function(){var e;u(c,r),i.isFunction(t.onProgress)&&(e={supportProgress:!1,loaded:1,total:1},t.onProgress(e))},t.doPost=function(){u(c)},t.cancel=function(){p(c),i.isFunction(t.onCancel)&&t.onCancel()},t.updateAction=function(t){n=t,l.attr("action",t)},t.destroy=function(t){g(c,t)},t.onCancel=null,t.onComplete=null,t.onProgress=null,c.bind("load",function(e){if(!i.browser.safari&&d&&!t.autoSubmit)return void(d=!1);if(c.attr("src")!=="javascript".concat(":false;")){var n=e.target,o,r,s;try{r=n.contentDocument?n.contentDocument:window.frames[0].document,o=r.XMLDocument?r.XMLDocument:r.body?r.body.innerHTML:r,i.isFunction(t.onComplete)&&(s={e:e,response:o,supportProgress:!1},t.onComplete(s))}catch(a){o=""}finally{}}})},o=new f};var C=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._swfAppendAddtionalData=function(t){t.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:""},t.widget=this},e.prototype._swfGetHandlers=function(){var t=this,e=t.element;return{onSelect:function(e){var i=this,n={};return t._trigger("change",null,e)===!1?!1:(t._createFileRow(e),this.queueData.queueSize+=e.size,this.queueData.files[e.id]=e,void 0)},onSelectError:function(t,e){e==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT?alert("File size exceeds the limitation!"):e==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED&&alert("Too many files!")},onDialogOpen:function(){this.queueData.filesReplaced=0,this.queueData.filesCancelled=0},onDialogClose:function(e,i,n){var o=this.settings;this.queueData.filesErrored=e-i,this.queueData.filesSelected=e,this.queueData.filesQueued=i-this.queueData.filesCancelled,this.queueData.queueLength=n,t.isStartUpload=!1,t.options.autoSubmit&&(t.uploadAll=!0,t._swfUploadFile()),o.onDialogClose&&o.onDialogClose.call(this,this.queueData)},onUploadStart:function(e){if(this.bytesLoaded=0,0==this.queueData.uploadQueue.length&&(this.queueData.uploadSize=e.size),!t.isStartUpload&&t.uploadAll){if(t._trigger("totalUpload",null,null)===!1)return this.cancelUpload(),!1;t.isStartUpload=!0}return t._trigger("upload",null,e)===!1?(this.cancelUpload(e.id),!1):void 0},onUploadProgress:function(n,o,r){var s=i("#"+n.id,e),a,l,h=Math.round(o/r*100),d=i("."+w,s),c={sender:n.name,loaded:o,total:r},u=this.queueData;d.html(h+"%"),t._trigger("progress",null,c),a=u.queueBytesUploaded+o,l=u.queueSize,t._updateSwfProgress(a,l),t._trigger("totalProgress",null,{loaded:a,total:l})},onUploadError:function(t,n,o){var r=this.settings,s=i("#"+t.id,e),a=i("."+w,s),l="Error";switch(n){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:l="HTTP Error ("+o+")";break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:l="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:l="IO Error";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:l="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+o+")."),l="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:l="Failed";break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:l="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:l="Cancelled",this.queueData.queueSize-=t.size,this.queueData.queueLength-=1,(t.status==SWFUpload.FILE_STATUS.IN_PROGRESS||i.inArray(t.id,this.queueData.uploadQueue)>=0)&&(this.queueData.uploadSize-=t.size),r.onCancel&&r.onCancel.call(this,t),delete this.queueData.files[t.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:l="Stopped"}a.text(l);var h=this.getStats();this.queueData.uploadsErrored=h.upload_errors},onUploadSuccess:function(n,o,r){var s=this.getStats();this.queueData.uploadsSuccessful=s.successful_uploads,this.queueData.queueBytesUploaded+=n.size,this.queueData.response=r;var a=i("#"+n.id,e),l=this;l.queueData.queueLength-=1,a.fadeOut(1500,function(){a.remove(),t.options.showUploadedFiles&&t._createUploadedFiles(n.name),l.queueData.queueLength||t.commandRow.hide()}),t._trigger("complete",null,{response:r})},onUploadComplete:function(e,i,n){var o=this;!o.queueData.queueLength&&t.uploadAll&&(t._cleanSwfProgress(),t._trigger("totalComplete",null,o.queueData)),t.uploadAll&&t._swfUploadFile()}}},e.prototype._cleanSwfProgress=function(){},e.prototype._updateSwfProgress=function(t,e){},e.prototype._initSwfUploadOptions=function(t,e){var n=this,o=n.element,r,s=n._swfGetHandlers(),a=n.options,l=n.options.swfUploadOptions,h=o.attr("id"),d=h+"_SWFUpload";return i("<input type='file' id='"+d+"'>").appendTo(o),r=i.extend({id:d,swf:"SWFUpload.swf",auto:!1,buttonClass:"",buttonCursor:"hand",buttonImage:null,checkExisting:!1,debug:!1,fileObjName:"Filedata",fileSizeLimit:a.maximumFileSize?a.maximumFileSize:0,fileTypeDesc:"All Files",fileTypeExts:a.accept?a.accept:"*.*",height:e,itemTemplate:!1,method:"post",multi:a.multiple,formData:{},preventCaching:!0,progressData:"percentage",queueID:!1,queueSizeLimit:a.maximumFiles?a.maximumFiles:999,removeCompleted:!0,removeTimeout:3,requeueErrors:!1,successTimeout:30,uploadLimit:0,width:t,uploader:a.action,overrideEvents:[]},l),{assume_success_timeout:r.successTimeout,button_placeholder_id:r.id,button_width:r.width,button_height:r.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:a.multiple?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_disabled:!1,button_cursor:"arrow"==r.buttonCursor?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:r.debug,requeue_on_error:r.requeueErrors,file_post_name:r.fileObjName,file_size_limit:r.fileSizeLimit,file_types:r.fileTypeExts,file_types_description:r.fileTypeDesc,file_queue_limit:r.queueSizeLimit,file_upload_limit:r.uploadLimit,flash_url:r.swf,prevent_swf_caching:r.preventCaching,post_params:r.formData,upload_url:r.uploader,use_query_string:"get"==r.method,file_dialog_complete_handler:s.onDialogClose,file_dialog_start_handler:s.onDialogOpen,file_queued_handler:s.onSelect,file_queue_error_handler:s.onSelectError,swfupload_loaded_handler:r.onSWFReady,upload_complete_handler:s.onUploadComplete,upload_error_handler:s.onUploadError,upload_progress_handler:s.onUploadProgress,upload_start_handler:s.onUploadStart,upload_success_handler:s.onUploadSuccess}},e.prototype._createSWFUpload=function(){var t=this,e=t.element,n=t.addBtn,o,r=t.options.swfUploadOptions,s,a=n.width(),l=n.height(),h=swfobject.getFlashPlayerVersion(),d=h.major>=9;d?(o=t._initSwfUploadOptions(a,l),s=new SWFUpload(o),t.swfupload=s,i("#"+s.movieName).css({position:"absolute","z-index":100,top:0,left:0,width:a,height:l}),t._swfAppendAddtionalData(s)):(alert("Please install flash player."),r&&r.onFallback&&r.onFallback.call())},e.prototype._create=function(){var t=this,e=t.options,n=(new Date).getTime(),o=t.supportXhr();window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t.filesLen=0,t.totalUploadFiles=0,t.useXhr=o,t.id=n,t._createContainers(),t._createUploadButton(),e.enableSWFUploadOnIE&&i.browser.msie||e.enableSWFUpload?t._createSWFUpload():t._createFileInput(),t._bindEvents(),e.disabled&&t.disable(),t.element.is(":hidden")&&t.element.wijAddVisibilityObserver&&t.element.wijAddVisibilityObserver(function(){t._applyInputPosition(),t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijupload")},e.prototype._setOption=function(t,e){var n=this;i.Widget.prototype._setOption.apply(this,arguments),"disabled"===t?n._handleDisabledOption(e,n.upload):"accept"===t&&n.input&&n.input.attr("accept",e)},e.prototype._handleDisabledOption=function(t,e){var i=this;t?(i.disabledDiv||(i.disabledDiv=i._createDisabledDiv(e)),i.disabledDiv.appendTo("body")):i.disabledDiv&&(i.disabledDiv.remove(),i.disabledDiv=null)},e.prototype._createDisabledDiv=function(t){var e=this,n,o=t?t:e.upload,r=o.offset(),s=o.outerWidth(),a=o.outerHeight();return n=i("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:s,height:a,left:r.left,top:r.top}),i.browser.msie&&(n.css("background-color","white"),parseInt(i.browser.version)>=9&&n.css("opacity","0.1")),n},e.prototype.destroy=function(){var t=this;t.upload.removeClass(o),t.upload.undelegate(t.widgetName).undelegate("."+t.widgetName),t.input.remove(),t.addBtn.remove(),t.filesList.remove(),t.commandRow.remove(),t.isCreateByInput===!0&&t.element.css({display:""}).unwrap(),t.uploaders&&(i.each(t.uploaders,function(t,e){e.destroy&&e.destroy(!0),e=null}),t.uploaders=null),t.disabledDiv&&(t.disabledDiv.remove(),t.disabledDiv=null)},e.prototype.widget=function(){return this.upload},e.prototype.supportXhr=function(){var t=!1;return t="undefined"==typeof(new XMLHttpRequest).upload?!1:!0},e.prototype._createContainers=function(){var t=this,e,n,r=t.element;if(r.is(":input")&&"file"===r.attr("type"))t.isCreateByInput=!0,t.maxDisplay=r.attr("multiple")||t.options.multiple?0:1,t.upload=r.css({display:"none"}).wrap("<div>").parent();else{if(!t.element.is("div"))throw'The initial markup must be "DIV", "INPUT[type=file]"';t.maxDisplay=t.options.multiple?0:1,t.upload=r}t.upload.addClass(o),e=i("<ul>").addClass(a).appendTo(t.upload),n=i("<div>").addClass(l).appendTo(t.upload),t.filesList=e,n.hide(),t.commandRow=n,t._createCommandRow(n)},e.prototype._createCommandRow=function(t){var e=this,n=e.options,o=i("<a>").attr("href","#").text("uploadAll").addClass(h).button({icons:{primary:n.wijCSS.iconCircleArrowN},label:e._getLocalization("uploadAll","Upload All")}).button("widget").addClass(n.wijCSS.stateDefault),r=i("<a>").attr("href","#").text("cancelAll").addClass(d).button({icons:{primary:n.wijCSS.iconCancel},label:e._getLocalization("cancelAll","Cancel All")}).button("widget").addClass(n.wijCSS.stateDefault);t.append(o).append(r)},e.prototype._getLocalization=function(t,e){var i=this.options.localization;return i&&i[t]||e},e.prototype._createUploadButton=function(){var t=this,e=t.options,n=i("<a>").attr("href","javascript:void(0);").button({label:t._getLocalization("uploadFiles","Upload files")}).button("widget").addClass(e.wijCSS.stateDefault);n.mousemove(function(e){var i=n.data("uiButton").options.disabled;if(t.input){var o=e.pageX,r=e.pageY;i||t.input.offset({left:o+10-t.input.width(),top:r+10-t.input.height()})}}),t.addBtn=n,t.upload.prepend(n)},e.prototype._applyInputPosition=function(){var t=this,e=t.addBtn,i=e.offset(),n=t.cuurentInput;n.offset({left:i.left+e.width()-n.width(),top:i.top}).height(e.height())},e.prototype._createFileInput=function(){var t=this,e=t.addBtn,n=e.offset(),o=t.element.attr("accept")||t.options.accept,r="wijUpload_"+t.id+"_input"+t.filesLen,s=i("<input>").attr("type","file").prependTo(t.upload),a=t.options.maximumFiles||t.maxDisplay;1!==a&&0===t.maxDisplay&&s.attr("multiple","multiple"),o&&s.attr("accept",o),t.cuurentInput=s,t.filesLen++,s.attr("id",r).attr("name",r).css("position","absolute").offset({left:n.left+e.width()-s.width(),top:n.top}).css("z-index","9999").css("opacity",0).height(e.height()).css("cursor","pointer"),t.input=s,s.bind("change",function(e){var n,o;return t._trigger("change",e,i(this))===!1?!1:(t._createFileInput(),n=t._createFileRow(i(this)),t._setAddBtnState(),t.options.autoSubmit&&(o=i(p,n),o&&o.click()),s.unbind("change"),void 0)}),t.uploadAll=!1},e.prototype._createUploadedFiles=function(t){},e.prototype._setAddBtnState=function(){var t=this,e=t.options.maximumFiles||t.maxDisplay,n=t.addBtn,o;e&&n&&(t.maskDiv||(t.maskDiv=i("<div></div>").css("position","absolute").css("z-index","9999").width(n.outerWidth()).height(n.outerHeight()).appendTo(t.upload).offset(n.offset())),o=i("li",t.filesList),o.length>=e?(n.button({disabled:!0}),t.maskDiv.show(),t.input&&t.input.css("left","-1000px")):(n.button({disabled:!1}),t.maskDiv.hide()))},e.prototype._createFileRow=function(t){var e=this,n=e.options,o=i("<li>"),a="",l,h,d,p=i("<span>").addClass(c),f=i("<a>").attr("href","#").text("upload").addClass(u).button({text:!1,icons:{primary:n.wijCSS.iconCircleArrowN},label:e._getLocalization("upload","upload")}).button("widget").addClass(n.wijCSS.stateDefault),y=i("<a>").attr("href","#").text("cancel").addClass(g).button({text:!1,icons:{primary:n.wijCSS.iconCancel},label:e._getLocalization("cancel","cancel")}).button("widget").addClass(n.wijCSS.stateDefault);return o.addClass(r).addClass(n.wijCSS.content).addClass(n.wijCSS.cornerAll),n.enableSWFUploadOnIE&&i.browser.msie||n.enableSWFUpload?(a=t.name,o.attr("id",t.id).data("file",t)):(o.append(t),t.hide(),a=x(t[0])),l=i("<span>"+a+"</span>").addClass(m).addClass(n.wijCSS.stateHighlight).addClass(n.wijCSS.cornerAll),o.append(l),o.append(p),h=i("<span />").addClass(w),p.append(h),p.append(f).append(y),o.appendTo(e.filesList),d=i(s,e.upload),d.length&&(e.commandRow.show(),(!n.enableSWFUploadOnIE||!i.browser.msie)&&!n.enableSWFUpload&&e._createUploader(o),e._resetProgressAll()),o},e.prototype._createUploader=function(t){var e=this,n=i("input",t),o=e.options.action,r=e.options.handleRequest,s;e.useXhr?(s=v(e.id,t,o),s.handleRequest=function(t,n){i.isFunction(r)&&r.call(e,t,n)}):s=_(e.id,t,o),s.onCancel=function(){var t=this;e._trigger("cancel",null,t.inputFile),0===e.totalUploadFiles&&e.uploadAll&&e._trigger("totalComplete")},e._wijUpload()&&(s.onProgress=function(t){var n=i("."+w,this.fileRow),o={sender:t.fileName,loaded:t.loaded,total:t.total,fileNameList:void 0},r=this.inputFile.attr("id");t.supportProgress?(n.html(Math.round(1e3*t.loaded/t.total)/10+"%"),t.fileNameList&&(o.fileNameList=t.fileNameList),e._trigger("progress",null,o),e._progressTotal(r,t.loaded)):n.addClass(y)},s.onComplete=function(t){var n=this,o=n.inputFile.attr("id"),r=e.uploaders[o],s=b(n.inputFile[0]),a=i("."+w,n.fileRow);e._trigger("complete",t.e,n.inputFile),a.removeClass(y),a.html("100%"),e._removeFileRow(n.fileRow,r,!0),e._progressTotal(o,s),e.totalUploadFiles--,0===e.totalUploadFiles&&(e.uploadAll||e.options.autoSubmit)&&e._trigger("totalComplete",t.e,t)}),"undefined"==typeof e.uploaders&&(e.uploaders={}),e.uploaders[n.attr("id")]=s},e.prototype._progressTotal=function(t,e){var i=this,n=i.progressAll,o,r;i.uploadAll&&(n&&n.loadedSize&&(n.loadedSize[t]=e,o=i._getLoadedSize(n.loadedSize),r=n.totalSize),i._trigger("totalProgress",null,{loaded:o,total:r}))},e.prototype._getLoadedSize=function(t){var e=0;return i.each(t,function(t,i){e+=i}),e},e.prototype._getTotalSize=function(){var t=this,e=0;return t.uploaders&&i.each(t.uploaders,function(t,i){e+=b(i.inputFile[0])}),e},e.prototype._resetProgressAll=function(){this.progressAll={totalSize:0,loadedSize:{}}},e.prototype._wijUpload=function(){return!0},e.prototype._wijcancel=function(t){},e.prototype._upload=function(t,e){},e.prototype._swfUploadFile=function(t){this.swfupload.startUpload(t)},e.prototype._bindEvents=function(){var t=this,e=t.options,n=t.progressAll;t.upload.delegate(f,"click."+t.widgetName,function(o){var r=i(this),a=r.parents(s),l,h;if(e.enableSWFUploadOnIE&&i.browser.msie||e.enableSWFUpload){var d=a.data("file");t.swfupload.cancelUpload(d.id),a.fadeOut(1500,function(){a.remove(),0==t.swfupload.queueData.queueLength&&t.commandRow.hide()})}else l=i("input",a[0]),h=t.uploaders[l.attr("id")],t._wijcancel(l),t._wijUpload()&&h&&h.cancel(),n&&(n.totalSize-=b(l[0]),n.loadedSize[l.val()]&&delete n.loadedSize[l.val()]),t._removeFileRow(a,h,!1)}),t.upload.delegate(p,"click."+t.widgetName,function(n){var o=i(this),r=o.parents(s),a,l;if(e.enableSWFUploadOnIE&&i.browser.msie||e.enableSWFUpload){var h=r.data("file");t.uploadAll=!1,t._wijUpload()?t._swfUploadFile(h.id):t._upload(h.id,!0)}else{if(a=i("input",r[0]),l=t.uploaders[a.attr("id")],t._trigger("upload",n,a)===!1)return!1;if(t.options.autoSubmit&&(l.autoSubmit=!0,t._trigger("totalUpload",n,null)===!1))return!1;t.totalUploadFiles++,t._upload(r),l&&t._wijUpload()&&l.upload()}n.preventDefault()}),t.upload.delegate("."+h,"click."+t.widgetName,function(n){if(e.enableSWFUploadOnIE&&i.browser.msie||e.enableSWFUpload)t.uploadAll=!0,t._wijUpload()?t._swfUploadFile():t._upload(!0,!0);else{if(t.uploadAll=!0,t.progressAll||t._resetProgressAll(),t._trigger("totalUpload",n,null)===!1)return!1;t.progressAll.totalSize=t._getTotalSize(),t._wijuploadAll(i(p,t.filesList[0])),t._wijUpload()&&i(p,t.filesList[0]).each(function(t,e){return i(e).click(),t})}}),t.upload.delegate("."+d,"click."+t.widgetName,function(n){e.enableSWFUploadOnIE&&i.browser.msie||e.enableSWFUpload?(i.each(t.swfupload.queueData.files,function(e,i){t.swfupload.cancelUpload(e)}),i(s,t.element).fadeOut(1500,function(){i(this).remove(),t.commandRow.hide()})):(t._resetProgressAll(),i(f,t.filesList[0]).each(function(t,e){i(e).click()}))})},e.prototype._wijuploadAll=function(t){},e.prototype._wijFileRowRemoved=function(t,e,i){this._setAddBtnState()},e.prototype._removeFileRow=function(t,e,n){var o=this,r,a;e&&(r=e.inputFile.attr("id")),t.fadeOut(1500,function(){t.remove(),o._wijFileRowRemoved(t,e.inputFile,n),o.uploaders[r]&&delete o.uploaders[r],a=i(s,o.upload),a.length?(o.commandRow.show(),e&&e.destroy&&e.destroy()):(o.commandRow.hide(),o.totalUploadFiles=0,o._resetProgressAll(),e&&e.destroy&&e.destroy(!0))})},e.prototype._getFileName=function(t){return S(t)},e.prototype._getFileNameByInput=function(t){return x(t)},e.prototype._getFileSize=function(t){return b(t)},e}(t.wijmoWidget);e.wijupload=C;var D=function(){function t(){this.wijCSS={iconCircleArrowN:"ui-icon-circle-arrow-n",iconCancel:"ui-icon-cancel"},this.action="",this.autoSubmit=!1,this.change=null,this.upload=null,this.totalUpload=null,this.progress=null,this.totalProgress=null,this.complete=null,this.totalComplete=null,this.maximumFiles=0,this.multiple=!0,this.accept="",this.enableSWFUploadOnIE=!1,this.enableSWFUpload=!1,this.swfUploadOptions={},this.localization={},this.handleRequest=null}return t}(),I="wijmo-wijupload",j=I+"-";C.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new D),i.wijmo.registerWidget("wijupload",C.prototype)}(t.upload||(t.upload={}));var e=t.upload}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){var t=this;this.element.is(":hidden")&&this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver(),t._pageLize(!0)},"wijwizard"),this._pageLize(!0)},e.prototype._init=function(){var t=this.options,e=t.disabled;t.disabledState?(this.disable(),t.disabled=e):t.autoPlay&&this.play()},e.prototype._setOption=function(e,i){switch(t.prototype._setOption.call(this,e,i),e){case"activeIndex":this.show(i);break;case"navButtons":case"backBtnText":case"nextBtnText":this._createButtons();break;case"autoPlay":i===!0?this.play():this.stop();default:this._pageLize(!1)}},e.prototype.destroy=function(){var t=this.options;return this.abort(),this.stop(),this._removeScroller(),this._removeButtons(),this.element.unbind(".wijwizard").removeClass(t.wijCSS.wijwizard).removeClass(t.wijCSS.widget).removeClass(t.wijCSS.helperClearFix).removeData("wijwizard"),this.list&&this.list.removeClass(t.wijCSS.widget).removeClass(t.wijCSS.helperReset).removeClass(t.wijCSS.wijwizardSteps).removeClass(t.wijCSS.helperClearFix).removeAttr("role"),this.lis&&(this.lis.removeClass(t.wijCSS.header).removeClass(t.wijCSS.cornerAll).removeClass(t.wijCSS.priorityPrimary).removeClass(t.wijCSS.prioritySecondary).removeAttr("role"),i.each(this.lis,function(){i.data(this,"destroy.wijwizard")?i(this).remove():i(this).removeAttr("aria-selected")})),i.each(this.panels,function(){var e=i(this).unbind(".wijwizard");i.each(["load","cache"],function(t,i){e.removeData(i+".wijwizard")}),i.data(this,"destroy.wijwizard")?e.remove():e.removeClass(t.wijCSS.stateDefault).removeClass(t.wijCSS.wijwizardActived).removeClass(t.wijCSS.stateActive).removeClass(t.wijCSS.stateHover).removeClass(t.wijCSS.stateFocus).removeClass(t.wijCSS.stateDisabled).removeClass(t.wijCSS.wijwizardPanel).removeClass(t.wijCSS.content).removeClass(t.wijCSS.wijwizardHide).css({position:"",left:"",top:""}).removeAttr("aria-hidden")}),this.container.replaceWith(this.container.contents()),t.cookie&&this._cookie(null,t.cookie),this},e.prototype._pageLize=function(t){var e=this.options,n=/^#.+/;this.list=this.element.children("ol,ul").eq(0),this.list&&0===this.list.length&&(this.list=this.element.find("."+e.wijCSS.wijwizardSteps).eq(0),this.list&&0===this.list.length&&(this.list=null)),this.list&&(this.lis=i("li",this.list)),t?(this.panels=i("> div",this.element),i.each(this.panels,function(t,e){var o=i(e).attr("src");o&&!n.test(o)&&i.data(e,"load.wijwizard",o.replace(/#.*$/,""))}),this.element.addClass(e.wijCSS.wijwizard).addClass(e.wijCSS.widget).addClass(e.wijCSS.helperClearFix),this.list&&(this.list.addClass(e.wijCSS.widget).addClass(e.wijCSS.helperReset).addClass(e.wijCSS.wijwizardSteps).addClass(e.wijCSS.helperClearFix).attr("role","tablist"),this.lis.addClass(e.wijCSS.header).addClass(e.wijCSS.cornerAll).attr("role","tab")),this.container=i("<div/>"),this.container.addClass(e.wijCSS.wijwizardContent).addClass(e.wijCSS.widget).addClass(e.wijCSS.content).addClass(e.wijCSS.cornerAll),this.container.append(this.panels),this.container.appendTo(this.element),this.panels.addClass(e.wijCSS.wijwizardPanel).addClass(e.wijCSS.content).attr("role","tabpanel"),void 0===e.activeIndex?("number"!=typeof e.activeIndex&&e.cookie&&(e.activeIndex=parseInt(this._cookie(void 0,void 0),10)),"number"!=typeof e.activeIndex&&this.panels.filter("."+e.wijCSS.wijwizardActived).length&&(e.activeIndex=this.panels.index(this.panels.filter("."+e.wijCSS.wijwizardActived))),e.activeIndex=e.activeIndex||(this.panels.length?0:-1)):null===e.activeIndex&&(e.activeIndex=-1),e.activeIndex=e.activeIndex>=0&&this.panels[e.activeIndex]||e.activeIndex<0?e.activeIndex:0,this.panels.addClass(e.wijCSS.wijwizardHide).attr("aria-hidden",!0),e.activeIndex>=0&&this.panels.length&&(this.panels.eq(e.activeIndex).removeClass(e.wijCSS.wijwizardHide).addClass(e.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.load(e.activeIndex)),this._createButtons(),this._addScrollForContent()):(this.panels=i("> div",this.container),e.activeIndex=this.panels.index(this.panels.filter("."+e.wijCSS.wijwizardActived))),this._refreshStep(),this._initScroller(),e.cookie&&this._cookie(e.activeIndex,e.cookie),e.cache===!1&&this.panels.removeData("cache.wijwizard"),(void 0===e.showOption||null===e.showOption)&&(e.showOption={}),this._normalizeBlindOption(e.showOption),(void 0===e.hideOption||null===e.hideOption)&&(e.hideOption={}),this._normalizeBlindOption(e.hideOption),this.panels.unbind(".wijwizard")},e.prototype._removeButtons=function(){this.buttons&&(this.buttons.remove(),this.buttons=void 0)},e.prototype._createButtons=function(){var t=this,e=this,n=this.options,o,r,s,a=n.backBtnText,l=n.nextBtnText;this._removeButtons(),"none"!==n.navButtons&&(this.buttons||(o=n.navButtons,"auto"===o&&(o=this.list?"common":"edge"),this.buttons=i("<div/>"),this.buttons.addClass(n.wijCSS.wijwizardButtons),r=function(t,e){n.disabled||e.is(":not(."+n.wijCSS.stateDisabled+")")&&e.addClass(t)},s=function(t,e){n.disabled||e.removeClass(t)},"common"===o?(this.backBtn=i("<a href='#'><span class='"+n.wijCSS.buttonText+"'>"+a+"</span></a>").addClass(n.wijCSS.widget).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerAll).addClass(n.wijCSS.button).addClass(n.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return t.back(),!1},mouseover:function(){r(n.wijCSS.stateHover,i(this))},mouseout:function(){s(n.wijCSS.stateHover,i(this))},mousedown:function(){r(n.wijCSS.stateActive,i(this))},mouseup:function(){s(n.wijCSS.stateActive,i(this))}}).attr("role","button"),this.nextBtn=i("<a href='#'><span class='"+n.wijCSS.buttonText+"'>"+l+"</span></a>").addClass(n.wijCSS.widget).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerAll).addClass(n.wijCSS.button).addClass(n.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return e.next(),!1},mouseover:function(){r(n.wijCSS.stateHover,i(this))},mouseout:function(){s(n.wijCSS.stateHover,i(this))},mousedown:function(){r(n.wijCSS.stateActive,i(this))},mouseup:function(){s(n.wijCSS.stateActive,i(this))}}).attr("role","button")):(this.backBtn=i("<a href='#'/>").addClass(n.wijCSS.wijwizardPrev).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerRight).append("<span class='"+n.wijCSS.icon+" "+n.wijCSS.iconArrowLeft+"'></span>").appendTo(this.buttons).bind({click:function(){return e.back(),!1},mouseover:function(){r(n.wijCSS.stateHover,i(this))},mouseout:function(){s(n.wijCSS.stateHover,i(this))},mousedown:function(){r(n.wijCSS.stateActive,i(this))},mouseup:function(){s(n.wijCSS.stateActive,i(this))}}).attr("role","button"),this.nextBtn=i("<a href='#'/>").addClass(n.wijCSS.wijwizardNext).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerLeft).append("<span class='"+n.wijCSS.icon+" "+n.wijCSS.iconArrowRight+"'></span>").appendTo(this.buttons).bind({click:function(){return e.next(),!1},mouseover:function(){r(n.wijCSS.stateHover,i(this))},mouseout:function(){s(n.wijCSS.stateHover,i(this))},mousedown:function(){r(n.wijCSS.stateActive,i(this))},mouseup:function(){s(n.wijCSS.stateActive,i(this))}}).attr("role","button")),this.buttons.appendTo(this.element)))},e.prototype._refreshStep=function(){var t=this.options;this.lis&&(this.lis.removeClass(t.wijCSS.priorityPrimary).addClass(t.wijCSS.prioritySecondary).attr("aria-selected",!1),t.activeIndex>=0&&t.activeIndex<=this.lis.length-1&&(this.lis&&this.lis.eq(t.activeIndex).removeClass(t.wijCSS.prioritySecondary).addClass(t.wijCSS.priorityPrimary).attr("aria-selected",!0),this.scrollWrap&&this.scrollWrap.wijsuperpanel("scrollChildIntoView",this.lis.eq(t.activeIndex)))),this.buttons&&!t.loop&&(this.backBtn[t.activeIndex<=0?"addClass":"removeClass"](t.wijCSS.stateDisabled).attr("aria-disabled",0===t.activeIndex),this.nextBtn[t.activeIndex>=this.panels.length-1?"addClass":"removeClass"](t.wijCSS.stateDisabled).attr("aria-disabled",t.activeIndex>=this.panels.length-1))},e.prototype._initScroller=function(){if(this.lis){var t=0;i.each(this.lis,function(){t+=i(this).outerWidth(!0)}),this.element.innerWidth()<t?(void 0===this.scrollWrap&&(this.list.wrap("<div class='scrollWrap'></div>"),this.scrollWrap=this.list.parent(),i.effects&&i.effects.save?i.effects.save(this.list,["width","height","overflow"]):i.save&&i.save(this.list,["width","height","overflow"])),this.list.width(t+8),this.scrollWrap.height(this.list.outerHeight(!0)),this.scrollWrap.wijsuperpanel({allowResize:!1,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollBarVisibility:"hidden"}})):this._removeScroller()}},e.prototype._removeScroller=function(){this.scrollWrap&&(this.scrollWrap.wijsuperpanel("destroy").replaceWith(this.scrollWrap.contents()),this.scrollWrap=void 0,i.effects&&i.effects.restore?i.effects.restore(this.list,["width","height","overflow"]):i.restore&&i.restore(this.list,["width","height","overflow"]))},e.prototype._cookie=function(t,e){var n=this.cookie||(this.cookie=this.options.cookie.name);return i.cookie.apply(null,[n].concat(i.makeArray(arguments)))},e.prototype._normalizeBlindOption=function(t){if(void 0===t.blind&&(t.blind=!1),void 0===t.fade&&(t.fade=!1),void 0===t.duration&&(t.duration=200),"string"==typeof t.duration)try{t.duration=parseInt(t.duration,10)}catch(e){t.duration=200}},e.prototype._ui=function(t){return{panel:t,index:this.panels.index(t)}},e.prototype._removeSpinner=function(){this.element.removeClass(this.options.wijCSS.tabsLoading);var t=this.element.data("spinner.wijwizard");t&&(this.element.removeData("spinner.wijwizard"),t.remove())},e.prototype._showPanel=function(t){var e=this,n=this.options,o=i(t),r;o.addClass(n.wijCSS.wijwizardActived),(n.showOption.blind||n.showOption.fade)&&n.showOption.duration>0?(r={duration:n.showOption.duration},n.showOption.blind&&(r.height="toggle"),n.showOption.fade&&(r.opacity="toggle"),o.hide().removeClass(n.wijCSS.wijwizardHide).animate(r,n.showOption.duration||"normal","linear",function(){e._resetStyle(o),o.wijTriggerVisibility&&o.wijTriggerVisibility(),e._trigger("show",null,e._ui(o[0])),e._removeSpinner(),o.attr("aria-hidden",!1),e._trigger("activeIndexChanged",null,e._ui(o[0]))})):(o.removeClass(n.wijCSS.wijwizardHide).attr("aria-hidden",!1),o.wijTriggerVisibility&&o.wijTriggerVisibility(),this._trigger("show",null,this._ui(o[0])),this._removeSpinner(),this._trigger("activeIndexChanged",null,this._ui(o[0])))},e.prototype._hidePanel=function(t){var e=this,n=this,o=this.options,r=i(t),s;r.removeClass(o.wijCSS.wijwizardActived),(o.hideOption.blind||o.hideOption.fade)&&o.hideOption.duration>0?(s={duration:o.hideOption.duration},o.hideOption.blind&&(s.height="toggle"),o.hideOption.fade&&(s.opacity="toggle"),r.animate(s,o.hideOption.duration||"normal","linear",function(){r.addClass(o.wijCSS.wijwizardHide).attr("aria-hidden",!0),e._resetStyle(r),e.element.dequeue("wijwizard")})):(r.addClass(o.wijCSS.wijwizardHide).attr("aria-hidden",!0),this.element.dequeue("wijwizard"))},e.prototype._resetStyle=function(t){t.css({display:""}),i.support.opacity||t[0].style.removeAttribute("filter")},e.prototype._addScrollForContent=function(){var t=this,e=t.element.height();t.buttons&&(e-=t.buttons.outerHeight(!0)),t.list&&(e-=t.list.outerHeight(!0)),e-=t.container.outerHeight(!0)-t.container.innerHeight()-(t.container.innerHeight()-t.container.height()),e<t.container.height()&&t.container.height(e),t.container.css("overflow","auto")},e.prototype.add=function(t,e,n){void 0===t&&(t=this.panels.length),void 0===e&&(e="Step "+t);var o=this,r=this.options,s=i(r.panelTemplate||o._defaults.panelTemplate).data("destroy.wijwizard",!0),a;return s.addClass(r.wijCSS.wijwizardPanel).addClass(r.wijCSS.content).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.wijwizardHide).attr("aria-hidden",!0),t>=this.panels.length?this.panels.length>0?s.insertAfter(this.panels[this.panels.length-1]):s.appendTo(this.container):s.insertBefore(this.panels[t]),this.list&&this.lis&&(a=i((r.stepHeaderTemplate||o._defaults.stepHeaderTemplate).replace(/#\{title\}/g,e).replace(/#\{desc\}/g,n)),a.addClass(r.wijCSS.header).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.prioritySecondary).data("destroy.wijwizard",!0),t>=this.lis.length?a.appendTo(this.list):a.insertBefore(this.lis[t])),this._pageLize(!1),1===this.panels.length&&(r.activeIndex=0,a.addClass(r.wijCSS.priorityPrimary),s.removeClass(r.wijCSS.wijwizardHide).addClass(r.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.element.queue("wijwizard",function(){o._trigger("show",null,o._ui(o.panels[0]))}),this._refreshStep(),this.load(0)),this._trigger("add",null,this._ui(this.panels[t])),this},e.prototype.remove=function(t){var e=this.options,i=this.panels.eq(t).remove();return this.lis.eq(t).remove(),t<e.activeIndex&&e.activeIndex--,this._pageLize(!1),i.hasClass(e.wijCSS.wijwizardActived)&&this.panels.length>=1&&this.show(t+(t<this.panels.length?0:-1)),this._trigger("remove",null,this._ui(i[0])),this},e.prototype.show=function(t){var e=this;if(0>t||t>=this.panels.length)return this;if(this.element.queue("wijwizard").length>0)return this;var n=this.options,o={nextIndex:0,nextPanel:null},r,s;if(i.extend(o,this._ui(this.panels[n.activeIndex])),o.nextIndex=t,
o.nextPanel=this.panels[t],this._trigger("validating",null,o)===!1)return this;if(r=this.panels.filter(":not(."+n.wijCSS.wijwizardHide+")"),s=this.panels.eq(t),n.activeIndex=t,this.abort(),n.cookie&&this._cookie(n.activeIndex,n.cookie),this._refreshStep(),!s.length)throw"jQuery UI wijwizard: Mismatching fragment identifier.";return r.length&&this.element.queue("wijwizard",function(){e._hidePanel(r)}),this.element.queue("wijwizard",function(){e._showPanel(s)}),this.load(t),this},e.prototype.next=function(){var t=this.options,e=t.activeIndex+1;return t.disabled?!1:(t.loop&&(e%=this.panels.length),e<this.panels.length?(this.show(e),!0):!1)},e.prototype.back=function(){var t=this.options,e=t.activeIndex-1;return t.disabled?!1:(t.loop&&(e=0>e?this.panels.length-1:e),e>=0?(this.show(e),!0):!1)},e.prototype.load=function(t){var e=this,n=e.options,o=e.panels.eq(t)[0],r=i.data(o,"load.wijwizard"),s;return e.abort(),!r||0!==e.element.queue("wijwizard").length&&i.data(o,"cache.wijwizard")?void e.element.dequeue("wijwizard"):(this.element.addClass(n.wijCSS.tabsLoading),n.spinner&&(s=this.element.data("spinner.wijwizard"),s||(s=i("<div/>"),s.addClass(n.wijCSS.wijwizardSpinner),s.html(n.spinner||e._defaults.spinner),s.appendTo(document.body),this.element.data("spinner.wijwizard",s),s.wijpopup({showEffect:"blind",hideEffect:"blind"})),s.wijpopup("show",{of:this.element,my:"center center",at:"center center"})),this.xhr=i.ajax(i.extend({},n.ajaxOptions,{url:r,dataType:"html",success:function(r,s){i(o).html(r),n.cache&&i.data(o,"cache.wijwizard",!0),e._trigger("load",null,e._ui(e.panels[t]));try{n.ajaxOptions&&n.ajaxOptions.success&&n.ajaxOptions.success(r,s)}catch(a){}},error:function(i,r,s){e._trigger("load",null,e._ui(e.panels[t]));try{n.ajaxOptions&&n.ajaxOptions.error&&n.ajaxOptions.error(i,r,t,o)}catch(a){}}})),e.element.dequeue("wijwizard"),e)},e.prototype.abort=function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("wijwizard",this.element.queue("wijwizard").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._removeSpinner(),this},e.prototype.url=function(t,e){return this.panels.eq(t).removeData("cache.wijwizard").data("load.wijwizard",e),this},e.prototype.count=function(){return this.panels.length},e.prototype.stop=function(){var t=this.element.data("intId.wijwizard");t&&(window.clearInterval(t),this.element.removeData("intId.wijwizard"))},e.prototype.play=function(){var t=this,e=this.options,i,n=this.panels.length;this.element.data("intId.wijwizard")||(i=window.setInterval(function(){var i=e.activeIndex+1;if(i>=n){if(!e.loop)return void t.stop();i=0}t.show(i)},e.delay),this.element.data("intId.wijwizard",i))},e}(t.wijmoWidget);e.wijwizard=n,n.prototype._defaults={stepHeaderTemplate:"<li><h1>#{title}</h1>#{desc}</li>",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>"};var o=function(){function t(){this.wijCSS={wijwizard:"wijmo-wijwizard",wijwizardButtons:"wijmo-wijwizard-buttons",wijwizardPrev:"wijmo-wijwizard-prev",wijwizardNext:"wijmo-wijwizard-next",wijwizardSteps:"wijmo-wijwizard-steps",wijwizardContent:"wijmo-wijwizard-content",wijwizardPanel:"wijmo-wijwizard-panel",wijwizardActived:"wijmo-wijwizard-actived",wijwizardHide:"wijmo-wijwizard-hide",wijwizardSpinner:"wijmo-wijwizard-spinner"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a"},this.navButtons="auto",this.autoPlay=!1,this.delay=3e3,this.loop=!1,this.hideOption={fade:!0},this.showOption={fade:!0,duration:400},this.ajaxOptions=null,this.cache=!1,this.cookie=null,this.stepHeaderTemplate="",this.panelTemplate="",this.spinner="",this.backBtnText="back",this.nextBtnText="next",this.add=null,this.remove=null,this.activeIndexChanged=null,this.show=null,this.load=null,this.validating=null}return t}();n.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new o),i.wijmo.registerWidget("wijwizard",n.prototype)}(t.wizard||(t.wizard={}));var e=t.wizard}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijribbon",o="wijmo-wijribbon",r=o+"-disabled",s=o+"-bigbutton",a=o+"-panel",l=o+"-groups",h=o+"-group",d=h+"-content",c=h+"-label",u=o+"-dropdown",p=o+"-dropdowngroup",g=o+"-abbrev",f=g+"group",m=o+"-text",w=o+"-icon",y=o+"-abbrevicon",v="ui-button",_="ui-state-active",S=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){var t=this;window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t._ribbonify(),i(window).bind("resize.wijribbon",function(){t.updateRibbonSize()}),t.element.is(":hidden")&&t.element.wijAddVisibilityObserver&&t.element.wijAddVisibilityObserver(function(){t.updateRibbonSize(),t.options.disabled&&t._setDisabled(!0),t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijribbon"),t.options.disabled&&t._setDisabled(!0)},e.prototype._setOption=function(t,e){i.wijmo.widget.prototype._setOption.apply(this,arguments),"disabled"===t&&this._setDisabled(e),i(".wijmo-wijribbon-startmenulink",this.element).unbind("click.tabs")},e.prototype._setDisabled=function(t){var e=this,n=e.element,o=n.offset(),s=o.top,a=o.left,l=i("body"),h=this.options.wijCSS,d=e.disabledModal;n.data("wijmoWijtabs")&&n.wijtabs("option","disabled",t),0!==n.closest(".wijmo-wijeditor").length&&(s=0,a=0,l=n.parent()),t?(d||(d=i("<div></div>").addClass(h.stateDisabled+" "+r).css({top:s,left:a,"background-color":"lightgray",position:"absolute"}).appendTo(l).bind("click mousedown mouseup mouseover mouseout focus keydown keypress",function(t){return t.stopPropagation(),t.preventDefault(),!1}),e.disabledModal=d),e.disabledModal.width(n.width()).height(n.outerHeight()).show()):e.disabledModal&&e.disabledModal.hide()},e.prototype._initCustomButtons=function(){var t=this,e;i.each(i("[customtype]",t.element),function(n,o){e=i(o).attr("customtype"),e&&t.options.custombuttons[e]&&t.options.custombuttons[e].create(i(o))})},e.prototype._ribbonify=function(){var t=this,e=this.options.wijCSS;t.buttons={},t.listUis={},t.accessbarBtns={},t._initCustomButtons(),t._createAccessToolBar(),t._getButtonSets(),t._createButtons(),t._createGroup(),t._createSplit(),t._createDropdwon(),t._createInputDropdown(),t._createGallery(),t._hideShowedList(),t._createTab(),i("."+e.helperReset+":not(."+l+", ."+e.tabsNav+", .wijmo-wijmenu-list)",t.element).hover(function(){i(this).addClass(e.stateHover)},function(){i(this).removeClass(e.stateHover)}),i("."+v,t.element).bind("mouseenter",function(){i("."+e.buttonText,this).addClass(e.stateHover)}).bind("mouseleave",function(){i("."+e.buttonText,this).removeClass(e.stateHover)}),i("button."+v,t.element).bind("mousedown",function(){t._addActiveClassToButtonText(this)}).bind("mouseup",function(){t._addActiveClassToButtonText(this)}),i("label."+v,t.element).bind("click",function(){i("span",this)&&1===i("span",this).length&&t._addActiveClassToLabelButtonText(this)})},e.prototype._addActiveClassToButtonText=function(t){var e=this.options.wijCSS;t&&(i(t).hasAllClasses(_)?i("."+e.buttonText,t).addClass(e.stateActive).addClass(e.stateDefault):i("."+e.buttonText,t).removeClass(e.stateActive).removeClass(e.stateDefault))},e.prototype._addActiveClassToLabelButtonText=function(t){var e=this,n,o,r;t&&(o=i(t).attr("for"),n=i("#"+o,e.element),n.is(":checkbox")?e._addActiveClassToButtonText(t):n.is(":radio")&&(r=e.element.find("[name='"+n.attr("name")+"']"),i.each(r,function(){e._updateGroupElementTextState(this)})))},e.prototype._updateGroupElementTextState=function(t){var e,n=this.options.wijCSS;t&&(e=i("[for='"+i(t).attr("id")+"']",i(t).parent()),e&&(e.hasAllClasses(_)?e.children("."+n.buttonText).addClass(n.stateActive).addClass(n.stateDefault):e.children("."+n.buttonText).removeClass(n.stateActive).removeClass(n.stateDefault)))},e.prototype._getButtonSets=function(){var t=this,e;t.groups=[],t.splits=[],t.dropdowns=[],t.inputDropdowns=[],i("span>button, span>:checkbox, span>:radio, div>button, div>:checkbox, div>:radio, div>:text",t.element).each(function(n,o){return i(o).parents("[customtype]")&&0!==i(o).parents("[customtype]").length?void 0:(e=i(o).parent(),0!==i(">ul",e).length||e.hasClass("wijmo-wijribbon-accesstoolbar")?2===i(">button",e).length?t.splits.push(e):1===i(">button",e).length?t.dropdowns.push(e):1===i(">input[type='text']",e).length&&t.inputDropdowns.push(e):t.groups.push(e),this)}),t.groups=t._unique(t.groups),t.splits=t._unique(t.splits)},e.prototype._unique=function(t){var e=i.makeArray(i.map(t,function(t){return t.get(0)}));return i.map(i.unique(e),function(t){return i(t)})},e.prototype._createButtons=function(){var t=this,e=t.element;i(":checkbox",e).each(function(){return i(this).parents("[customtype]")&&0!==i(this).parents("[customtype]").length?void 0:(t._createButton(i(this),"checkbox"),i(this).bind("change",function(){t._addActiveClassToLabelButtonText(i(this).button("widget")[0])}),this)}),i(":radio",e).each(function(){return i(this).parents("[customtype]")&&0!==i(this).parents("[customtype]").length?void 0:(t._createButton(i(this),"radio"),i(this).bind("change",function(){t._addActiveClassToLabelButtonText(i(this).button("widget")[0])}),this)}),i("button",e).each(function(){return i(this).parents("[customtype]")&&0!==i(this).parents("[customtype]").length?void 0:(t._createButton(i(this),"button"),this)})},e.prototype._createButton=function(t,e){var n=this,o=this.options.wijCSS,r=n._buildButtonOption(t,e),s=t.data("commandName"),a;t.button(r),r.text||("button"===e?t.children("."+o.buttonText).text(s):(a=i("[for='"+t.attr("id")+"']",t.parent()),a&&a.children("."+o.buttonText).text(s))),t.parent().is(".wijmo-wijribbon-accesstoolbar")&&"true"===t.attr("canlocateonaccesstoolbar")&&t.button("widget").hide(),n._triggerEvent(t)},e.prototype._createGroup=function(){i.each(this.groups,function(t,e){e.buttonset()})},e.prototype._createSplit=function(){var t=this,e=this.options.wijCSS;i.each(t.splits,function(n,r){var s=r.children("ul"),a=r.children("button:eq(0)"),l=a.data("commandName"),h=r.children("button:eq(1)"),d;s.children("li").addClass(e.cornerAll),r.addClass(o+"-"+l),h.button({icons:{primary:e.iconArrowDown},text:!1}).data("list",s).unbind("click").bind("click",function(t){t.stopPropagation(),t.preventDefault()}).bind("mouseup",function(e){s=i(this).data("list"),s.is(":visible")?(t.showList.hide().css("z-index",""),t.showList=null):(s.show().position({my:"left top",at:"left bottom",of:r}).css("z-index",9999),t.showList=s),e.stopPropagation(),e.preventDefault()}),h.children("."+e.buttonText).text("foo"),r.after(s),s.css("position","absolute").addClass(e.helperReset+" "+e.helperClearFix+" "+e.cornerAll+" "+u).hide(),r.buttonset(),d={ui:a,defaultValue:a.button("option","label"),buttons:[],type:"split",trigger:h,list:s},i("button, :checkbox, :radio",s).bind("click",function(e){s.hide().css("z-index",""),t.showList=null,e.preventDefault()}),s.find(">li>button,>li>:radio,>li>:checkbox").each(function(e,n){var o=i(n).data("commandName");""!==o&&t.buttons[o]&&(t.buttons[o].parent=a,t.buttons[o].type="split"),d.buttons.push(i(n))}),""!==l&&(t.listUis[l]=d)})},e.prototype._createDropdwon=function(){var t=this,e=this.options.wijCSS,n,r;t.dropdownLabels={},i.each(t.dropdowns,function(n,r){var s=r.children("ul"),a=r.children("button:eq(0)"),l=a.data("commandName"),h;s.children("li").addClass(e.cornerAll+" "+e.stateDefault),r.addClass(o+"-"+l),a.button({icons:{secondary:e.iconArrowDown}}).unbind("click").bind("click",function(t){t.stopPropagation(),t.preventDefault()}).bind("mouseup",function(e){t._showDropDownList(s,a),e.stopPropagation(),e.preventDefault()}).bind("keydown",function(e){s.is(":visible")&&t._dropdownListKeyHandler(e,s,a)}),h={ui:a,defaultValue:a.button("option","label"),buttons:[],type:"dropdown",list:s},i("button, :checkbox, :radio",s).bind("click",function(n){var o=i(this).data("commandName"),r,l=a.children("."+e.buttonText).width();t.dropdownLabels[o]||(t.dropdownLabels[o]=t._getDropdownLabelSubstr(i(this).button("option","label"),a.children("."+e.buttonText),l)),r=t.dropdownLabels[o],a.button("option","label",r),a.attr("title",i(this).button("option","label")),s.hide().css("z-index",""),t.showList=null,n.preventDefault()}),s.css("position","absolute").addClass(e.helperReset+" "+e.helperClearFix+" "+e.cornerAll+" "+u).hide(),r.buttonset(),t._collectDropDownButtons(s,a,h,l)})},e.prototype._createInputDropdown=function(){var t=this,e=this.options.wijCSS;t.dropdownLabels={},i.each(t.inputDropdowns,function(n,r){var s=r.children("ul"),a=r.children("input[type='text']:eq(0)"),l=t._createInputDropDownWrapper(a),h=a.prop("name"),d;r.prepend(l),s.children("li").addClass(e.cornerAll+" "+e.stateDefault),r.addClass(o+"-"+h),a.removeProp("name").data("commandName",h).addClass(e.stateDefault+" "+e.content+" "+e.cornerLeft),l.find("a").bind("mouseup",function(e){t._showDropDownList(s,a),a.focus(),e.stopPropagation(),e.preventDefault()}).bind("keydown",function(e){t._dropdownListKeyHandler(e,s,l)}),t._bindInputEvent(a,s),d={ui:a,defaultValue:a.val(),buttons:[],type:"dropdown",list:s},i("button, :checkbox, :radio",s).bind("click",function(e){var n=i(this).data("commandName"),o;t.dropdownLabels[n]||(t.dropdownLabels[n]=i(this).button("option","label")),o=t.dropdownLabels[n],a.val(i(this).button("option","label")).attr("title",i(this).button("option","label")),s.hide().css("z-index",""),t.showList=null,e.preventDefault(),e.stopPropagation()}),s.css("position","absolute").addClass(e.helperReset+" "+e.helperClearFix+" "+e.cornerAll+" "+u).hide(),t._collectDropDownButtons(s,a,d,h)})},e.prototype._collectDropDownButtons=function(t,e,n,o){var r=this;t.find(">li>button,>li>:radio,>li>:checkbox").each(function(t,o){var s=i(o).data("commandName");""!==s&&r.buttons[s]&&(r.buttons[s].parent=e,r.buttons[s].type="dropdown"),n.buttons.push(i(o))}),""!==o&&(r.listUis[o]=n)},e.prototype._showDropDownList=function(t,e){var i=this;t.is(":visible")&&!t.find("li."+i.options.wijCSS.stateActive)?(i.showList.hide().css("z-index",""),i.showList=null):(i.showList&&(i.showList.hide(),i.showList=null),t.show().position({my:"left top",at:"left bottom",of:e}).css("z-index",9999),i.showList=t,i.isShow=!0)},e.prototype._bindInputEvent=function(t,e){var i=this,n,o;t.bind("change",function(e){var n={name:void 0,commandName:void 0};n.name=t.prop("name"),n.commandName=t.val(),i._trigger("click",e,n)}).bind("keydown",function(n){i._dropdownListKeyHandler(n,e,t)})},e.prototype._dropdownListKeyHandler=function(t,e,i){var n=this,o=t.keyCode,r=n._getKeyCodeEnum();switch(o){case r.UP:n._activeDropDownListElement(!1,e,i),t.preventDefault();break;case r.DOWN:n._activeDropDownListElement(!0,e,i),t.preventDefault();break;case r.ENTER:e.find("label."+n.options.wijCSS.stateActive).parent("li").find("input").trigger("click"),t.preventDefault()}},e.prototype._activeDropDownListElement=function(t,e,n){var o=this,r=e.find("li").length,s,a;return e.is(":visible")?(a=e.find("label."+o.options.wijCSS.stateActive).parent("li"),a&&a.length>0&&(s=e.find("li").index(a)),o._changeListItemActiveState(a,!1),void 0===s?s=0:t?(s++,s==r&&(s=void 0)):(s--,-1==s&&(s=r-1)),o._changeListItemActiveState(i(e.find("li")[s]),!0),void 0):void o._showDropDownList(e,n)},e.prototype._changeListItemActiveState=function(t,e){var n=this.options.wijCSS;t&&(e?(i("label",t).addClass(n.stateActive),i("span",t).addClass(n.stateActive)):(i("label",t).removeClass(n.stateActive),i("span",t).removeClass(n.stateActive)))},e.prototype._createGallery=function(){var t=this,e=t.options.wijCSS;i(".wijmo-wijribbon-gallery",t.element).each(function(n,o){i(o).children("div").each(function(n,o){i(o).bind("mouseenter",function(t){i(o).hasAllClasses(e.stateDisabled)||i(o).addClass(e.stateHover)}).bind("mouseleave",function(t){i(o).hasAllClasses(e.stateDisabled)||i(o).removeClass(e.stateHover)}).bind("click",function(n){if(!i(o).hasAllClasses(e.stateDisabled)){i(o).parent("div.wijmo-wijribbon-gallery").children("div").removeClass(e.stateActive),i(o).addClass(e.stateActive);var r={name:void 0,commandName:void 0};r.name=i(o).parent("div.wijmo-wijribbon-gallery").attr("name"),r.commandName=i(o).attr("name"),t._trigger("click",n,r)}}),t.buttons[i(o).attr("name")]={button:i(o),type:"galleryBtn"}})})},e.prototype._getKeyCodeEnum=function(){if(i.ui&&i.ui.keyCode)return i.ui.keyCode;if(i.mobile&&i.mobile.keyCode)return i.mobile.keyCode;throw"keyCode object is not found"},e.prototype._createInputDropDownWrapper=function(t){var e=this.options.wijCSS,n=i("<span class='wijmo-wijribbon-inputdropdownwrapper'></span>").append(t);return i("<a></a>").appendTo(n).button({icons:{primary:e.iconArrowDown},text:!1}).removeClass(e.cornerAll).addClass("wijmo-wijribbon-inputdropdownbtn "+e.cornerRight),n},e.prototype._createTab=function(){var t=this,e=this.options.wijCSS,n=t.element;return n.addClass(o),t.tabEle=n,i(">ul",n).length>0?(n.wijtabs({select:function(e,i){t._hideAllMenus()}}),t._createRibbonGroups(),i(".wijmo-wijribbon-startmenu")&&i(".wijmo-wijribbon-startmenu").length>0&&(n.wijtabs("option","selected",1),t._createStartMenu()),!0):(n.addClass(o+"-simple").addClass(e.stateDefault).addClass(e.helperClearFix),!1)},e.prototype._createAccessToolBar=function(){var t=this,e,n=i("<div class='wijmo-wijribbon-accesstoolbar'></div>"),o;(0!==i("*[canlocateonaccesstoolbar='true']",t.element).length||0!==i("*[locateonaccesstoolbar='true']",t.element).length)&&(i("input[canlocateonaccesstoolbar='true'],input[locateonaccesstoolbar='true']",t.element).each(function(){e=i(this).attr("id")+"_accessbar";var n=i("label[for="+i(this).attr("id")+"]");t.accessbarBtns[n.attr("title")]={button:i(this).clone().attr("id",e),type:i(this).attr("type"),labelEle:n.clone().attr("for",e),selected:"true"===i(this).attr("locateonaccesstoolbar")?!0:!1}}),i("button[canlocateonaccesstoolbar='true'],button[locateonaccesstoolbar='true']",t.element).each(function(){e=i(this).attr("id")+"_accessbar",t.accessbarBtns[i(this).attr("title")]={button:i(this).clone(),type:"button",selected:"true"===i(this).attr("locateonaccesstoolbar")?!0:!1}}),i.each(t.accessbarBtns,function(t,e){n.append(e.button),e.labelEle&&n.append(e.labelEle)}),o=i('<button title="Customize Access Toolbar" class ="wijmo-wijribbon-accesstoolbarbtn '+t.options.wijCSS.iconArrowDown+'" name="quicktoolbar"></button>'),n.append(o),t.accessbarBtns&&t.element.prepend(n),t._createCustomQuickToolbarMenu(o,n))},e.prototype._createCustomQuickToolbarMenu=function(t,e){var n=this,o,r,s=n.options.wijCSS,a=i('<ul class="wijmo-wijribbon-accesstoolbarmenu"></ul>');i.each(n.accessbarBtns,function(t,e){r=e.selected?" wijmo-wijribbon-accesstoolbarmenuitemchecked":" wijmo-wijribbon-accesstoolbarmenuitemunchecked",o=i('<li><a class="'+s.cornerAll+'" tabindex="-1"><span class="'+s.icon+r+'"></span><span class="wijmo-wijmenu-text">'+t+"</span></a></li>"),o.data("accessbarcommand",t),a.append(o)}),a.prepend("<li class='wijmo-wijribbon-accesstoolbarmenutitleitem'><a>Customize Access Toolbar</a></li>"),e.append(a),a.wijmenu({trigger:t,triggerEvent:"click",orientation:"vertical",select:function(t,e){var o=e.item,r=o.element.data("accessbarcommand"),l=i("span."+s.icon,o.element),h=n.accessbarBtns[r].button,d=h.button("widget");l.hasClass("wijmo-wijribbon-accesstoolbarmenuitemchecked")?(l.removeClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").addClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),d.hide().removeAttr("canlocateonaccesstoolbar").attr("locateonaccesstoolbar","true")):(l.addClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").removeClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),d.show().removeAttr("locateonaccesstoolbar").attr("canlocateonaccesstoolbar","true")),a.wijmenu("deactivate",null)}}),a.wijmenu("setItemDisabled",i(".wijmo-wijribbon-accesstoolbarmenutitleitem"),!0)},e.prototype.updateRibbonSize=function(){var t=this,e,n=this.options.wijCSS,r;t.tabEle.children("div").not(".wijmo-wijmenu").each(function(s,a){var l=i(a),h=l.is(":visible"),d=l.find(">ul>li:not(.wijmo-wijmenu-item)"),c=[],u=l.width();return h||(l.removeClass(n.wijtabsHide),u=l.width()),d.each(function(n,s){var a=i(s),l=a.find(">div:last"),h=t._getGroupLabelText(l);return e=a.children("."+p),r=a.children("."+f),e&&(a.addClass(o+"-"+h.toLowerCase()).prepend(e.children()),e.remove(),r&&r.remove()),c.push({width:a.outerWidth(!0),text:h}),this}),t._adjustRibbonGroupIfNeeded(d,c,u),h||l.addClass(n.wijtabsHide),this}),t.options.disabled&&t._setDisabled(!0)},e.prototype._createRibbonGroups=function(){var t=this,e=this.options.wijCSS;t.tabEle.children("div").each(function(n,r){var s=i(r),u=s.is(":visible"),p=s.find(">ul:not(.wijmo-wijribbon-accesstoolbarmenu)>li"),g=[],f;return s.data("destroy.tabs")?void s.remove():(u||s.removeClass(e.wijtabsHide),f=s.width(),s.addClass(a),s.hasAllClasses(e.tabsPanel)||(s.addClass("wijmo-wijribbon-accesstoolbar"),t.tabEle.prepend(s)),s.find(">ul").addClass(e.helperReset+" "+e.helperClearFix+" "+e.content+" "+e.cornerAll+" "+l),p.each(function(n,r){var s=i(r),a=s.find(">div:last"),l=a.find("span"),u=e.stateDefault+" "+h,p=t._getGroupLabelText(a);return a&&(u+=" "+o+"-"+p.toLowerCase()),s.addClass(u),a.addClass(c).bind("click",function(){return!1}),s.wrapInner("<div class = '"+d+"'></div>"),s.children().bind("mouseover",function(){i(this).addClass(e.stateHover)}).bind("mouseout",function(){i(this).removeClass(e.stateHover)}),a.appendTo(s),g.push({width:s.outerWidth(!0),text:p}),this}),t._originalGroupInfo=g,t._adjustRibbonGroupIfNeeded(p,g,f),u||s.addClass(e.wijtabsHide),this)})},e.prototype._createStartMenu=function(){var t=this,e=i(".wijmo-wijribbon-startmenulink",t.element),n=t.options.wijCSS;e.unbind("click"),e.parent("li").addClass("wijmo-wijribbon-startmenulinkcontainer").hover(function(){i(this).removeClass("wijmo-wijribbon-startmenulinkcontainer")},function(){i(this).addClass("wijmo-wijribbon-startmenulinkcontainer")}),i(".wijmo-wijribbon-startmenuindicator",t.element).addClass(n.icon+" "+n.iconArrowDown),i(".wijmo-wijribbon-startmenu",t.element).wijmenu({trigger:i(".wijmo-wijribbon-startmenulink",t.element).parent(),triggerEvent:"click",orientation:"vertical",select:function(e,i){var n={name:void 0,commandName:void 0};n.commandName=i.item._link.attr("name"),t._trigger("click",e,n)},hidden:function(t,e){e.activeItem&&e.activeItem._link.removeClass(n.stateFocus)}})},e.prototype._getGroupLabelText=function(t){var e,n;return t&&(e=t.find("span"),n=t.attr("displayname")?t.attr("displayname"):e&&e.length>0&&!t.hasAllClasses(f)?i(e[0]).text():i.trim(t.text())),n},e.prototype._adjustRibbonGroupIfNeeded=function(t,e,n){for(var r=this,s=t.length-1,a=0,l=0,h=0,d,c,u;s>=0;s--){for(h=0,a=0;s>a;a++)h+=e[a].width;h+l+e[s].width<=n?(d=i(t[s]).children("."+p),c=i(t[s]).children("."+f),d&&(i(t[s]).addClass(o+"-"+e[s].text.toLowerCase()).prepend(d.children()),d.remove(),c&&c.remove())):(u=e[s],l+=r._createDropDownRibbonGroup(u.text,t[s]))}},e.prototype._createDropDownRibbonGroup=function(t,e){var n=this,r=o+"-"+t.toLowerCase(),s=this.options.wijCSS,a=i(e).removeClass(r),l=n._getGroupLabelText(a.find(">div:last"))||t,d;return a.wrapInner("<div class='"+p+" "+h+"'></div>").children().hide().addClass(r).bind("mouseup."+n.widget,function(t){null!==n.showDrpDwnGroup&&(n.showDrpDwnGroup.hide().css("z-index",""),n.showDrpDwnGroup=null)}),d=i("<div class='"+f+"'><span class='"+g+l.toLowerCase()+" "+w+" "+y+"'></span><span class='"+m+"'>"+l+"</span><span class='"+s.icon+" "+s.iconArrowDown+" "+w+"'></span></div>").appendTo(a).unbind(n.widget).bind("mouseover."+n.widget,function(t){i(this).addClass(s.stateHover)}).bind("mouseout."+n.widget,function(t){i(this).removeClass(s.stateHover)}).bind("click."+n.widget,function(t){var e=i(this).siblings("."+p);e.is(":visible")?(e.hide().css("z-index",""),n.showDrpDwnGroup=null):(n.showDrpDwnGroup&&n.showDrpDwnGroup.hide().css("z-index",""),e.show().position({my:"left top",at:"left bottom",of:this}).css("z-index","10000"),n.showDrpDwnGroup=e,t.stopPropagation())}),a.outerWidth(!0)},e.prototype._hideShowedList=function(){var t=this;i(document).bind("mouseup",function(e){var n=e.target;t.showList&&(i(n).is(document)||!i.contains(t.showList.get(0),n))&&(t.showList.hide().css("z-index",""),t.showList=null),t.showDrpDwnGroup&&(i(n).is(document)||!i.contains(t.showDrpDwnGroup.get(0),n))&&(t.showDrpDwnGroup.hide().css("z-index",""),t.showDrpDwnGroup=null)})},e.prototype._buildButtonOption=function(t,e){var n=!0,o=this,r=t.attr("class"),a,l,h,d,c,u,p;if(r&&""!==r&&r!==s)l=r.split(" ")[0],t.removeClass(l),c=i.trim(t.text()),""===c&&(n=!1);else{if("checkbox"===e||"radio"===e){if(""===i.trim(t.attr("id")))return;if(u=i("[for='"+t.attr("id")+"']",t.parent()),!u.is("label"))return;r=u.attr("class"),r&&""!==r&&r!==s?(l=r.split(" ")[0],u.removeClass(l),c=i.trim(u.text()),""===c&&(n=!1)):a=u.children("span,div")}else"button"===e&&(a=t.children("span,div"));a&&(1===a.length?""!==a.eq(0).attr("class")&&(h=a.eq(0),l=h.attr("class"),n=!1):2===a.length?a.eq(0).attr("class")&&(h=a.eq(0),l=h.attr("class"),h.is("span")?d="left":h.is("div")&&(d="top"),c=a.eq(1).text()):"button"===e&&""!==i.trim(t.text())&&(c=i.trim(t.text())))}return"button"===e?(t.empty(),p=i.trim(t.attr("name")),""!==p&&t.removeAttr("name")):(p=i.trim(u.attr("name")),""!==p&&u.removeAttr("name")),""!==p&&(t.data("commandName",p),o.buttons[p]||(o.buttons[p]={button:void 0,accessToolbarButton:void 0}),t.parent().is(".wijmo-wijribbon-accesstoolbar")?o.buttons[p].accessToolbarButton=t:o.buttons[p].button=t),{label:c,icons:{primary:l},position:d,text:n}},e.prototype._triggerEvent=function(t){var e=this,i,n,o=e.options.wijCSS;t.bind("click",function(o){if(e.options.disabled)return o.preventDefault(),void o.stopPropagation();e._hideAllMenus();var r=!0,s=t.data("commandName"),a=e.buttons[s],l={name:void 0,commandName:void 0};a&&a.parent&&(l.name=a.parent.data("commandName")),l.commandName=s,e._trigger("click",o,l),i=t.parent().is(".wijmo-wijribbon-accesstoolbar")?e.buttons[s].button:e.buttons[s].accessToolbarButton,i&&(n=i.button("widget"),i.is("button")||(n&&n.hasAllClasses(_)&&(r=!1),e._setBtnWidgetCheckedStyle(i,r))),t.is("button")&&(o.preventDefault(),o.stopPropagation())})},e.prototype._getDropdownLabelSubstr=function(t,e,n){var o=this,r=t.length,s=0,a=r,l=Math.floor((s+a)/2),h=i("<span></span>"),d=t.substr(0,l),c;for(h.appendTo(e.parent()),c=o._calculateWidth(d,h);c!==n&&a>s;)d=t.substr(0,l+1),c=o._calculateWidth(d,h),c>n?a=l-1:n>c&&(s=l+1),l=Math.floor((s+a)/2);return h.remove(),d},e.prototype._calculateWidth=function(t,e){return e.text(t),e.width()},e.prototype.hideDropdown=function(t){var e=this,i=e.listUis[t];i&&i.list&&i.list.hide()},e.prototype._hideAllMenus=function(){var t=this;i(".wijmo-wijmenu",t.tabEle).hide()},e.prototype.setTabPageVisible=function(t,e){var n=this,o=i("a[href=#"+t+"]",n.element).parent("li"),r=o.parent("ul"),s;o&&o.length>0&&(e?(o.show(),s=i("li",r).index(o)):(o.hide(),s=i("li",r).index(i('li:visible:not(".wijmo-wijribbon-startmenulinkcontainer")',r)))),n.element.wijtabs("option","selected",s)},e.prototype.destroy=function(){this.disabledModal&&this.disabledModal.remove(),i(window).unbind("resize.wijribbon"),i.Widget.prototype.destroy.call(this)},e.prototype.getDropdownList=function(t){var e=this,n=e.listUis[t],o={};return n&&i.each(n.buttons,function(t,e){o[e.data("commandName")]=e.button("option","label")}),o},e.prototype.setButtonDisabled=function(t,e){var n=this.buttons[t],o=this.options.wijCSS,r,s,a=!1,l,h,d;if(n&&n.disabled)return void n.disabled(e);if(n&&n.button&&"galleryBtn"===n.type&&n.button.addClass(o.stateDisabled),n&&n.button){if(l=n.button,h=n.accessToolbarButton,a=l.is("button"),"galleryBtn"===n.type)return void(e?l.addClass(o.stateDisabled):l.removeClass(o.stateDisabled));l.button("option","disabled",e),r=i("."+o.buttonText,l),r&&r.removeClass(o.stateHover),h&&(h.button("option","disabled",e),s=i("."+o.buttonText,h),s&&s.removeClass(o.stateHover)),a?"save"!==t&&(l.children("."+o.buttonText).text(t),h&&l.children("."+o.buttonText).text(t)):i("[for='"+l.attr("id")+"']",l.parent()).children("."+o.buttonText).text(t),d=this.listUis[t],d&&"split"===d.type&&(d.trigger.button("option","disabled",e),d.trigger.children("."+o.buttonText).text(t))}},e.prototype.setButtonsDisabled=function(t){var e=this;i.each(t,function(t,i){e.setButtonDisabled(t,i)})},e.prototype.setButtonsChecked=function(t){var e=this;i.each(t,function(t,n){i.isPlainObject(n)?e.setButtonChecked(t,n.checked,n.name):e.setButtonChecked(t,n,null)})},e.prototype.registerButtonInformation=function(t,e){return t&&e?this.buttons[t]=e:void 0},e.prototype.ribbonClick=function(t,e){this._trigger("click",t,e)},e.prototype._setBtnWidgetCheckedStyle=function(t,e){var i=this,t,n=i.options.wijCSS;t.is("button")?e?t.addClass(n.stateActive):t.removeClass(n.stateActive):t.is("input[type='text']")||(t.prop("checked",e),t.button("refresh")),i._addActiveClassToButtonText(t.button("widget"))},e.prototype.removeButtonHoverState=function(t){var e=this,n,o=this.options.wijCSS,r=e.buttons[t];r&&r.button&&(n=r.button,n.is("button")&&(n.removeClass(o.stateHover).removeClass(o.stateFocus),i("span",n).removeClass(o.stateHover)))},e.prototype.setButtonChecked=function(t,e,n){var o=this,r,s=o.buttons[t],a=this.options.wijCSS,l,h,d,c;if(s&&s.checked)return void s.checked(e);if(s&&s.button){if(l=s.button,h=s.accessToolbarButton,l.is("button"))e?(l.addClass(a.stateActive),h&&h.addClass(a.stateActive)):(l.removeClass(a.stateActive),h&&h.removeClass(a.stateActive));else{if("galleryBtn"===s.type){var u=l.parent("div");return i("div",u).removeClass(a.stateActive),void(e?l.addClass(a.stateActive):l.removeClass(a.stateActive))}l.is("input[type='text']")||(l.prop("checked",e),l.button("refresh"),h&&(h.prop("checked",e),h.button("refresh")))}s.parent?"dropdown"===s.type&&e&&(o.dropdownLabels[t]||(o.dropdownLabels[t]=o._getDropdownLabelSubstr(l.button("option","label"),s.parent.children("."+a.buttonText),s.parent.children("."+a.buttonText).width())),c=o.dropdownLabels[t],s.parent.is("input[type='text']")?(s.parent.val(c),s.parent.attr("title",c)):(s.parent.button("option","label",c),s.parent.attr("title",l.button("option","label"))),r=i(":radio",s.button.closest("ul")),r&&i.each(r,function(){o._updateGroupElementTextState(this)})):(o._addActiveClassToButtonText(l.button("widget")),h&&o._addActiveClassToButtonText(h.button("widget")))}else n&&(d=o.listUis[n],d&&(d.ui.is("input[type='text']")?d.ui.val(d.defaultValue):d.ui.button("option","label",d.defaultValue),d.buttons&&i.each(d.buttons,function(t,e){e.prop("checked",!1),e.button("refresh"),o._addActiveClassToButtonText(e.button("widget"))})))},e}(t.wijmoWidget);e.wijribbon=S;var x=function(){function t(){this.initSelector=":jqmData(role='wijribbon')",this.wijCSS={wijtabsHide:"wijmo-wijtabs-hide"},this.click=null,this.custombuttons=null}return t}();S.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new x),i.wijmo.registerWidget("wijribbon",S.prototype)}(t.ribbon||(t.ribbon={}));var e=t.ribbon}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijeditor",o=alert,r=window,s=document,a=parseInt,l,h,d,c=[],u=null,p=!0,g=!0,f=0,m=[],w=null,y=null,v="setButtonDisabled",_="setButtonsDisabled",S="setButtonChecked",x="setButtonsChecked",b="form",C="imagebutton",D="textarea",I="button",j="textbox",T="list",E="passwordfield",k="dropdownlist",L="hiddenfield",P="radio",M="checkbox",F="insertcol",A="insertrow",B="insertcell",R="splitcell",O="mergecell",G="deletecol",U="deleterow",N="deletecell",V="justifyleft",H="justifycenter",W="justifyright",z="justifyfull",K="borders",$="insertorderedlist",Y="insertunorderedlist",q="outdent",X="indent",J="backcolor",Q="fontcolor",Z="bold",tt="italic",et="strikethrough",it="underline",nt="subscript",ot="superscript",rt="template",st="removeformat",at="insertbreak",lt="insertparagraph",ht="insertprintpagebreak",dt="inserthorizontalrule",ct="tablebutton",ut="inserttable",pt="edittable",gt="wysiwyg",ft="split",mt="code",wt="wordwrap",yt="fullscreen",vt="undo",_t="redo",St="preview",xt="cleanup",bt="cut",Ct="copy",Dt="paste",It="selectall",jt="media",Tt="specialchar",Et="datetime",kt="find",Lt="inspect",Pt="save",Mt="spelling",Ft="imagebrowser",At="link",Bt="xx-small",Rt="x-small",Ot="small",Gt="medium",Ut="large",Nt="x-large",Vt="xx-large",Ht="fontname",Wt="fontsize",$t="blockquote",zt="insertcode",Kt="wijmo-wijribbon",Yt=Kt+"-bigbutton",qt=Kt+"-dropdownbutton",Xt=Kt+"-splitbutton",Jt=Kt+"-list",Qt=Kt+"-save",Zt=Kt+"-save16",te=Kt+"-undo",ee=Kt+"-redo",ie=Kt+"-preview",ne=Kt+"-cleanup",oe=Kt+"-cut",re=Kt+"-copy",se=Kt+"-paste",ae=Kt+"-selectall",le=Kt+"-bgcolor",he=Kt+"-color",de=Kt+"-bold",ce=Kt+"-italic",ue=Kt+"-underline",pe=Kt+"-strike",ge=Kt+"-sub",fe=Kt+"-sup",me=Kt+"-template",we=Kt+"-removeformat",ye=Kt+"-justifyleft",ve=Kt+"-justifycenter",_e=Kt+"-justifyright",Se=Kt+"-justifyfull",xe=Kt+"-borders",be=Kt+"-orderlist",Ce=Kt+"-unorderlist",De=Kt+"-outdent",Ie=Kt+"-indent",je=Kt+"-inspect",Te=Kt+"-find",Ee=Kt+"-table",ke=Kt+"-inserttable",Le=Kt+"-edittable",Pe=Kt+"-insertcol",Me=Kt+"-insertrow",Fe=Kt+"-insertcell",Ae=Kt+"-splitcell",Be=Kt+"-mergecell",Re=Kt+"-deletecol",Oe=Kt+"-deleterow",Ge=Kt+"-deletecell",Ue=Kt+"-insertbreak",Ne=Kt+"-insertparagraph",Ve=Kt+"-insertprintpagebreak",He=Kt+"-inserthr",We=Kt+"-form",$e=Kt+"-textarea",ze=Kt+"-textbox",Ke=Kt+"-password",Ye=Kt+"-hiddenfield",qe=Kt+"-imagebutton",Xe=Kt+"-button",Je=Kt+"-listbox",Qe=Kt+"-dropdownlist",Ze=Kt+"-radio",ti=Kt+"-checkbox",ei=Kt+"-link",ii=Kt+"-link16",ni=Kt+"-imagebrowser",oi=Kt+"-media",ri=Kt+"-specialchar",si=Kt+"-datetime",ai=Kt+"-blockquote",li=Kt+"-insertcode",hi=Kt+"-modes",di=Kt+"-designview",ci=Kt+"-sourceview",ui=Kt+"-splitview",pi=Kt+"-wordwrap",gi=Kt+"-fullscreen",fi="wijmo-wijeditor",mi=fi+"-container",wi=fi+"-header",yi=fi+"-content",vi=fi+"-footer",_i=fi+"-pathselector",Si=fi+"-fullscreen",xi=fi+"-dialog",bi=xi+"-hr",Ci=xi+"-buttons",Di=xi+"-button",Ii=xi+"-text",ji=fi+"-imagedlg",Ti=ji+"-content",Ei=ji+"-fields",ki=ji+"-imagefield",Li=ji+"-imagelist",Pi=ji+"-preview",Mi=ji+"-imagesrc",Fi=ji+"-imagealt",Ai=ji+"-imagewidth",Bi=ji+"-imageheight",Ri=ji+"-css",Oi=ji+"-hideimagelist",Gi=fi+"-templatedlg",Ui=Gi+"-toplabels",Ni=Gi+"-topleftlabel",Vi=Gi+"-toprightlabel",Hi=Gi+"-content",Wi=Gi+"-templatelist",$i=Gi+"-preview",zi=Gi+"-templateinfo",Ki=Gi+"-nameinfo",Yi=Gi+"-descriptioninfo",qi=Gi+"-fields",Xi=Gi+"-name",Ji=Gi+"-description",Qi=Gi+"-buttons",Zi=Gi+"-delete",tn=Gi+"-save",en=fi+"-linkdlg",nn=en+"-address",on=en+"-linktype",rn=en+"-anchor",sn=en+"-text",an=en+"-target",ln=en+"-css",hn=en+"-src",dn=en+"-width",cn=en+"-height",un=en+"-imagecontainer",pn=en+"-linkicontype",gn=fi+"-codedlg",fn=gn+"-source",mn=gn+"-sourcelabel",wn=fi+"-taginsdlg",yn=wn+"-caption",vn=wn+"-taglabel",_n=wn+"-tagtext",Sn=wn+"-filterempty",xn=wn+"-attribs",bn=wn+"-attriblist",Cn=wn+"-innerhtml",Dn=wn+"-css",In=fi+"-colordlg",jn=In+"-picker",Tn=In+"-color",En=fi+"-tabledlg",kn=En+"-rows",Ln=En+"-columns",Pn=En+"-width",Mn=En+"-height",Fn=En+"-border",An=En+"-cellpadding",Bn=En+"-cellspacing",Rn=En+"-csstext",On=En+"-bgcolor",Gn=fi+"-previewdlg",Un=Gn+"-caption",Nn=Gn+"-navigator",Vn=Gn+"-prev",Hn=Gn+"-next",Wn=Gn+"-printall",$n=Gn+"-printone",zn=Gn+"-ok",Kn=Gn+"-printdocument",Yn=Gn+"-previewiframe",qn=fi+"-cleanupdlg",Xn=qn+"-caption",Jn=qn+"-document",Qn=qn+"-actions",Zn=fi+"-finddlg",to=Zn+"-find",eo=Zn+"-replace",io=fi+"-mediadlg",no=io+"-type",oo=io+"-src",ro=io+"-width",so=io+"-height",ao=fi+"-specialchardlg",lo=ao+"-chars",ho=ao+"-preview",co=ao+"-content",uo=ao+"-list",po=ao+"_label",go=ao+"-punctuation",fo=ao+"-symbols",mo=ao+"-diacritics",wo="wijmo-formatspan",yo="."+Ci+" input:first",vo="."+Ci+" input:last",_o="."+Ci+" input[value='OK']",So="."+Ci+" input[engValue='Cancel']",xo=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],bo=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],Co=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],Do={
Form:{name:"form",tip:"Form",css:We},Image:{name:"imagebutton",tip:"Image Button",css:qe},TextArea:{name:"textarea",tip:"TextArea",css:$e},Button:{name:"button",tip:"Button",css:Xe},TextBox:{name:"textbox",tip:"TextBox",css:ze},List:{name:"list",tip:"ListBox",css:Je},PasswordField:{name:"passwordfield",tip:"Password Field",css:Ke},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Qe},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Ye},Radio:{name:"radio",tip:"RadioButton",css:Ze},CheckBox:{name:"checkbox",tip:"CheckBox",css:ti},InsertColumn:{name:"insertcol",tip:"Insert Column",css:Pe},InsertRow:{name:"insertrow",tip:"Insert Row",css:Me},InsertCell:{name:"insertcell",tip:"Insert Cell",css:Fe},SplitCell:{name:"splitcell",tip:"Split Cell",css:Ae},MergeCell:{name:"mergecell",tip:"Merge Cell",css:Be},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:Re},DeleteRow:{name:"deleterow",tip:"Delete Row",css:Oe},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:Ge},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:ye,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:ve,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:_e,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:Se,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:xe},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:be,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:Ce,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:De,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:Ie,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:le},ForeColor:{name:"fontcolor",tip:"Font Color",css:he},Bold:{name:"bold",tip:"Bold",css:de},Italic:{name:"italic",tip:"Italic",css:ce},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:pe},UnderLine:{name:"underline",tip:"Underline",css:ue},SubScript:{name:"subscript",tip:"Subscript",css:ge},SuperScript:{name:"superscript",tip:"Superscript",css:fe},Template:{name:"template",tip:"Template",css:me},RemoveFormat:{name:"removeformat",tip:"RemoveFormat",css:we},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:Ue},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Ne},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:Ve},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:He},Table:{name:"tablebutton",tip:"Table",css:Ee},InsertTable:{name:"inserttable",tip:"Insert Table",css:ke},EditTable:{name:"edittable",tip:"Edit Table",css:Le},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:di,grpname:"modes"},Split:{name:"split",tip:"Split View",css:ui,grpname:"modes"},Code:{name:"code",tip:"Source View",css:ci,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:pi},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:gi},Undo:{name:"undo",tip:"Undo",css:te},Redo:{name:"redo",tip:"Redo",css:ee},Preview:{name:"preview",tip:"Preview",css:ie},Cleanup:{name:"cleanup",tip:"Clean up",css:ne},Cut:{name:"cut",tip:"Cut",css:oe},Copy:{name:"copy",tip:"Copy",css:re},Paste:{name:"paste",tip:"Paste",css:se},SelectAll:{name:"selectall",tip:"Select All",css:ae},Media:{name:"media",tip:"Media",css:oi},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:ri},InsertDate:{name:"datetime",tip:"Insert Date Time",css:si},Find:{name:"find",tip:"Find And Replace",css:Te,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:je,text:"Inspect"},Save:{name:"save",tip:"Save",css:Qt,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:ni},Link:{name:"link",tip:"Link",css:ei,text:"Link"},FontName:{name:"fontname",tip:"Font Name",css:qt},FontSize:{name:"fontsize",tip:"Font Size",css:qt},BlockQuote:{name:"blockquote",tip:"Block Quote",css:ai},InsertCode:{name:"insertcode",tip:"Insert Code",css:li}},Io=function(){var t=this,e=[];t.append=function(t){e.push(t)},t.toString=function(){return e.join("")},t.dispose=function(){e=null}},jo=function(t){this.text=t,this.render=function(){return this.text}},To=function(t,e,n){var o=this,r={br:!0,img:!0,hr:!0,input:!0};o.tagName=t||"div",o.attributes=n||{},o.innerText=e||"",o.children=[],i.isPlainObject(e)&&(o.innerText="",o.attributes=e),o._isShortTag=!1,r[o.tagName]===!0&&(o._isShortTag=!0),o.render=function(){var t=new Io,e="";return t.append(o._renderBeginTag(o.tagName,o.attributes)),""!==o.innerText&&t.append(o.innerText),o.children.length>0&&i.each(o.children,function(e,i){t.append(i.render())}),t.append(o._renderEndTag(o.tagName)),e=t.toString(),t.dispose(),e},o.add=function(t){this.children.push(t)},o._renderBeginTag=function(t,e){var n=new Io,o="";return n.append("<"),n.append(t),i.each(e,function(t,e){n.append(" "),n.append(t),n.append("="),n.append('"'),n.append(e?e.toString():""),n.append('"')}),this._isShortTag?n.append(" "):n.append(">"),o=n.toString(),n.dispose(),o},o._renderEndTag=function(t){var e=new Io,i="";return this._isShortTag?e.append("/>"):(e.append("</"),e.append(t),e.append(">")),i=e.toString(),e.dispose(),i}},Eo=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.wijeditor=function(){this._curPageIdx=0,this.tRange=null,this.txtFoundInIE=!1,this.txtFoundInNoneIE=!1},e.prototype._create=function(){var t=this;window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t.element.is("input")||(t.id_prefix="wijeditor-"+t.element.attr("id")+"-",t.$ribbon=void 0,t.$modes=void 0,t._editorify(),t._initElements(),r.setTimeout(function(){t.options.disabled&&t._handleDisabledOption(!0,t.editor)},40),t._continueSavingInputTextForUndo=!1,t.element.is(":hidden")&&t.editor.wijAddVisibilityObserver&&t.editor.wijAddVisibilityObserver(function(e){i.contains(t.editor[0],e.target)||(t.refresh(),t.editor.wijRemoveVisibilityObserver&&t.editor.wijRemoveVisibilityObserver())},"wijeditor"))},e.prototype._contextMenuWidgetName=function(){return"wijmenu"},e.prototype._createBigButton=function(t,e,i,n){var o=this,r=o._createElement("button",{title:t,name:i,"class":Yt});return r.add(o._createDiv(e)),r.add(o._createSpan("",n)),r},e.prototype._createTextButton=function(t,e,i){return this._createElement("button",i,{title:t,name:e})},e.prototype._createButton=function(t,e,i,n){var o=this,r;return n?(r=o._createElement("button",{title:t,name:i}),r.add(o._createSpan(e)),r.add(o._createSpan("",n)),r):o._createElement("button",{title:t,name:i,"class":e})},e.prototype._createTextRadioButton=function(t,e,i,n,o){var r=this,s=[];return s.push(r._createElement("input",{id:e+i,type:"radio",name:n})),s.push(r._createElement("label",o,{"for":e+i,title:t,name:i})),s},e.prototype._createImageRadioButton=function(t,e,i,n,o){var r=this,s=[];return s.push(r._createElement("input",{id:e+n,type:"radio",name:o})),s.push(r._createElement("label",{"for":e+n,title:t,name:n,"class":i})),s},e.prototype._createImageCheckButton=function(t,e,i,n){var o=this,r=[];return r.push(o._createElement("input",{id:e+n,type:"checkbox"})),r.push(o._createElement("label",{"for":e+n,title:t,name:n,"class":i})),r},e.prototype._createRibbonList=function(){return this._createSpan(Jt)},e.prototype._createDropdownButton=function(t,e,n,o,r){var s=this,a=s._createElement("div",{title:t,"class":qt}),l=s._createElement("ul");return a.add(s._createTextButton(t,e,n)),a.add(l),i.each(o,function(t,n){var o=s._createElement("li"),a=s._createTextRadioButton(n.tip,r,n.name,e,n.text);i.each(a,function(t,e){o.add(e)}),l.add(o)}),a},e.prototype._createSplitButton=function(t,e,n,o,r){var s=this,a=s._createElement("div",{title:t,"class":Xt}),l=s._createElement("ul");return a.add(s._createBigButton(t,e,n,o)),a.add(s._createElement("button",{"class":Yt})),a.add(l),i.each(r,function(t,e){var i=s._createElement("li");i.add(s._createButton(e.tip,e.css,e.name,e.text)),l.add(i)}),a},e.prototype._createButtonByCommand=function(t){var e=this,i,n=Do[t],o;if(n){switch(o=n.name){case $t:case b:case C:case D:case I:case j:case T:case E:case k:case L:case P:case M:case F:case A:case B:case R:case O:case G:case U:case N:case st:case at:case lt:case ht:case yt:case vt:case _t:case bt:case Ct:case Dt:case Et:case wt:case J:case Q:case St:case xt:case jt:case Tt:case rt:case Ft:case zt:case dt:case It:i=e._createButton(n.tip,n.css,o);break;case kt:case Lt:i=e._createButton(n.tip,n.css,o,n.text);break;case K:case nt:case ot:case Z:case tt:case it:case et:i=e._createImageCheckButton(n.tip,e.id_prefix,n.css,o);break;case gt:case ft:case mt:case V:case H:case W:case z:case q:case X:case $:case Y:i=e._createImageRadioButton(n.tip,e.id_prefix,n.css,o,n.grpname);break;case ct:i=e._createSplitButton("Table",Ee,ct,"Table",[{tip:"Insert Table",css:ke,name:ut,text:"Insert"},{tip:"Edit Table",css:Le,name:pt,text:"Edit"}]);break;case Pt:i="ribbon"===e.options.mode?e._createBigButton(n.tip,n.css,o,n.text):e._createButton(n.tip,Zt,o);break;case At:i="ribbon"===e.options.mode?e._createBigButton(n.tip,n.css,o,n.text):e._createButton(n.tip,ii,o);break;case Ht:i=e._createDropdownButton("Font Name",Ht,"Font Name",[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],e.id_prefix);break;case Wt:i=e._createDropdownButton("Font Size",Wt,"Font Size",[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],e.id_prefix);break;case Mt:}return i}},e.prototype._createActionGroup=function(){var t=this,e=t._createElement("li"),i=t._createRibbonList();return e.add(t._createButtonByCommand("Save")),e.add(i),i.add(t._createButtonByCommand("Undo")),i.add(t._createButtonByCommand("Redo")),i=t._createRibbonList(),e.add(i),i.add(t._createButtonByCommand("Preview")),i.add(t._createButtonByCommand("Cleanup")),i=t._createRibbonList(),e.add(i),i.add(t._createButtonByCommand("Cut")),i.add(t._createButtonByCommand("Copy")),i.add(t._createButtonByCommand("Paste")),i.add(t._createButtonByCommand("SelectAll")),e.add(t._createElement("div","Actions")),e},e.prototype._createFontGroup=function(){var t=this,e=t._createElement("li"),n=t._createRibbonList();return e.add(t._createButtonByCommand("FontName")),e.add(t._createButtonByCommand("FontSize")),e.add(n),n.add(t._createButtonByCommand("BackColor")),n.add(t._createButtonByCommand("ForeColor")),n=t._createRibbonList(),e.add(n),i.each(t._createButtonByCommand("Bold"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("Italic"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("UnderLine"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("StrikeThrough"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("SubScript"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("SuperScript"),function(t,e){n.add(e)}),n=t._createRibbonList(),e.add(n),n.add(t._createButtonByCommand("Template")),n=t._createRibbonList(),e.add(n),n.add(t._createButtonByCommand("RemoveFormat")),e.add(t._createElement("div","Font")),e},e.prototype._createParaGroup=function(){var t=this,e=t._createElement("li"),n=t._createRibbonList();return e.add(n),i.each(t._createButtonByCommand("JustifyLeft"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("JustifyCenter"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("JustifyRight"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("JustifyFull"),function(t,e){n.add(e)}),n=t._createRibbonList(),e.add(n),i.each(t._createButtonByCommand("Border"),function(t,e){n.add(e)}),n=t._createRibbonList(),e.add(n),i.each(t._createButtonByCommand("NumberedList"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("BulletedList"),function(t,e){n.add(e)}),n=t._createRibbonList(),e.add(n),i.each(t._createButtonByCommand("Outdent"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("Indent"),function(t,e){n.add(e)}),e.add(t._createElement("div","Paragraph")),e},e.prototype._createReviewGroup=function(){var t=this,e=t._createElement("li");return e.add(t._createButtonByCommand("Inspect")),e.add(t._createButtonByCommand("Find")),e.add(t._createElement("div","Review")),e},e.prototype._createTablesGroup=function(){var t=this,e=t._createElement("li"),i=t._createRibbonList();return e.add(t._createButtonByCommand("Table")),e.add(i),i.add(t._createButtonByCommand("InsertColumn")),i.add(t._createButtonByCommand("InsertRow")),i.add(t._createButtonByCommand("InsertCell")),i=t._createRibbonList(),e.add(i),i.add(t._createButtonByCommand("SplitCell")),i.add(t._createButtonByCommand("MergeCell")),i=t._createRibbonList(),e.add(i),i.add(t._createButtonByCommand("DeleteColumn")),i.add(t._createButtonByCommand("DeleteRow")),i.add(t._createButtonByCommand("DeleteCell")),e.add(t._createElement("div","Tables")),e},e.prototype._createBreaksGroup=function(){var t=this,e=t._createElement("li");return e.add(t._createButtonByCommand("InsertBreak")),e.add(t._createButtonByCommand("InsertParagraph")),e.add(t._createButtonByCommand("InsertPrint")),e.add(t._createButtonByCommand("InsertHR")),e.add(t._createElement("div","Breaks")),e},e.prototype._createFormsGroup=function(){var t=this,e=t._createElement("li"),i=t._createRibbonList();return e.add(i),i.add(t._createButtonByCommand("Form")),i=t._createRibbonList(),e.add(i),i.add(t._createButtonByCommand("TextArea")),i.add(t._createButtonByCommand("TextBox")),i.add(t._createButtonByCommand("PasswordField")),i.add(t._createButtonByCommand("HiddenField")),i=t._createRibbonList(),e.add(i),i.add(t._createButtonByCommand("Image")),i.add(t._createButtonByCommand("Button")),i=t._createRibbonList(),e.add(i),i.add(t._createButtonByCommand("List")),i.add(t._createButtonByCommand("DropDownList")),i.add(t._createButtonByCommand("Radio")),i.add(t._createButtonByCommand("CheckBox")),e.add(t._createElement("div","Forms")),e},e.prototype._createSpecialGroup=function(){var t=this,e=t._createElement("li");return e.add(t._createButtonByCommand("Link")),e.add(t._createButtonByCommand("InsertImage")),e.add(t._createButtonByCommand("Media")),e.add(t._createButtonByCommand("InsertSpecialChar")),e.add(t._createButtonByCommand("InsertDate")),e.add(t._createElement("div","Special")),e},e.prototype._getDefaultRibbonMarkup=function(){var t=this,e=t._createElement("div"),i=t._createElement("ul"),n=t._createElement("li"),o=t._createElement("li"),r=t._createElement("div",{id:t.id_prefix+"format"}),s=t._createElement("div",{id:t.id_prefix+"insert"}),a=t._createElement("ul"),l=t._createElement("ul");return e.add(i),e.add(r),e.add(s),i.add(n),i.add(o),n.add(t._createElement("a","Format",{href:"#"+t.id_prefix+"format"})),o.add(t._createElement("a","Insert",{href:"#"+t.id_prefix+"insert"})),r.add(a),a.add(t._createActionGroup()),a.add(t._createFontGroup()),a.add(t._createParaGroup()),a.add(t._createReviewGroup()),s.add(l),l.add(t._createTablesGroup()),l.add(t._createBreaksGroup()),l.add(t._createFormsGroup()),l.add(t._createSpecialGroup()),e.render()},e.prototype._getRibbonModesMarkup=function(){var t=this,e=t._createDiv(hi),n=t._createRibbonList(),o=t.element.find(".wijeditor-footer"),r,s,a,l,h;return o.length>0&&(r=i(o.find("."+di)),r.length>0&&(Do.Wysiwyg.tip=r.attr("title")||Do.Wysiwyg.tip),s=i(o.find("."+ui)),s.length>0&&(Do.Split.tip=s.attr("title")||Do.Split.tip),a=i(o.find("."+ci)),a.length>0&&(Do.Code.tip=a.attr("title")||Do.Code.tip),l=i(o.find("."+pi)),r.length>0&&(Do.Wordwrap.tip=l.attr("title")||Do.Wordwrap.tip),h=i(o.find("."+gi)),r.length>0&&(Do.FullScreen.tip=h.attr("title")||Do.FullScreen.tip),o.remove()),e.add(n),i.each(t._createButtonByCommand("Wysiwyg"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("Code"),function(t,e){n.add(e)}),i.each(t._createButtonByCommand("Split"),function(t,e){n.add(e)}),e.add(t._createButtonByCommand("Wordwrap")),e.add(t._createButtonByCommand("FullScreen")),e.render()},e.prototype._getSimpleToolBar=function(t){var e=this,n,o=e._createDiv("");return i.each(t,function(t,r){n=e._createButtonByCommand(r),n&&(-1!==i.inArray(r,xo)?i.each(n,function(t,e){o.add(e)}):o.add(n))}),o.render()},e.prototype._editorify=function(){var t=this,e=t.element,n=e.width(),o=e.height(),r=t.options,s=r.mode,a,l,h,d,c,u,p;t._oriStyle=e.attr("style"),t._oriContent=e.html(),t._oriEleWidth=n,t._oriEleHeight=o,e.is("textarea")?("ribbon"===s?t.$ribbon=i(t._getDefaultRibbonMarkup()):"bbcode"===s?t.$ribbon=i(t._getSimpleToolBar(Co)):r.simpleModeCommands&&0!==r.simpleModeCommands.length?(h=i.grep(r.simpleModeCommands,function(t,e){return"Table"!==t},void 0),t.$ribbon=i(t._getSimpleToolBar(h))):t.$ribbon=i(t._getSimpleToolBar(bo)),r.text&&e.val(r.text),t.sourceView=e,t.editor=e.wrap("<div></div>").parent(),t.editor.width(n).height(o)):(t.editor=e,t.$ribbon=e.children(":eq(0)"),u=e.children(":eq(1)"),u.is("textarea")?(r.text&&u.val(r.text),t.sourceView=u):(p=r.text?r.text:u.html(),u.remove(),t.sourceView=i("<textarea></textarea>").val(p))),a=i("<div class='"+mi+"'></div>"),t.dialog=i("<div class ='"+fi+"'></div>"),t.subDialog=i("<div class ='"+fi+"'></div>"),t.editor.addClass(fi).addClass(t.options.wijCSS.widget).append(a).append(t.dialog).append(t.subDialog),t._createMenuMarkUp(t,r),t.$ribbon.wrap("<a href='javascript:void(null)'></a>").parent().appendTo("<div class='"+wi+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(a),l=i("<div class='"+yi+"'></div>").appendTo(a),t.designView=i("<iframe frameborder='0'></iframe>"),t.designView.wrap("<div></div>").parent().appendTo(l),t.sourceView.wrap("<div></div>").parent().appendTo(l),d=[t.$ribbon],t.$modes=i(t._getRibbonModesMarkup()),r.showFooter&&(c=i("<div class='"+vi+" ui-widget ui-widget-content ui-state-default'></div>"),a.append(c),c.append("<div class='"+_i+"'></div>"),t.$modes.appendTo(c),d.push(t.$modes)),i.each(d,function(e,i){i.wijribbon({click:function(e,i){t._ribbonCommand(i.commandName,i.name),t._trigger("commandButtonClick",e,i)}})})},e.prototype._createMenuMarkUp=function(t,e){e.customContextMenu&&!i.browser.webkit&&(t.contextMenu=i("<ul><li _c1buttoncmd='cut'><a>"+this.localizeString("contextMenuCut","Cut")+"</a></li><li _c1buttoncmd='copy'><a>"+this.localizeString("contextMenuCopy","Copy")+"</a></li><li _c1buttoncmd='paste'><a>"+this.localizeString("contextMenuPaste","Paste")+"</a></li></ul>"),i("<a href='#'></a>").append(t.contextMenu).appendTo(t.editor))},e.prototype._handleDisabledOption=function(t,e){var n=this;t?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(e)),i("body").focus(),n.disabledDiv.appendTo(n.editor)):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},e.prototype._createDisabledDiv=function(t){var e=this,n=t?t:e.element,o=n.outerWidth(),r=n.outerHeight();return i("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"relative","background-color":"lightgray",width:o,height:r,left:0,top:-r})},e.prototype._initElements=function(){var t=this,e=t.options,i=t.element.height()-t._getHeader().outerHeight(!0)-t._getFooter().outerHeight(!0),n={};t._getContent().height(i).wijsplitter({showExpander:!1,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:!1},panel2:{scrollBars:"none",collapsed:!0}}),t.sourceView.css("width","").css("height",""),t._addHandlerToDesignView(),t._addDefaultFontStyleToDesignView(),t._createWijMenu(),(!e.showPathSelector||"bbcode"===t.options.mode)&&t._getPathSelector().hide(),t._ribbonCommand(e.editorMode,null,!0),e.fullScreenMode&&t._setFullScreen(e.fullScreenMode),n[_t]=!0,n[vt]=!0,t.$ribbon.wijribbon(_,n),t._handleWinDocumentKeyDown()},e.prototype._handleWinDocumentKeyDown=function(){var t=this;i(document).keydown(function(e){if(!t.options.disabled)switch(e.keyCode){case 27:t._escActionAssociated()}})},e.prototype._setOption=function(t,e){var n=this,o=n.options,r=o.mode,s=n.$ribbon.parent(),a=o.customContextMenu;if(i.Widget.prototype._setOption.apply(n,arguments),"fullScreenMode"===t)o.fullScreenMode=e,n._setFullScreen(e);else if("showPathSelector"===t)o.showPathSelector=e,e?n._getPathSelector().show():n._getPathSelector().hide();else if("editorMode"===t)o.editorMode=e,n._ribbonCommand(e);else if("fullScreenContainerSelector"===t)o.fullScreenContainerSelector=e,n.options.fullScreenMode&&n._setFullScreen(!0);else if("disabled"===t)n._handleDisabledOption(e,n.editor);else if("showFooter"===t)e?i("."+vi).is(":visible")||i("."+vi).show():i("."+vi).is(":visible")&&i("."+vi).hide();else if("commandButtonClick"===t)o.commandButtonClick=e;else if("text"===t)o.text=e,n.setText(e);else if("customContextMenu"===t){if(a===e)return;e?(n.contextMenu||n._createMenuMarkUp(n,o),n._createWijMenu()):(n.contextMenu[n._contextMenuWidgetName()]("destroy").remove(),n.contextMenu=void 0)}else"mode"===t&&e!==r&&(n.$ribbon.wijribbon("destroy"),n.$ribbon.remove(),"ribbon"===e?n.$ribbon=i(n._getDefaultRibbonMarkup()):"bbcode"===e?n.$ribbon=i(n._getSimpleToolBar(Co)):n.$ribbon=i(n._getSimpleToolBar(bo)),s.append(n.$ribbon),n.$ribbon.wijribbon({click:function(t,e){n._ribbonCommand(e.commandName,e.name),n._trigger("commandButtonClick",t,e)}}),n._ribbonCommand(o.editorMode))},e.prototype._getHeader=function(){return i("."+wi,this.editor)},e.prototype._getContent=function(){return i("."+yi,this.editor)},e.prototype._getFooter=function(){return i("."+vi,this.editor)},e.prototype._getPathSelector=function(){return i("."+_i,this.editor)},e.prototype._getModes=function(){return i("."+hi,this.editor)},e.prototype._getDesignView=function(){return this.designView},e.prototype._getDesignViewWindow=function(){var t=this.designView;return t&&t.length>0?t[0].contentWindow:null},e.prototype._getDesignViewDocument=function(){var t=this._getDesignViewWindow();return t?t.document:null},e.prototype._getDesignViewText=function(){var t=this._getDesignViewDocument();return t&&t.body&&t.body.innerHTML?t.body.innerHTML:""},e.prototype._setDesignViewText=function(t){var e=this,i=this._getDesignViewDocument();"bbcode"===this.options.mode&&(t=e._convertBBCodeToHtml(t)),i&&i.body&&(i.body.innerHTML=t),e.options.text=t},e.prototype._getDialog=function(){return this.dialog},e.prototype._getSubDialog=function(){return this.subDialog},e.prototype._initContentDocument=function(){var t=this,e=t.sourceView.val(),n=t._getDesignViewDocument();"bbcode"===t.options.mode&&(e=t._convertBBCodeToHtml(i.trim(e))),n.open(),n.write('<html style="width:100%;height:100%;'+(t.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle"  type="text/css" >table,td,tr{border: 1px #acacac dashed;}</style></head><body>'+e+"</body></html>"),n.close(),g||i("#__wijStyle",n).prop("disabled",!g),t.element.attr("accesskey")&&(i(n.body).attr("accesskey",t.element.attr("accesskey")),t.element.removeAttr("accesskey")),m=[],m.push(e),f=0},e.prototype._addHandlerToDesignView=function(){var t=this,e=t._getDesignViewWindow(),i=e.document;t._initContentDocument(),t._loadDesignView()},e.prototype._loadDesignView=function(){var t=this,e=t._getDesignViewWindow(),n=e.document;i.browser.mozilla?setTimeout(t._setDesignModeForFF,1e3,t):t._setContentEditable(n,!0),i.browser.msie&&t._setContentSpellCheck(n,!1),t.sourceView.bind("blur."+t.widgetName,function(e){t._onSourceViewBlur()}),t.sourceView.bind("keyup."+t.widgetName,function(e){t._onSourceViewBlur()}),i.browser.mozilla?i(n).bind("blur."+t.widgetName,function(e){t._onDesignViewBlur(e)}):i(e).blur(function(e){t._onDesignViewBlur(e)}),i(n).bind("mouseup."+t.widgetName,function(e){t._onDesignViewMouseUp(e)}).bind("keydown."+t.widgetName,function(e){t._onDesignViewKeyDown(e)}).bind("keyup."+t.widgetName,function(e){t._onDesignViewKeyUp(e),t._onDesignViewBlur(e)})},e.prototype._addDefaultFontStyleToDesignView=function(){var t=this,e=t.options,n=t._getDesignViewDocument(),o=e.defaultFontName,r=e.defaultFontSize,s='<style type="text/css"> body {';(""!==o&&null!==o||""!==r&&null!==r)&&(""!==o&&null!==o&&(s+="font-family: "+o+";"),""!==e.defaultFontSize&&null!==e.defaultFontSize&&(s+=" font-size: "+r+";"),s+="}</style>",window.setTimeout(function(){i(s).appendTo(i("head",n))},200),t._setFontStyleButtonState(o,Ht),t._setFontStyleButtonState(r,Wt))},e.prototype._setFontStyleButtonState=function(t,e){var n="";t&&null!==t&&(i.each(this.$ribbon.wijribbon("getDropdownList",e),function(e,i){return i.toUpperCase()===t.toUpperCase()?(n=e,!1):void 0}),this.$ribbon.wijribbon(S,n,!0,e))},e.prototype._setDesignModeForFF=function(t){var e=t._getDesignViewDocument();e&&(e.designMode="on")},e.prototype.destroy=function(){var t=this;t.element.html(t._oriContent),t.element.removeAttr("tabindex"),void 0===t._oriStyle?t.element.removeAttr("style"):t.element.attr("style",t._oriStyle),t.element.insertBefore(t.editor),t.element.unbind("."+t.widgetName),t.editor.remove(),i.Widget.prototype.destroy.call(t)},e.prototype.showEditorDialog=function(t){switch(t){case ut:case rt:case Ft:case Lt:case kt:case Tt:case jt:case xt:case At:case J:case Q:case zt:this._ribbonCommand(t);break;default:o("Cannot find the dialog with command name '"+t+"'!")}},e.prototype.executeEditorAction=function(t,e){this._ribbonCommand(t,e)},e.prototype._isFontSizeCustomized=function(){if(null!==u)return u;var t=this.$ribbon.wijribbon("getDropdownList",Wt),e=[Bt,Rt,Ot,Gt,Ut,Nt,Vt];return u=!1,i.each(t,function(t,n){return-1===i.inArray(t,e)?(u=!0,!1):void 0}),u},e.prototype._fontSizeCommand=function(t){var e=this,n=e._getDesignViewDocument(),o,r=4,s="font-size",l=[];switch(e._getDesignViewWindow().getSelection&&(o=e._getDesignViewWindow().getSelection()),t){case Bt:r=1;break;case Rt:r=2;break;case Ot:r=3;break;case Gt:r=4;break;case Ut:r=5;break;case Nt:r=6;break;case Vt:r=7}e._isFontSizeCustomized()?i.browser.msie?e._formatFontSpan(n,s,t):(n.execCommand("FontSize",!1,r),i.each(i("font[size]",n),function(n,o){l.push(e._replaceFontWithSpan(i(o),"size",s,t))}),e._setSelection(l)):i.browser.msie&&a(i.browser.version)>=9?o&&o.rangeCount>0&&n.execCommand("FontSize",!1,r):n.execCommand("FontSize",!1,r),"bbcode"===e.options.mode&&!i.browser.msie&&e._convertFontStyleToStandTag(),e._addtoUndoBuffer()},e.prototype._fontNameCommand=function(t){var e=this,n=e._getDesignViewDocument(),o,r=e.$ribbon.wijribbon("getDropdownList",Ht),s;e._getDesignViewWindow().getSelection&&(o=e._getDesignViewWindow().getSelection()),i.each(r,function(e,i){return t===e?(s=i,!1):void 0}),i.browser.msie&&a(i.browser.version)>=9?o&&o.rangeCount>0&&n.execCommand("FontName",!1,s):n.execCommand("FontName",!1,s),e._isFontSizeCustomized()&&i.browser.msie&&e._formatFontSpan(n,"font-family",s),e._addtoUndoBuffer()},e.prototype._formatFontSpan=function(t,e,n){var o=this,r=n,s="fontFamily",a=[];"font-family"!==e&&(r="c1-temp",s="fontSize"),t.execCommand("FontName",!1,r),i.each(i("font[face='"+r+"']",t),function(t,r){var l=o._replaceFontWithSpan(i(r),"face",e,n),h,d;for(a.push(l),h=i("span."+wo,l),d=h.length-1;d>=0;d--)o._removeSpecifiedStyleSpan(i(h[d]),s,e);i.each(l,function(t,n){i.each(i(n).parents("span."+wo),function(t,r){var a=i(r);return a.children().length>1?!1:void(a.text()===i(n).text()&&o._removeSpecifiedStyleSpan(a,s,e))})})}),o._setSelection(a)},e.prototype._setSelection=function(t,e,n){var o=this._getDesignViewWindow(),r=o.document,s,a,l,h,d=0;try{i.browser.msie?(s=r.selection.createRange(),t?(i.each(t,function(t,e){d+=e.text().length}),s.moveToElementText(t[0][0]),s.collapse(!0),s.moveEnd("character",d)):(s.moveStart("textedit",-1),s.collapse(!0),s.moveStart("character",e),s.moveEnd("character",n)),s.select()):(h=o.getSelection(),s=r.createRange(),a=t[0][0],l=t[t.length-1][0],s.setStart(a,0),s.setEnd(l,l.childNodes.length),h.removeAllRanges(),h.addRange(s))}catch(c){}},e.prototype._replaceFontWithSpan=function(t,e,i,n){t.wrap("<span class = '"+wo+"' style='"+i+":"+n+"'></span>");var o=t.parent();return t.removeAttr(e),/<font\s*>/gi.test(o.html())&&(o.html(t.html()),t.remove()),o},e.prototype._removeSpecifiedStyleSpan=function(t,e,n){var o,r=!0;""!==t[0].style[e]&&t.css(n,""),o=t.attr("style"),o&&i.each(o.split(";"),function(t,e){var o=i.trim(e).toLowerCase();return""!==o&&-1!==o.indexOf(n)?(r=!1,!1):void 0}),r&&t.replaceWith(t.html())},e.prototype._removeFormat=function(){var t=this,e=t._getDesignViewDocument(),n={};e.execCommand(st,!1,null),t._isFontSizeCustomized()&&i.browser.msie&&t._removeFormatForIE(e),t._addtoUndoBuffer(),n[Z]=!1,n[tt]=!1,n[et]=!1,n[it]=!1,n[nt]=!1,n[ot]=!1,n[$]=!1,n[Y]=!1,n[V]=!1,n[H]=!1,n[W]=!1,n[z]=!1,t.$ribbon.wijribbon(x,n)},e.prototype._removeFormatForIE=function(t){var e=t.selection.createRange(),n=e.htmlText,o=e.text,r=0,s=i(e.parentElement()),a=i(t.body),l="",h="",d="__c1temp",c="c1-temp",u="<span class='"+c+"'>"+d+"</span>",p,g,f,m,w,y;for(s.addClass("c1-app-parent"),e.pasteHTML(u),r=a.text().indexOf(d),p=i("span."+c,t),g=p,p.parentsUntil("body").each(function(t){return i(this).is(".c1-app-parent")?!1:void(g=i(this))}),p.html(n),f=i("span."+wo,p),w=f.length-1;w>=0;w--)m=i(f[w]),m.replaceWith(m.html());for(g.is("."+c)||g.after(p),i.each(g.parents("span."+wo),function(t,e){l+="</span>",h="<span class='"+wo+"' style = '"+i(e).attr("style")+"'>"+h}),n=p.html(),p.replaceWith(d),y=a.html().split(d),a.html(y[0]+l+n+h+y[1]),f=i("span."+wo,t),w=f.length-1;w>=0;w--)m=i(f[w]),""===m.text()&&m.replaceWith(m.html());i(".c1-app-parent",t).removeClass("c1-app-parent"),this._setSelection(null,r,o.length)},e.prototype._toggleFullScreen=function(){var t=this,e=t.options;e.fullScreenMode=!e.fullScreenMode,t._setFullScreen(e.fullScreenMode),t.$modes.wijribbon(S,yt,e.fullScreenMode),t.$modes.wijribbon("removeButtonHoverState",yt)},e.prototype._setFullScreen=function(t){var e=this,n=1,o=e._getHeader(),s=e._getFooter(),c=e._getContent(),u=e.options.fullScreenContainerSelector,p=i(u),g=e._getDesignViewText(),f,m,w;t?(0===p.length&&(p=i(r),u="body",e._oriDocOverFlow=i(document.documentElement).css("overflow"),i(document.documentElement).css({overflow:"hidden"}),i.browser.mozilla||window.scrollTo(0,0),i(r).bind("resize.wijeditor",function(){e._fullscreenOnWindowResize()})),f=p.width(),m=p.height()-2*n,l=e.editor.width(),h=e.editor.height(),d||(d=e.editor.parent()),e._replacedDiv||(e._replacedDiv=i("<div />")),e.editor.after(e._replacedDiv),i(u).append(e.editor),e.editor.css({width:f,height:m,position:""}).addClass(Si),e.$ribbon.wijribbon("updateRibbonSize")):(e._replacedDiv.after(e.editor).remove(),e.editor.css({width:l,height:h,position:"static"}).removeClass(Si),e.options.fullScreenContainerSelector||i(document.documentElement).css({overflow:e._oriDocOverFlow}),i(r).unbind("resize.wijeditor"),e.$ribbon.wijribbon("updateRibbonSize")),w=e.editor.height()-o.outerHeight(!0)-s.outerHeight(!0),c.height(w).wijsplitter("refresh"),e._addHandlerToDesignView(),e._addDefaultFontStyleToDesignView(),e._createWijMenu(),i.browser.msie&&window.setTimeout(function(){"bbcode"===e.options.mode&&(g=e._convertHtmlToBBCode(i.trim(g))),e._setDesignViewText(g),a(i.browser.version)>=9&&e.sourceView.val(g)},40),e.$modes.wijribbon(S,yt,t)},e.prototype._createWijMenu=function(){var t=this,e=t._getDesignViewDocument();t.contextMenu&&t.contextMenu[t._contextMenuWidgetName()]({orientation:"vertical",trigger:t.designView,triggerEvent:"rtclick",showing:function(n,o){i.browser.msie&&(w=e.selection.createRange());var r=t.designView.offset(),s=i(i(t.designView)[0].contentWindow).scrollLeft(),a=i(i(t.designView)[0].contentWindow).scrollTop(),l=r.left+2-s,h=r.top-a;o.options.position={my:"left+"+l+" top+"+h,at:"right top",of:n,collision:"none none"}},animation:{animated:"fade"},select:function(e,i){t._setIESelection(),t._contextMenuItemClick(e,i),t.contextMenu[t._contextMenuWidgetName()]("deactivate")}});
},e.prototype._fullscreenOnWindowResize=function(){var t=this,e=t._getHeader(),n=t._getFooter(),o=t._getContent(),r,s=i(window).width(),a=i(window).height();t.editor.css({width:s,height:a}),r=t.editor.height()-e.height()-n.height(),o.height(r).wijsplitter("refresh")},e.prototype._saveText=function(t){},e.prototype._doSpellCheck=function(){},e.prototype._ribbonCommand=function(t,e,n){var o=this,r=o._getDesignViewDocument(),s=o._getContent(),a=s.height()/2,l,h,d;if(e===Ht)return o._fontNameCommand(t),void o._onDesignViewBlur(null);if(e===Wt)return o._fontSizeCommand(t),void o._onDesignViewBlur(null);switch(o.editor.hasClass("ui-helper-hidden-accessible")||(n?setTimeout(function(){o._setIEFocus()},0):o._setIEFocus()),t){case $t:i.browser.msie?(r.execCommand("FormatBlock",!1,"<ADDRESS>"),d=r.selection.createRange(),d=i(d.parentElement()).closest("address"),d.length&&(d.replaceWith("<blockquote>"+d.html()+"</blockquote>"),r.body.innerHTML=r.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>"),r.body.innerHTML=r.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>"),r.body.innerHTML=r.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,""))):r.execCommand("FormatBlock",!1,"<BLOCKQUOTE>"),o._addtoUndoBuffer(),o._setFocusNotIE();break;case b:l=o._generateUniqueName("form"),o.insertHTML('<form id="'+l+'" name="'+l+'" method="post">'+l+"</form>"),o._setFocusNotIE();break;case C:l=o._generateUniqueName("image"),o.insertHTML('<input id="'+l+'" name="'+l+'" type="image" value="'+l+'"/>'),o._setFocusNotIE();break;case D:l=o._generateUniqueName("textarea"),o.insertHTML('<textarea id="'+l+'" name="'+l+'" rows="4" cols="48"></textarea>'),o._setFocusNotIE();break;case I:l=o._generateUniqueName("button"),o.insertHTML('<input id="'+l+'" name="'+l+'" type="button" value="'+l+'"/>'),o._setFocusNotIE();break;case j:l=o._generateUniqueName("textbox"),o.insertHTML('<input id="'+l+'" name="'+l+'" type="text" value="'+l+'"/>'),o._setFocusNotIE();break;case T:l=o._generateUniqueName("list"),o.insertHTML('<select id="'+l+'" name="'+l+'" style="width: 120px" size="8"></select>'),o._setFocusNotIE();break;case E:l=o._generateUniqueName("password"),o.insertHTML('<input id="'+l+'" name="'+l+'" type="password" value="'+l+'"/>'),o._setFocusNotIE();break;case k:l=o._generateUniqueName("dropdown"),o.insertHTML('<select id="'+l+'" name="'+l+'"></select>'),o._setFocusNotIE();break;case L:l=o._generateUniqueName("hidden"),o.insertHTML('<input id="'+l+'" name="'+l+'" type="hidden" value="'+l+'" />'),o._setFocusNotIE();break;case P:l=o._generateUniqueName("radiobox"),o.insertHTML('<input id="'+l+'" name="'+l+'" type="radio" value="'+l+'"><label for="'+l+'">'+l+"</label></input>"),o._setFocusNotIE();break;case M:l=o._generateUniqueName("checkbox"),o.insertHTML('<input id="'+l+'" name="'+l+'" type="checkbox" value="'+l+'"><label for="'+l+'">'+l+"</label></input>"),o._setFocusNotIE();break;case F:case A:case B:case R:case O:case G:case U:case N:o._tableAction(t);break;case K:o._toggleTableBorders();break;case nt:try{r.queryCommandState(ot)&&(r.execCommand(ot,!1,null),o.$ribbon.wijribbon(S,ot,!1))}catch(c){}r.execCommand(nt,!1,null),o._addtoUndoBuffer(),o._setFocusNotIE();break;case ot:try{r.queryCommandState(nt)&&(r.execCommand(nt,!1,null),o.$ribbon.wijribbon(S,nt,!1))}catch(u){}r.execCommand(ot,!1,null),o._addtoUndoBuffer(),o._setFocusNotIE();break;case st:o._removeFormat(),o._setFocusNotIE();break;case at:o.insertHTML("<br/>"),o._setFocusNotIE();break;case lt:h=o._getSelectedContent(),h&&""!==h||(h="&nbsp;"),o.insertHTML("<p>"+h+"</p>"),o._setFocusNotIE();break;case ht:o.insertHTML('<div title="Print Page Break" style="font-size:1px;page-break-before:always;vertical-align:middle;height:1px;background-color:#c0c0c0">&nbsp;</div>'),o._setFocusNotIE();break;case yt:o._toggleFullScreen();break;case vt:o._undoAction(),o._setFocusNotIE();break;case _t:o._redoAction(),o._setFocusNotIE();break;case bt:o._execCut(),o._setFocusNotIE();break;case Ct:o._execCopy();break;case Dt:o._execPaste();break;case Et:o.insertDateAndTime(),o._setFocusNotIE();break;case gt:o.$modes.data("wijmoWijribbon")&&o.$modes.wijribbon(v,wt,!0).wijribbon(S,gt,!0),o.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option","panel2",{collapsed:!0});break;case ft:o.$modes.data("wijmoWijribbon")&&o.$modes.wijribbon(v,wt,!0).wijribbon(S,ft,!0),o.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option",{splitterDistance:a,panel1:{collapsed:!1},panel2:{collapsed:!1}});break;case mt:o.$modes.data("wijmoWijribbon")&&o.$modes.wijribbon(v,wt,!1).wijribbon(S,mt,!0),o.$ribbon.wijribbon("option","disabled",!0),s.wijsplitter("option","panel1",{collapsed:!0}),i.browser.msie&&o.sourceView.focus();break;case wt:s.wijsplitter("option","panel1").collapsed&&o._toggleWordWrap();break;case J:o._saveSelectionForIE(),o._createDialog(this.localizeString("backColorDialogTitle","Set BackColor"),o._getDialogRes_BackColor(),o.initBackColorDialog);break;case Q:o._saveSelectionForIE(),o._createDialog(this.localizeString("foreColorDialogTitle","Set ForeColor"),o._getDialogRes_ForeColor(),o.initForeColorDialog);break;case ut:o._saveSelectionForIE(),o._createDialog(this.localizeString("insertTableDialogTitle","Insert Table"),o._getDialogRes_Table(),o.initInsertTableDialog);break;case pt:o._getEditableTable()&&o._createDialog(this.localizeString("editTableDialogTitle","Edit Table"),o._getDialogRes_Table(),o.initEditTableDialog);break;case St:o._createDialog(this.localizeString("previewDialogPreview","Preview"),o._getDialogRes_Preview(),o.initPreviewDialog);break;case xt:o._createDialog(this.localizeString("cleanUpDialogTitle","Clean up source HTML document"),o._getDialogRes_CleanUp(),o.initCleanUpDialog);break;case jt:o._saveSelectionForIE(),o._createDialog(this.localizeString("mediaDialogTitle","Insert media"),o._getDialogRes_Media(),o.initMediaDialog);break;case Tt:o._saveSelectionForIE(),o._createDialog(this.localizeString("specialCharacterDialogTitle","Insert special character"),o._getDialogRes_SpecialCharacter(),o.initSpecialCharacterDialog);break;case kt:o._createDialog(this.localizeString("findAndReplaceTitle","Find and replace"),o._getDialogRes_FindAndReplace(),o.initFindDialog);break;case Lt:y=o._getSelectedElement(),o._createDialog(this.localizeString("tagInspectorDialogTitle","Tag Inspector"),o._getDialogRes_TagInspector(),o.initTagInspectorDialog);break;case rt:o._saveSelectionForIE(),o._createDialog(this.localizeString("templateDialogApplyTemplate","Apply Template"),o._getDialogRes_Template(),o.initTemplateDialog);break;case Ft:o._saveSelectionForIE(),o._createDialog(this.localizeString("imageEditorDialogImageBrowser","Image Browser"),o._getDialogRes_ImageBrowser(),o.initImageBrowserDialog);break;case At:o._saveSelectionForIE(),o._createDialog(this.localizeString("hyperLinkDialogInserthyperLink","Insert hyperLink"),o._getDialogRes_Link(),o.initHyperLinkDialog);break;case zt:o._saveSelectionForIE(),o._createDialog("Insert Code",o._getDialogRes_Code(),o.initInsertCodeDialog);break;case V:case H:case W:case z:case q:case X:case Z:case tt:case it:case $:case Y:case et:case dt:case It:r.execCommand(t,!1,null),"bbcode"===o.options.mode&&!i.browser.msie&&o._convertStyleToStandTag(),o._addtoUndoBuffer(),o._setFocusNotIE();break;case Pt:o._saveText();break;case Mt:o._doSpellCheck()}o._onDesignViewBlur(null)},e.prototype._saveSelectionForIE=function(){var t=this._getDesignViewWindow(),e;i.browser.msie&&(e=t.document.selection,w=e.createRange())},e.prototype._createDialog=function(t,e,n){var o=this,r,s=o.dialog;s.html("").undelegate(o.widgetName).undelegate("."+o.widgetName).append(e),o.subDialog&&o.subDialog.html("").undelegate(o.widgetName).undelegate("."+o.widgetName),r={width:"auto",height:"auto",modal:!0,title:t,position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},s.data("wijmoWijdialog")?(s.wijdialog("reset"),s.wijdialog("option",{width:"auto",height:"auto",title:t})):i.browser.msie&&6===a(i.browser.version)?window.setTimeout(function(){s.wijdialog(r)},0):s.wijdialog(r),o._adjustDialogLayoutForIE7(),n&&n.call(o),s.wijdialog("open")},e.prototype._adjustDialogLayoutForIE7=function(){var t=this.dialog;i.browser.msie&&/^7\.[0-9]+/.test(i.browser.version)&&t.wijdialog("option","width",t.parent().width())},e.prototype._contextMenuItemClick=function(t,e,i){var n=this,o=e.item.element.attr("_c1buttoncmd");switch(o){case bt:n._execCut();break;case Ct:n._execCopy();break;case Dt:n.focus(),n._execPaste()}},e.prototype._execCut=function(){var t=this,e=t._getDesignViewDocument();i.browser.safari?o(this.localizeString("errorMessageCutError","This function is not supported in current browser.  Plesse use (Ctrl + X).")):i.browser.msie?(e.execCommand("Cut",!1,null),t._addtoUndoBuffer()):(t._execCopy(),t._deleteSelectionContent(),t._addtoUndoBuffer())},e.prototype._execCopy=function(){var t=this,e=t._getDesignViewDocument();i.browser.safari?o(this.localizeString("errorMessageCopyError","This function is not supported in current browser. Plesse use (Ctrl + C).")):i.browser.msie?(e.execCommand("Copy",!1,null),t._addtoUndoBuffer()):t._copyToClipboard(t._getSelectedContent())},e.prototype._execPaste=function(){var t=this,e,n=t._getDesignViewDocument();if(i.browser.safari)o(this.localizeString("errorMessagePasteError","This function is not supported in current browser. Plesse use (Ctrl + V)."));else if(i.browser.msie)n.execCommand("Paste",!1,null),t._addtoUndoBuffer();else try{e=t._copyFromClipboard(),e&&""!==e&&t.insertHTML(e)}catch(r){}},e.prototype._getFontSizeCollection=function(){return{"10px":Bt,"13px":Rt,"16px":Ot,"18px":Gt,"24px":Ut,"32px":Nt,"48px":Vt,1:Bt,2:Rt,3:Ot,4:Gt,5:Ut,6:Nt,7:Vt}},e.prototype._updateButtonStates=function(t){var e=this,n=e._getDesignViewDocument(),o,r,s={},a=[Z,tt,et,it,nt,ot,$,Y,V,H,W,z],l,h=t.target,d=i(h);i.each(a,function(t,e){s[e]=n.queryCommandState(e)}),e.$ribbon.wijribbon(x,s),o=e._queryCommandValue(Ht)||"",i.each(e.$ribbon.wijribbon("getDropdownList",Ht),function(t,e){return e.toUpperCase()===o.toUpperCase()?(r=t,!1):void 0}),e.$ribbon.wijribbon(S,r,!0,Ht),e._isFontSizeCustomized()?(r=d.is("span")?h.style.fontSize:"",""===r&&(l=d.parents("span."+wo),i.each(l,function(t,e){return r=e.style.fontSize,r&&""!==r?!1:void 0})),""===r&&(r=d.css("font-size"))):(o=e._queryCommandValue(Wt)||"",""===o&&(o=d.css("font-size")),i.each(e._getFontSizeCollection(),function(t,e){return t.toString()===o.toString()?(r=e,!1):void 0})),e.$ribbon.wijribbon(S,r,!0,Wt)},e.prototype._queryCommandValue=function(t){var e=this._getDesignViewDocument();try{if(!e.queryCommandEnabled(t))return null}catch(i){return null}try{return e.queryCommandValue(t)}catch(n){}return null},e.prototype._escActionAssociated=function(){var t=this,e=t._getDesignViewWindow();e&&e.document&&void 0!==e.document.selection&&e.document.selection.empty(),e&&void 0!==e.getSelection&&e.getSelection().removeAllRanges(),t._hideAllDropdownsMenus()},e.prototype._hideAllDropdownsMenus=function(){var t=this;t.contextMenu&&t.contextMenu[t._contextMenuWidgetName()]("hideAllMenus"),t.$ribbon.wijribbon("hideDropdown",Ht).wijribbon("hideDropdown",Wt).wijribbon("hideDropdown",ct)},e.prototype._onDesignViewKeyDown=function(t){var e=this,i;e._setSaveBtnEnabled();try{if(t.ctrlKey)i=String.fromCharCode(t.keyCode).toLowerCase();else switch(t.keyCode){case 27:e._escActionAssociated();break;case 13:case 46:e._addtoUndoBuffer(),e._continueSavingInputTextForUndo=!1;break;default:e._continueSavingInputTextForUndo=!0}}catch(n){}},e.prototype._onDesignViewKeyUp=function(t){var e=this,n;if((37===t.keyCode||38===t.keyCode||39===t.keyCode||40===t.keyCode||33===t.keyCode||34===t.keyCode||35===t.keyCode||36===t.keyCode)&&(i.browser.msie&&"6.0"===i.browser.version?(e._keyTimeoutHandlerIE6&&(clearTimeout(e._keyTimeoutHandlerIE6),e._keyTimeoutHandlerIE6=null),e._keyTimeoutHandlerIE6=window.setTimeout(function(){e._updateButtonStates(t)},300)):e._updateButtonStates(t)),t.ctrlKey)switch(n=String.fromCharCode(t.keyCode).toLowerCase()){case"y":e._redoAction(),t.preventDefault(),t.stopPropagation();break;case"z":e._undoAction(),t.preventDefault(),t.stopPropagation();break;case"x":case"v":e._addtoUndoBuffer(),e._continueSavingInputTextForUndo=!1}},e.prototype._onDesignViewMouseUp=function(t){var e=this,n;if(2!==t.button&&(e._updateButtonStates(t),e._refreshPathSelector(),e._hideAllDropdownsMenus(),i(document).mouseup(),i.browser.msie&&(n=i(t.target).closest("a"),t.ctrlKey&&n.length>0)))try{n.focus(),r.open(n[0].href,"_blank")}catch(o){}},e.prototype._onDesignViewBlur=function(t){var e=this,n=e.options,o;o=e._getDesignViewText(),"bbcode"===n.mode&&(o=e._convertHtmlToBBCode(i.trim(o))),e.sourceView.val(o),e._onTextChange(t),n.text=o},e.prototype._onTextChange=function(t){var e=this;e._continueSavingInputTextForUndo&&(e._addtoUndoBuffer(),e._continueSavingInputTextForUndo=!1),e._trigger("textChanged",t,{text:e.options.text})},e.prototype._onSourceViewBlur=function(){var t=this,e;e=t.sourceView.val(),t._setDesignViewText(e),t.options.text=e},e.prototype._convertBBCodeToHtml=function(t){return t?(t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),i.browser.msie&&(t=t.replace(/&lt;p&gt;/gim,"<p>"),t=t.replace(/&lt;\/p&gt;/gim,"</p>")),t=t.replace(/(?:\r\n|\n|\r)/g,"<br>"),t=t.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>'),t=t.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>'),t=t.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>'),t=t.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>'),t=t.replace(/\[B\]/gim,"<b>"),t=t.replace(/\[\/B\]/gim,"</b>"),t=t.replace(/\[I\]/gim,"<i>"),t=t.replace(/\[\/I\]/gim,"</i>"),t=t.replace(/\[S\]/gim,"<strike>"),t=t.replace(/\[\/S\]/gim,"</strike>"),t=t.replace(/\[U\]/gim,"<u>"),t=t.replace(/\[\/U\]/gim,"</u>"),t=t.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>'),t=t.replace(/\[BLOCK\]/gim,"<blockquote>"),t=t.replace(/\[\/BLOCK\]/gim,"</blockquote>"),t=t.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>"),t=t.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>"),t=t.replace(/\[\*\]/gim,"</li><li>"),t=t.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">'),t=t.replace(/\[\/size\]/gim,"</font>"),t=t.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">'),t=t.replace(/\[\/color\]/gim,"</font>")):""},e.prototype._replaceComplexHtml=function(t){var e,n,o,r,s=i("<div/>").html(t);for(e=i("img",s),i.each(e,function(){o="[IMG height="+i(this).height()+" width="+i(this).width()+"]"+i(this).attr("src").toString()+"[/IMG]",i(this).replaceWith(o)}),n=i("font",s),r=n.length-1;r>=0;r--)i(n[r]).attr("color")&&i(i(n[r])).attr("size")?o="[Color="+i(i(n[r])).attr("color")+"][Size="+i(i(n[r])).attr("size")+"]"+i(i(n[r])).html()+"[/Size][/Color]":i(i(n[r])).attr("color")&&!i(i(n[r])).attr("size")?o="[Color="+i(i(n[r])).attr("color")+"] "+i(i(n[r])).html()+"[/Color]":i(i(n[r])).attr("size")&&!i(i(n[r])).attr("color")&&(o="[Size="+i(i(n[r])).attr("size")+"]"+i(i(n[r])).html()+"[/Size]"),i(i(n[r])).replaceWith(o);return s.html()},e.prototype._convertHtmlToBBCode=function(t){var e=this;if(""!==t)return t=e._replaceComplexHtml(t),t=t.replace(/<br(?=[ \/>]).*?>/gim,"\r\n"),i.browser.msie&&(t=t.replace(/<p>/gim,"&lt;p&gt;"),t=t.replace(/<\/p>/gim,"&lt;/p&gt;")),t=t.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]"),t=t.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]"),t=t.replace(/<(?:b|strong)>/gim,"[B]"),t=t.replace(/<\/(?:b|strong)>/gim,"[/B]"),t=t.replace(/<(?:i|em)>/gim,"[I]"),t=t.replace(/<\/(?:i|em)>/gim,"[/I]"),t=t.replace(/<(?:strike|s)>/gim,"[S]"),t=t.replace(/<\/(?:strike|s)>/gim,"[/S]"),t=t.replace(/<u>/gim,"[U]"),t=t.replace(/<\/u>/gim,"[/U]"),t=t.replace(/<blockquote.*?\>/gim,"[BLOCK]"),t=t.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]"),t=t.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]"),t=t.replace(/<\/(?:ol)>/gim,"[/LIST]"),t=t.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]"),t=t.replace(/<\/(?:ul)>/gim,"[/LIST]"),t=t.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1"),t=t.replace(/&nbsp;/gi," "),t=t.replace(/(<[^>]+>)/gm,"")},e.prototype._convertFontStyleToStandTag=function(){var t=this,e=t._getDesignViewDocument(),n=i(e.body),o,r,s=i("[style*='color: ']",n);0!==s.length&&(o=s,r="<font color='"+t._getWebColorFromRgb(s.css("color"))+"'></font>"),o&&i.each(o,function(t){i(this).is("span")?i(this).replaceWith(i(r).html(i(this).html())):i(this).is("font")&&i(this).attr("size")&&i(this).removeAttr("style").html(i(r).html())})},e.prototype._convertStyleToStandTag=function(){var t=this,e=t._getDesignViewDocument(),n=i(e.body),o,r,s,a=i("[style*='font-weight: bold;']",n),l=i("[style*='font-style: italic;']",n),h=i("[style*='text-decoration: line-through;']",n),d=i("[style*='text-decoration: underline;']",n);0!==a.length?(o=a,r="<b></b>",s="font-weight"):0!==l.length?(o=l,r="<i></i>",s="font-style"):0!==h.length?(o=h,r="<strike></strikes>",s="text-decoration"):0!==d.length&&(o=d,r="<u></u>",s="text-decoration"),o&&i.each(o,function(t){i(this).is("span")&&""===this.style.fontSize?i(this).replaceWith(i(r).html(i(this).html())):i(this).removeAttr("style").html(i(r).html())})},e.prototype._getWebColorFromRgb=function(t){var e=this,i;return 0===t.indexOf("rgb(")&&(i=t.substring(4,t.length-1).split(","),t=e._convertToWebColor(a(i[0]),a(i[1]),a(i[2]))),t},e.prototype._updateList=function(t,e){var n;i("option",e).remove();for(n in t)t[n]&&e.append("<option>"+n+"</option>")},e.prototype._triggerEvent=function(t,e){var i=this,n=i.options[t];return n&&"function"==typeof n?n.call(i,e):n},e.prototype._closeDialog=function(){this.dialog.wijdialog("close"),w=null,this.focus()},e.prototype._onTemplateList=function(t){return this._triggerEvent("templateList",t)},e.prototype.updateTemplateList=function(t,e){var n=this,o=e||i("select",n.dialog);n._updateList(t,o),n._templateList=t},e.prototype.initTemplateDialog=function(){var t=this,e=t.dialog,n=i("select",e),o=t._onTemplateList();e.delegate("select","change."+t.widgetName,function(){t.templateListOnChanged()}).delegate("."+Zi,"click."+t.widgetName,function(){t.deleteTemplate()}).delegate("."+tn,"click."+t.widgetName,function(){t.saveTemplate()}).delegate(yo,"click."+t.widgetName,function(){t.applyTemplate()}).delegate(vo,"click."+t.widgetName,function(){t._closeDialog()}),(o||(o=t._templateList))&&t.updateTemplateList(o,n)},e.prototype.templateListOnChanged=function(){var t=this,e=t.dialog,n=i("select",e).val(),o=i("iframe",e),r=t._templateList,s;r&&(s=r[n],s.src&&o.attr("src",s.src+"?d="+(new Date).getMilliseconds().toString()),s.text&&o.length>0&&o[0].contentWindow.document.write(s.text),n&&(i("."+Ki,e).html(n),i("."+Xi,e).val(n)),s.desc&&(i("."+Yi,e).html(s.desc),i("."+Ji,e).val(s.desc)))},e.prototype._onSaveTemplate=function(t){this._triggerEvent("saveTemplate",t)},e.prototype.saveTemplate=function(){var t=this,e=t.dialog,n=i("."+Xi,e).val(),r=i("."+Ji,e).val(),s=t._templateList,a=this._getDesignViewText();return""===i.trim(n)?void o(this.localizeString("errorMessageTemplateNameError","Please input a template name!")):(s||(t._templateList=[],s=t._templateList),s[n]||i("select",e).append("<option>"+n+"</option>"),s[n]={desc:r,text:a},t._onSaveTemplate({name:n,desc:r,text:a}),void 0)},e.prototype._onDeleteTemplate=function(t){this._triggerEvent("deleteTemplate",t)},e.prototype.deleteTemplate=function(){var t=this,e=t.dialog,n=i("select",e),r=n.val(),s=t._templateList;return""===i.trim(r)?void o(this.localizeString("errorMessageTemplateFileError","Please select a template file.")):(i("option:selected",n).remove(),i("iframe",e).attr("src","about:blank"),i("."+Ki,e).empty(),i("."+Xi,e).val(""),i("."+Yi,e).empty(),i("."+Ji,e).val(""),delete s[r],t._onDeleteTemplate(r),void 0)},e.prototype.applyTemplate=function(){var t=this,e=t.dialog,n=i("select",e),r=n.val(),s=i("iframe",e)[0],a=i("."+Xi,e).val(),l=s.contentWindow.document.body.innerHTML;return""===i.trim(a)||""===i.trim(r)?void o(this.localizeString("errorMessageValidTemplateFileError","Please select a valid template file.")):(t._setDesignViewText(l),t._addtoUndoBuffer(),t._setSaveBtnEnabled(),t._closeDialog(),void 0)},e.prototype._onImageList=function(){var t=this,e=t.options.imageList;return e&&"function"==typeof e?e.call(t):e},e.prototype.updateImageList=function(t,e){var n=this,o=n.dialog,r=e||i("select",o),s=i("."+ki,o);return n._updateList(t,r),n._imgList=t,t?void s.removeClass(Oi):void s.addClass(Oi)},e.prototype.initImageBrowserDialog=function(){var t=this,e=t.dialog,n=t._onImageList();return i("img",e).hide(),e.delegate("select","change."+t.widgetName,function(){t.imageListOnChanged()}).delegate(yo,"click."+t.widgetName,function(e){t.submitInsertImageDialog(),t._onDesignViewBlur(e)}).delegate(vo,"click."+t.widgetName,function(){t._closeDialog()}),i("."+Mi+" input",e).bind("change."+t.widgetName,function(){t.imageUrlChanged(this)}),n||(n=t._imgList)?void t.updateImageList(n,i("select",e)):void i("."+ki,e).addClass(Oi)},e.prototype.imageUrlChanged=function(t){var e=this,n=e.dialog;i("img",this.dialog).attr("src",i(t).val()+"?"+(new Date).getTime()).show().bind("load",function(){i("."+Ai+" input",n).val(i("img",n).width().toString()),i("."+Bi+" input",n).val(i("img",n).height().toString())})},e.prototype.imageListOnChanged=function(){var t=this,e=t.dialog,n=i("select",e).val(),o=t._imgList,s;o&&(s=o[n],i("img",e).prop("src",s).show(),i("."+Mi+" input",e).prop("value",s),r.setTimeout(function(){i("."+Ai+" input",e).val(i("img",e).width().toString()),i("."+Bi+" input",e).val(i("img",e).height().toString())},200))},e.prototype.submitInsertImageDialog=function(){var t=this,e,n=t.dialog,r=i("."+Mi+" input",n).val(),s=i("."+Fi+" input",n).val(),a=i("."+Ai+" input",n).val(),l=i("."+Bi+" input",n).val(),h=i("."+Ri+" input",n).val();return""===i.trim(r)?void o(this.localizeString("errorMessageSelectImageError","Please select a image.")):t._isNumeric(a)?t._isNumeric(l)?(t.focus(),i.browser.msie?(e='<img src="'+r+'" alt="'+s+'" style="width:'+a+"px;height:"+l+"px","bbcode"!==t.options.mode&&null!==h&&void 0!==h&&h.length>0&&(e+=";"+h)):(e='<img src="'+r+'" alt="'+s+'" width="'+a+'" height="'+l,"bbcode"!==t.options.mode&&(e+='" style="'+h)),e+='"/>',t.insertHTML(e),t._closeDialog(),void 0):void o(this.localizeString("errorMessageImageHeightError","Please input a number for 'Image height' textbox.")):void o(this.localizeString("errorMessageImageWidthError","Please input a number for 'Image width' textbox."))},e.prototype.initHyperLinkDialog=function(){var t=this,e=t.dialog,n=t.getLinkHrefField(),o=i("."+un,e),s,a,l,h=i("."+nn+" input",e);e.delegate(yo,"click."+t.widgetName,function(e){t.submitHyperLinkDialog(),t._onDesignViewBlur(e)}).delegate(vo,"click."+t.widgetName,function(){t._closeDialog()}).delegate("."+rn,"change."+t.widgetName,function(){t.anchorListOnChanged(this)}).delegate("."+on+">div","click."+t.widgetName,function(){t.radioListOnChanged()}).delegate("."+pn+">div","click."+t.widgetName,function(){t.linkIconTypeOnChanged()}).delegate("."+hn+" input","change."+t.widgetName,function(){t.tempImg=i('<img src="'+i("."+hn+" input",e).val()+'">').appendTo("body"),r.setTimeout(function(){i("."+dn+" input",e).val(t.tempImg.width().toString()),i("."+cn+" input",e).val(t.tempImg.height().toString()),t.tempImg.remove(),t.tempImg=void 0},200)});try{h.val(n),a=t._getLinkInnerHTML()}catch(d){}l=i(a),s=a&&"<img"===a.substring(0,3)?!0:!1,s?(o.show(),i("."+sn+" input",e).hide(),i("."+hn+" input",e).val(l.attr("src")),i("."+dn+" input",e).val(l.attr("width")),i("."+cn+" input",e).val(l.attr("heigth"))):(i("."+sn+" input",e).show(),o.hide(),i("."+sn+" input",e).val(a)),i("."+ln+" input",e).val(t._getLinkCssField()),i("."+an+" select",e).val(t._getLinkTarget()),i("#radAnchor",e).attr("checked","checked"),i("#radLinkTypeIsText",e).attr("checked","checked"),n.length>6&&("http"===n.substring(0,4)?i("#radUrl",e).attr("checked","checked"):"mailto"===n.substring(0,6)?i("#radMail",e).attr("checked","checked"):"#"===n.substring(0,1)?i("#radAnchor",e).attr("checked","checked"):i("#radFile",e).attr("checked","checked")),l=void 0},e.prototype._getLinkInnerHTML=function(){var t=this,e;t.focus(),e=t._getInspectElement();try{if(e&&"A"===e.tagName)return e.innerHTML||""}catch(i){}return""},e.prototype.getLinkHrefField=function(){var t=this,e;t.focus(),e=t._getInspectElement();try{if(e&&"A"===e.tagName)return t.fixAbsoluteUrlsIfNeeded(e.href||"")}catch(i){}return""},e.prototype._getLinkTarget=function(){var t=this,e;t.focus(),e=t._getInspectElement();try{if(e&&"A"===e.tagName)return e.target||""}catch(i){}return""},e.prototype._getLinkCssField=function(){var t=this,e;t.focus(),e=t._getInspectElement();try{if(e&&"A"===e.tagName)return e.style.cssText||""}catch(i){}return""},e.prototype.submitHyperLinkDialog=function(){var t=this,e=t.dialog,n=i("#radMail",e),r=i("."+nn+" input",e),s=i("."+sn+" input",e),a=i("."+ln+" input",e),l=i("."+an+" select",e),h=r.val(),d=s.val(),c=l.val(),u=i("#radLinkTypeIsImage",e),p=u.prop("checked"),g=i("."+hn+" input",e).val(),f=i("."+dn+" input",e).val(),m=i("."+cn+" input",e).val(),w=a.val();return""===h?void o(this.localizeString("errorMessageAddressError","Please input address!")):""!==d||p?""===g&&p?void o(this.localizeString("errorMessageHyperLinkImageUrlError","Please input image url!")):!t._isNumeric(f)&&p?void o(this.localizeString("errorMessageHyperLinkImageWidthError","Please input correct image width!")):!t._isNumeric(m)&&p?void o(this.localizeString("errorMessageHyperLinkImageHeightError","Please input correct image height!")):n.attr("checked")&&!t._isEmail(h)?void o(this.localizeString("errorMessageHyperLinkEmail","Please input correct email!")):(p&&(d='<img src="'+g+'" width="'+f+'" height="'+m,d+='"/>'),t._editLink(d,h,w,c),t._closeDialog(),void 0):void o(this.localizeString("errorMessageDisplayTextError","Please input display text!"))},e.prototype._editLink=function(t,e,i,n){var o=this,r,s="";o.focus(),r=o._getInspectElement();try{if(r&&"A"===r.tagName)return r.innerHTML=t,r.href=e,r.target=n,i!==r.style.cssText&&(r.style.cssText=i),o._addtoUndoBuffer(),o._setSaveBtnEnabled(),void 0}catch(a){}s='<a href="'+e+'" target="'+n+'"',""!==i&&(s+=' style="'+i+'"'),s+=">"+t+"</a>",o._setIESelection(),o.insertHTML(s)},e.prototype.anchorListOnChanged=function(t){var e=this,n=e.dialog,o=i(t).val();""!==o&&(i("."+nn+" input",n).val(o),i("#radAnchor",n).attr("checked","checked"))},e.prototype.radioListOnChanged=function(){var t=this,e=t.dialog,n=i("."+rn,e),o=i("."+nn+" input",e);o.val(""),i("#radUrl",e).is(":checked")?n.hide():i("#radAnchor",e).is(":checked")?n.show():i("#radMail",e).is(":checked")?(n.hide(),o.val("mailto:")):i("#radFile",e).is(":checked")&&n.hide()},e.prototype.linkIconTypeOnChanged=function(){var t=this,e=t.dialog,n=i("."+un,e),o=i("."+sn,e);i("#radLinkTypeIsText",e).is(":checked")?(o.show(),n.hide()):i("#radLinkTypeIsImage",e).is(":checked")&&(o.hide(),n.show())},e.prototype._getDialogRes_Code=function(){var t=this,e=t._createDiv(en);return e.add(t._createElement("div","Enter source code",{"class":mn})),e.add(t._createElement("textarea","",{"class":fn})),e.add(t._createSeparator()),e.add(t._createOKCancelButtons()),e.render()},e.prototype.initInsertCodeDialog=function(){var t=this,e=t.dialog;e.delegate(yo,"click."+t.widgetName,function(e){t.submitCodeDialog(),t._onDesignViewBlur(e)}).delegate(vo,"click."+t.widgetName,function(){t._closeDialog()})},e.prototype.submitCodeDialog=function(){var t=this,e=t.dialog,n=i("."+fn,e),o=n.val();""!==o&&(o=o.replace(/</g,"&lt;"),o=o.replace(/>/g,"&gt;"),o="<pre>"+o+"</pre>",t._setIESelection(),t.insertHTML(o),t._closeDialog())},e.prototype.initTagInspectorDialog=function(){var t=this,e=t.dialog,n=i("."+Cn);e.delegate(yo,"click."+t.widgetName,function(e){t.submitTagInspectorDialog(),t._onDesignViewBlur(e)}).delegate(vo,"click."+t.widgetName,function(){t._closeDialog()}).delegate("#displayNoEmpty","click."+t.widgetName,function(){t.tagInspectorDialogSwitchAttList(this)}),t._laySelectedElementAttributes(i("."+bn,e),i("."+_n,e)),i("."+Dn+" input",e).val(t._getSelectedElementStyle()),t._selectedElementCanHaveChildren()?(n.show(),i("textarea",n).val(t._getSelectedElementInnerHTML())):n.hide()},e.prototype.submitTagInspectorDialog=function(){var t=this,e=t.dialog,n=t._getInspectElement(),o=i("."+bn,e),r=i("."+Dn+" input").val(),s=i("."+Cn+" textarea").val();try{i.each(i("input:checkbox",o),function(t,e){var o,r,s=i(e);s.is(":checked")&&(o=s.siblings("span").text(),o=o.substring(0,o.length-1),r=s.siblings("input:text").val(),i(n).attr(o,r))}),""!==i.trim(r)&&(n.style.cssText=r),t._selectedElementCanHaveChildren()&&i(n).html(s)}catch(a){}t._closeDialog(),t._addtoUndoBuffer(),t._setSaveBtnEnabled()},e.prototype.tagInspectorDialogSwitchAttList=function(t){var e=i("."+bn,this.dialog),n=!t.checked;i.each(i("input:text",e),function(t,e){""===i(e).val()&&i(e).parent("li")[n?"show":"hide"]()})},e.prototype._laySelectedElementAttributes=function(t,e){var n=this,o=n._getInspectElement(),r,s,a,l=this.localizeString("tagInspectorDialogSave","Save"),h="";if(o){switch(e.html(o.tagName),r=n._getDictionaryDeclare(),s=o.tagName.toLowerCase(),a=r[s],s){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":h+="<ul class='ui-helper-reset'>",i.each(a,function(t,e){var i=o.getAttribute(e)||"";h+="<li><span class='"+Ii+"'>",h+=e+":</span>",h+="<input type='text' value='"+i+"'/>",h+="<input type='checkbox' id='save"+t+"'/>",h+="<label for='save"+t+"'>"+l+"</label></li>"})}t.html(h)}},e.prototype._getSelectedElementStyle=function(){var t=this._getInspectElement();return t&&t.style?t.style.cssText||"":""},e.prototype._getSelectedElementInnerHTML=function(){var t=this._getInspectElement();return t?t.innerHTML:""},e.prototype._selectedElementCanHaveChildren=function(){return!i(this._getInspectElement()).is("input,hr,br,img")},e.prototype.initBackColorDialog=function(){this._initColorDialog("BackColor")},e.prototype.initForeColorDialog=function(){this._initColorDialog("ForeColor")},e.prototype._initColorDialog=function(t){var e=this,n=e.dialog,o=e._getDesignViewDocument(),r=o.queryCommandValue(t),s,l,h;n.delegate(yo,"click."+e.widgetName,function(i){e.submitColorDialog(t),e._onDesignViewBlur(i)}).delegate(vo,"click."+e.widgetName,function(){e._closeDialog()}),r&&(h=r.toString(),i.browser.mozilla&&"transparent"===h&&(h="#ffffff"),i.browser.msie&&(s=a(h),h="rgb("+(255&s)+", "+((65280&s)>>8)+", "+((16711680&s)>>16)+")"),0===h.indexOf("rgb(")?(l=h.substring(4,h.length-1).split(","),h=e._convertToWebColor(a(l[0]),a(l[1]),a(l[2]))):0===h.indexOf("rgba(")&&(l=h.substring(5,h.length-1).split(","),h=e._convertToWebColor(a(l[0]),a(l[1]),a(l[2]))),i("."+Tn+" input",n).attr("value",h)),i("."+jn,n).wijeditorcolorcanvas("."+Tn+" input",h)},e.prototype.submitColorDialog=function(t){var e=this,n=i("."+Tn+" input",e.dialog);e.setColor(t,n.val()),e._closeDialog()},e.prototype.setColor=function(t,e){var n=this,o=n._getDesignViewDocument(),r=n._getDesignViewWindow(),s;if(n._setIESelection(),i.browser.mozilla&&"BackColor"===t)s=r.getSelection(),n.insertHTML('<span style="background-color:'+e+';">'+s+"</span>");else{if(o.execCommand(t,!1,e),i.browser.msie){var a=o.selection.createRange().htmlText;a.indexOf("<U>")>=0&&a.indexOf("</U>")>=0&&(o.execCommand("Underline",!1,!1),o.execCommand("Underline")),a.indexOf("<STRIKE>")>=0&&a.indexOf("</STRIKE>")>=0&&(o.execCommand("StrikeThrough",!1,!1),o.execCommand("StrikeThrough"));
}"bbcode"===n.options.mode&&!i.browser.msie&&n._convertFontStyleToStandTag()}n._addtoUndoBuffer(),n._setSaveBtnEnabled()},e.prototype.initInsertTableDialog=function(){var t=this,e=t.dialog;e.delegate(yo,"click."+t.widgetName,function(e){t.submitInsertTableDialog(),t._onDesignViewBlur(e)}).delegate(So,"click."+t.widgetName,function(){t._closeDialog()}).delegate("."+On+" input:button","click."+t.widgetName,function(){t.showTableColorDialog(this)})},e.prototype.submitInsertTableDialog=function(){var t=this,e=t._getValuesFromTableDialog();e&&(t._insertTable(e),t._closeDialog())},e.prototype._insertTable=function(t){var e=this,n="",o,r;if(!t)return!1;for(e.focus(),n+='<table width="'+t.width+'" height="'+t.height+'" cellspacing="'+t.cspacing+'" cellpadding="'+t.cpadding+'" border="'+t.border+'" bgcolor="'+t.bgcolor+'" style="'+t.css+'">',o=0;o<t.rows;o++){for(n+="<tr>",r=0;r<t.cols;r++)n+="<td>Cell "+(o+1)+"-"+(r+1)+"</td>";n+="</tr>"}n+="</table>",(i.browser.mozilla||i.browser.msie&&a(i.browser.version)>=9)&&(n+="<br />"),e.insertHTML(n)},e.prototype.initEditTableDialog=function(){var t=this,e=t.dialog,n=t._getInspectElement(),o,r;if(e.delegate(yo,"click."+t.widgetName,function(e){t.submitEditTableDialog(),t._onDesignViewBlur(e)}).delegate(So,"click."+t.widgetName,function(){t._closeDialog()}).delegate("."+On+" input:button","click."+t.widgetName,function(){t.showTableColorDialog(this)}),n){try{o=n.rows,r=o.length>0?o[0].cells.length:0,o=o.length}catch(s){}i("."+kn+" input",e).val(o),i("."+Ln+" input",e).val(r),i("."+Pn+" input",e).val(n.getAttribute("width")),i("."+Mn+" input",e).val(n.getAttribute("height")),i("."+Fn+" input",e).val(n.getAttribute("border")),i("."+An+" input",e).val(n.getAttribute("cellPadding")),i("."+Bn+" input",e).val(n.getAttribute("cellSpacing")),i("."+On+" input",e).val(n.getAttribute("bgcolor")||"#ffffff"),i("."+Rn+" input",e).val(n.style.cssText)}},e.prototype.submitEditTableDialog=function(){var t=this,e=t._getInspectElement(),n=i(e),o=t._getValuesFromTableDialog(),r=o&&a(o.rows),s=o&&a(o.cols),l,h;if(o){if(e){if(n.attr("width",o.width),n.attr("height",o.height),n.attr("bgcolor",o.bgcolor),n.attr("border",o.border),n.attr("cellSpacing",o.cspacing),n.attr("cellPadding",o.cpadding),e.style.cssText=o.css,!r||isNaN(r))return;if(!s||isNaN(s))return;for(;e.rows.length>r;)e.deleteRow(0);for(;e.rows.length<r;)for(l=e.insertRow(0);l.cells.length<s;)h=l.insertCell(0),h.innerHTML="&nbsp;";i.each(e.rows,function(t,e){for(;e.cells.length>s;)e.deleteCell(0);for(;e.cells.length<s;)h=e.insertCell(0),h.innerHTML="&nbsp;"})}t._closeDialog()}},e.prototype._getValuesFromTableDialog=function(){var t=this,e=t.dialog,n=i("."+kn+" input",e).val(),r=i("."+Ln+" input",e).val(),s=i("."+Pn+" input",e).val(),l=i("."+Mn+" input",e).val(),h=i("."+Fn+" input",e).val(),d=i("."+An+" input",e).val(),c=i("."+Bn+" input",e).val(),u=i("."+Rn+" input",e).val(),p=i("."+On+" input",e).val();return t._isNumeric(n)?t._isNumeric(r)?t._isNumeric(s)?t._isNumeric(l)?t._isNumeric(h)?t._isNumeric(d)?t._isNumeric(c)?{rows:n,cols:r,width:a(s),height:a(l),border:h,cpadding:d,cspacing:c,css:u,bgcolor:p}:(o(this.localizeString("tableDialogCellSpacingError","Please input a number for 'Cell Spacing' textbox.")),!1):(o(this.localizeString("tableDialogCellPaddingError","Please input a number for 'Cell Padding' textbox.")),!1):(o(this.localizeString("tableDialogBorderError","Please input a number for 'Border thickness' textbox.")),!1):(o(this.localizeString("errorMessageTableHeightError","Please input a number for 'Table Height' textbox.")),!1):(o(this.localizeString("errorMessageTableWidthError","Please input a number for 'Table Width ' textbox.")),!1):(o(this.localizeString("errorMessageColumnsError","Please input a number for 'Columns' textbox.")),!1):(o(this.localizeString("errorMessageRowsError","Please input a number for 'Rows' textbox.")),!1)},e.prototype.showTableColorDialog=function(t){var e=this,n,o=e.subDialog,r=i(t).prev().val(),s=e._getDialogRes_Color();n={width:"auto",height:"auto",modal:!0,title:"Set Background Color",position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},o.empty().append(s),i.browser.msie&&6===a(i.browser.version)?window.setTimeout(function(){o.wijdialog(n)},0):o.wijdialog(n),o.delegate(_o,"click."+e.widgetName,function(){e.submitTableColorDialog()}).delegate(So,"click."+e.widgetName,function(){e.closeSubDialog()}),""!==r&&i("."+Tn+" input",o).val(r),i("."+jn,o).wijeditorcolorcanvas("."+Tn+" input",r),o.wijdialog("open")},e.prototype.submitTableColorDialog=function(){var t=this,e=t.subDialog,n=t.dialog,o=i("."+Tn+" input",e).val();i("."+On+" input:text",n).val(o),t.closeSubDialog()},e.prototype.closeSubDialog=function(){this.subDialog.wijdialog("close")},e.prototype._getEditableTable=function(){var t=this,e,n,r;if(n=t._getSelectedElement(),!n)return o(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;if(r=i(n),r.is("td,tr,tbody,th"))n=r.parents("table:first")[0];else if(!r.is("table")){if(e=r.find("table:only-child"),!i.browser.msie||!e.length)return o(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;n=e[0]}return y=n,!0},e.prototype.initPreviewDialog=function(){var t=this,e=t.dialog;t._setPreviewContent(0),e.delegate("#rad640_480","click."+t.widgetName,function(){t._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+t.widgetName,function(){t._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+t.widgetName,function(){t._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+t.widgetName,function(){t._splitPreviewPages(this.checked)}).delegate("."+Wn,"click."+t.widgetName,function(){t._printPreviewPage(!0)}).delegate("."+$n,"click."+t.widgetName,function(){t._printPreviewPage(!1)}).delegate("."+zn,"click."+t.widgetName,function(){t._closeDialog()}).delegate("."+Vn,"click."+t.widgetName,function(){t._navigatePreviewPage(!1)}).delegate("."+Hn,"click."+t.widgetName,function(){t._navigatePreviewPage(!0)})},e.prototype._setPreviewContent=function(t){var e=this,n=e.dialog,o=i("iframe",n),r=i("."+Nn+" span",n),s=o[0].contentWindow.document;s.open(),-1===t?(s.write(e._getPreviewAllPageContent()),r.html("1 / 1")):(s.write(e._getPreviewPageContent(t)),r.html(t+1+" / "+e._getPreviewPageCount())),s.close()},e.prototype._setPreviewDialogSize=function(t,e){var n=this,o=n.dialog,r=i("iframe",o),s=o.wijdialog("option","width"),a=o.wijdialog("option","height");"auto"===s?s=o.parent(".wijmo-wijdialog").width()-r.width():s-=r.width(),"auto"===a?a=o.parent(".wijmo-wijdialog").height()-r.height():a-=r.height(),r.css("width",t).css("height",e),o.wijdialog("option",{width:t+s,height:e+a})},e.prototype._getPreviewPageCount=function(){return this._getPreviewPages().length},e.prototype._getPreviewPageContent=function(t){var e=this._getPreviewPages();return e.length>t?e[t]:null},e.prototype._getPreviewAllPageContent=function(){return this._getDesignViewText()},e.prototype._getPreviewPages=function(){var t=this._getPreviewAllPageContent(),e=new RegExp("<(DIV|div)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>(.*?)<\\/(DIV|div)>","g"),i=t.replace(e,"!-~U^n#i@q,P|.a=g~e+br!");return i.split("!-~U^n#i@q,P|.a=g~e+br!")},e.prototype._splitPreviewPages=function(t){var e=this,n=e.dialog,o=i("."+Kn,n),r=i("."+Nn,n);t?(e._setPreviewContent(0),r.show(),o.hide()):(e._setPreviewContent(-1),r.hide(),o.show()),e._curPageIdx=0},e.prototype._navigatePreviewPage=function(t){var e=this,n=i("#chkSplit",e.dialog),o=e._curPageIdx,r=e._getPreviewPageCount();n.is(":checked")&&(t?(o++,r>o?e._setPreviewContent(o):o=r-1):(o--,o>=0?e._setPreviewContent(o):o=0),e._curPageIdx=o)},e.prototype._printPreviewPage=function(t){var e=this,n=e.dialog,o=i("#chkSplit",n),r=i("iframe",n)[0].contentWindow;t&&(o.removeAttr("checked"),e._setPreviewContent(-1)),r.focus(),r.print()},e.prototype.initCleanUpDialog=function(){var t=this,e=t.dialog;i("textarea",e).val(t.sourceView.val()),e.delegate(yo,"click."+t.widgetName,function(e){t.submitCleanUpDialog(),t._onDesignViewBlur(e)}).delegate(vo,"click."+t.widgetName,function(){t._closeDialog()})},e.prototype.submitCleanUpDialog=function(){var t=this,e=t.dialog,n=t.sourceView,o=n.val(),r;i("#replaceSpans",e).is(":checked")&&(r=new RegExp("<\\/?SPAN[^>]*>","g"),o=o.replace(r,"")),i("#replaceClass",e).is(":checked")&&(r=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g"),o=o.replace(r,"<$1$3")),i("#replaceStyle",e).is(":checked")&&(r=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g"),o=o.replace(r,"<$1$3"),r=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g"),o=o.replace(r,"<$1$3"),r=new RegExp("<\\\\?\\?xml[^>]*>","g"),o=o.replace(r,""),r=new RegExp("<\\/?\\w+:[^>]*>","g"),o=o.replace(r,"")),i("#replaceNbsp",e).is(":checked")&&(r=new RegExp("&nbsp;","g"),o=o.replace(r," ")),i("#transformPtoDiv",e).is(":checked")&&(r=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g"),o=o.replace(r,"<div$2</div>")),n.val(o),t._setDesignViewText(o),t._addtoUndoBuffer(),t._closeDialog()},e.prototype.initFindDialog=function(){var t=this,e=t.dialog;t.tRange&&(t.tRange=null),e.delegate(yo,"click."+t.widgetName,function(){t.submitFindAction()}).delegate(vo,"click."+t.widgetName,function(e){t.submitReplaceAction(),t._onDesignViewBlur(e)})},e.prototype.submitFindAction=function(){var t=this,e=i("textarea:first",t.dialog).val();""!==i.trim(e)&&t._findAndReplaceString(e)},e.prototype.submitReplaceAction=function(){var t=this,e=t.dialog,n=i("textarea:first",e).val(),r=i("textarea:last",e).val();if(""!==i.trim(n))return""===i.trim(r)?void o(this.localizeString("errorMessageReplaceStringError","please input replace string!")):void t._findAndReplaceString(n,r)},e.prototype._findAndReplaceString=function(t,e){var n=this,r=n._getDesignViewWindow(),s=0,a=!1,l,h=e&&e!==t;if(e||(e=t),i.browser.msie)n.tRange&&(n.txtFoundInIE&&h?(s=n.tRange.findText(t),s&&(n.tRange.pasteHTML(e),n.tRange.collapse(!1),a=!0,n.txtFoundInIE=!1)):(n.tRange.collapse(!1),s=n.tRange.findText(t),s&&n.tRange.select())),!a&&(!n.tRange||!s)&&(n.tRange=r.document.body.createTextRange(),s=n.tRange.findText(t),s&&(n.tRange.select(),h&&(n.tRange.pasteHTML(e),a=!0)));else{if(n.txtFoundInNoneIE&&h)n._replaceSelectionForNoneIE(e),a=!0,n.txtFoundInNoneIE=!1;else if(l=r.getSelection(),l.rangeCount>0&&l.collapseToEnd(),s=r.find(t),!s)for(s=r.find(t,0,1);r.find(t,0,1);)continue;n.txtFoundInNoneIE=n.txtFoundInNoneIE||s,n.txtFoundInNoneIE&&h&&(n._replaceSelectionForNoneIE(e),a=!0,n.txtFoundInNoneIE=!1)}s||a?n.txtFoundInIE=!0:(o('"'+t+'"'+this.localizeString("errorMessageFindTextError"," String Not Found!")),n.tRange=null,n.txtFoundInNoneIE=!1,n.txtFoundInIE=!1)},e.prototype._replaceSelectionForNoneIE=function(t){var e=this._getDesignViewDocument();e.execCommand("inserttext",!1,t)},e.prototype.initMediaDialog=function(){var t=this,e=t.dialog;e.delegate(yo,"click."+t.widgetName,function(e){t.submitMediaDialog(),t._onDesignViewBlur(e)}).delegate(vo,"click."+t.widgetName,function(){t._closeDialog()})},e.prototype.submitMediaDialog=function(){var t=this,e=t.dialog,n=i("select",e).val(),r=i("."+oo+" input",e).val(),s=i("."+ro+" input",e).val(),a=i("."+so+" input",e).val();return""===r?void o(this.localizeString("errorMessageUrlEmptyError","URL is empty!")):t._isUrl(r)?t._isNumeric(s)?t._isNumeric(a)?(t._insertMedia(n,r,s,a),void t._closeDialog()):void o(this.localizeString("errorMessageMediaHeightError","please input height of the media!")):void o(this.localizeString("errorMessageMediaWidthError","please input width of the media!")):void o(this.localizeString("errorMessageUrlCorrectError","please input correct URL!"))},e.prototype._insertMedia=function(t,e,i,n){var o=this,r="";switch(o._setIESelection(),t){case"video":r+='<embed src="'+e+'" width="'+i+'" height="'+n+'" type=audio/x-pn-realaudio-plugin console="Clip1" controls="IMAGEWINDOW,ControlPanel,StatusBar" autostart="true"></embed>';break;case"flash":r+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+i+'" height="'+n+'">',r+='<param name="movie" value="'+e+'">',r+='<param name="quality" value="high">',r+='<embed src="'+e+'" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="'+i+'" height="'+n+'"></embed>',r+="</object>";break;case"applet":r+='<applet code="'+e+'" width="'+i+'" height="'+n+'"></applet>';break;case"other":r+='<embed src="'+e+'" width="'+i+'" height="'+n+'"></embed>'}o.insertHTML(r)},e.prototype.initSpecialCharacterDialog=function(){var t=this,e=t.dialog,n=i("."+co+" span",e);e.delegate("label","click."+t.widgetName,function(e){t.submitSpecialCharacterDialog(this),t._onDesignViewBlur(e)}).delegate(yo,"click."+t.widgetName,function(){t._closeDialog()}).delegate("label","mouseover."+t.widgetName,function(){n.html(i(this).html())}).delegate("label","mouseout."+t.widgetName,function(){n.empty()})},e.prototype.submitSpecialCharacterDialog=function(t){var e=this;e._setIESelection(),e.insertHTML(i(t).html()),e._closeDialog()},e.prototype._setSaveBtnEnabled=function(){this.$ribbon.wijribbon(v,Pt,!1)},e.prototype._undoAction=function(){var t=this._getDesignViewDocument().body,e={};f--,0>=f&&(f=0),t.innerHTML=m[f],f?this.$ribbon.wijribbon(v,_t,!1):(e[vt]=!0,e[_t]=!1,this.$ribbon.wijribbon(_,e))},e.prototype._redoAction=function(){var t=this._getDesignViewDocument().body,e=m.length,i={};f++,f>=e-1&&(f=e-1),t.innerHTML=m[f],f===e-1?(i[vt]=!1,i[_t]=!0,this.$ribbon.wijribbon(_,i)):this.$ribbon.wijribbon(v,vt,!1)},e.prototype._addtoUndoBuffer=function(){var t=m.length-1-f,e;for(e=0;t>e;e++)m.pop();f++,m.push(this._getDesignViewText()),this.$ribbon.wijribbon(v,vt,!1)},e.prototype._deleteSelectionContent=function(){var t=this._getDesignViewWindow(),e,n,o,r="rangeCount";if(i.browser.msie)e=t.document.selection,"none"!==e.type.toLowerCase()&&e.clear();else for(e=t.getSelection(),n=0;n<e[r];n++)o=e.getRangeAt(n),o.deleteContents()},e.prototype._refreshPathSelector=function(){var t=this,e=t._getParentElement(t._getDesignViewWindow()),n,o=t._getPathSelector(),r=i(e).parents(),s=r.length,a="wijmo-wijeditor-label ui-state-default ui-corner-all",l;if(e){for(n=e.tagName?e.tagName.toLowerCase():"",o.empty(),l=s-1;l>=0;l--)o.append("<label class='"+a+"'>&lt;"+r[l].tagName.toLowerCase()+"&gt;</label>");o.append("<label class='"+a+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+n+"&gt;</label>")}},e.prototype._toggleTableBorders=function(){var t=this._getDesignViewDocument(),e=i("#__wijStyle",t);g=!g,i.browser.safari?g?e.html("table,td,tr{border: 1px #acacac dashed;}"):e.empty():e.prop("disabled",!g)},e.prototype._tableAction=function(t){var e=this,n=e._getParentElement(e._getDesignViewWindow()),r=i(n).closest("td"),s,a,l,h,d,c,u,p,g,f,m=0;if(e._setSaveBtnEnabled(),0===r.length&&t!==O)return!1;t!==O&&(s=r.parent(),a=s.closest("table"),l=r[0],h=s[0],d=a[0],c=h.rowIndex,u=l.cellIndex);try{switch(t){case A:for(p=h.cells.length,f=d.insertRow(c),m=0;p>m;m++)e._insertCell(f,m);break;case U:d.deleteRow(c);break;case F:for(g=d.rows.length,m=0;g>m;m++)e._insertCell(d.rows[m],u);break;case G:e._removeColumn(d,u);break;case B:e._insertCell(h,u+1);break;case N:p=h.cells.length,1===p?d.deleteRow(c):h.deleteCell(u);break;case R:e._splitCell(d,h,c,u);break;case O:e._mergeCell(e._getSelectedCells(n))}this._addtoUndoBuffer()}catch(w){return o(w.message),!1}return!0},e.prototype._removeColumn=function(t,e){for(var i=t.rows.length,n=0,o,r,s,a,l;i>n;)o=t.rows[n],r=o.cells,s=r.length,a=e>s-1?s-1:e,l=r[a].colSpan,l>1&&s>1&&(s>a+1?r[a+1].colSpan+=l-1:r[a-1].colSpan+=l+1),1===s?(t.deleteRow(n),i=t.rows.length):(o.deleteCell(a),n++)},e.prototype._splitCell=function(t,e,i,n){for(var o=t.rows.length,r=0,s=0,a,l,h,d,c;n>=r;)e.cells[r].colSpan>1&&(s+=e.cells[r].colSpan-1),r++;if(this._insertCell(e,n+1),e.cells[n].colSpan>1)e.cells[n].colSpan--;else for(h=0;o>h;h++)if(a=t.rows[h],h!==i){for(d=n,r=0,l=0;d>=r;)a.cells[r].colSpan>1&&(l+=a.cells[r].colSpan-1,d-=l),r++;c=n+s-l,0>c&&(c=0),a.cells[c].colSpan++}},e.prototype._mergeCell=function(t){var e=t.length,i,n,o,r;if(2>e||t[0].parentNode!==t[e-1].parentNode)return!1;for(i=t[0].parentNode,n=t[0].cellIndex,o=n+e,r=n+1;o>r;r++)i.cells[n].innerHTML+=i.cells[n+1].innerHTML,i.cells[n].colSpan++,i.deleteCell(n+1)},e.prototype._getSelectedCells=function(t){var e=this._getDesignViewWindow(),n=e.document,o=[],r,s,a,l,h,d,c,u;if(i.browser.msie)r=n.selection.createRange(),s=i(t).closest("tr")[0],s&&i.each(s.cells,function(t,e){var i=n.selection.createRange(),s="compareEndPoints";i.moveToElementText(e),(r.inRange(i)||r[s]("StartToStart",i)>=0&&r[s]("StartToEnd",i)<=0||r[s]("EndToStart",i)>=0&&r[s]("EndToEnd",i)<=0)&&o.push(e)});else if(i.browser.mozilla)for(a=e.getSelection(),h=a.rangeCount,l=0;h>l;l++)r=a.getRangeAt(l),d=r.startContainer,c=d.nodeName.toLowerCase(),"td"===c||"th"===c?o.push(d):"tr"===c&&(u=r.startOffset,o.push(d.cells[u]));else if(a=e.getSelection(),s=i(t).closest("tr")[0])for(h=s.cells.length,l=0;h>l;l++)o.push(s.cells[l]);return o},e.prototype.insertDateAndTime=function(){var t=new Date;this.options.culture&&""!==this.options.culture?this.insertHTML(Globalize.format(t,"dddd ",Globalize.findClosestCulture(this.options.culture))+Globalize.format(t,"F",Globalize.findClosestCulture(this.options.culture))):this.insertHTML(t.toDateString()+" "+t.toTimeString())},e.prototype._toggleWordWrap=function(){var t=this,e=t.sourceView,n="wrap",o;p=!p,o=p?"soft":"off",e.attr(n,o),e[0].focus(),i.browser.mozilla&&(e.hide(),r.setTimeout(function(){e.show()},40))},e.prototype.insertHTML=function(t){var e=this,n=e._getDesignViewDocument(),o;try{i.browser.msie?(o=n.selection.createRange(),o.pasteHTML(t),o.collapse(!1),o.select()):n.execCommand("insertHTML",!1,t)}catch(r){}e._addtoUndoBuffer(),e._setSaveBtnEnabled()},e.prototype._getSelectedContent=function(){var t=this._getDesignViewWindow(),e=t.document,i="",n="cloneContents",o,r,s;return e.selection?(o=e.selection.createRange(),o.htmlText):(o=t.getSelection().getRangeAt(0),o&&o[n]&&(r=o[n](),s=document.createElement("div"),s.appendChild(r),i=s.innerHTML,s=null),i||"")},e.prototype._setIESelection=function(){i.browser.msie&&w&&w.select()},e.prototype._setIEFocus=function(){var t=this._getDesignViewDocument();if(i.browser.msie)try{t.body.focus()}catch(e){}},e.prototype.focus=function(){var t=this._getDesignViewWindow(),e=t.document;i.browser.msie?w?w.select():e.body?e.body.focus():e.onreadystatechange=function(){"complete"===e.readyState&&e.body.focus()}:t.focus()},e.prototype._setFocusNotIE=function(){var t=this._getDesignViewWindow(),e=t.document;i.browser.msie||(i.browser.mozilla?t.focus():e.body&&e.body.focus())},e.prototype._getInspectElement=function(){return y||this._getSelectedElement()},e.prototype._getSelectedElement=function(){return this._getParentElement(this._getDesignViewWindow())},e.prototype._createElement=function(t,e,i){return new To(t,e,i)},e.prototype._createDiv=function(t,e){return this._createElement("div",{"class":t})},e.prototype._createSpan=function(t,e){var i=this;return e?0===t.length?i._createElement("span",e):this._createElement("span",e,{"class":t}):i._createElement("span",{"class":t})},e.prototype._createTextBox=function(t,e){var i={"class":t,type:"text",value:void 0};return e&&(i.value=e),this._createElement("input",i)},e.prototype._createLabel=function(t,e){return e?new To("label",t,{"for":e}):new To("label",t)},e.prototype._createRadio=function(t,e,i){var n={name:e,id:t,value:i,type:"radio"};return this._createElement("input",n)},e.prototype._createCheckbox=function(t){var e={type:"checkbox",id:t};return this._createElement("input","",e)},e.prototype._createSelect=function(t,e){var n=this,o={"class":t},r=n._createElement("select",o);return""===t&&(r=n._createElement("select")),i.each(e,function(t,e){i.isPlainObject(e)&&e.selected?r.add(n._createElement("option",e.text,{selected:"selected"})):r.add(n._createElement("option",e))}),r},e.prototype._createInputButton=function(t,e){var i={"class":t,type:"button",value:void 0};return e&&(i.value=e),this._createElement("input",i)},e.prototype._createTextField=function(t,e,i,n){var o=this,r=o._createDiv(e),s={type:"text",value:""};return n&&(s.value=n),r.add(o._createSpan(Ii,t)),r.add(o._createElement("input",s)),i&&r.add(new jo(i)),r},e.prototype._createSeparator=function(){var t=this,e=t._createDiv(bi);return e.add(t._createElement("hr")),e},e.prototype._createOKCancelButtons=function(){var t=this,e=t._createDiv(Ci);return e.add(t._createElement("input",{type:"button","class":Di,value:this.localizeString("dialogOK","OK")})),e.add(t._createElement("input",{type:"button","class":Di,engValue:"Cancel",value:this.localizeString("dialogCancel","Cancel")})),e},e.prototype._getDialogRes_Template=function(){var t=this,e=t._createDiv(Gi),i=t._createDiv(Ui),n=t._createDiv(Hi),o=t._createDiv(Wi),r=t._createDiv($i),s=t._createDiv(zi),a=t._createElement("div",this.localizeString("templateDialogName","Name :")),l=t._createElement("div",this.localizeString("templateDialogDescription","Description :")),h=t._createDiv(qi),d=t._createDiv(Qi);return i.add(t._createElement("div",this.localizeString("templateDialogSelectTemplate","Select Template:"),{"class":Ni})),i.add(t._createElement("div",this.localizeString("templateDialogTemplatePreview","Template Preview:"),{"class":Vi})),e.add(i),o.add(t._createElement("select",{size:8})),r.add(t._createElement("iframe",{frameborder:0})),n.add(o),n.add(r),e.add(n),a.add(t._createSpan(Ki)),l.add(t._createSpan(Yi)),s.add(a),s.add(l),e.add(s),h.add(t._createSpan(Ii,this.localizeString("templateDialogName","Name :"))),h.add(t._createTextBox(Xi)),h.add(t._createSpan(Ii,this.localizeString("templateDialogDescription","Description :"))),h.add(t._createTextBox(Ji)),e.add(h),d.add(t._createInputButton(Di+" "+Zi,this.localizeString("templateDialogDeleteSelected","Delete selected"))),d.add(t._createInputButton(Di+" "+tn,this.localizeString("templateDialogSaveCurrentPage","Save current page as template"))),e.add(d),e.add(t._createSeparator()),e.add(t._createOKCancelButtons()),e.render()},e.prototype._getDialogRes_ImageBrowser=function(){var t=this,e=t._createDiv(ji),i=t._createDiv(Ti),n=t._createDiv(Ei),o=t._createDiv(ki),r=t._createDiv(Li),s=t._createDiv(Pi);return n.add(t._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),Mi)),n.add(t._createTextField(this.localizeString("imageEditorDialogImageAltText","Image alt text:"),Fi)),n.add(t._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),Ai,this.localizeString("dialogPixel","px"))),n.add(t._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),Bi,this.localizeString("dialogPixel","px"))),n.add(t._createTextField(this.localizeString("imageEditorDialogCssText","Css text:"),Ri)),i.add(n),o.add(r),r.add(t._createElement("select",{size:8})),o.add(s),s.add(t._createElement("img",{src:"",alt:""})),i.add(o),i.add(t._createSeparator()),i.add(t._createOKCancelButtons()),e.add(i),e.render()},e.prototype._getDialogRes_Link=function(){var t=this,e=t._createDiv(en),n=t._createTextField(this.localizeString("hyperLinkDialogAddress","Address :"),nn),o=t._createDiv(on+" ui-helper-clearfix"),r=t._createElement("div"),s=t._createDiv(un),a=t._createDiv(pn),l=t._createElement("div"),h=[{id:"radUrl",value:"url",text:this.localizeString("hyperLinkDialogUrl","url")},{id:"radAnchor",value:"anchor",checked:!0,text:this.localizeString("hyperLinkDialogAnchor","anchor")},{id:"radMail",value:"email",text:this.localizeString("hyperLinkDialogEmail","email")}],d=[{id:"radLinkTypeIsText",value:"text",checked:!0,text:this.localizeString("hyperLinkDialogText","text")},{id:"radLinkTypeIsImage",value:"image",text:this.localizeString("hyperLinkDialogImage","image")}],c=[],u=t._createTextField(this.localizeString("hyperLinkDialogTextToDisplay","Text to display :"),sn),p=t._createSpan(Ii,this.localizeString("hyperLinkDialogIconType","Icon Type :")),g=t._createDiv(an),f=t._createSpan(Ii,this.localizeString("hyperLinkDialogTarget","Target :")),m=[{text:"_blank",selected:!0},"_parent","_self","_top"],w=t._createSelect(an,m),y=t._createTextField(this.localizeString("hyperLinkDialogCss","Css :"),ln),v;for(s.add(t._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),hn)),s.add(t._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),dn,this.localizeString("dialogPixel","px"))),s.add(t._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),cn,this.localizeString("dialogPixel","px"))),e.add(n),e.add(o),o.add(r),a.add(l),l.add(p),i.each(h,function(e,i){r.add(t._createRadio(i.id,"radioList",i.value)),r.add(t._createLabel(i.text,i.id))}),i.each(d,function(e,i){l.add(t._createRadio(i.id,"linkIconRadioList",i.value)),l.add(t._createLabel(i.text,i.id))}),v=1;8>v;v++)c.push("#anchor"+v.toString());return o.add(t._createSelect(rn,c)),e.add(t._createSeparator()),e.add(a),e.add(u),e.add(s),e.add(g),g.add(f),g.add(w),e.add(y),e.add(t._createSeparator()),e.add(t._createOKCancelButtons()),e.render()},e.prototype._getDialogRes_TagInspector=function(){var t=this,e=t._createDiv(wn),i=t._createDiv(yn),n=t._createDiv(Sn),o=t._createDiv(xn),r=t._createDiv(Cn);return e.add(i),i.add(t._createSpan(vn,this.localizeString("tagInspectorDialogSelectedTag","Selected tag :"))),i.add(t._createSpan(_n,"")),e.add(n),n.add(t._createCheckbox("displayNoEmpty")),n.add(t._createLabel(this.localizeString("tagInspectorDialogDisplayNotEmptyAttributes","Display not empty attributes only"),"displayNoEmpty")),e.add(o),o.add(t._createSpan(Ii,this.localizeString("tagInspectorDialogAttributes","Attributes:"))),o.add(t._createDiv(bn)),e.add(r),r.add(t._createSpan(Ii,this.localizeString("tagInspectorDialogInnerHTML","Inner HTML:"))),r.add(t._createElement("textarea")),e.add(t._createTextField(this.localizeString("tagInspectorDialogCSSText","Css Text:"),Dn)),e.add(t._createSeparator()),e.add(t._createOKCancelButtons()),e.render()},e.prototype._getDialogRes_Color=function(){return this._getDialogRes_CommonColor("#FFFFFF")},e.prototype._getDialogRes_ForeColor=function(){return this._getDialogRes_CommonColor("#000000")},e.prototype._getDialogRes_BackColor=function(){return this._getDialogRes_CommonColor("#FFFFFF")},e.prototype._getDialogRes_CommonColor=function(t){var e=this,i=e._createDiv(In),n=e._createDiv(Tn);return i.add(e._createDiv(jn)),i.add(n),n.add(e._createSpan(Ii,this.localizeString("backColorDialogSelectedColor","Selected Color:"))),n.add(e._createElement("input",{type:"text",value:t})),i.add(e._createSeparator()),i.add(e._createOKCancelButtons()),i.render()},e.prototype._getDialogRes_Table=function(){var t=this,e=t._createDiv(En),i=t._createDiv(On);return e.add(t._createTextField(this.localizeString("tableDialogRows","Rows :"),kn,"",3)),e.add(t._createTextField(this.localizeString("tableDialogColumns","Columns :"),Ln,"",3)),e.add(t._createTextField(this.localizeString("tableDialogTableWidth","Table Width :"),Pn,this.localizeString("tableDialogPixels","pixels"),200)),e.add(t._createTextField(this.localizeString("tableDialogTableHeight","Table Height :"),Mn,this.localizeString("tableDialogPixels","pixels"),200)),e.add(t._createTextField(this.localizeString("tableDialogBorder","Border thickness:"),Fn)),e.add(t._createTextField(this.localizeString("tableDialogCellPadding","Cell Padding :"),An)),e.add(t._createTextField(this.localizeString("tableDialogCellSpacing","Cell Spacing :"),Bn)),e.add(t._createTextField(this.localizeString("tableDialogCssText","Css Text :"),Rn)),e.add(i),i.add(t._createSpan(Ii,this.localizeString("tableDialogBackgroundColor","Background Color:"))),i.add(t._createElement("input",{type:"text"})),i.add(t._createElement("input",{type:"button",value:"..."})),e.add(t._createSeparator()),e.add(t._createOKCancelButtons()),e.render()},e.prototype._getDialogRes_Preview=function(){var t=this,e=t._createDiv(Gn),i=t._createDiv(Un),n=t._createDiv(Ci),o=t._createDiv(Nn),r=t._createDiv(Yn);return e.add(i),i.add(t._createSpan(Ii,this.localizeString("previewDialogPreviewSize","Preview Size:"))),i.add(t._createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"})),i.add(t._createLabel("640x480","rad640_480")),i.add(t._createElement("input",{id:"rad800_600",name:"preview",type:"radio"})),i.add(t._createLabel("800x600","rad800_600")),i.add(t._createElement("input",{id:"rad1024_768",name:"preview",type:"radio"})),i.add(t._createLabel("1024x768","rad1024_768")),i.add(t._createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"})),i.add(t._createLabel(this.localizeString("previewDialogSplit","Split pages"),"chkSplit")),e.add(t._createSeparator()),e.add(n),n.add(t._createInputButton(Di+" "+Wn,this.localizeString("previewDialogPrintAll","Print All"))),n.add(t._createInputButton(Di+" "+$n,this.localizeString("previewDialogPrintPage","Print Page"))),n.add(t._createInputButton(Di+" "+zn,this.localizeString("dialogOK","OK"))),e.add(t._createSeparator()),e.add(o),o.add(t._createElement("a",this.localizeString("previewDialogPrevPage","Prev page"),{"class":Vn,href:"#"})),o.add(t._createElement("span","1 / 1")),o.add(t._createElement("a",this.localizeString("previewDialogNextPage","Next page"),{"class":Hn,href:"#"})),e.add(t._createDiv(Kn)),e.add(r),r.add(t._createElement("iframe",{src:"about:blank"})),e.render()},e.prototype._getDialogRes_CleanUp=function(){var t=this,e=t._createDiv(qn),n=t._createDiv(Xn),o=t._createDiv(Jn),r=t._createDiv(Qn),s=[{id:"replaceSpans",label:this.localizeString("cleanUpDialogStripSpanTag","Strip SPAN tag")},{id:"replaceClass",label:this.localizeString("cleanUpDialogStripClass","Strip CLASS tag")},{id:"replaceStyle",label:this.localizeString("cleanUpDialogStripStyle","Strip STYLE attribute")},{id:"replaceNbsp",label:this.localizeString("cleanUpDialogReplaceSymbol","Replace &amp;nbsp; symbol")},{id:"transformPtoDiv",label:this.localizeString("cleanUpDialogTransformParagraphToDIV","Transform Paragraph to DIV")}];return e.add(n),n.add(t._createSpan(Ii,this.localizeString("cleanUpDialogDocumentSource","Document source :"))),e.add(o),o.add(t._createElement("textarea",{readonly:"readonly"})),e.add(r),i.each(s,function(e,i){r.add(t._createCheckbox(i.id)),r.add(t._createLabel(i.label,i.id))}),e.add(t._createSeparator()),e.add(t._createOKCancelButtons()),e.render()},e.prototype._getDialogRes_FindAndReplace=function(){var t=this,e=t._createDiv(Zn),i=t._createDiv(to),n=t._createDiv(eo),o=t._createDiv(Ci);return e.add(i),i.add(t._createSpan(Ii,this.localizeString("findAndReplaceFind","Find:"))),i.add(t._createElement("textarea","text")),e.add(n),n.add(t._createSpan(Ii,this.localizeString("findAndReplaceReplace","Replace:"))),n.add(t._createElement("textarea")),e.add(t._createSeparator()),e.add(o),o.add(t._createInputButton(Di,this.localizeString("findAndReplaceFindButton","Find"))),o.add(t._createInputButton(Di,this.localizeString("findAndReplaceReplaceButton","Replace"))),e.render()},e.prototype._getDialogRes_Media=function(){var t=this,e=t._createDiv(io),i=t._createDiv(no);return e.add(i),i.add(t._createSpan(Ii,this.localizeString("mediaDialogMediaType","Media Type :"))),i.add(t._createSelect("",["flash","video","applet","other"])),e.add(t._createTextField(this.localizeString("mediaDialogMediaUrl","Media Url :"),oo)),e.add(t._createTextField(this.localizeString("mediaDialogWidth","Width :"),ro,this.localizeString("dialogPixel","px"),200)),e.add(t._createTextField(this.localizeString("mediaDialogHeight","Height :"),so,this.localizeString("dialogPixel","px"),200)),e.add(t._createSeparator()),e.add(t._createOKCancelButtons()),e.render()},e.prototype._getDialogRes_SpecialCharacter=function(){var t=this,e=t._createDiv(ao),n=t._createDiv(lo),o=t._createDiv(ho),r=t._createDiv(co),s=t._createDiv(uo),a=t._createDiv(po,"Punctuation"),l=t._createDiv(go),h=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],d=t._createDiv(po,"Symbols"),c=t._createDiv(fo),u=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],p=t._createDiv(po,"Diacritics"),g=t._createDiv(mo),f=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],m=t._createDiv(Ci);
return e.add(n),n.add(o),o.add(r),r.add(new To("span")),n.add(s),s.add(a),a.add(l),i.each(h,function(e,i){l.add(t._createLabel(i))}),s.add(d),d.add(c),i.each(u,function(e,i){c.add(t._createLabel(i))}),s.add(p),p.add(g),i.each(f,function(e,i){g.add(t._createLabel(i))}),e.add(t._createSeparator()),m.add(t._createInputButton(Di,"Cancel")),e.add(m),e.render()},e.prototype._copyFromClipboard=function(){var t,e,n,o;if(r.clipboardData)return r.clipboardData.getData("Text");if(i.browser.mozilla){try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(s){}return t=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),t?(e=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable),e?(e.addDataFlavor("text/unicode"),t.getData(e,t.kGlobalClipboard),e.getTransferData("text/unicode",n,o),n&&(n=n.value.QueryInterface(Components.interfaces.nsISupportsString)),n?n.data.substring(0,o.value/2):""):!1):!1}},e.prototype._copyToClipboard=function(t){var e,n,s,a={},l={};if(r.clipboardData&&t)r.clipboardData.setData("Text",t);else if(i.browser.mozilla)try{if(netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),e=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard),!e)return;if(n=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable),!n)return;if(n.addDataFlavor("text/unicode"),l={},a=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),a.data=t,n.setTransferData("text/unicode",a,2*t.length),s=Components.interfaces.nsIClipboard,!e)return!1;e.setData(n,null,s.kGlobalClipboard)}catch(h){a="Copy text to Clipboard \n",a+="If you are using firefox please do the following :\n ",a+="1. Write in your url box : 'about:config'\n",a+="2. Change signed.applets.codebase_principal_support = true\n",o(this.localizeString("errorMessageCopyToClipboardError",a))}},e.prototype.fixAbsoluteUrlsIfNeeded=function(t){var e=this,i=s.URL,n=s.URL,o=s.URL,r=!1,a=n.length,l=t,h,d,c,u,p,g,f,m;for(f=a-1;f>0;f--)if(h=n.charAt(f),d=n.charAt(f-1),"/"===h||"\\"===h){if(h===d)break;o=n.substring(0,f)+h,r||(n=o,r=!0)}return c=e._prepareLiteralRegexText(i+"?"),u=new RegExp(c,"g"),l=l.replace(u,"?"),p=e._prepareLiteralRegexText(n),u=new RegExp(p,"g"),l=l.replace(u,""),g=e._prepareLiteralRegexText(o),u=new RegExp(g,"g"),l=l.replace(u,"/"),m=l.indexOf("#"),m>-1&&(l=l.substr(m)),l},e.prototype._insertCell=function(t,e){var i=t.insertCell(e);return i.innerHTML="&nbsp;",i},e.prototype._getDictionaryDeclare=function(){var t={};return t.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"],t.b=["class","dir","id","lang","title"],t.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"],t.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"],t.code=["class","dir","id","lang","title"],t.div=["align","class","dir","id","lang","title"],t.em=["class","dir","id","lang","title"],t.font=["class","color","dir","face","id","lang","pointsize","size","title"],t.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"],t.hr=["align","class","color","id","noshade","size","title","width"],t.i=["class","dir","id","lang","title"],t.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"],t.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"],t.label=["accesskey","class","dir","for","id","lang","title"],t.li=["class","dir","id","lang","title","type","value"],t.ol=["class","compact","dir","id","lang","start","title","type"],t.option=["class","dir","disabled","id","label","lang","selected","title","value"],t.p=["align","class","dir","id","lang","title"],t.span=["class","dir","id","lang","title"],t.strong=["class","dir","id","lang","title"],t.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"],t.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"],t.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],t.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],t.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"],t.tbody=["align","bgColor","class","dir","id","lang","title","valign"],t.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"],t.u=["class","id","xml:lang"],t.ul=["class","compact","dir","id","lang","title","type"],t},e.prototype._getParentElement=function(t){var e=this,i=e._getRange(t),n,o,r,s,a;return i?i.commonAncestorContainer?(n=t.getSelection(),o=i.startContainer||n.baseNode,r=i.endContainer||n.extentNode,s=i.startOffset,null===s&&(s=n.baseOffset),a=i.endOffset,null===a&&(a=n.extentOffset),o===r&&a-s===1?n.anchorNode.childNodes[n.anchorOffset]:i.commonAncestorContainer.tagName?i.commonAncestorContainer:t.document===i.commonAncestorContainer&&n.baseNode?n.baseNode.parentNode:i.commonAncestorContainer.parentNode):i.length?i.item(0):i.parentElement?i.parentElement():null:null},e.prototype._getRange=function(t){var e,i;return t.document.selection&&!r.opera?t.document.selection.createRange():t.getSelection?(e=t.getSelection(),!e||e.rangeCount<1?null:i=e.getRangeAt?e.getRangeAt(0):t.document.createRange()):void 0},e.prototype._generateUniqueName=function(t){var e=c[t];return e||(e=0),c[t]=++e,t+e},e.prototype._setContentEditable=function(t,e){var n="designMode",o="contentEditable";try{t.body[o]&&(t.body[o]=e.toString()),t[n]&&(e||"off"===t[n]?e&&"on"!==t[n]&&(i.browser.msie&&a(i.browser.version)>=9||(t[n]="on")):t[n]="off"),e&&!i.browser.msie&&t.execCommand("useCSS",!1,!0)}catch(r){}},e.prototype._setContentSpellCheck=function(t,e){var i="spellcheck";try{void 0!==t.body[i]&&(t.body[i]=e)}catch(n){}},e.prototype._formatString=function(t,e){var i=t.length,n;for(n=0;e-i>n;n++)t="0"+t;return t},e.prototype._convertToWebColor=function(t,e,i){var n=this,o,r,s,l;return(isNaN(t)||0>255-t)&&(t=0),(isNaN(e)||0>255-e)&&(e=0),(isNaN(i)||0>255-i)&&(i=0),o=n._formatString(a(t).toString(16),2),r=n._formatString(a(e).toString(16),2),s=n._formatString(a(i).toString(16),2),l="#"+o+r+s},e.prototype._prepareLiteralRegexText=function(t){var e=t;return e=e.replace("\\","\\\\"),e=e.replace(".","\\."),e=e.replace("?","\\?")},e.prototype._isNumeric=function(t){return new RegExp("^\\d+$").test(t)},e.prototype._isEmail=function(t){return new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+").test(t)},e.prototype._isUrl=function(t){return new RegExp("[a-zA-z]+://[^s]+").test(t)},e.prototype.refresh=function(){var t=this,e=t._getDesignViewDocument(),n=t.element,o=t._getHeader(),r=t._getFooter(),s=t._oriEleWidth,a=t._oriEleHeight,l=t._getContent(),h;t.editor.width(s).height(a),this.$ribbon.wijribbon("updateRibbonSize"),window.setTimeout(function(){h=t.editor.height()-o.outerHeight(!0)-r.outerHeight(!0),l.height(h),l.data("wijmoWijsplitter")&&l.wijsplitter("refresh")},0),i.browser.mozilla?setTimeout(t._setDesignModeForFF,1e3,t):t._setContentEditable(e,!0)},e.prototype.getText=function(){var t=this;return t._getDesignViewText()},e.prototype.setText=function(t){var e=this;t&&(e._setDesignViewText(t),e.sourceView.val(t))},e.prototype.localizeString=function(t,e){var i=this.options;return i.localization&&i.localization[t]?i.localization[t]:e},e}(t.wijmoWidget);e.wijeditor=Eo;var ko=function(){function t(){this.initSelector=":jqmData(role='wijeditor')",this.fullScreenContainerSelector="",this.editorMode="wysiwyg",this.fullScreenMode=!1,this.showPathSelector=!0,this.mode="ribbon",this.commandButtonClick=null,this.simpleModeCommands=null,this.showFooter=!0,this.customContextMenu=!0,this.text=null,this.textChanged=null,this.localization=null}return t}();Eo.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new ko),i.wijmo.registerWidget("wijeditor",Eo.prototype);var Lo=fi+"-colorcanvas",Po=fi+"-color",Mo=fi+"-wheel",Fo=fi+"-overlay",Ao=fi+"-marker";i.fn.wijeditorcolorcanvas=function(t,e){var i=this.get(0);return i.wijeditorcolorcanvas||(i.wijeditorcolorcanvas=new Bo(i,t,e))};var Bo=function(){function t(t,e,n){var o=this,r="",l,h;h="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ",r+="<div class='"+Lo+"'>",r+="<div class='"+Po+"'></div>",r+="<div class='"+Mo+"'></div>",r+="<div class='"+Fo+"'></div>",r+="<div class='h-marker "+Ao+"'></div>",r+="<div class='sl-marker "+Ao+"'></div></div>",i(t).html(r),l=i("."+Lo,t),o.wheel=i("."+Mo,t).get(0),o.radius=84,o.square=100,o.width=194,i.browser.msie&&parseInt(i.browser.version,10)<7&&i("*",l).each(function(){var t=this,e=t.currentStyle.backgroundImage;return"none"!==e&&(e=e.substring(5,e.length-2),i(t).css({backgroundImage:"none",filter:h+"src='"+e+"')"})),this}),o.linkTo=function(t){return"object"==typeof o.callback&&i(o.callback).unbind("keyup",o.updateValue),o.color=null,"function"==typeof t?o.callback=t:("object"==typeof t||"string"==typeof t)&&(o.callback=i(t),o.callback.bind("keyup",o.updateValue),o.callback.get(0).value&&o.setColor(o.callback.get(0).value)),this},o.updateValue=function(t){var e=this;e.value&&e.value!==o.color&&o.setColor(e.value)},o.setColor=function(t){var e=o.unpack(t);return o.color!==t&&e&&(o.color=t,o.rgb=e,o.hsl=o.RGBToHSL(o.rgb),o.updateDisplay()),this},o.setHSL=function(t){return o.hsl=t,o.rgb=o.HSLToRGB(t),o.color=o.pack(o.rgb),o.updateDisplay(),this},o.widgetCoords=function(t){var e,n,r,s,a;return r=t.target||t.srcElement,s=o.wheel,a=o.absolutePosition(s),e=(t.pageX||0*(t.clientX+i("html").get(0).scrollLeft))-a.x,n=(t.pageY||0*(t.clientY+i("html").get(0).scrollTop))-a.y,{x:e-o.width/2,y:n-o.width/2}},o.mousedown=function(t){s.dragging||(i(s).bind("mousemove",o.mousemove).bind("mouseup",o.mouseup),s.dragging=!0);var e=o.widgetCoords(t);return o.circleDrag=2*Math.max(Math.abs(e.x),Math.abs(e.y))>o.square,o.mousemove(t),!1},o.mousemove=function(t){var e=o.widgetCoords(t),i,n,r;return o.circleDrag?(i=Math.atan2(e.x,-e.y)/6.28,0>i&&(i+=1),o.setHSL([i,o.hsl[1],o.hsl[2]])):(n=Math.max(0,Math.min(1,-(e.x/o.square)+.5)),r=Math.max(0,Math.min(1,-(e.y/o.square)+.5)),o.setHSL([o.hsl[0],n,r])),!1},o.mouseup=function(){i(s).unbind("mousemove",o.mousemove).unbind("mouseup",o.mouseup),s.dragging=!1},o.updateDisplay=function(){var t=6.28*o.hsl[0],e;i(".h-marker",l).css({left:Math.round(Math.sin(t)*o.radius+o.width/2)+"px",top:Math.round(-Math.cos(t)*o.radius+o.width/2)+"px"}),i(".sl-marker",l).css({left:Math.round(o.square*(.5-o.hsl[1])+o.width/2)+"px",top:Math.round(o.square*(.5-o.hsl[2])+o.width/2)+"px"}),i("."+Po,l).css("backgroundColor",o.pack(o.HSLToRGB([o.hsl[0],1,.5]))),"object"==typeof o.callback?(i(o.callback).css({backgroundColor:o.color,color:o.hsl[2]>.5?"#000":"#fff"}),i(o.callback).each(function(){return e=this,e.value&&e.value!==o.color&&(e.value=o.color),this})):"function"==typeof o.callback&&o.callback.call(o,o.color)},o.absolutePosition=function(t){var e={x:t.offsetLeft,y:t.offsetTop},i;return t.offsetParent&&(i=o.absolutePosition(t.offsetParent),e.x+=i.x,e.y+=i.y),e},o.pack=function(t){var e=Math.round(255*t[0]),i,n;return i=Math.round(255*t[1]),n=Math.round(255*t[2]),"#"+(16>e?"0":"")+e.toString(16)+(16>i?"0":"")+i.toString(16)+(16>n?"0":"")+n.toString(16)},o.unpack=function(t){return 7===t.length?[a("0x"+t.substring(1,3))/255,a("0x"+t.substring(3,5))/255,a("0x"+t.substring(5,7))/255]:4===t.length?[a("0x"+t.substring(1,2))/15,a("0x"+t.substring(2,3))/15,a("0x"+t.substring(3,4))/15]:void 0},o.HSLToRGB=function(t){var e,i,n,o,r,s=this;return n=t[0],o=t[1],r=t[2],i=.5>=r?r*(o+1):r+o-r*o,e=2*r-i,[s.hueToRGB(e,i,n+.33333),s.hueToRGB(e,i,n),s.hueToRGB(e,i,n-.33333)]},o.hueToRGB=function(t,e,i){return i=0>i?i+1:i>1?i-1:i,1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(.66666-i)*6:t},o.RGBToHSL=function(t){var e,i,n,o,r,s,a,l,h;return a=t[0],l=t[1],h=t[2],e=Math.min(a,Math.min(l,h)),i=Math.max(a,Math.max(l,h)),n=i-e,s=(e+i)/2,r=0,s>0&&1>s&&(r=n/(.5>s?2*s:2-2*s)),o=0,n>0&&(i===a&&i!==l&&(o+=(l-h)/n),i===l&&i!==h&&(o+=2+(h-a)/n),i===h&&i!==a&&(o+=4+(a-l)/n),o/=6),[o,r,s]},i("*",l).mousedown(o.mousedown),o.setColor(n||"#000000"),e&&o.linkTo(e)}return t}();e._wijeditorcolorcanvas=Bo}(t.editor||(t.editor={}));var e=t.editor}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){var i=this,n=jQuery,o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._setOption=function(e,i){var o=this.options,r=n("."+o.wijCSS.wijratingResetButton,this.ratingElement[0]),s=n("."+o.wijCSS.wijratingStarContainer,this.ratingElement[0]),a=n("."+o.wijCSS.wijratingNormalStar,this.ratingElement[0]);if(n.isPlainObject(o[e])){switch(e){case"resetButton":"undefined"!=typeof i.disabled&&i.disabled!==o[e].disabled&&(i.disabled?(r.hide(),r.attr("aria-hidden",!0)):o.disabled||(r.show(),r.attr("aria-hidden",!1))),"undefined"!=typeof i.hint&&i.hint!==o[e].hint&&(null===i.hint?r.attr("title",""):r.attr("title",i.hint)),i.position&&i.position.length&&i.position!==o[e].position&&("rightOrBottom"===i.position?r.parent().append(r):r.parent().prepend(r)),"undefined"!=typeof i.customizedClass&&i.customizedClass!==o[e].customizedClass&&(o[e].customizedClass.length&&r.removeClass(o[e].customizedClass),i.customizedClass.length&&r.addClass(i.customizedClass));break;case"hint":"undefined"!=typeof i.disabled&&i.disabled!==o[e].disabled&&(i.disabled?a.removeAttr("title"):this._resetHint(o.hint.content)),"undefined"!=typeof i.content&&i.content!==o[e].content&&(o[e].disabled||this._resetHint(i.content));break;case"icons":"undefined"!=typeof i.iconsClass&&(o[e].iconsClass&&o[e].iconsClass.length&&this._removeCustomizedIconsClass(o[e].iconsClass),this._addCustomizedIconsClass(i.iconsClass,o.split)),"undefined"!=typeof i.hoverIconsClass&&o[e].hoverIconsClass&&o[e].hoverIconsClass.length&&this._removeCustomizedIconsClass(o[e].hoverIconsClass),"undefined"!=typeof i.ratedIconsClass&&(o[e].ratedIconsClass&&o[e].ratedIconsClass.length&&this._removeCustomizedIconsClass(o[e].ratedIconsClass),this._resetValue(o.value,o.ratingMode,i.ratedIconsClass))}n.extend(!0,o[e],i)}else{if(i===o[e])return;switch(e){case"disabled":i?(this._unbindLiveEvents(),r.hide(),r.attr("aria-hidden",!0)):(this._bindLiveEvents(),o.resetButton.disabled||(r.show(),r.attr("aria-hidden",!1)));break;case"count":this._createStars(o.split,i,s);break;case"split":this._createStars(i,o.count,s);break;case"totalValue":this._resetTotalValue(i);break;case"orientation":"vertical"===i?this.ratingElement.addClass(o.wijCSS.wijvRating):this.ratingElement.removeClass(o.wijCSS.wijvRating),o.split>1&&(o[e]=i,this._createStars(o.split,o.count,s));break;case"direction":o[e]=i,this._createStars(o.split,o.count,s);break;case"ratingMode":this._resetValue(o.value,i,o.icons.ratedIconsClass);break;case"value":if(o.min&&i<o.min)return;if(o.max&&i>o.max)return;this._resetValue(i,o.ratingMode,o.icons.ratedIconsClass);break;case"iconWidth":o[e]=i,this._createStars(o.split,o.count,s);break;case"iconHeight":o[e]=i,this._createStars(o.split,o.count,s)}t.prototype._setOption.call(this,e,i)}},e.prototype._create=function(){var e=this.options,i;if(this.element.is("select"))this._parseSelect(),this.element.hide(),i=n("<div></div>"),this.element.after(i);else{if(!this.element.is("div"))return;this.element.children("input[type='radio']").length>0?(this._parseRadio(),this.element.hide(),i=n("<div></div>"),this.element.after(i)):i=this.element}this.ratingElement=i,this._createRating(),e.disabled||this._bindLiveEvents(),t.prototype._create.call(this)},e.prototype.destroy=function(){var e=this.options;this._unbindLiveEvents(),this.element!==this.ratingElement?(this.ratingElement.remove(),this.element.show()):this.element.removeClass(e.wijCSS.widget).removeClass(e.wijCSS.wijrating).removeClass(e.wijCSS.wijvRating).empty(),t.prototype.destroy.call(this)},e.prototype._unbindLiveEvents=function(){var t=this.options;this.ratingElement.off(".wijrating","."+t.wijCSS.wijratingNormalStar).off(".wijrating","."+t.wijCSS.wijratingResetButton)},e.prototype._bindLiveEvents=function(){var t=this,e=t.options,i="."+e.wijCSS.wijratingNormalStar,o="."+e.wijCSS.wijratingResetButton,r,s={element:t.ratingElement,mouseover:function(o){var s=n(o.target),a=n(i,t.ratingElement[0]);s.is(i)&&(a.removeClass(e.wijCSS.wijratingHoverStar),s.addClass(e.wijCSS.wijratingHoverStar),"continuous"===e.ratingMode&&("reversed"===e.direction?s.parent().nextAll().children().addClass(e.wijCSS.wijratingHoverStar):s.parent().prevAll().children().addClass(e.wijCSS.wijratingHoverStar)),t._addCustomizedHoverIconsClass(e.icons.hoverIconsClass,e.split,s),r={value:parseFloat(s.html()),target:s},t._trigger("hover",o,r))},mouseout:function(o){var r=n(o.target),s=n(i,t.ratingElement[0]);r.is(i)&&(s.removeClass(e.wijCSS.wijratingHoverStar),t._removeCustomizedIconsClass(e.icons.hoverIconsClass))},click:function(o){var s=n(o.target),a=parseFloat(s.html()),l=n(i,t.ratingElement[0]),h={duration:500,easing:null,delay:250,animated:null},d=n.wijmo.wijrating.animations,c;return n.extend(!0,h,e.animation),c=h.animated,s.is(i)&&!(e.max&&a>e.max||e.min&&a<e.min)?(r={oldValue:e.value,newValue:a,target:s},t._trigger("rating",o,r)===!1?!1:(e.value=a,t._resetValue(a,e.ratingMode,e.icons.ratedIconsClass),l.removeClass(e.wijCSS.wijratingHoverStar),t._removeCustomizedIconsClass(e.icons.hoverIconsClass),r={value:a,target:s},c?d&&d[c]?d[c](e,l,function(){t._trigger("rated",o,r)}):n.effects&&(n.effects[c]||n.effects.effect&&n.effects.effect[c])?t._playJqueryAnimation(h,l,function(){n.browser.msie&&parseInt(n.browser.version)<9&&l.css("filter",""),t._trigger("rated",o,r)}):t._trigger("rated",o,r):t._trigger("rated",o,r),void 0)):void 0}},a={element:t.ratingElement,mouseover:function(t){var i=n(t.target);i=i.closest("."+e.wijCSS.wijratingResetButton),i.addClass(e.wijCSS.wijratingHoverResetButton).addClass(e.wijCSS.stateHover),e.resetButton.customizedHoverClass&&e.resetButton.customizedHoverClass.length&&i.addClass(e.resetButton.customizedHoverClass)},mouseout:function(t){var i=n(t.target);i=i.closest("."+e.wijCSS.wijratingResetButton),i.removeClass(e.wijCSS.wijratingHoverResetButton).removeClass(e.wijCSS.stateHover),e.resetButton.customizedHoverClass&&e.resetButton.customizedHoverClass.length&&i.removeClass(e.resetButton.customizedHoverClass)},click:function(e){var i=n(e.target);t._setOption("value",0),r={target:i},t._trigger("reset",e,r)}};this.ratingElement.on("mouseover.wijrating",i,n.proxy(s.mouseover,s)).on("mouseout.wijrating",i,n.proxy(s.mouseout,s)).on("click.wijrating",i,n.proxy(s.click,s)).on("mouseover.wijrating",o,n.proxy(a.mouseover,a)).on("mouseout.wijrating",o,n.proxy(a.mouseout,a)).on("click.wijrating",o,n.proxy(a.click,a))},e.prototype._createRating=function(){var t=this.ratingElement,e=this.options,i,o,r;t.addClass(e.wijCSS.wijrating).addClass(e.wijCSS.widget),"vertical"===e.orientation&&t.addClass(e.wijCSS.wijvRating),i=n("<div></div>").addClass(e.wijCSS.wijratingResetButton).addClass(e.wijCSS.cornerAll).addClass(e.wijCSS.stateDefault),e.resetButton.customizedClass&&e.resetButton.customizedClass.length&&i.addClass(e.resetButton.customizedClass),i.appendTo(t),i.attr("role","button").attr("aria-label","reset").attr("aria-hidden",!1),e.resetButton.hint&&e.resetButton.hint.length&&i.attr("title",e.resetButton.hint),(e.resetButton.disabled||e.disabled)&&(i.hide(),i.attr("aria-hidden",!0)),o=n("<span></span>"),o.addClass(e.wijCSS.icon).addClass(e.wijCSS.iconClose),i.append(o),r=n("<div></div>"),r.attr("role","radiogroup").addClass(e.wijCSS.wijratingStarContainer),"leftOrTop"===e.resetButton.position?r.appendTo(t):r.prependTo(t),this._createStars(e.split,e.count,r)},e.prototype._createStars=function(t,e,i){var o=this.options,r=o.hint,s,a,l,h=0,d=0,c=0,u=Math.ceil(o.iconWidth/t),p=Math.ceil(o.iconHeight/t),g=o.icons.ratedIconsClass,f,m,w=g&&g.length;for(i.empty(),d;e*t>d;d++,c++)l=Math.round((d+1)*o.totalValue*100/e/t)/100,h=Math.round((d+2)*o.totalValue*100/e/t)/100,c===t&&(c=0),a=n("<div></div>"),a.attr("role","radio").attr("aria-checked",!1),"vertical"===o.orientation?a.width(o.iconWidth).height(p):a.width(u).height(o.iconHeight),a.addClass(o.wijCSS.wijratingStar),s=n("<div>"+l+"</div>"),s.addClass(o.wijCSS.wijratingNormalStar).width(o.iconWidth).height(o.iconHeight),a.attr("aria-label",l),c>0&&"normal"===o.direction?"vertical"===o.orientation?s.css({"margin-top":"-"+c*p+"px"}):s.css({"margin-left":"-"+c*u+"px"}):t-1>c&&"reversed"===o.direction&&("vertical"===o.orientation?s.css({"margin-top":"-"+(t-1-c)*p+"px"}):s.css({"margin-left":"-"+(t-1-c)*u+"px"})),r.disabled||(r.content&&r.content.length?d<=r.content.length&&(s.attr("title",r.content[d]),a.attr("aria-label",r.content[d])):s.attr("title",l)),w&&("string"==typeof g?m=g:n.isArray(g)&&(f=Math.floor(d/t),g.length>f&&(m=g[f]))),l===o.value||h>o.value&&l<o.value&&"single"===o.ratingMode?(s.addClass(o.wijCSS.wijratingRatedStar),w&&s.addClass(m),a.attr("aria-checked",!0)):l<o.value&&"continuous"===o.ratingMode&&(s.addClass(o.wijCSS.wijratingRatedStar),w&&s.addClass(m)),s.appendTo(a),"reversed"===o.direction?a.prependTo(i):a.appendTo(i);this._addCustomizedIconsClass(o.icons.iconsClass,t)},e.prototype._resetValue=function(t,e,i){var o=this.options,r=n("."+o.wijCSS.wijratingNormalStar,this.ratingElement[0]),s=e||o.ratingMode,a=i&&i.length,l=0,h;n.each(r,function(e,d){var c=n(d),u=parseFloat(c.html()),p;p=e<r.length-1?parseFloat(n(r[e+1]).html()):"normal"===o.direction?o.totalValue+1:-1,c.removeClass(o.wijCSS.wijratingRatedStar),c.parent().attr("aria-checked",!1),a&&("string"==typeof i?(c.removeClass(i),h=i):n.isArray(i)&&(n.each(i,function(t,e){c.removeClass(e)}),l="reversed"===o.direction?Math.floor((r.length-1-e)/o.split):Math.floor(e/o.split),i.length>l&&(h=i[l]))),u===t||p>t&&t>u&&"single"===s?(c.addClass(o.wijCSS.wijratingRatedStar),a&&c.addClass(h),c.parent().attr("aria-checked",!0)):"continuous"===s&&t>u&&(c.addClass(o.wijCSS.wijratingRatedStar),a&&c.addClass(h))})},e.prototype._resetTotalValue=function(t){var e=this.options,i=e.hint,o=n("."+e.wijCSS.wijratingNormalStar,this.ratingElement[0]),r=o.length;n.each(o,function(o,s){var a=n(s),l=Math.round((o+1)*t*100/r)/100,h=parseFloat(a.html());h===e.value&&(e.value=l),a.html(l.toString()),i&&i.length&&i.length>=o&&i[o]&&i[o].length?a.attr("title",i[o]):a.attr("title",l)})},e.prototype._resetHint=function(t){var e=this.options,i=n("."+e.wijCSS.wijratingNormalStar,this.ratingElement[0]);n.each(i,function(e,i){var o=n(i),r=parseFloat(o.html());t&&t.length&&t.length>=e&&t[e]&&t[e].length?o.attr("title",t[e]):o.attr("title",r)})},e.prototype._clearIntentTimer=function(){this.intentTimers&&this.intentTimers.length&&n.each(this.intentTimers,function(t,e){e&&(window.clearTimeout(e),e=null)}),this.intentTimers=[]},e.prototype._playJqueryAnimation=function(t,e,i){var o=this,r=this,s=r.options,a={easing:t.easing},l=t.animated;r._clearIntentTimer(),n.each(e,function(h,d){var c=Math.floor(h/s.split)*t.delay,u;u=window.setTimeout(function(){n(d).hide(l,a,t.duration,function(){h===e.length-1&&n.each(e,function(h,d){var c=Math.floor(h/s.split)*t.delay,u;u=window.setTimeout(function(){n(d).show(l,a,t.duration,function(){h===e.length-1&&i&&n.isFunction(i)&&i.call(o)})},c),r.intentTimers.push(u)})})},c),r.intentTimers.push(u)})},e.prototype._addCustomizedIconsClass=function(t,e){var i=this,o=i.options,r,s=0,a=0;t&&t.length&&(r=n("."+o.wijCSS.wijratingNormalStar,i.ratingElement[0]),n.each(r,function(o,r){if(s===e&&(s=0,a++),"string"==typeof t)n(r).addClass(t);else if(n.isArray(t)){var l=t.length;l>a&&("reversed"===i.options.direction?n(r).addClass(t[l-a-1]):n(r).addClass(t[a]))}s++}))},e.prototype._addCustomizedHoverIconsClass=function(t,e,i){var o=this.options,r=o.direction,s=o.ratingMode,a=n("."+o.wijCSS.wijratingNormalStar,this.ratingElement[0]),l=a.index(i),h=0,d;if(t&&t.length)if("string"==typeof t)i.addClass(t),"single"!==s&&("reversed"===r?i.parent().nextAll().children().addClass(t):i.parent().prevAll().children().addClass(t));else if(n.isArray(t))if("single"===s)d="reversed"===r?a.length-1-l:l,h=Math.floor(d/e),t.length>h&&i.addClass(t[h]);else if("reversed"===r)for(d=a.length-1;d>=l;d--)h=Math.floor((a.length-1-d)/e),t.length>h&&n(a[d]).addClass(t[h]);else for(d=0;l>=d;d++)h=Math.floor(d/e),t.length>h&&n(a[d]).addClass(t[h])},e.prototype._removeCustomizedIconsClass=function(t){var e=this.options,i=n("."+e.wijCSS.wijratingNormalStar,this.ratingElement[0]);t&&t.length&&("string"==typeof t?i.removeClass(t):n.isArray(t)&&n.each(t,function(t,e){i.removeClass(e)}))},e.prototype._parseSelect=function(){var t=this.options,e=[],i=n("option",this.element);i.length&&(t.count=i.length,t.totalValue=i.length,n.each(i,function(i,o){var r=n(o);e.push(r.html()),r.is(":selected")&&(t.value=i+1)}),t.hint.content=e)},e.prototype._parseRadio=function(){var t=this,e=t.options,i=[],o=n("input[type='radio']",t.element);o.length&&(e.count=o.length,e.totalValue=o.length,n.each(o,function(o,r){var s=n(r),a=s.attr("id"),l;a&&a.length>0?(l=n("label[for='"+a+"']",t.element),l.length?i.push(l.html()):i.push("")):i.push(""),s.is(":checked")&&(e.value=o+1)}),e.hint.content=i)},e}(t.wijmoWidget);e.wijrating=o;var r=function(){function t(){this.wijCSS={wijrating:"wijmo-wijrating",wijratingStarContainer:"wijmo-wijrating-starcontainer",wijratingResetButton:"wijmo-wijrating-reset",wijratingHoverResetButton:"wijmo-wijrating-resethover",wijratingStar:"wijmo-wijrating-star",wijratingNormalStar:"wijmo-wijrating-normal",wijratingHoverStar:"wijmo-wijrating-hover",wijratingRatedStar:"wijmo-wijrating-rated",wijvRating:"wijmo-wijrating-vertical"},this.wijMobileCSS={iconClose:"ui-icon-delete"},this.disabled=!1,this.count=5,this.split=1,this.totalValue=5,this.value=0,this.min=null,this.max=null,this.resetButton={disabled:!1,hint:"cancel this rating!",position:"leftOrTop",customizedClass:"",customizedHoverClass:""},this.hint={disabled:!1,content:null},this.orientation="horizontal",this.direction="normal",this.ratingMode="continuous",this.icons={iconsClass:null,hoverIconsClass:null,ratedIconsClass:null},this.iconWidth=16,this.iconHeight=16,this.animation=null,this.rating=null,this.rated=null,this.reset=null,this.hover=null}return t}();o.prototype.options=n.extend(!0,{},t.wijmoWidget.prototype.options,new r),n.wijmo.registerWidget("wijrating",o.prototype),n.mobile&&(n.mobile.selectmenu.prototype.options.initSelector=n.mobile.selectmenu.prototype.options.initSelector+":not( :jqmData(role='wijrating') )"),n.extend(n.wijmo.wijrating,{animations:{scroll:function(t,e,o){var r=t,s=o,a=250,l=500,h="linear",d=250,c=jQuery.makeArray(e);c.reverse(),n.each(c,function(t,i){var o=Math.floor(t/r.split)*d,c={width:0},u,p;u=window.setTimeout(function(){n(i).animate(c,a,h,function(){window.clearTimeout(u),t===e.length-1&&(p=window.setTimeout(function(){n.each(e,function(t,i){var o=Math.floor(t/r.split)*d,l={width:r.iconWidth},c;c=window.setTimeout(function(){var o=this;n(i).animate(l,a,h,function(){window.clearTimeout(c),t===e.length-1&&s&&n.isFunction(s)&&s.call(o)})},o)}),window.clearTimeout(p)},l))})},o)}),o&&n.isFunction(o)&&o.call(i)}}})}(t.rating||(t.rating={}));var e=t.rating}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){var e=this;e._handleChartStyles(),t.prototype._create.call(this),e.chartElement.addClass(e.options.wijCSS.scatter)},e.prototype.destroy=function(){var e=this;e.chartElement.removeClass(e.options.wijCSS.scatter),t.prototype.destroy.call(this)},e.prototype.getScatter=function(t,e){var i=this,n=i.chartElement.data("fields"),o,r,s,a;if(n&&n.chartElements){if(s=n.chartElements.scatters,s&&s.length){if(r=s.length,0>t||t>=r)return o;if(a=s[t],"undefined"==typeof e)return a;if(r=a.length,a&&r)return 0>e||e>=r?o:a[e]}return o}},e.prototype._paintLegendIcon=function(t,e,i,n,o,r,s,a,l,h){var d=this,c=Math.min(i,n),u,p=l.markerType,g;return u=l.markerStyle,u=$.extend({fill:o.stroke,stroke:o.stroke,opacity:1},u),p||(p="circle"),g=d.canvas.paintMarker(p,t+i/2,e+n/2,3),$(g.node).data("legendIndex",r).data("index",s),d.legendIcons.push(g),g.attr(u),$.wijraphael.addClass($(g.node),a),l.visible===!1&&($(h.node).data("dotOpacity",g.attr("opacity")||1),g.attr("opacity",.3)),g},e.prototype._paintLegend=function(){var e=this,i=e.options,n=[].concat(i.seriesList),o=i.seriesStyles,r=0;$.extend(!0,i,{legend:{size:{width:20,height:10}}}),t.prototype._paintLegend.call(this)},e.prototype._showSerieEles=function(t){$.each(t,function(t,e){e.show(),e.label&&e.label.show(),$(e.element).data("wijchartDataObj")&&($(e.element).data("wijchartDataObj").visible=!0)})},e.prototype._hideSerieEles=function(t){$.each(t,function(t,e){e.hide(),e.label&&e.label.hide(),$(e.element).data("wijchartDataObj")&&($(e.element).data("wijchartDataObj").visible=!1)})},e.prototype._indicatorLineShowing=function(e){t.prototype._indicatorLineShowing.call(this,e),$.each(e,function(t,e){e.dot&&(e.dot.attr(e.hoverStyle),e.dot.scale(1.5,1.5))})},e.prototype._removeIndicatorStyles=function(t){$.each(t,function(t,e){e.dot&&(e.dot.attr(e.style),e.dot.scale(1,1))})},e.prototype._paintTooltip=function(){var e=this,i=e.chartElement,n=i.data("fields");t.prototype._paintTooltip.call(this),e.tooltip&&n&&n.chartElements&&n.chartElements.tooltipTars&&(e.tooltip.setTargets(n.chartElements.tooltipTars),e.tooltip.setOptions({mouseTrailing:!1}))},e.prototype._getTooltipText=function(t,e){var i=$(e).data("wijchartDataObj"),n={data:i,label:i.label,x:i.x,y:i.y,type:i.markerType,target:e,fmt:t};return $.proxy(t,n)()},e.prototype._onBeforeTooltipShowing=function(e){var i=this,n=e.options,o=i.options.hint.style,r=e.target,s,a;r&&($.browser.msie&&parseInt($.browser.version)<9?(s=$(r).data().wijchartDataObj,a=s.style,n.style.stroke=o.stroke||a.stroke||a.fill||"#ffffff"):n.style.stroke=o.stroke||r.getAttribute("stroke")||r.getAttribute("fill")||"#ffffff",r.attrs={stroke:n.style.stroke}),t.prototype._onBeforeTooltipShowing.call(this,e)},e.prototype._clearChartElement=function(){var t=this,e=t.chartElement.data("fields");t.headerEles.length&&($.each(t.headerEles,function(t,e){e.wijRemove(),e=null}),t.headerEles=[]),t.footerEles.length&&($.each(t.footerEles,function(t,e){e.wijRemove(),e=null}),t.footerEles=[]),t.legendEles.length&&($.each(t.legendEles,function(t,e){e.wijRemove(),e=null}),t.legendEles=[]),t.legends.length&&($.each(t.legends,function(t,e){e.wijRemove(),e=null}),t.legends=[]),t.legendIcons.length&&($.each(t.legendIcons,function(t,e){e.wijRemove(),e=null}),t.legendIcons=[]),
t.legendDots.length&&($.each(t.legendDots,function(t,e){e=null}),t.legendDots=[]),t.axisEles.length&&($.each(t.axisEles,function(t,e){e.wijRemove(),e=null}),t.axisEles=[]),t.chartLabelEles.length&&($.each(t.chartLabelEles,function(t,e){e.wijRemove(),e=null}),t.chartLabelEles=[]),e&&e.chartElements&&($.each(e.chartElements,function(t,i){i.length&&$.each(i,function(t,e){null!==e[0]&&(e.remove&&e.remove(),i[t]=null)}),e.chartElements[t]=null}),e.chartElements={},$(e.clipRect.element).stop().remove(),e.render.destroy(),e.clipRect.destroy()),t.dataPoints=null,t.pointXs=null,t.canvas.clear(),t.innerState={}},e.prototype._paintPlotArea=function(){var t=this,e=t.options,i;i=new n(this.chartElement,{bounds:t.canvasBounds,widgetName:t.widgetName,canvas:t.canvas,tooltip:t.tooltip,axis:e.axis,animation:e.animation,seriesTransition:e.seriesTransition,seriesList:e.seriesList,seriesStyles:e.seriesStyles,seriesHoverStyles:e.seriesHoverStyles,hint:e.hint,disabled:e.disabled,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,zoomOnHover:e.zoomOnHover,mouseDown:$.proxy(t._mouseDown,t),mouseUp:$.proxy(t._mouseUp,t),mouseOver:$.proxy(t._mouseOver,t),mouseOut:$.proxy(t._mouseOut,t),mouseMove:$.proxy(t._mouseMove,t),click:$.proxy(t._click,t),showChartLabels:e.showChartLabels,chartLabelStyle:e.chartLabelStyle,chartLabelFormatString:e.chartLabelFormatString,culture:t._getCulture(),wijCSS:e.wijCSS,widget:this}),i.render()},e}(t.wijchartcore);t.wijscatterchart=e,e.prototype.widgetEventPrefix="wijscatterchart";var i=function(){function t(){this.initSelector=":jqmData(role='wijscatterchart')",this.wijCSS={scatter:"wijmo-wijscatterchart",scatterElement:"wijscatterchart"},this.animation={enabled:!0,duration:2e3,easing:">"},this.showChartLabels=!1,this.seriesTransition={enabled:!0,duration:2e3,easing:">"},this.zoomOnHover=!0,this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return t}();e.prototype.options=$.extend(!0,{},t.wijchartcore.prototype.options,new i),$.wijmo.registerWidget("wijscatterchart",e.prototype);var n=function(){function e(t,e){this.scatters=[],this.chartLabels=[],this.tooltipTars=[],this.seriesEles=[],this.element=t,this.options=e,this._init()}return e.prototype._init=function(){var e=this.element,i=this.options,n=i.bounds,o=i.axis.x.min,r=i.axis.y.min,s=i.axis.x.max,a=i.axis.y.max;this.width=n.endX-n.startX,this.height=n.endY-n.startY,this.plotInfo={minX:o,minY:r,maxX:s,maxY:a,width:this.width,height:this.height,kx:this.width/(s-o),ky:this.height/(a-r)},this.fields=e.data("fields")||{},e.find("svg").length>0?this.chartRender=t.render.createRender(e.find("svg").get(0),e.width(),e.height()):this.chartRender=t.render.createRender(e.children(":first").addClass("vmlcontainer").get(0),e.width(),e.height()),this.clipRect=this.chartRender.clipRect(0,0,0,e.height()),this.g=this.chartRender.g(),this.g.clip(this.clipRect),this.g.add(),this.fields.render=this.chartRender,this.fields.clipRect=this.clipRect},e.prototype.bindLiveEvents=function(){var t=$.isFunction,e=this.options,i=e.wijCSS,n=this.element,o=e.widgetName,r=e.mouseDown,s=e.mouseUp,a=e.mouseOver,l=e.mouseOut,h=e.mouseMove,d=e.click,c=e.zoomOnHover,u=e.seriesHoverStyles,p=e.seriesStyles,g=e.disabled,f="";$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(f="wij"),$("."+i.scatterElement,n[0]).on(f+"mousedown."+o,function(e){if(!g&&t(r)){var i=$(e.target).data("wijchartDataObj");i||(i=$(e.target.parentNode).data("wijchartDataObj")),r.call(n,e,i)}}).on(f+"mouseup."+o,function(e){if(!g&&t(s)){var i=$(e.target).data("wijchartDataObj");i||(i=$(e.target.parentNode).data("wijchartDataObj")),s.call(n,e,i)}}).on(f+"mouseover."+o,function(e){if(!g){var i=$(e.target).data("wijchartDataObj"),o,r,s;i||(i=$(e.target.parentNode).data("wijchartDataObj")),s=i.dot,c&&(o=i.seriesIndex,s.attr&&(r=$.extend(!0,{},u[o]),s.attr(r)),document.createElementNS?s.scale(1.5,1.5):s.attr("stroke-width",5)),t(a)&&a.call(n,e,i)}}).on(f+"mouseout."+o,function(e){if(!g){var i=$(e.target).data("wijchartDataObj"),o,r;i||(i=$(e.target.parentNode).data("wijchartDataObj")),r=i.dot,c&&(o=i.seriesIndex,r.attr&&r.attr($.extend(!0,{},p[o]))),document.createElementNS&&r.scale(1,1),t(l)&&l.call(n,e,i)}}).on(f+"mousemove."+o,function(e){if(!g&&t(h)){var i=$(e.target).data("wijchartDataObj");i||(i=$(e.target.parentNode).data("wijchartDataObj")),h.call(n,e,i)}}).on(f+"click."+o,function(e){if(!g&&t(d)){var i=$(e.target).data("wijchartDataObj");i||(i=$(e.target.parentNode).data("wijchartDataObj")),d.call(n,e,i)}})},e.prototype.unbindLiveEvents=function(){var t=this.options,e=t.widgetName,i=t.wijCSS;$("."+i.scatterElement,this.element).off(e).off("."+e)},e.prototype.paintDefaultChartLabel=function(t,e,i){var n=this.options,o=$.extend(!0,{},n.textStyle,n.chartLabelStyle),r,s=n.chartLabelFormatString,a;return r=n.isYTime?Globalize.format(i,"f",n.culture):$.round(i,2),s&&s.length&&(r=Globalize.format(r,s,n.culture)),a=this.chartRender.text(t,e,r)},e.prototype.paintScatters=function(){var t=this,e=t.options,i=e.seriesList,n=e.seriesStyles,o=e.seriesHoverStyles,r=e.isXTime,s=e.isYTime,a=e.bounds,l=this.plotInfo,h=e.wijCSS,d=e.showChartLabels,c=e.chartLabelStyle,u=e.widget;$.each(i,function(e,i){var p=i.data,g,f=i.markerWidth||5,m=n[e],w=o[e],y=p.x,v=p.y,_=[],S=[],x;return i=$.extend(!0,{visible:!0,markerType:"circle"},i),g=i.markerType,"exclude"===i.display?!0:(!m.fill&&m.stroke&&(m.fill=m.stroke),void 0===y?!0:($.each(v,function(n,o){var p=y[n],b=0,C=0,D,I,j,T={};return r&&(p=$.toOADate(p)),s&&(o=$.toOADate(o)),"undefined"==typeof p?!1:(D=isNaN(p)||"string"==typeof p?n:p,b=a.startX+(D-l.minX)*l.kx,C=a.endY-(o-l.minY)*l.ky,m.opacity&&(m["fill-opacity"]=m.opacity,m["stroke-opacity"]=m.opacity,delete m.opacity),"cross"===g&&void 0!==m["stroke-width"]&&0===m["stroke-width"]&&(m["stroke-width"]=1),I=t.chartRender.symbol(g,b,C,f),I.attr(m),I.add(t.g),I.attr({"class":h.canvasObject+" "+h.scatterElement}),T=$.extend(!1,{dot:I,x:y[n],y:v[n],seriesIndex:e,index:n,markerType:g,type:"scatter",style:m,hoverStyle:w,visible:!0},i),d&&(j=t.paintDefaultChartLabel(b,C-6,v[n]),j.add(t.g),c=$.extend({"font-size":"10px",fill:"#888","font-family":"Arial"},c),j.attr(c),I.label=j,t.chartLabels.push(j)),u.dataPoints=u.dataPoints||{},u.pointXs=u.pointXs||[],x=$.round(b,2),u.dataPoints[x.toString()]||(u.dataPoints[x.toString()]=[],u.pointXs.push(x)),u.dataPoints[x.toString()].push(T),$(I.element).data("wijchartDataObj",T),_.push(I),t.tooltipTars.push($.extend({},I,{node:I.element})),S.push(I),i.visible===!1&&I.hide(),void 0)}),t.scatters.push(_),t.seriesEles.push(S),void 0))})},e.prototype.playAnimation=function(){var t=this,e=t.options,i=e.animation,n=t.element,o=n.css("background-color");i.enabled?("transparent"===o&&(o="white"),t.clipRect.getCSS?$(t.clipRect.members[0].element).animate({width:n.width()},{duration:i.duration,step:function(e){t.clipRect.width=e;var i=t.clipRect.getCSS();$(this).css(i)}}):$(t.clipRect.element).animate({width:n.width()},{duration:i.duration,step:function(e){t.clipRect.attr("width",e)}})):t.clipRect.getCSS?($(t.clipRect.members[0].element).css({width:n.width()}),t.clipRect.width=n.width(),$(t.clipRect.members[0].element).css(t.clipRect.getCSS())):($(t.clipRect.element).css({width:n.width()}),t.clipRect.attr("width",n.width()))},e.prototype.render=function(){this.paintScatters(),this.playAnimation(),this.unbindLiveEvents(),this.bindLiveEvents(),this.chartEles={animationSet:this.animationSet,tooltipTars:this.tooltipTars,scatters:this.scatters,labels:this.chartLabels},this.fields.chartElements||(this.fields.chartElements={}),this.fields.seriesEles=this.seriesEles,$.extend(!0,this.fields.chartElements,this.chartEles),this.element.data("fields",this.fields)},e}();t.ScatterChartRender=n}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var wijmo;!function(t){!function(t){!function(t){function e(t){return"string"==typeof t}function i(t){return"number"==typeof t}function n(t){return void 0!==t&&null!==t}function o(t,i,o){var r="setAttribute",s;return e(i)?n(o)?t[r](i,o):t&&t.getAttribute&&(s=t.getAttribute(i)):n(i)&&$.isPlainObject(i)&&$.each(i,function(e,i){t[r](e,i)}),s}function r(t,e){c&&e&&void 0!==e.opacity&&(e.filter="alpha(opacity="+100*e.opacity+")"),$.extend(t.style,e)}function s(t,e,i){var n=h.createElement(t);return e&&$.extend(n,e),i&&r(n,i),n}function a(t){$.each(t,function(e,i){t[e]&&t[e].destroy&&t[e].destroy(),delete t[e]})}function l(t,e,i){return g?new L(t,e,i):new M(t,e,i)}var h=document,d=$.each,c=$.browser.msie,u=8===h.documentMode,p="http://www.w3.org/2000/svg",g=!!h.createElementNS&&!!h.createElementNS(p,"svg").createSVGRect,f=0,m="div",w="absolute",y="hidden",v="scatterchart-",_="visible",S="visibility",x="px",b="none",C="M",D="L",I=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,j=/^(\d{1,3})\-(?:((?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))\-)(?:(?:((?:(?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))(?:\:\d{1,3})?)\-)?)*((?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))$/,T=function(){function t(){}return t.prototype.attr=function(t,e){},t.prototype.scale=function(t,e){},t.prototype.symbolAttr=function(t){},t.prototype.clip=function(t){},t.prototype.crisp=function(t,e,i,n,o){},t.prototype.css=function(t){},t.prototype.getBBox=function(){},t.prototype.show=function(){},t.prototype.hide=function(){},t.prototype.add=function(t){},t.prototype.destroy=function(){},t.prototype.empty=function(){},t.prototype.remove=function(){},t}();t.ChartElement=T;var E=function(){function t(t,e,i){}return t.prototype.destroy=function(){},t.prototype.createElement=function(t){},t.prototype.path=function(t){return this._element},t.prototype.circle=function(t,e,i){return this._element},t.prototype.rect=function(t,e,i,n,o,r){return this._element},t.prototype.setSize=function(t,e){},t.prototype.g=function(t){return this._element},t.prototype.text=function(t,e,i){return this._element},t.prototype.symbol=function(t,e,i,n,o){return this._element},t.prototype.clipRect=function(t,e,i,n){return this._element},t}();t.ChartRender=E;var k=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.init=function(t,e){this.element=h.createElementNS(p,e),this.renderer=t},i.prototype.attr=function(t,i){var r,s,a=this.element,l=this.renderer,h=a.nodeName,d,c=this;if(void 0!==t)return e(t)&&n(i)&&(r=t,t={},t[r]=i),e(t)?(r=t,"circle"===h&&(r={x:"cx",y:"cy"}[r]||r),c=o(a,r)||this[r]||0,"d"!==r&&r!==S&&(c=parseFloat(c))):t&&$.each(t,function(e,i){d=!1,s=t[e],"d"===e?(s&&s.join&&(s=s.join(" ")),/(NaN| {2}|^$)/.test(s)&&(s="M 0 0"),this.d=s):"fill"===e?s=l._color(s,a,e):"circle"===h&&("x"===e||"y"===e)&&(e={x:"cx",y:"cy"}[e]||e),jQuery.browser.safari&&"stroke-width"===e&&0===s&&(s=1e-6),d||o(a,e,s),a.attrs=a.attrs||{},a.attrs[e]=s}),c},i.prototype.scale=function(t,e){var i=this,n=i.getBBox(),o=-(n.x+n.width/2)/2,r=-(n.y+n.height/2)/2;1===t&&(o=0),1===e&&(r=0),i.attr("transform","matrix("+t+",0,0, "+e+","+o+","+r+")")},i.prototype.symbolAttr=function(t){var e=this;d(["x","y","r","start","end","width","height","innerR"],function(i,n){t[n]?e[n]=t[n]:e[n]=e[n]}),e.attr({d:e.renderer.symbols[e.symbolName](Math.round(2*e.x)/2,Math.round(2*e.y)/2,e.r,{start:e.start,end:e.end,width:e.width,height:e.height,innerR:e.innerR})})},i.prototype.clip=function(t){return this.attr("clip-path","url("+this.renderer.url+"#"+t.id+")")},i.prototype.crisp=function(t,e,i,n,o){var r=this,s,a={},l={},h;t=t||r.strokeWidth||0,h=t%2/2,l.x=Math.floor(e||r.x||0)+h,l.y=Math.floor(i||r.y||0)+h,l.width=Math.floor((n||r.width||0)-2*h),l.height=Math.floor((o||r.height||0)-2*h),l.strokeWidth=t;for(s in l)r[s]!==l[s]&&(r[s]=a[s]=l[s]);return a},i.prototype.css=function(t){var e=this,i=e.element,n=t&&t.width&&"text"===i.nodeName,o="",s=function(t,e){return"-"+e.toLowerCase()};return t&&t.color&&(t.fill=t.color),t=$.extend(e.styles,t),e.styles=t,c&&!g?(n&&delete t.width,r(e.element,t)):($.each(t,function(e,i){o+=i.replace(/([A-Z])/g,s)+":"+t[i]+";"}),e.attr({style:o})),e},i.prototype.getBBox=function(){var t,e,i,n=this.rotation,o=n*Math.PI*2/360;try{t=$.extend({},this.element.getBBox())}catch(r){t={width:0,height:0}}return e=t.width,i=t.height,n&&(t.width=Math.abs(i*Math.sin(o))+Math.abs(e*Math.cos(o)),t.height=Math.abs(i*Math.cos(o))+Math.abs(e*Math.sin(o))),t},i.prototype.show=function(){return this.attr({visibility:_})},i.prototype.hide=function(){return this.attr({visibility:y})},i.prototype.add=function(t){var e=this,i=e.renderer,r=t||i,s=r.element||i.box,a=s.childNodes,l=e.element,h=o(l,"zIndex"),d,c,u;if(t&&e.htmlNode&&(t.htmlNode||(t.htmlNode=[]),t.htmlNode.push(e)),h&&(r.handleZ=!0,h=parseInt(h,10)),r.handleZ)for(u=0;u<a.length;u++)if(d=a[u],c=o(d,"zIndex"),d!==l&&(parseInt(c,10)>h||!n(h)&&n(c)))return s.insertBefore(l,d),e;return s.appendChild(l),e.added=!0,e},i.prototype._safeRemoveChild=function(t){var e=t.parentNode;e&&e.removeChild(t)},i.prototype.destroy=function(){var t=this,e=t.element||{},i=t.shadows,n=t.box,o;if(e.onclick=e.onmouseout=e.onmouseover=e.onmousemove=null,t.clipPath&&(t.clipPath=t.clipPath.destroy()),t.stops){for(o=0;o<t.stops.length;o++)t.stops[o]=t.stops[o].destroy();t.stops=null}return t._safeRemoveChild(e),i&&d(i,function(e){t._safeRemoveChild(e)}),n&&n.destroy(),$.each(t,function(e,i){delete t[e]}),null},i.prototype.empty=function(){for(var t=this.element,e=t.childNodes,i=e.length;i--;)t.removeChild(e[i]),$(e[i]).remove()},i.prototype.remove=function(){var t=this.element,e=t.parentNode;e.removeChild(t),$(t).remove()},i}(T),L=function(t){function e(e,i,n){t.call(this,e,i,n),this.gradientCache={},this.init(e,i,n)}return __extends(e,t),e.prototype.init=function(t,i,n){var o=this,r=h.location,s;this.symbols=e._symbols,this.Element=k,$(t).is("svg")?(o.box=t,s=new o.Element,s.element=t,s.render=o,o.defs=$("defs",t).get(0),o.gradients={}):(s=o.createElement("svg").attr({xmlns:p,version:"1.1"}),t.appendChild(s.element),o.box=s.element,o.boxWrapper=s,o.defs=this.createElement("defs").add(),o.gradients={},o.setSize(i,n)),o.url=c?"":r.href.replace(/#.*?$/,"")},e.prototype.destroy=function(){var t=this;return t.box=null,a(t.gradients||{}),t.gradients=null,null},e.prototype.createElement=function(t){var e=new this.Element;return e.init(this,t),e},e.prototype.path=function(t){var e=this.createElement("path");return e.attr({d:t,fill:b}),e},e.prototype.circle=function(t,e,i){var n=$.isPlainObject(t)?t:{x:t,y:e,r:i},o=this.createElement("circle");return o.attr(n),o},e.prototype.rect=function(t,e,i,n,o,r){$.isPlainObject(t)&&(e=t.y,i=t.width,n=t.height,o=t.r,r=t.strokeWidth,t=t.x);var s=this.createElement("rect");return s.attr({rx:o,ry:o,fill:b}),s.attr(s.crisp(r,t,e,Math.max(i,0),Math.max(n,0))),s},e.prototype.setSize=function(t,e){var i=this;i.width=t,i.height=e,i.boxWrapper.attr({width:t,height:e})},e.prototype.g=function(t){var e=this.createElement("g");return n(t)&&e.attr({"class":v+t}),e},e.prototype.text=function(t,e,i){$.isPlainObject(t)&&(e=t.y,i=t.text,t=t.x);var n=this.createElement("text");return n.attr({x:t,y:e,"text-anchor":"middle"}),n.element.textContent=i,n},e.prototype.symbol=function(t,e,i,n,o){var r,s=this,a=s.symbols[t],l=a&&a(Math.round(e),Math.round(i),n,o);return l?(r=s.path(l),$.extend(r,{symbolName:t,x:e,y:i,r:n}),o&&$.extend(r,o)):r=s.circle(e,i,n),r},e._symbols={box:function(t,e,i){var n=.707*i;return[C,t-n,e-n,D,t+n,e-n,t+n,e+n,t-n,e+n,"Z"]},tri:function(t,e,i){return[C,t,e-1.33*i,D,t+i,e+.67*i,t-i,e+.67*i,"Z"]},invertedTri:function(t,e,i){return[C,t,e+1.33*i,D,t-i,e-.67*i,t+i,e-.67*i,"Z"]},diamond:function(t,e,i){return[C,t,e-i,D,t+i,e,t,e+i,t-i,e,"Z"]},cross:function(t,e,i){var n=.707*i;return[C,t-n,e-n,D,t+n,e+n,C,t-n,e+n,D,t+n,e-n]},arc:function(t,e,i,n){var o=n.start,r=n.end-1e-6,s=n.innerR,a=Math.cos(o),l=Math.sin(o),h=Math.cos(r),d=Math.sin(r),c=n.end-o<Math.PI?0:1;return[C,t+i*a,e+i*l,"A",i,i,0,c,1,t+i*h,e+i*d,D,t+s*h,e+s*d,"A",s,s,0,c,0,t+s*a,e+s*l,"Z"]}},e.prototype.clipRect=function(t,e,i,n){var o,r=v+f++,s=this.createElement("clipPath");return s.attr({id:r}),$(this.defs).append(s.element),o=this.rect(t,e,i,n,0).add(s),o.id=r,o.clipPath=s,o},e.prototype._parsegradientcolor=function(t){var e=this,i=[],n,o,r,s,a,l,h,d;if(e.gradientCache[t])return e.gradientCache[t];for(r=0,l=t.length;l>r;r++){if(n={},o=t[r].match(/^([^:]*):?([\d\.]*)/),n.color=Raphael.getRGB(o[1]),n.color.error)return null;n.color=n.color.hex,o[2]&&(n.offset=o[2]+"%"),i.push(n)}for(r=1,l=i.length-1;l>r;r++)if(!i[r].offset){for(s=parseFloat(i[r-1].offset||0),a=0,h=r+1;l>h;h++)if(i[h].offset){a=i[h].offset;break}for(a||(a=100,h=l),a=parseFloat(a),d=(a-s)/(h-r+1);h>r;r++)s+=d,i[r].offset=s+"%"}return e.gradientCache[t]=i,i},e.prototype._color=function(t,e,i){var n=this,r="color",s=.5,a=.5,l=n.gradients,h,d,c,u,p,g,m,w,y,_,S=t,x,b,C;if(j.test(t)?r="linear":t=t.replace(I,function(t,e,i){if(r="radial",e&&i){s=parseFloat(e),a=parseFloat(i);var n=a>.5?1:-1;Math.pow(s-.5,2)+Math.pow(a-.5,2)>.25&&(a=Math.sqrt(.25-Math.pow(s-.5,2))*n+.5)&&.5!==a&&(a=parseFloat(a.toFixed(5))-1e-5*n)}return""}),"linear"===r||"radial"===r){if(d=t.split(/\s*\-\s*/),"linear"===r){if(b=d.shift(),b=-parseFloat(b),isNaN(b))return t;w=[0,0,Math.cos(Raphael.rad(b)),Math.sin(Raphael.rad(b))],y=1/(Math.max(Math.abs(w[2]),Math.abs(w[3]))||1),w[2]*=y,w[3]*=y,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0),c=w[0],u=w[1],p=w[2],g=w[3]}return l[S]?x=o(l[S].element,"id"):(C=this._parsegradientcolor(d),$.each(C,function(t,e){e.offset=e.offset?e.offset:t?"100%":"0%"}),x=v+f++,h=n.createElement(r+"Gradient"),"radial"===r?h.attr({id:x,fx:s,fy:a}):h.attr({id:x,x1:c,y1:u,x2:p,y2:g}),$(this.defs).append(h.element),h.stops=[],$.each(C,function(t,e){var i;m=e.color,_=1,i=n.createElement("stop"),i.attr({offset:e.offset,"stop-color":m,"stop-opacity":_}).add(h),h.stops.push(i)}),l[S]=h),"url(#"+x+")"}return e.removeAttribute(i+"-opacity"),t},e}(E),P=function(t){function a(){t.apply(this,arguments)}return __extends(a,t),a.prototype.init=function(t,e){var i=["<",e,' filled="f" stroked="f"'],n=["position: ",w,";"];("shape"===e||e===m)&&n.push("left:0;top:0;width:10px;height:10px;"),u&&n.push("visibility: ",e===m?y:_),i.push(' style="',n.join(""),'"/>'),e&&(i=e===m||"span"===e||"img"===e?i.join(""):t.prepVML(i),this.element=s(i)),this.renderer=t},a.prototype.add=function(t){var e=this,i=e.renderer,n=e.element,o=i.box,s=t&&t.inverted,a=t?t.element||t:o;return u&&a.gVis===y&&r(n,{visibility:y}),a.appendChild(n),e.added=!0,e},a.prototype.attr=function(t,s){var a,l,h,d=this,c=d.element||{},p=c.style,g=c.nodeName,f=d.symbolName,w=d.renderer,y,v,C=d.shadows,D,I,j=d;return void 0===t?j:(e(t)&&n(s)&&(a=t,t={},t[a]=s),e(t)?(a=t,j="strokeWidth"===a||"stroke-width"===a?d.strokeweight:d[a]):t&&$.each(t,function(e,n){if(l=n,D=!1,f&&/^(x|y|r|start|end|width|height|innerR)/.test(e))v||(d.symbolAttr(t),v=!0),D=!0;else if("d"===e){for(l=l||[],d.d=l.join(" "),h=l.length,I=[];h--;)i(l[h])?I[h]=Math.round(10*l[h])-5:"Z"===l[h]?I[h]="x":I[h]=l[h];if(l=I.join(" ")||"x",c.path=l,C)for(h=C.length;h--;)C[h].path=l;D=!0}else if("zIndex"===e||e===S){if(u&&e===S&&g===m){for(c.gVis=l,y=c.childNodes,h=y.length;h--;)r(y[h],{visibility:l});l===_&&(l=null)}l&&(p[e]=l),D=!0}else"class"===e?c.className=l:"stroke"===e?e="strokecolor":"stroke-width"===e||"strokeWidth"===e?(c.stroked=l?!0:!1,e="strokeweight",d[e]=l,i(l)&&(l+=x)):"fill"===e&&("SPAN"===g?p.color=l:(c.filled=l!==b?!0:!1,l=w.color(l,c,e),e="fillcolor"));D||("opacity"===e&&(e="fill-opacity"),u?c[e]=l:o(c,e,l)),c.attrs=c.attrs||{},c.attrs[e]=l}),j)},a.prototype.scale=function(t,e){var i=this,n=i.attr("stroke-width")||0;i.css({filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+t+",, M12=0, M21=0, M22="+e+", Dx=0, Dy=0, sizingmethod='auto expand')"}).attr("stroke-width",n)},a.prototype.clip=function(t){var e=this,i=t.members;return i.push(e),e.css(t.getCSS(e.inverted))},a.prototype.css=function(t){var e=this,i=e.element,n=t&&"SPAN"===i.tagName&&t.width;return n&&(delete t.width,e.textWidth=n),e.styles=$.extend(e.styles,t),r(e.element,t),e},a.prototype.destroy=function(){var t=this;return t.destroyClip&&t.destroyClip(),k.prototype.destroy.apply(t)},a.prototype.empty=function(){for(var t=this.element,e=t.childNodes,i=e.length,n;i--;)n=e[i],n.parentNode.removeChild(n),$(n).remove()},a.prototype.getBBox=function(){var t=this,e=t.element,i=t.bBox;return i||("text"===e.nodeName&&(e.style.position=w),i=t.bBox={x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}),i},a}(k),M=function(t){function e(){t.apply(this,arguments),this.isIE8=$.browser.msie&&8===parseInt($.browser.version)}return __extends(e,t),e.prototype.init=function(t,i,n){var o=this,r;this.Element=P,this.symbols=e._symbols,$(t).hasClass("vmlcontainer")?(o.box=t,r=new this.Element,r.element=t,r.render=this,o.boxWrapper=r):(r=o.createElement(m),t.appendChild(r.element),o.box=r.element,o.boxWrapper=r,o.setSize(i,n)),h.namespaces.v||(h.namespaces.add("v","urn:schemas-microsoft-com:vml"),h.createStyleSheet().cssText="v\\:fill, v\\:path, v\\:shape, v\\:stroke{ behavior:url(#default#VML); display: inline-block; } ")},e.prototype.clipRect=function(t,e,i,n){var o=this.createElement();return $.extend(o,{members:[],left:t,top:e,width:i,height:n,getCSS:function(t){var e=this,i=e.top,n=e.left,o=n+e.width,r=i+e.height,s={clip:"rect("+Math.round(t?n:i)+"px,"+Math.round(t?r:o)+"px,"+Math.round(t?o:r)+"px,"+Math.round(t?i:n)+"px)"};return!t&&u&&$.extend(s,{width:o+x,height:r+x}),s},updateClipping:function(){d(o.members,function(t,e){e.css(o.getCSS(e.inverted))})}}),o},e.prototype.color=function(t,e,i){var n,o=this,r="color",a,l,h,d,c=[],u,p,g,f,m=0;return j.test(t)?r="linear":t=t.replace(I,function(t,e,i){return r="radial",e&&i&&(e=parseFloat(e),i=parseFloat(i),Math.pow(e-.5,2)+Math.pow(i-.5,2)>.25&&(i=Math.sqrt(.25-Math.pow(e-.5,2))*(2*(i>.5?1:0)-1)+.5),g=e+" "+i),""}),"linear"!==r&&"radial"!==r?(p=e.getElementsByTagName(i),p.length&&(p[0].opacity=1),t):(a=t.split(/\s*\-\s*/),"linear"===r&&(m=a.shift(),m=-parseFloat(m.toString())),f=o._parsegradientcolor(a),$.each(f,function(t,e){e.offset=e.offset?e.offset:t?"100%":"0%",c.push(e.offset+" "+e.color),l=e.color,t?d=l:h=l}),n="radial"===r?['<fill colors="',c.join(),'" angle="0"','" focusposition="',g,'" color="',h,'" color2="',d,'" focussize="0 0"',' type="gradientTitle" focus="100%" method="none" />']:['<fill colors="',c.join(),'" angle="',m.toString(),'" type="gradient" focus="100%" method="sigma" />'],u=s(o.prepVML(n)),$(e).append(u),void 0)},e.prototype.prepVML=function(t){var e="display:inline-block;behavior:url(#default#VML);",i=this.isIE8;return t=t.join(""),i?(t=t.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),t=-1===t.indexOf('style="')?t.replace("/>",' style="'+e+'" />'):t.replace('style="','style="'+e)):t=t.replace("<","<v:"),t},e.prototype.path=function(t){var e=this.createElement("shape");return e.attr({coordsize:"100 100",d:t}),e},e.prototype.g=function(t){var e,i;return t&&(i={className:v+t,"class":v+t}),e=this.createElement(m).attr(i)},e.prototype.text=function(t,e,i){var n=this.createElement("span"),o=n.element,r,s;return o.innerHTML=i,$(o).appendTo("body"),r=$(o).width(),s=$(o).height(),t-=r/2,e-=s/2,n.x=t,n.y=e,$(o).css({position:"absolute","white-space":"nowrap","font-family":"Arial","font-size":"10",left:t+"px",top:e+"px"}),n},e._symbols=$.extend({},L._symbols,{arc:function(t,e,i,n){var o=n.start,r=n.end,s=Math.cos(o),a=Math.sin(o),l=Math.cos(r),h=Math.sin(r),d=n.innerR,c=.07/i,u=d&&.1/d||0;return r-o===0?["x"]:(2*Math.PI-r+o<c?l=-c:u>r-o&&(l=Math.cos(o+u)),["wa",t-i,e-i,t+i,e+i,t+i*s,e+i*a,t+i*l,e+i*h,"at",t-d,e-d,t+d,e+d,t+d*l,e+d*h,t+d*s,e+d*a,"x","e"])},circle:function(t,e,i){return["wa",t-i,e-i,t+i,e+i,t+i,e,t+i,e,"e"]},rect:function(t,e,i,o){if(!n(o))return[];var r=o.width,s=o.height,a=t+r,l=e+s;return i=Math.min(i,r,s),[C,t+i,e,D,a-i,e,"wa",a-2*i,e,a,e+2*i,a-i,e,a,e+i,D,a,l-i,"wa",a-2*i,l-2*i,a,l,a,l-i,a-i,l,D,t+i,l,"wa",t,l-2*i,t+2*i,l,t+i,l,t,l-i,D,t,e+i,"wa",t,e,t+2*i,e+2*i,t,e+i,t+i,e,"x","e"]}}),e}(L);t.createRender=l}(t.render||(t.render={}));var e=t.render}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=1e4,i=function(t){function i(){t.apply(this,arguments),this.bubMax=0,this.bubMin=0,this.bubDiff=0}return __extends(i,t),i.prototype._setOption=function(i,n){var o=this,r=o.options;"minimumSize"===i||"minimumSize"===i?(isNaN(n)||0>n?n=0:n>e&&(n=e),r[i]=n,o.redraw()):"chartLabel"===i?($.extend(r.chartLabel,n),o.redraw()):(("showChartLabels"===i||"chartLabelStyle"===i)&&(r[i]=n,o._setLabelOption()),t.prototype._setOption.call(this,i,n)),"seriesList"===i&&(o.indexs=null,o.bubbleRadius=null)},i.prototype._create=function(){var e=this,i=e.options,n=e._getDefFill();this._handleChartStyles(),e._setLabelOption(),t.prototype._create.call(this),e.chartElement.addClass(i.wijCSS.bubbleChart)},i.prototype._setLabelOption=function(){var t=this.options;t.showChartLabels!==!0&&t.chartLabel.visible===!0&&(t.chartLabel.visible=!1),!$.isPlainObject(t.chartLabel.style)&&$.isPlainObject(t.chartLabelStyle)&&(t.chartLabel.style=t.chartLabelStyle)},i.prototype._clearChartElement=function(){var e=this,i=e.options,n=e.chartElement.data("fields");t.prototype._clearChartElement.call(this),n&&n.bubbleInfos&&$.each(n.bubbleInfos,function(t,e){e.bubble&&e.bubble.wijRemove(),e.dcl&&e.dcl.wijRemove(),e.symbol&&e.symbol.wijRemove()}),n&&n.bubbles&&e._destroyRaphaelArray(n.bubbles),e.element.removeData("plotInfos"),i.seriesTransition.enabled||n&&n.bubblesAnimationInfos&&(n.bubblesAnimationInfos=null)},i.prototype.destroy=function(){var e=this;e.chartElement.removeClass(e.options.wijCSS.bubbleChart+" ui-helper-reset"),e._destroyEles(),t.prototype.destroy.call(this)},i.prototype.getBubble=function(t){return this.chartElement.data("fields").bubbles[t]},i.prototype.redraw=function(e){this.bubbleRadius=null,t.prototype.redraw.call(this,e)},i.prototype._destroyEles=function(){var t=this,e=t.element,i=e.data("fields");i.bubbleInfos&&$.each(i.bubbleInfos,function(e,i){t._removeEle(i.bubble),t._removeEle(i.dcl),t._removeEle(i.symbol),i=null}),e.removeData("fields"),t.bubbleRadius=[]},i.prototype._removeEle=function(t){t&&(t.node&&$(t.node).removeData(),t.wijRemove(),t=null)},i.prototype._paintPlotArea=function(){var t=this,e=this.chartElement,i=t.options,n=i.seriesList,r=n.length,s=[].concat(i.seriesStyles.slice(0,r)),a=[].concat(i.seriesHoverStyles.slice(0,r)),l=t.canvasBounds,h=t.axisInfo.x,d=t.axisInfo.y[0];0!==r&&(t._prepBubbleData(),this.bubbleChartRender=new o(this.chartElement,{seriesList:n,seriesStyles:s,seriesHoverStyles:a,canvas:t.canvas,bounds:l,xAxisInfo:h,yAxisInfo:d,chartLabel:i.chartLabel,textStyle:i.textStyle,chartLabelStyle:i.chartLabelStyle,chartLabelFormatString:i.chartLabelFormatString,bubbleRadius:t.bubbleRadius,animation:i.animation,seriesTransition:i.seriesTransition,sizingMethod:i.sizingMethod,minimumSize:i.minimumSize,maximumSize:i.maximumSize,mouseDown:$.proxy(t._mouseDown,t),mouseUp:$.proxy(t._mouseUp,t),mouseOver:$.proxy(t._mouseOver,t),mouseOut:$.proxy(t._mouseOut,t),mouseMove:$.proxy(t._mouseMove,t),click:$.proxy(t._click,t),disabled:i.disabled,culture:t._getCulture(),wijCSS:i.wijCSS,shadow:i.shadow,widget:this}),this.bubbleChartRender.render(),t.tooltipbubbles=[],$.each(e.data("fields").bubbleInfos,function(e,i){t.tooltipbubbles.push(i.bubble),i.dcl&&t.tooltipbubbles.push(i.dcl),i.symbol&&t.tooltipbubbles.push(i.symbol)}),t.tooltip&&t.tooltip.setTargets(t.tooltipbubbles))},i.prototype._paintLegendIcon=function(t,e,i,n,o,r,s,a,l,h){var d=this,c=Math.min(i,n),u,p,g;return u=l.markerStyle,u=$.extend({fill:o.fill,stroke:o.stroke,opacity:1},u),l.markers&&(p=l.markers.type),p||(p="circle"),g=d.canvas.paintMarker(p,t+i/2,e+n/2,c/2),$(g.node).data("legendIndex",r).data("index",s),d.legendIcons.push(g),g.attr(u),$.wijraphael.addClass($(g.node),a),g},i.prototype._getbubbleIndexs=function(t,e){var n=this,o=n.options,r=o.axis.x.max,s=o.axis.x.min,a=o.axis.y.min,l=o.axis.y.max,h=[],d=[],c=[],u=[],p=[],g=[],f=-1,m=-1,w=-1,y=-1;n.bubbleRadius=[],n._prepBubbleData(),$.each(o.seriesList,function(f,m){var w=m.data,y=m.markers||{},v=y.type||"circle";return void 0===w.y1?!0:void $.each(w.y1,function(f,m){var y=i.transform(m,o.maximumSize,o.minimumSize,n.canvasBounds,n.bubMax,n.bubDiff,o.sizingMethod,v),_,S;_=n._isDate(w.x[f])?$.toOADate(w.x[f]):isNaN(w.x[f])?f:w.x[f],S=w.y[f],n._isDate(S)&&(S=$.toOADate(S)),h.push(_-y*(r-s)/t),d.push(S-y*(l-a)/e),c.push(_+y*(r-s)/t),u.push(S+y*(l-a)/e),p.push(_),g.push(S),n.bubbleRadius.push(y)})}),f=n._getMinIndex(h),m=n._getMinIndex(d),w=n._getMaxIndex(c),y=n._getMaxIndex(u),n.indexs={xMin:{x:p[f],y:g[f],r:n.bubbleRadius[f]},xMax:{x:p[w],y:g[w],r:n.bubbleRadius[w]},yMin:{x:p[m],y:g[m],r:n.bubbleRadius[m]},yMax:{x:p[y],y:g[y],r:n.bubbleRadius[y]}}},i.prototype._calculateParameters=function(e,i){t.prototype._calculateParameters.call(this,e,i);var n=this;(i.autoMax||i.autoMin)&&n._adjust(i,e)},i.prototype._adjust=function(t,e){var i=t.unitMinor,n=this,o=t.autoMin,r=t.autoMax,s=n.canvasBounds,a={x:s.startX,y:s.startY},l=s.endX-a.x,h=s.endY-a.y,d=e.max,c=e.min,u=t.origin;n.indexs||n._getbubbleIndexs(l,h),"x"===e.id?(o&&(c=n._getMinTick(n.indexs.xMin.x,n.indexs.xMin.r,c,d,l,i)),r&&(d=n._getMaxTick(n.indexs.xMax.x,n.indexs.xMax.r,c,d,l,i))):(o&&(c=n._getMinTick(n.indexs.yMin.y,n.indexs.yMin.r,c,d,h,i)),r&&(d=n._getMaxTick(n.indexs.yMax.y,n.indexs.yMax.r,c,d,h,i))),(d!==e.max||c!==e.min)&&(null!==u&&void 0!==u&&(c>u?c=u:u>d&&(d=u)),e.min=c,e.max=d,this._calculateMajorMinor(t,e),n._adjust(t,e))},i.prototype._getMinTick=function(t,e,i,n,o,r){return e>(t-i)*o/(n-i)?i-r:i},i.prototype._getMaxTick=function(t,e,i,n,o,r){return(t-i)*o/(n-i)+e>o?n+r:n},i.prototype._getMinIndex=function(t){var e=-1,i=0;return $.each(t,function(t,e){0===t?i=e:i>e&&(i=e)}),$.each(t,function(t,n){return n===i?(e=t,!1):void 0}),e},i.prototype._getMaxIndex=function(t){var e=-1,i=0;return $.each(t,function(t,e){0===t?i=e:e>i&&(i=e)}),$.each(t,function(t,n){return n===i?(e=t,!1):void 0}),e},i.prototype._showSerieEles=function(t){$.each(t,function(t,e){e.bubble&&(e.bubble.show(),e.bubble.shadow&&e.bubble.shadow.show(),e.bubble.tracker&&e.bubble.tracker.show(),$(e.bubble.node).data("wijchartDataObj")&&($(e.bubble.node).data("wijchartDataObj").visible=!0)),e.dcl&&e.dcl.show(),e.symbol&&e.symbol.show()})},i.prototype._hideSerieEles=function(t){$.each(t,function(t,e){e.bubble&&(e.bubble.hide(),e.bubble.shadow&&e.bubble.shadow.hide(),e.bubble.tracker&&e.bubble.tracker.hide(),$(e.bubble.node).data("wijchartDataObj")&&($(e.bubble.node).data("wijchartDataObj").visible=!1)),e.dcl&&e.dcl.hide(),e.symbol&&e.symbol.hide()})},i.prototype._indicatorLineShowing=function(e){t.prototype._indicatorLineShowing.call(this,e),$.each(e,function(t,e){e.bubble&&e.bubble.attr(e.hoverStyle)})},i.prototype._removeIndicatorStyles=function(t){$.each(t,function(t,e){e.bubble&&e.bubble.attr(e.style)})},i.prototype._parseTable=function(){if(this.element.is("table")){var t=this,e=t.element,i=t.options,n=$("caption",e),o=$("thead th",e),r=[],s=$("tbody tr",e),a=null,l=null,h=[],d=[],c=[],u=function(t){var e=$.trim(t);return isNaN(t)||(e=parseFloat(t.toString())),e};n.length&&(i.header=$.extend({visible:!0,text:$.trim($(n[0]).text())},i.header),n.length>1&&(i.footer=$.extend({visibel:!0,text:$.trim($(n[1]).text())},i.footer))),i.legend=$.extend({visible:!0},i.legend),a=$.trim(o.eq(1).text()),s.each(function(t,e){var i=$("td",e);return i.length>=3&&(h.push(u(i.eq(0).text())),d.push(u(i.eq(1).text())),c.push(u(i.eq(2).text()))),this}),l={label:a,
legendEntry:!0,data:{x:h,y:d,y1:c}},r.push(l),t.options.seriesList=r}},i.prototype._unbindLiveEvents=function(){var t=this;$("."+t.options.wijCSS.bubbleElement,t.chartElement[0]).off(".wijbubblechart").off("wijbubblechart"),t.tooltip&&(t.tooltip.destroy(),t.tooltip=null)},i.prototype._paintTooltip=function(){var e=this,i=e.chartElement.data("fields");t.prototype._paintTooltip.call(this),e.tooltip&&i&&i.trackers&&i.trackers.length&&(e.tooltip.setTargets(i.trackers),e.tooltip.setOptions({relatedElement:i.trackers[0]}))},i.prototype._getTooltipText=function(t,e){var i=$(e.node),n,o;return i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),o={data:n,value:n.value,label:n.label,total:n.total,target:e,fmt:t,x:n.x,y:n.y,y1:n.y1},$.proxy(t,o)()},i.prototype._prepBubbleData=function(){var t=this,e=t.options.seriesList,i=-Number.MAX_VALUE,n=Number.MAX_VALUE,o;$.each(e,function(t,e){o=e.data,o&&o.y1&&$.each(o.y1,function(t,e){i=Math.max(i,e),n=Math.min(n,e)})}),this.bubMax=i,this.bubMin=n,this.bubDiff=i-n},i.transform=function(t,e,n,o,r,s,a,l){var h,d=t,c=e-n,u=o.endX-o.startX,p=o.endY-o.startY;return 0>d&&(d=0),0===s?d=1:d/=r,d=i.transformByArea(d,a,l),d*=c,d+=n,h=Math.min(u,p),d*=h/200},i.transformByArea=function(t,e,i){var n=t;if("area"===e)switch(i){case"circle":n=Math.sqrt(n/Math.PI);break;case"tri":case"invertedTri":n=Math.sqrt(n/(3*Math.sin(Math.PI/6)*Math.cos(Math.PI/6)));break;case"box":n=Math.sqrt(n/2);break;case"diamond":case"cross":n=Math.sqrt(n/2);break;default:n=Math.sqrt(4*n/Math.PI)}return n},i}(t.wijchartcore);t.wijbubblechart=i,i.prototype.widgetEventPrefix="wijbubblechart";var n=function(){function t(){this.initSelector=":jqmData(role='wijbubblechart')",this.wijCSS={bubbleChart:"wijmo-wijbubblechart",bubbleElement:"wijbubblechart-bubble",bubbleTracker:"bubbletracker",bubbleLabel:"wijbubblechart-label",bubbleSymbol:"wijbubblechart-symbol"},this.minimumSize=5,this.maximumSize=20,this.sizingMethod="diameter",this.animation={enabled:!0,duration:1e3,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.seriesList=[],this.seriesHoverStyles=[{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5}],this.chartLabel={position:"inside",compass:"north",visible:!0,style:{},chartLabelFormatString:""},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return t}();i.prototype.options=$.extend(!0,{},t.wijchartcore.prototype.options,new n),$.wijmo.registerWidget("wijbubblechart",i.prototype);var o=function(){function e(t,e){this.element=t,this.options=e,this._init()}return e.prototype._init=function(){var t=this.options,e=t.bounds;this.fields=this.element.data("fields")||{},this.canvas=t.canvas,this.seriesList=$.arrayClone(t.seriesList),this.seriesStyles=t.seriesStyles,this.seriesHoverStyles=t.seriesHoverStyles,this.startLocation={x:e.startX,y:e.startY},this.width=e.endX-this.startLocation.x,this.height=e.endY-this.startLocation.y,this.seriesEles=[],this.bubbles=[],this.bubbleInfos=[],this.trackers=this.canvas.set(),this.currentIndex=0},e.prototype.initAnimationState=function(t,e){var i=t.bubble,n=t.symbol,o;"circle"===i.type?i.attr({r:1e-4,cx:e.startX,cy:e.endY}):(o=i.wijGetBBox(),i.transform("t"+(e.startX-o.x)+","+(e.endY-o.y)+"s0.001..."),i.shadow&&i.shadow.transform("t"+(e.startX-o.x)+","+(e.endY-o.y)+"s0.001...")),n&&n.hide()},e.prototype.playAnimation=function(){var t=this,e=t.options,i=e.animation,n=e.bounds,o=t.fields.bubblesAnimationInfos,r=[],s=t.fields.bubbleInfos,a=e.seriesTransition,l,h,d;i&&i.enabled?(l=i.duration||400,h=i.easing,$.each(s,function(e,i){var s=i.bubble,c,u,p=s.wijGetBBox();c="circle"===s.type?{r:s.attr("r"),cx:s.attr("cx"),cy:s.attr("cy")}:{transform:s.matrix.toTransformString(),"stroke-width":s.attr("stroke-width"),width:p.width,x:p.x,y:p.y},s.shadow&&s.shadow.hide(),o&&a.enabled?(u=o[e],u?("circle"===s.type?s.attr({cx:u.cx,cy:u.cy,r:u.r}):(p=s.wijGetBBox(),d=u.width/p.width,c.transform=s.matrix.toTransformString(),s.transform(Raphael.format("s{0}t{1}{2}...",d,u.x-p.x,u.y-p.y)),s.shadow&&s.shadow.transform(Raphael.format("s{0}t{1}{2}...",d,u.x-p.x,u.y-p.y))),l=a.duration,h=a.easing):t.initAnimationState(i,n)):t.initAnimationState(i,n),r.push(c),s.wijAnimate(c,l,h,function(){$(i.bubble.node).data("wijchartDataObj")&&$(i.bubble.node).data("wijchartDataObj").visible&&(i.dcl&&i.dcl.show(),i.symbol&&(i.symbol.show(),i.bubble.wijAttr("opacity",.1)),s.shadow&&s.shadow.show())})}),t.fields.bubblesAnimationInfos=r):$.each(s,function(t,e){$(e.bubble.node).data("wijchartDataObj")&&$(e.bubble.node).data("wijchartDataObj").visible&&(e.dcl&&e.dcl.show(),e.symbol&&e.symbol.show())})},e.prototype.getSymbol=function(t,e){var i;return $.each(t,function(t,n){return t===e?(i=n,!1):void 0}),i},e.prototype.getLabelVisible=function(t,e){var i=!0;return $.each(t,function(t,n){return e===n?(i=!1,!1):void 0}),i},e.prototype.paintMarker=function(t,e,i,n){var o;return this.canvas[t]&&(o=this.canvas[t](e,i,n)),o},e.prototype.getLabelBox=function(t){var e=this.canvas.text(0,0,t),i=e.wijGetBBox(),n;return n={width:i.width,height:i.height},e.remove(),n},e.prototype.applyLabelCompass=function(t,e){var i=this.options.chartLabel.compass||"north",n=this.getLabelBox(e),o=t.r;switch(i){case"north":t.y-=o+n.height/2;break;case"south":t.y+=o+n.height/2;break;case"east":t.x+=o+n.width/2;break;case"west":t.x-=o+n.width/2}},e.prototype.paintDefaultChartLabel=function(t,e){var i=this.options,n=i.chartLabel,o=i.culture,r=$.extend(!0,{},i.textStyle,i.chartLabelStyle,n.style),s=$.round(e,2),a=""===n.chartLabelFormatString?i.chartLabelFormatString:n.chartLabelFormatString,l=this.options.widget,h;return a&&a.length&&(s=Globalize.format(s,a,o)),h=l._text.call(l,t.x,t.y,s).attr(r)},e.prototype.paintbubble=function(e,n,o,r,s,a,l,h){var d=e.data,c=r.min,u=s.min,p=r.max,g=s.max,f=a/(p-c),m=l/(g-u),w=[],y=this.options,v=this,_=y.bounds,S=y.wijCSS,x=y.widget,b=y.chartLabel,C=y.bubbleRadius,D,I,j,T;void 0!==d.y1&&($.each(d.y1,function(a,l){if(void 0===d.x||void 0===d.y)return!0;var h=d.x[a],u=d.y[a],p=e.markers||{},E=p.type||"circle",k=p.symbol,L=e.invisibleMarkLabels||[],P,M,F,A,B,R,O,G,U,N;C?(U=C[v.currentIndex],v.currentIndex++):U=i.transform(l,y.maximumSize,y.minimumSize,y.bounds,v.options.widget.bubMax,v.options.widget.bubDiff,y.sizingMethod,E),r.isTime?h=$.toOADate(h):isNaN(h)&&(h=a),s.isTime&&(u=$.toOADate(u)),B=_.startX+(h-c)*f,R=_.startY+(g-u)*m,k&&(O=v.getSymbol(k,a)),A=v.paintMarker(E,B,R,U),A.attr(n),O&&(I=O.width||2*U,j=O.height||2*U,G=v.canvas.image(O.url,B-U,R-U,I,j)),v.options.shadow&&t.ChartUtil.paintShadow(A,2,null),$.wijraphael.addClass($(A.node),S.canvasObject+" "+S.bubbleElement),O&&A.attr("opacity",.1),F=$.extend(!1,{index:a,bubble:A,style:n,y1:l,x:h,y:u,type:"bubble",hoverStyle:o,visible:!0},e),O&&(F.symbol=!0,F.hoverStyle=$.extend({},o,{opacity:.1}),$(G.node).data("wijchartDataObj",F),$.wijraphael.addClass($(G.node),S.bubbleSymbol)),$(A.node).data("wijchartDataObj",F),x.dataPoints=x.dataPoints||{},x.pointXs=x.pointXs||[],T=$.round(B,2),x.dataPoints[T.toString()]||(x.dataPoints[T.toString()]=[],x.pointXs.push(T)),x.dataPoints[T.toString()].push(F),N=A.clone(),$.browser.msie&&parseInt($.browser.version)<9?N.attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}):N.attr({opacity:.01,fill:"white","fill-opacity":.01}),$(N.node).data("owner",$(A.node)),$.wijraphael.addClass($(N.node),S.canvasObject+" "+S.bubbleElement+" "+S.bubbleTracker),A.tracker=N,v.trackers.push(N),v.bubbles.push(A),v.fields.bubbles=v.bubbles,P={x:B,y:R,r:U},b.visible&&v.getLabelVisible(L,a)&&("outside"===b.position&&v.applyLabelCompass(P,l),D=v.paintDefaultChartLabel(P,l),D.hide(),$(D.node).data("wijchartDataObj",F),$.wijraphael.addClass($(D.node),S.bubbleLabel)),M={bubble:A,dcl:D,symbol:G},v.bubbleInfos.push(M),w.push(M),e.visible===!1&&(A.hide(),D&&D.hide(),N.hide(),G&&G.hide())}),v.fields.bubbleInfos=v.bubbleInfos,v.seriesEles.push(w))},e.prototype.paintBubbles=function(){var t=this,e=t.options,i=e.xAxisInfo,n=e.yAxisInfo;$.each(t.seriesList,function(e,o){var r=t.seriesStyles[e],s=t.seriesHoverStyles[e];t.paintbubble(o,r,s,i,n,t.width,t.height,t.startLocation)})},e.prototype.bindLiveEvents=function(t,e,i,n,o,r,s,a){var l=this.options,h=l.wijCSS,d="",c={mousedown:function(i){if(!a){var n=$(i.target),o;n.data("owner")&&(n=n.data("owner")),o=n.data("wijchartDataObj"),e.call(t,i,o)}},mouseup:function(e){if(!a){var n=$(e.target),o;n.data("owner")&&(n=n.data("owner")),o=n.data("wijchartDataObj"),i.call(t,e,o)}},mouseover:function(e){if(!a){var i=$(e.target),o,r;i.data("owner")&&(i=i.data("owner")),o=i.data("wijchartDataObj"),r=o.bubble,o.hoverStyle?(r.attr(o.hoverStyle),r.shadow&&r.shadow.attr(o.hoverStyle)):r&&r.attr({opacity:"0.8"}),n.call(t,e,o)}},mouseout:function(e){if(!a){var i=$(e.target),n,r;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),r=n.bubble,n.symbol||(n.hoverStyle?(n.hoverStyle["stroke-width"]&&!n.style["stroke-width"]&&(r.attr("stroke-width",""),r.shadow&&r.shadow.attr("stroke-width","")),r.wijAttr({transform:""}),r.wijAttr(n.style),n.style.opacity&&(r.attr("opacity",n.style.opacity),r.shadow&&r.shadow.attr("opacity",n.style.opacity))):r&&r.attr({opacity:"1"}),o.call(t,e,n))}},mousemove:function(e){if(!a){var i=$(e.target),n,o;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),r.call(t,e,n)}},click:function(e){if(!a){var i=$(e.target),n;i.data("owner")&&(i=i.data("owner")),n=i.data("wijchartDataObj"),s.call(t,e,n)}}};$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(d="wij"),$.each(["click","mouseover","mouseout","mousemove","mousedown","mouseup"],function(e,i){$("."+h.bubbleTracker,t).on(d+i+".wijbubblechart",c[i])})},e.prototype.render=function(){var t=this.options,e=t.mouseDown,i=t.mouseUp,n=t.mouseOver,o=t.mouseOut,r=t.mouseMove,s=t.click,a=t.disabled;this.paintBubbles(),this.fields.seriesEles=this.seriesEles,this.playAnimation(),this.trackers.toFront(),this.fields.trackers=this.trackers,this.bindLiveEvents(this.element,e,i,n,o,r,s,a),this.element.data("fields",this.fields)},e}();t.BubbleChartRender=o}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijcarousel",o="wijmo-wijcarousel-",r="wijmo-wijcarousel ",s=o+"list",a=o+"item ",l=o+"clip",h=o+"current",d=o+"horizontal-multi",c=o+"horizontal",u=o+"button",p=o+"vertical-multi",g=o+"vertical",f=o+"button-next",m=o+"button-previous",w=o+"preview",y="<a><span></span></a>",v=".wijmo-wijcarousel-pager,."+u+",."+f+",."+m,_="<div></div>",S='<li class="wijmo-wijcarousel-page"><a></a></li>',x="li.wijmo-wijcarousel-page",b=".wijmo-wijcarousel-text,.wijmo-wijcarousel-caption",C=1,D=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._handleDisabledOption=function(t,e){var i=this,n=i.options;i.pager&&!i.pager.is(":hidden")&&i.pager.wijpager("option","disabled",t),i._applyBtnClass()},e.prototype._initStates=function(t,e){var i=this;i.count=0,i.currentIdx=t.start,i.timeout=null,i.isHorizontal="horizontal"===t.orientation,i.width=e.width()||640,i.height=e.height()||480,i.offset=0},e.prototype._set_showControlsOnHover=function(t){var e=this;e.container.unbind("mouseenter."+e.widgetName),e.container.unbind("mouseleave."+e.widgetName),t&&e.container.bind("mouseenter."+e.widgetName,function(){e.options.disabled||e._showControls()}).bind("mouseleave."+e.widgetName,function(){e.options.disabled||e._hideControls()}),e.container.find(v).stop(!0,!0)[t?"hide":"show"]()},e.prototype._create=function(){var t=this,e=t.options,n=t.element;if(window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t._initStates(e,n),t._createDom(t.isHorizontal),t.list.bind("click."+t.widgetName,i.proxy(t._itemClick,t)),e.showControlsOnHover&&(t.container.bind("mouseenter."+t.widgetName,function(){t.options.disabled||t._showControls()}).bind("mouseleave."+t.widgetName,function(){t.options.disabled||t._hideControls()}),t.container.find(v).hide()),e.loadCallback&&i.isFunction(e.loadCallback)&&t._trigger("loadCallback",null,t),e.disabledState){var o=e.disabled;t.disable(),e.disabled=o}else e.auto&&t.play();e.disabled&&t.disable();try{e.display=parseFloat(e.display)}catch(r){e.display=1}t.element.is(":hidden")&&t.element.wijAddVisibilityObserver&&t.element.wijAddVisibilityObserver(function(){t.refresh(),t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijcarousel")},e.prototype._showControls=function(){this.container.find(v).stop(!0,!0).fadeIn(600,function(){i(this).css("opacity","")})},e.prototype._hideControls=function(){this.container.find(v).stop(!0,!0).fadeOut(600)},e.prototype._applyContainerStyle=function(t,e){var i=this,n=i.options,o={},r=i.list,s=0,a,l=0,h=t?"left":"top",d=0,c,u=t?"width":"height";if(a=i.itemBound[t?"w":"h"],i.count=i.list.children("li").length,s=i.count*a,i.list[u](s),i.clip[u](n.display*a),i.clip[t?"height":"width"](i.itemBound[t?"h":"w"]),n.loop){for(c=r.find(">li:first"),n.preview&&!!e&&(c=c.next()),d=c.data("itemIndex"),d;d<i.currentIdx;d++)r.children("li:first").appendTo(r);if(n.preview){if(!e)for(d=0;C>d;d++)r.children("li:last").prependTo(r);l=-a*C}o[h]=l,r.css(o)}else o[h]=-a*i.currentIdx,r.css(o)},e.prototype._applyListStyle=function(){var t=this,e=t.options,i="horizontal"===e.orientation,n=0,o,r=i?"width":"height";t.itemBound=t._getItemBound(),o=t.itemBound[i?"w":"h"],n=t.count*o,t.list[r](n)},e.prototype._createButtons=function(t,e){var n=this,o=n.options,r,s=o.wijCSS.stateDisabled;i.each(["prevBtn","nextBtn"],function(a,l){var h=o[l+"Class"],d="nextBtn"===l,c=d?"next":"previous",u=d?f:m,p=d?e:t;if(h&&h.defaultClass?(s=h.disableClass||s,r=h.hoverClass,n[l]=i('<a class="'+o.wijCSS.stateDefault+'"></a>').addClass(h.defaultClass).mouseover(function(){i(this).hasAllClasses(s)||i(this).addClass(r)}).mouseout(function(){i(this).hasAllClasses(s)||i(this).removeClass(r)})):n[l]=i(n._createBtn(u,p)),n[l].bind("click."+n.widgetName,function(t){if(!n.options.disabled){var e=i(this);e.hasAllClasses(o.wijCSS.stateDisabled)||n[c].call(n)}}).appendTo(n.container),i.browser.msie&&n.clip.find("iframe").length>0){var g=n.element.children("iframe.bgiframe."+l+"Frame");0===g.length&&(g=i('<iframe class="bgiframe '+l+'Frame" frameborder="0" tabindex="-1" src="javascript: false;" style="position:absolute;top:0px;left:0px;opacity:0;" />'),g.width(n[l].outerWidth()),g.height(n[l].outerHeight()),n.container.append(g))}})},e.prototype._applyBtnClass=function(){var t=this,e=t.options,n=e.wijCSS.stateDisabled,o=e.wijCSS.stateHover;i.each(["prevBtn","nextBtn"],function(i,r){var s=e[r+"Class"],a,l=t[r];s&&(n=s.disableClass||n,o=s.hoverClass||o),a="prevBtn"===r?t.currentIdx<=0:t.currentIdx+e.display>=t.count,a&&!e.loop||e.disabled?l.removeClass(o).addClass(n):l.hasAllClasses(n)&&l.removeClass(n)})},e.prototype._applyBtnStyle=function(t){var e=this,n=0,o,r=e.options.wijCSS,s={collision:"none",of:e.container,my:t?"right{offset} center":"center bottom{offset}",at:t?"right center":"center bottom"},a={collision:"none",of:e.container,my:t?"left{offset} center":"center top{offset}",at:t?"left center":"center top"},l="inside"===e.options.buttonPosition,h,d,c=["cornerBottom","cornerTop","cornerRight","cornerLeft"],u=2*(t?1:0)+(l?1:0),p=2*(t?1:0)+(l?0:1),g=function(t,e,n,o,r){var s="";if(t.removeClass(e).addClass(n),!isNaN(o)&&0!==o&&(s=o>0?"+"+o:"-"+-o),r.my=r.my.replace(/\{offset\}/,s),t.position(r),i.browser.msie){var a=t.next("iframe.bgiframe");a.length&&(a.css("left",t.css("left")),a.css("top",t.css("top")))}};n=t?e.prevBtn.width():e.prevBtn.height(),o=l?0:n,h=r[c[u]],d=r[c[p]],g(e.nextBtn,d,h,o,s),g(e.prevBtn,h,d,-o,a),e._applyBtnClass()},e.prototype._createDom=function(t){var e=this,n=e.options,o=e.element,a,l,h,u;if(o.is("div"))e.list=o.children("ul:eq(0)"),e.container=e.element,e.list.length||(e.list=i("<ul></ul>").appendTo(e.container));else{if(!o.is("ul"))return;e.list=o,e.container=o.parent()}e.itemBound=e._getItemBound(),t?(a=n.display>1&&!n.preview?d:c,l=n.wijCSS.iconArrowRight,h=n.wijCSS.iconArrowLeft):(a=n.display>1&&!n.preview?p:g,l=n.wijCSS.iconArrowDown,h=n.wijCSS.iconArrowUp),e.list.addClass(s).addClass(n.wijCSS.helperClearFix),u=r+n.wijCSS.widget+" "+a+" "+(n.preview?w+" ":"")+(n.display>1?n.wijCSS.content+" "+n.wijCSS.cornerAll:""),e.container.addClass(u),e._createItems(t),e._createClip(t),e._applyContainerStyle(t),e._createButtons(h,l),e._applyBtnStyle(t),n.preview&&e._createPreview(),n.showTimer&&e._createTimer(),n.showPager&&e._createPager(),n.showControls&&e._createControls()},e.prototype._createPreview=function(){var t=this,e=t.options,i,n,o="horizontal"===e.orientation,r=o?"left":"top",s=o?"right":"bottom",a,l;for(n=t.itemBound[o?"w":"h"],i=t.offset=Math.round(n/4),a=e.display*n+2*i,t.clip[o?"width":"height"](a),t.list.css(r,function(t,e){return parseFloat(e)+i}),t.clip.css(r,function(t,e){return-i}),t.container.css("margin-"+r,i+"px").css("margin-"+s,i+"px"),t.list.find(b).hide(),l=0;l<e.display;l++)t._getItemByIndex(t.currentIdx+l).find(b).show()},e.prototype._createItemsFromData=function(t){var e=this;i.isArray(t)&&t.length&&i.isPlainObject(t[0])&&!i.isEmptyObject(t[0])&&(e.list.empty(),i.each(t,function(t,n){var o;return i.isPlainObject(n)?(o=e._generateMarkup(n),void e.list.append(o)):!0}))},e.prototype._generateMarkup=function(t){var e,n;if(i.isPlainObject(t))return e=i("<li></li>"),"string"==typeof t.linkUrl&&t.linkUrl&&(n=i("<a>").attr("href",t.linkUrl),n.appendTo(e)),"string"==typeof t.imageUrl&&t.imageUrl&&i("<img>").attr("src",t.imageUrl).appendTo(n||e),"string"==typeof t.caption&&t.caption&&i("<span>").html(t.caption).appendTo(e),e},e.prototype._createItems=function(t){var e=this,n,o,r=e.options,s,a;if(e.list&&(e._createItemsFromData(r.data),e.list.children("li").each(function(t,n){var o=i(n);e._createItem(o,t)}),s=e.list.children("li").eq(e.currentIdx).addClass(h),r.preview&&r.display>1)){for(n=a=s,o=0;o<r.display-1;o++)a=a.next(),n=n.add(a);n.find("div.wijmo-wijcarousel-mask").css({opacity:0})}},e.prototype._createItem=function(t,e){var n=this,o=n.options,r,s;return r=t.addClass(a).addClass(o.wijCSS.helperClearFix).find("img:eq(0)").attr("role","img").addClass("wijmo-wijcarousel-image"),n._applyItemBound(t),s=t.children("span:eq(0)").hide(),n._createCaption(t,r,s),o.preview&&i('<div class="wijmo-wijcarousel-mask">').appendTo(t),t.data("itemIndex",e),t},e.prototype._applyItemBound=function(t){var e=this,i=e.itemBound.w,n=e.itemBound.h;e.itemWidth&&e.itemHeight||(t.width(i).height(n),e.itemWidth=i-(t.outerWidth(!0)-i),e.itemHeight=n-(t.outerHeight(!0)-n)),t.width(e.itemWidth).height(e.itemHeight)},e.prototype._createCaption=function(t,e,n){var o=this,r=o.options,s,a,l,h,d;r.showCaption&&(s=n.html()||e.attr("title"),s&&s.length&&(l=i("<span></span>").html(s),h=i(_).addClass([r.wijCSS.helperClearFix,"wijmo-wijcarousel-caption"].join(" ")).appendTo(t),a=i(_).addClass([r.wijCSS.helperClearFix,r.wijCSS.content,"wijmo-wijcarousel-text"].join(" ")).append(l).appendTo(t),o._applyCaptionStyle(h,a)))},e.prototype._applyCaptionStyle=function(t,e){var n=t.add(e),o;n.width(this.itemWidth),i.browser.webkit?(o=e.children("span").css("display","inline-block").height(),e.children("span").css("display","")):o=e.children("span").height(),n.height(o)},e.prototype._showCaption=function(t,e){var i=this,n=i._getItemByIndex(t),o=n.find(".wijmo-wijcarousel-text"),r=n.find(".wijmo-wijcarousel-caption");o.length&&o.fadeIn(300,function(){e>t&&i._showCaption(t+1,e)}),r.length&&(r.show(),r.animate({opacity:.5},300))},e.prototype._hideCaption=function(){this.element.find(b).hide()},e.prototype._createClip=function(t){this.clip=this.list.wrap("<div></div>").parent().addClass(l)},e.prototype._createBtn=function(t,e){var n=i(y),o=this.options;return n.addClass(o.wijCSS.stateDefault+" "+t).attr("role","button").mouseover(function(){i(this).hasAllClasses(o.wijCSS.stateDisabled)||i(this).addClass(o.wijCSS.stateHover)}).mouseout(function(){i(this).hasAllClasses(o.wijCSS.stateDisabled)||i(this).removeClass(o.wijCSS.stateHover)}).children("span:eq(0)").addClass(o.wijCSS.icon+" "+e),n},e.prototype._createControls=function(){var t=this,e=t.options,n={collision:"none",of:t.container,my:"center bottom",at:"center bottom"};e.control&&(t.controls=i(e.control).css({position:"absolute"}).appendTo(t.container),i.extend(n,e.controlPosition),t.controls.position(n))},e.prototype._createTimer=function(){var t=this,e=t.options;t._createPausePlay(),t.progressBar=i("<div></div>").addClass("wijmo-wijcarousel-timerbar-inner "+e.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),t.timer=i("<div></div>").addClass("wijmo-wijcarousel-timerbar "+e.wijCSS.cornerAll).appendTo(t.container).append(t.progressBar).append(t.playPauseBtn)},e.prototype._createPausePlay=function(){var t=this,e=t.options;t.playPauseBtn=i(t._createBtn(u,e.auto?e.wijCSS.iconPause:e.wijCSS.iconPlay)).bind("click."+t.widgetName,function(){if(!t.options.disabled){var n=i(this).children("span:eq(0)");t[n.hasAllClasses(e.wijCSS.iconPlay)?"play":"pause"]()}})},e.prototype._createPagingItem=function(t,e,n,o){var r=i(S).attr({role:"tab","aria-label":o+1,title:o+1}).addClass(this.options.wijCSS.stateDefault),s,a;if(t)r.addClass("wijmo-wijcarousel-dot");else{if(!(e&&e.images&&e.images[o]))return;s=e.imageWidth,a=e.imageHeight,s&&a&&r.width(s).height(a),r.children("a").append(i("<img>").attr("src",e.images[o]))}n.append(r)},e.prototype._createPaging=function(t){var e=this,n=e.options,o,r,s,a=n.thumbnails,l="dots"===t;for(e.container.append(e.pager=i('<div><ul class="wijmo-list '+n.wijCSS.cornerAll+" "+n.wijCSS.helperClearFix+' role="tablist"></ul></div>')),l||e.pager.addClass("wijmo-wijcarousel-thumbnails"),r=e.pager.children("ul.wijmo-list"),o=0;o<e.count;o++)e._createPagingItem(l,a,r,o);s=e.pager.find("li").eq(e.currentIdx),s.length&&e._activePagerItem(s),a&&i.each(["mousedown","mouseup","mouseover","mouseout","click"],function(t,e){var i=a[e];i&&"string"==typeof i&&window[i]&&(a[e]=window[i])}),e.pager.bind("mouseover."+e.widgetName,function(t){e.options.disabled||e._pageingEvents(t,"mouseover",a,l,function(t){t.addClass(n.wijCSS.stateHover)})}).bind("mouseout."+e.widgetName,function(t){e.options.disabled||e._pageingEvents(t,"mouseout",a,l,function(t){t.removeClass(n.wijCSS.stateHover)})}).bind("click."+e.widgetName,function(t){e.options.disabled||e._pageingEvents(t,"click",a,l,function(t){e.scrollTo(t.index()),e._activePagerItem(t)})}),l||i.each(["mousedown","mouseup"],function(t,n){i.isFunction(a[n])&&e.pager.bind(n,function(t){if(!e.options.disabled){var o=i(t.target).closest(x);o.length&&a[n].call(o,t)}})})},e.prototype._pageingEvents=function(t,e,n,o,r){var s=i(t.target).closest(x);s.length&&(i.isFunction(r)&&r.call(t,s),!o&&i.isFunction(n[e])&&n[e].call(s,t))},e.prototype._activePagerItem=function(t){var e=this.options.wijCSS.stateActive;t.addClass(e).attr("aria-selected","true").siblings("li").removeClass(e).removeAttr("aria-selected")},e.prototype._createWijSlider=function(){var t=this,e=t.options.sliderOrientation,n={orientation:e,range:!1,min:0,max:t.count-1,step:1,value:t.currentIdx,buttonClick:function(e,i){var n=i.value;t.scrollTo(n)},slide:function(e,i){var n=i.value;t.scrollTo(n)}},o=i("<div></div>").css("margin-bottom","10px").css("horizontal"===e?"width":"height","200px").appendTo(t.container);t.pager=o.wijslider(n).parent().wrap("<div>").parent().addClass("wijmo-wijcarousel-slider-wrapper")},e.prototype._createWijPager=function(){var t=this,e={pageCount:t.count,pageIndex:t.currentIdx,pageButtonCount:t.count,mode:"numeric",pageIndexChanged:function(e,i){var n=i.newPageIndex;t.scrollTo(n)}},n=i("<div></div>").appendTo(t.container);t.pager=n.wijpager(e).css({position:"absolute"})},e.prototype._createPager=function(){var t=this,e=t.options,n={collision:"none",of:t.container,my:"right top",at:"right bottom"};if("numbers"===e.pagerType)t._createWijPager();else if("dots"===e.pagerType||"thumbnails"===e.pagerType)t._createPaging(e.pagerType),t.pager.css({position:"absolute"});else{if(!i.wijmo.wijslider||"slider"!==e.pagerType)return;t._createWijSlider(),"horizontal"!==e.sliderOrientation&&(n.my="left center",n.at="right center")}t.pager.width(t.pager.width()+1),i.extend(n,e.pagerPosition),e.pagerPosition=n,t.pager.addClass("wijmo-wijcarousel-pager").position(n)},e.prototype._setOption=function(t,e){var n=this,o=n.options,r,s,a,l="horizontal"===o.orientation;if("pagerPosition"===t||"animation"===t||"controlPosition"===t)i.extend(!0,o[t],e);else switch(a=o[t],i.Widget.prototype._setOption.apply(n,arguments),t){case"showControls":case"showPager":case"showTimer":if(e===a)break;r=t.replace(/show/i,"").toLowerCase(),s=t.replace(/show/i,"_create"),e===!0?n[r]?n[r].jquery&&n[r].show():n[s]():n[r].hide();break;case"loop":case"orientation":case"display":case"preview":e!==a&&(n._wijdestroy(),n._create());break;case"data":n._createItems(l),n._applyContainerStyle(l),n._applyBtnClass(),o.showPager&&n._createPager();break;case"showCaption":e?n._createItems(l):n.element.find(b).remove();break;case"buttonPosition":n._applyBtnStyle(l);break;case"pagerType":e!==a&&(n.pager&&n.pager.jquery&&(n.pager.remove(),n.pager=null),n._createPager());break;case"disabled":n._handleDisabledOption(e,n.element);break;case"showControlsOnHover":n._set_showControlsOnHover(e)}},e.prototype._getItemBound=function(){var t={},e=this,i=e.options;return t="horizontal"===i.orientation?{w:Math.round(e.width/i.display),h:e.height}:{w:e.width,h:Math.round(e.height/i.display)}},e.prototype._stopAnimation=function(){var t=this;t.isPlaying&&t.progressBar&&t.progressBar.stop().css({width:"0%"}),t.list.stop(!0,!0)},e.prototype._itemClick=function(t){var e=i(t.target),n=this,o=n.options,r=n.currentIdx,s=e.closest("li."+a),l=s.data("itemIndex"),h,d;return n.options.disabled?void t.preventDefault():void(s.length>0&&((o.preview&&r>l||l>r+o.display-1)&&(h=n._getItemByIndex(r).index(),d=s.index()>h?"next":"previous",n[d]()),n._trigger("itemClick",t,{index:l,el:s})))},e.prototype._wijdestroy=function(){var t=this,e=t.options.wijCSS;t.container.removeClass("wijmo-wijcarousel "+e.widget).removeClass("wijmo-wijcarousel-horizontal").removeClass("wijmo-wijcarousel-vertical"),t.timeout&&(t.list.stop(!0),window.clearTimeout(t.timeout),t.timeout=null),t.options.showTimer&&t.progressBar&&t.progressBar.stop(!0),t.list.unwrap().removeClass("wijmo-wijcarousel-list").removeClass(e.helperClearFix).unbind("."+t.widgetName).removeAttr("style").children("li").each(function(t,n){var o=i(n);o.removeClass("wijmo-wijcarousel-item").removeClass(e.helperClearFix).removeClass(h),o.children("img").removeClass("wijmo-wijcarousel-image"),o.children(b).remove(),o.css({width:"",height:""}),o.removeData("itemIndex")}),t.itemWidth=t.itemHeight=void 0,t.element.find(v+",.wijmo-wijcarousel-timerbar").remove(),t.pager&&(t.pager.remove(),t.pager=null),t.timer&&(t.timer.remove(),t.timer=null),t.element.find("li>span").css("display","")},e.prototype.destroy=function(){this._wijdestroy(),i.Widget.prototype.destroy.apply(this)},e.prototype._resetDom=function(){var t=this;t._applyListStyle(),t.list.children("li").each(function(e,n){var o=i(n),r=o.children("div.wijmo-wijcarousel-caption"),s=o.children("div.wijmo-wijcarousel-text");t._applyItemBound(o),t._setStyle(r.add(s),function(){t._applyCaptionStyle(r,s)})}),t._applyContainerStyle(t.isHorizontal,!0),t.options.preview&&t._createPreview(),t._setStyle(t.prevBtn.add(t.nextBtn),function(){t._applyBtnStyle(t.isHorizontal)}),t._setStyle(t.pager,function(){t.pager.position(t.options.pagerPosition)}),t._setStyle(t.controls,function(){t.controls.position(t.options.controlPosition)})},e.prototype._setStyle=function(t,e){var i=!0;t&&0!==t.length&&("none"==t.css("display")&&(i=!1,t.css("display","")),e.call(this),i||t.css("display","none"))},e.prototype.refresh=function(){var t=this,e=t.options,i=t.element;t.width=i.width()||640,t.height=i.height()||480,t.itemWidth=t.itemHeight=0,t._resetDom(),t.pause()},e.prototype.play=function(){var t=this,e=t.options;if(!t.isPlaying&&!e.disabled){if(0===e.interval)return t.pause();if(e.showTimer&&t.progressBar)t.progressBar.css({width:"0%"}),t.playPauseBtn.children("span:eq(0)").removeClass(e.wijCSS.iconPlay).addClass(e.wijCSS.iconPause),t.progressBar.animate({width:"100%"},e.interval,null,function(){t._scroll("next",e.step)});else{if(t.timeout)return;t.timeout=window.setTimeout(function(){t.next()},e.interval)}t.isPlaying=!0}},e.prototype.pause=function(){var t=this,e=t.options;if(e.showTimer&&t.progressBar)t.progressBar.stop(!0).css({width:"0%"}),t.playPauseBtn.children("span:eq(0)").removeClass(e.wijCSS.iconPause).addClass(e.wijCSS.iconPlay);else{if(null===t.timeout)return;window.clearTimeout(t.timeout),t.timeout=null}t.isPlaying=!1},e.prototype.next=function(){var t=this,e=t.options.step;"number"!=typeof e||1>e||(t._stopAnimation(),t._scroll("next",e))},e.prototype.previous=function(){var t=this,e=t.options.step;"number"!=typeof e||1>e||(t._stopAnimation(),t._scroll("previous",e))},e.prototype.scrollTo=function(t){var e=this,i,n;e._stopAnimation(),i=t>e.currentIdx?"next":"previous",n=Math.abs(t-e.currentIdx),t!==e.currentIdx&&e._scroll(i,n)},e.prototype._scroll=function(t,e){var n=this,o=n.options,r=n.list,s=0,a,l,d="horizontal"===o.orientation,c={},u=n.itemBound[d?"w":"h"],p=d?"left":"top",g=e,f={},m=0,w=n.currentIdx*u;if(o.loop){if(o.preview&&(s=m=-u*C+n.offset),"next"===t)s+=-u*g,c[p]=s;else{for(l=0;e>l;l++)s-=u,r.children("li:last").prependTo(r);f[p]=s,c[p]=m,r.css(f)}n._doAnimation(t,c,e,p,u)}else{if("next"===t)if(n.currentIdx+o.display+e<=n.count)s=-w-u*g;else{if(!(n.currentIdx+o.display<n.count))return;g=n.count-n.currentIdx-o.display,s=-w-u*g}else n.currentIdx-e>=0?s=-w+u*g:n.currentIdx>0&&(g=n.currentIdx,s=0);void 0!==s&&(c[p]=s+n.offset,n._doAnimation(t,c,g))}if(o.preview){for(a=i(),l=0;l<o.display;l++)a=a.add(n._getItemByIndex(n.currentIdx+l).find("div.wijmo-wijcarousel-mask:eq(0)"));a.stop(!0).animate({opacity:.6},o.animation.duration/2,function(){n._getItemByIndex(n.currentIdx).removeClass(h)})}},e.prototype._doAnimation=function(t,e,n,o,r){var s=this,a=s.list,l=s.options,h,d,c={complete:null},u,p={},g;s.list.children().length&&(g="next"===t?s.currentIdx+n:s.currentIdx-n,l.loop?(g=g%s.count+(0>g?s.count:0),u=function(){var e=0;if(l.preview&&(e=s.offset-C*r),"next"===t){for(d=0;n>d;d++)a.children("li:first").appendTo(a);o&&(p[o]=e,a.css(p))}s.currentIdx=g,s._setCurrentState(s.currentIdx)}):u=function(){s.currentIdx=g,s._setCurrentState(s.currentIdx)},c.complete=u,h={index:s.currentIdx,to:g,el:s._getItemByIndex(s.currentIdx)},s._trigger("beforeScroll",null,h)&&(l.animation&&l.animation.complete&&(l.animation.complete=void 0),i.extend(c,l.animation),s._hideCaption(),a.animate(e,c)))},e.prototype._setCurrentState=function(t){var e=this,n=e.options,o,r,s,a=t+n.display-1,l,d,c;if(n.loop?e.isPlaying&&(window.clearTimeout(e.timeout),e.timeout=null,e.isPlaying=!1,e.play()):(s=t+n.display<e.count,e.isPlaying&&s?(window.clearTimeout(e.timeout),e.timeout=null,e.isPlaying=!1,e.play()):e.progressBar&&e.pause(),e._applyBtnClass()),n.preview){for(d=i(),l=e._getItemByIndex(t),c=0;c<n.display;c++)d=d.add(e._getItemByIndex(t+c).find("div.wijmo-wijcarousel-mask:eq(0)"));d.animate({opacity:0},n.animation.duration/2,function(){l.addClass(h),e._showCaption(t,a)})}else e._showCaption(t,a);e.pager&&(i.wijmo.wijslider&&e.pager.find(":wijmo-wijslider").length?e.pager.find(":wijmo-wijslider:eq(0)").wijslider("value",t):i.wijmo.wijpager&&e.pager.is(":wijmo-wijpager")?e.pager.wijpager("option","pageIndex",t):e.pager.jquery&&(o=e.pager.find(">ul:eq(0)>li").eq(t),
o.length&&e._activePagerItem(o))),r={firstIndex:t,lastIndex:a},e._trigger("afterScroll",null,r)},e.prototype._getItemByIndex=function(t){var e=this,n=e.list,o,r=t%e.count;return e.options.loop?(n.children("li").each(function(t){var e=i(this);return e.data("itemIndex")===r?(o=e,!1):void 0}),o):n.children("li").eq(r)},e.prototype._collectionChanged=function(t){var e=this;e.count=e.count+("add"===t?1:-1),e._applyListStyle(),e.pager&&e.pager.jquery&&(e.pager.remove(),e.pager=null,e._createPager()),e._applyBtnClass()},e.prototype.add=function(t,e){var n=this,o,r;if("string"==typeof t)o=i(t);else if(t.jquery)o=t;else{if(!i.isPlainObject(t))return;o=n._generateMarkup(t)}o.is("li")||(o=o.wrap("<li></li>").parent()),r=o,"number"==typeof e&&e>=0&&e<n.count?(r.insertBefore(n._getItemByIndex(e)),n.list.children("li").each(function(t,n){var o=i(n);o.data("itemIndex")>=e&&o.data("itemIndex",o.data("itemIndex")+1)})):(0==e&&r.appendTo(n.list),r.insertAfter(n._getItemByIndex(n.count-1))),n._createItem(o,void 0!==e?e:n.count),n._collectionChanged("add")},e.prototype.remove=function(t){var e=this,n;"number"==typeof t&&t>=0&&t<e.count?(n=e._getItemByIndex(t),e.list.children("li").each(function(e,n){var o=i(n);o.data("itemIndex")>t&&o.data("itemIndex",o.data("itemIndex")-1)})):n=e._getItemByIndex(e.count-1),n&&n.remove(),e._collectionChanged("remove")},e}(t.wijmoWidget);e.wijcarousel=D;var I=function(){function t(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijcarousel')",this.data=[],this.auto=!1,this.interval=5e3,this.showTimer=!1,this.buttonPosition="inside",this.showPager=!1,this.prevBtnClass={defaultClass:"",hoverClass:"",disableClass:""},this.nextBtnClass={defaultClass:"",hoverClass:"",disableClass:""},this.pagerType="numbers",this.thumbnails={mouseover:null,mouseout:null,mousedown:null,mouseup:null,click:null,imageWidth:58,imageHeight:74,images:[]},this.pagerPosition={},this.orientation="horizontal",this.sliderOrientation="horizontal",this.loop=!0,this.animation={queue:!0,disable:!1,duration:1e3,easing:"linear"},this.start=0,this.display=1,this.preview=!1,this.step=1,this.showControls=!1,this.control="",this.controlPosition={},this.showCaption=!0,this.showControlsOnHover=!1,this.itemClick=null,this.beforeScroll=null,this.afterScroll=null,this.loadCallback=null}return t}();D.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new I),i.wijmo.registerWidget("wijcarousel",D.prototype)}(t.carousel||(t.carousel={}));var e=t.carousel}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijgallery",o="wijmo-wijgallery",r="wijmo-wijgallery-",s=r+"selected",a=r+"button-",l=r+"button",h="wijmo-wijgallery-thumbs-pointer-{0}",d="wijmo-wijgallery-flashwrapper",c='<div class="wijmo-wijgallery-frame"><div class="wijmo-wijgallery-content"></div></div>',u='<div class="wijmo-wijgallery-thumbs"></div>',p="<a><span></span></a>",g='<div class="wijmo-wijgallery-frame-{0}"><a href="#" class="wijmo-wijgallery-frame-link"></a></div>',f="<div></div>",m="li.wijmo-wijcarousel-item";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var w=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._setOption=function(t,e){var n=this,o=n.options,r,s,a,l;if("framePosition"===t||"thumbnailPosition"===t||"transitions"===t||"pagingPosition"===t)i.extend(!0,o[t],e);else switch(a=o[t],i.Widget.prototype._setOption.apply(n,arguments),t){case"disabled":n._handleDisabledOption(e,n.element);break;case"thumbnailOrientation":n.thumbs[n.thumbWidgetName]({orientation:e});break;case"thumbsDisplay":n.thumbs[n.thumbWidgetName]({display:e});break;case"autoPlay":n[e?"play":"pause"]();break;case"showCounter":case"showTimer":case"showControls":r=t.replace(/show/i,"").toLowerCase(),s=t.replace(/show/i,"_create"),e!==a&&(e===!0?n[r]?n[r].jquery&&n[r].show():n[s]():n[r].hide());break;case"showCaption":e?(n._createCaption(n.size),l=n._loadCaption(n.images[n.currentIdx]),l.show()):n.element.find(".wijmo-wijgallery-caption,.wijmo-wijgallery-text").remove();break;case"showPager":case"thumbsLength":case"thumbnailDirection":case"showControlsOnHover":case"mode":case"data":n._wijdestroy(),n._create()}},e.prototype._handleDisabledOption=function(t,e){var i=this;i.pager&&!i.pager.is(":hidden")?i.pager.wijpager("option","disabled",t):i.thumbs&&!i.thumbs.is(":hidden")&&i.thumbs[i.thumbWidgetName]({disabled:t})},e.prototype._initLi=function(t){var e=t.children("a:eq(0)"),n=t.find("img:eq(0)"),o=t.find("span:eq(0)"),r={url:null,thumbUrl:null,title:n.attr("alt"),caption:void 0};return e.length&&e.attr("href")?(r.url=e.attr("href"),r.title||(r.title=e.attr("title"))):n.length&&(r.url=n.attr("src")),o.length?r.caption=o:n.attr("title")&&(r.caption=i("<span>").html(n.attr("title"))),r.thumbUrl=n.attr("src"),r},e.prototype._initStatus=function(){var t=this,e;t.images=[],t.ul=t.element.children("ul"),e=t.ul.children("li"),t._count=e.length,e.each(function(e){var n=t._initLi(i(this));t.images.push(n)})},e.prototype._createMarkupFromData=function(){var t=this,e=t.options,n=e.data,o=t.element,r=o.children("ul:eq(0)");t.images=n,r.length?r.empty():r=i("<ul>").appendTo(o),t.ul=r,i.each(n,function(t,e){var n=i("<a>"),o=i("<li>"),s=i("<img>");e.url&&n.attr("href",e.url),e.thumbUrl&&s.attr("src",e.thumbUrl),e.title&&s.attr("alt"),n.append(s).appendTo(o),o.appendTo(r)}),t._count=n.length},e.prototype._create=function(){var t=this,e=t.options;t.container=t.element,t.container.addClass([o,e.wijCSS.widget].join(" ")),t.currentThumbIdx=0,t.currentIdx=-1,t.timerCount=0,window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),e.showPager?(e.pagingPosition=!0,e.thumbnails=!1):e.thumbnails=!0,e.data&&e.data.length?t._createMarkupFromData():t._initStatus(),e.loadCallback&&i.isFunction(e.loadCallback)&&t._trigger("loadCallback",null,t),t._createDom(),e.autoPlay&&t._play(!0),e.showControlsOnHover&&(t.frame.find(".wijmo-wijpager,.wijmo-wijgallery-button-next,.wijmo-wijgallery-counter,.wijmo-wijgallery-button-previous").hide(),!t.isPlaying&&t.timer&&t.timer.hide()),e.disabled&&t.disable(),t.element.is(":hidden")&&t.element.wijAddVisibilityObserver&&t.element.wijAddVisibilityObserver(function(){t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijgallery")},e.prototype._createDom=function(){var t=this,e=t.options;e.thumbnails?t._createThumbnails():t.ul.hide(),t._createFrame(),e.control&&t._createControls(),e.showCounter&&t._createCounter(),e.showTimer&&t._createTimer(),e.showPager&&t._createPager()},e.prototype._getFrameSize=function(){var t=this,e="horizontal"===t.options.thumbnailOrientation,i=t.element.height()-(e&&t.thumbs?t.thumbs.outerHeight(!0):0),n=t.element.width()-(e?0:t.thumbs?t.thumbs.outerWidth(!0):0);return{w:2>n||!n?750:n,h:2>i||!i?300:i}},e.prototype._createFrame=function(){var t=this,e=t.options,n,o,r=t._getFrameSize(),s="after"===e.thumbnailDirection;t.frame=i(c).addClass(e.wijCSS.content+" "+e.wijCSS.helperClearFix)[s?"prependTo":"appendTo"](t.container).setOutWidth(r.w-1).setOutHeight(r.h).wrap('<div class="wijmo-wijgallery-framewrapper">'),t.size=r,n=t.frame.width(),o=t.frame.height(),t.frameWrapper=t.frame.parent(),"vertical"===e.thumbnailOrientation&&t.frameWrapper.addClass("wijmo-wijgallery-framewrapper-vertical"),e.showControlsOnHover&&(i.browser.msie&&parseInt(i.browser.version)>9&&(t.frame.data("previousBtnShown",!1),t.frame.data("nextBtnShown",!1)),t.frame.bind("mouseenter."+t.widgetName,function(){t.options.disabled||t._showControls("controls")}).bind("mouseleave."+t.widgetName,function(){t.options.disabled||(t._hideControls("controls"),i.browser.msie&&parseInt(i.browser.version)>9&&i.each(["previous","next"],function(e,i){t.frame.data(i+"BtnShown")&&(t._hideControls(i),t.frame.data(i+"BtnShown",!1))}))})),t.content=t.frame.children("div.wijmo-wijgallery-content"),"img"===e.mode&&t._createFrameMask(),t._createPrevNextBtn(),t._createCaption(r),t._createLoading(),t.last=i('<div class="'+e.wijCSS.overlay+' wijmo-wijgallery-last"></div>').appendTo(t.content).width(n).height(o).css({"line-height":r.h+"px"}),t.current=i('<div class="'+e.wijCSS.overlay+' wijmo-wijgallery-current"></div>').appendTo(t.content).width(n).height(o).css({"line-height":r.h+"px"}),t._show(0)},e.prototype._createControls=function(){var t=this,e=t.options,n={collision:"none",of:t.container,my:"center bottom",at:"center bottom"};e.control&&(t.controls=i(e.control).css({position:"absolute"}).appendTo(t.container),i.extend(n,e.controlPosition),t.controls.position(n))},e.prototype._createLoading=function(){var t=this;t.loading=i("<div></div>").addClass("wijmo-wijgallery-loading").appendTo(t.content),t.loading.css({left:(t.content.width()-t.loading.width())/2,top:(t.content.height()-t.loading.height())/2}),t.loading.hide()},e.prototype._createFrameMask=function(){var t=this,e=t.options;i.each(["previous","next"],function(n,o){var r=i(g.replace(/\{0\}/,o)).appendTo(t.frame),s=r.children("a");i.browser.msie&&parseInt(i.browser.version)<=9&&r.css({"background-color":"#fff"}),e.showControlsOnHover&&!(i.browser.msie&&parseInt(i.browser.version)>9)&&r.bind("mouseenter."+t.widgetName,function(){t.options.disabled||t._showControls(o)}).bind("mouseleave."+t.widgetName,function(){t.options.disabled||t._hideControls(o)}),i.browser.msie&&parseInt(i.browser.version)>9||s.bind("click."+t.widgetName,function(e){t.options.disabled||(t[o](),e.preventDefault())})}),i.browser.msie&&parseInt(i.browser.version)>9&&t.frame.bind("click."+t.widgetName,function(e){if(!t.options.disabled){var n=".wijmo-wijgallery-frame-",o=e.clientX,r=e.clientY;i.each(["previous","next"],function(s,a){var l=n+a,h=t.frame.find(l);h.length>0&&t._checkPositionInElement({X:o,Y:r},i(h[0]))&&(t[a](),e.preventDefault())})}}),e.showControlsOnHover&&i.browser.msie&&parseInt(i.browser.version)>9&&t.frame.bind("mousemove."+t.widgetName,function(e){if(!t.options.disabled){var n=".wijmo-wijgallery-frame-",o=e.clientX,r=e.clientY;i.each(["previous","next"],function(e,s){var a=n+s,l=t.frame.find(a);l.length>0&&(t._checkPositionInElement({X:o,Y:r},i(l[0]))?t.frame.data(s+"BtnShown")||(t._showControls(s),t.frame.data(s+"BtnShown",!0)):t.frame.data(s+"BtnShown")&&(t._hideControls(s),t.frame.data(s+"BtnShown",!1)))})}})},e.prototype._createCounter=function(){var t=this,e=t.options;return e.showCounter?(t.counter||(t.counter=i("<div></div>").addClass("wijmo-wijgallery-counter "+e.wijCSS.stateDefault+" "+e.wijCSS.cornerTL).appendTo(t.frame)),void t._refreshCounter()):void(t.counter&&(t.counter.remove(),t.counter=void 0))},e.prototype._refreshCounter=function(){var t=this,e=t.options,n;t.counter&&(t.counter.empty(),e.counter&&(n=e.counter.replace(/\[i\]/,t.currentIdx+1),n=n.replace(/\[n\]/,t._count),i("<span></span>").text(n).appendTo(t.counter)))},e.prototype._createPrevNextBtn=function(){var t=this,e=t.options.wijCSS;i.each(["next","previous"],function(n,o){var r="next"===o?e.iconArrowRight:e.iconArrowLeft,s;s=t.frame.find(".wijmo-wijgallery-frame-"+o),s.length&&"img"===t.options.mode||(s=t.frame),t[o+"Btn"]=i(t._createBtn(a+o,r)).appendTo(s),i.browser.msie&&parseInt(i.browser.version)>9&&"img"===t.options.mode||t[o+"Btn"].bind("click."+t.widgetName,i.proxy(t[o],t)),t._applyBtnStyle(o)})},e.prototype._applyBtnStyle=function(t){var e=this,i=e.options,n="next"===t,o=e[t+"Btn"],r=n?"right center":"left center",s=r,a=i.wijCSS,l=n?a.cornerLeft:a.cornerRight,h="next"===t?e.currentIdx>=e._count:e.currentIdx<=0,d={collision:"none",of:e.frame,my:s,at:r};o.addClass(l).position(d),h?o.removeClass(a.stateHover).addClass(a.stateDisabled):o.hasAllClasses(a.stateDisabled)&&o.removeClass(a.stateDisabled)},e.prototype._createCaption=function(t){var e=this,n=e.options,o=n.wijCSS;n.showCaption&&(e.overlay=i(f).addClass([o.content,o.helperClearFix,"wijmo-wijgallery-caption"].join(" ")).width(t.w).appendTo(e.content),e.caption=i(f).addClass([o.content,o.helperClearFix,"wijmo-wijgallery-text"].join(" ")).width(t.w).appendTo(e.content))},e.prototype._loadCaption=function(t){var e=this,n=t.caption,o,r=i("<span></span>"),s=e.element.find(".wijmo-wijgallery-text,.wijmo-wijgallery-caption");return n&&(s.show(),n.jquery&&n.show(),r.html(n),e.caption.empty().append(r),o=r.outerHeight(!0),s.height(o),i.browser.msie&&s.height(r.css("display","block").outerHeight(!0))),s.hide(),s},e.prototype._showCaption=function(t){var e=this;t&&t.caption&&(e.caption.length&&e.caption.fadeIn(500),e.overlay.length&&e.overlay.show().animate({opacity:.5},500))},e.prototype._createTooltip=function(t){var e=this,n=e.options.wijCSS,o=t||"bottom";e.pointer=i("<div>").addClass([n.content,n.stateDefault,h.replace(/\{0\}/,o)].join(" ")),e.pointer.appendTo(e.thumbsWrapper).hide()},e.prototype._createThumbnails=function(){var t=this,e=t.options,n="after"===e.thumbnailDirection,o="wijmo-wijgallery-thumbs-{0}",r="horizontal"===e.thumbnailOrientation,s=n?r?"bottom":"right":r?"top":"left";t.thumbPosition=s,t.thumbs=i(u).appendTo(t.container).addClass(e.wijCSS.content).addClass(r?"wijmo-wijcarousel-horizontal-multi":"wijmo-wijcarousel-vertical-multi"),r?t.thumbs.css({height:e.thumbsLength+"px"}).setOutWidth(t.element.width()):t.thumbs.css({width:e.thumbsLength+"px"}).setOutHeight(t.element.height()),t.ul.appendTo(t.thumbs),t.ul.children("li").each(function(e,n){var o=i(n).children("a"),r=t.images[e],s=r.thumbUrl;o.length||(o=i(n).wrapInner("<a>").children("a"),o.attr("href",s))}),i[t.namespace][t.thumbWidgetName]&&(t.thumbs.addClass(o.replace(/\{0\}/,s)).find("li").addClass(e.wijCSS.stateDefault).hover(function(){i(this).addClass(e.wijCSS.stateHover)},function(){i(this).removeClass(e.wijCSS.stateHover)}),t.thumbsWrapper=t.thumbs[t.thumbWidgetName]({display:e.thumbsDisplay,step:e.thumbsDisplay-1,itemPadding:"0 10px",showCaption:e.showThumbnailCaptions,orientation:e.thumbnailOrientation,loop:!1,itemClick:function(e,i){var n=i.index;t.show(n),e.preventDefault()},afterScroll:function(e,i){t.currentThumbIdx=i.firstIndex,t.activeLi&&t.activeLi.is("li")&&t.activeLi.index()>=i.firstIndex&&t.activeLi.index()<=i.lastIndex&&t._highlightThumb(t.activeLi),t.isScrolling=!1},beforeScroll:function(i,n){t.isScrolling=!0,"swf"===e.mode||"flv"===e.mode?t.pointer.hide():t.pointer.fadeOut(100)}}).wrap('<div class="wijmo-wijgallery-thumbswrapper">').parent(),r||t.thumbsWrapper.addClass("wijmo-wijgallery-thumbswrapper-vertical"),t._createTooltip(s))},e.prototype._calculatePosition=function(t,e,i,n,o,r){var s=this;"bottom"===s.thumbPosition?(t.left=t.left+(n-e)/2+r,t.top=t.top-i):"top"===s.thumbPosition?(t.left=t.left+(n-e)/2+r,t.top=t.top+o+2*r):"left"===s.thumbPosition?(t.left=t.left+n+2*r,t.top=t.top+(o-i)/2+r):"right"===s.thumbPosition&&(t.left=t.left-e,t.top=t.top+(o-i)/2+r)},e.prototype._highlightThumb=function(t){var e=this,i,n,o,r,a,l,h=[s,e.options.wijCSS.stateActive].join(" ");t&&t.length&&(t.siblings("li."+s).removeClass(h),t.addClass(h),i=e.pointer.outerWidth(!0),n=e.pointer.outerHeight(!0),o=t.width(),r=t.height(),a=t.offset(),l=5,e._calculatePosition(a,i,n,o,r,l),e.pointer.fadeIn(100),e.pointer.offset(a))},e.prototype._getSelector=function(t,e){var i,n=".wijmo-wijgallery-button-",o=".wijmo-wijpager,.wijmo-wijgallery-counter";return e&&(o+=",.wijmo-wijgallery-timerbar"),i="next"===t||"previous"===t?n+t:"controls"===t?o:o+","+n+"next,"+n+"previous"},e.prototype._showControls=function(t){var e=this,n;n=e._getSelector(t,!e.isPlaying&&e.timer),e.frame.find(n).stop(!0,!0).fadeIn(400,function(){i(this).css("opacity","")})},e.prototype._hideControls=function(t){var e=this,i;i=e._getSelector(t,!e.isPlaying&&e.timer),this.frame.find(i).stop(!0,!0).fadeOut(600)},e.prototype._createPager=function(){var t=this,e=t.options,n,o=e.thumbsDisplay,r=1,s=t.currentIdx,a=t.currentIdx,l={collision:"none",of:t.container,my:"right top",at:"right bottom"};e.thumbnails?(n=i("<div></div>").appendTo(t.thumbs),0!==o&&(r=Math.ceil(t._count/o),s=Math.ceil(t.currentIdx/o)),t.pager=n.wijpager({pageCount:r,pageIndex:s,pageButtonCount:r,mode:"numeric",pageIndexChanged:function(e,i){var n=i.newPageIndex;(n*o>a||a>=(n+1)*o)&&t.thumbs[t.thumbWidgetName]("scrollTo",n*o),e.preventDefault()}}).css({position:"absolute"})):(n=i("<div></div>").appendTo(t.container),t.pager=n.wijpager({pageCount:t._count,pageIndex:t.currentIdx,pageButtonCount:t._count,mode:"numeric",pageIndexChanged:function(e,i){var n=i.newPageIndex;t._show(n)}}).css({position:"absolute"}),i.extend(l,e.pagingPosition),t.pager.addClass("wijmo-wijgallery-pager").position(l))},e.prototype._createBtn=function(t,e){var n=i(p),o=this.options;return n.addClass(o.wijCSS.stateDefault+" "+t).attr("role","button").bind("mouseover"+this.widgetName,function(){i(this).hasAllClasses(o.wijCSS.stateDisabled)||i(this).addClass(o.wijCSS.stateHover)}).bind("mouseout"+this.widgetName,function(){i(this).hasAllClasses(o.wijCSS.stateDisabled)||i(this).removeClass(o.wijCSS.stateHover)}),n.children("span:eq(0)").addClass(o.wijCSS.icon+" "+e),n},e.prototype._createTimer=function(){var t=this,e=t.options;t._createPausePlay(),t.progressBar=i("<div></div>").addClass("wijmo-wijgallery-timerbar-inner "+e.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),t.timer=i("<div></div>").addClass("wijmo-wijgallery-timerbar "+e.wijCSS.cornerAll).appendTo(t.frame).append(t.progressBar).append(t.playPauseBtn)},e.prototype._createPausePlay=function(){var t=this,e=t.options;t.playPauseBtn=i(t._createBtn(l,e.autoPlay?e.wijCSS.iconPause:e.wijCSS.iconPlay)).bind("wijclick."+t.widgetName,function(){if(!i(this).hasAllClasses(e.wijCSS.stateDisabled)){var n=i(this).children("span:eq(0)");t[n.hasAllClasses(e.wijCSS.iconPlay)?"play":"pause"]()}})},e.prototype._show=function(t){var e=this,n=e.images[t],o,r,s,a=e._getFrameSize(),l=e.options,h=l.mode;e.currentIdx!==t&&n&&i.isPlainObject(n)&&(e.loading.delay(500).fadeIn(100),s=e.last.children("img,div."+d),s.length&&s.remove(),"swf"===h||"flv"===h?(e.last.hide(),e.current.empty(),e._wrapFlash(e.current,h,n.url),e.picture=e.current.children("div."+d),e._setCurrentStates(t),e.loading.stop().hide(),e._thumbsScroll(t)):"img"===h?(e.picture&&e.picture.length&&e.last.append(e.picture.unbind("load")),e.current.hide(),e.last.show(),e.picture=i("<img>").attr({src:n.url,alt:n.title}).appendTo(e.current).data("itemIndex",t),i.browser.msie&&e.picture[0].hasAttribute("complete")?e._imageLoaded(e,a):e.picture.bind("load",function(){e._imageLoaded(e,a)})):"iframe"===h&&(e.current.is(":hidden")?(o=e.current,r=e.last):(o=e.last,r=e.current),e.picture=i("<iframe></iframe>").addClass("wijmo-wijgallery-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true",src:n.url}).hide().appendTo(o).data("itemIndex",t).bind("load",function(){var t=i(this),n=t.data("itemIndex");e.loading.stop().hide(),e.pointer&&e.pointer.fadeOut(100),e._setCurrentStates(n),void 0!==n&&(l.showCaption,t.show(),r.fadeOut(function(){r.empty()}),o.fadeIn())})))},e.prototype._imageLoaded=function(t,e){var i=t.picture.attr("role","img"),n=i.data("itemIndex"),o=i[0].naturalWidth||i.width(),r=i[0].naturalHeight||i.height(),s=t.images[n];t.loading.stop().hide(),t.pointer&&t.pointer.fadeOut(100),o>e.w||r>e.h?o/r>e.w/e.h?i.css({width:"100%"}):i.css({height:"100%"}):o<e.w&&r<e.h&&i.addClass(t.options.wijCSS.stateDefault).addClass("wijmo-wijgallery-small-image"),void 0!==n&&void 0!==s&&(t.options.showCaption&&t.caption&&t._loadCaption(s),t._animate(n))},e.prototype._animate=function(t){var e=this,n=e.options,o=n.transitions,r="horizontal"===n.thumbnailOrientation,s,a,l,h,d,c,u=o.animated,p=o.duration;return e.last.children().length?(d={index:e.currentIdx,to:t,toImg:e.images[t]},void(e._trigger("beforeTransition",null,d)&&(u?"slide"===u?(s=e.size.w,a=e.size.h,e.current.show(),c=e.currentIdx>t?!0:!1,l=i.createWrapper(e.last).css({overflow:"hidden",width:r?2*s:s,height:r?a:2*a,left:r&&c?-s:0,top:r?0:c?-a:0}),l[c?"prepend":"append"](e.current),l.animate({left:r?c?0:-s:0,top:r?0:c?0:-a},p,function(){e.last.parent().is(".ui-effects-wrapper")&&e.last.unwrap(),e.last.hide(),e._setCurrentStates(t)})):i.mobile?(h=p/2,e.last.fadeOut(h,function(){e.current.stop(!0,!0).fadeIn(h,function(){e._setCurrentStates(t)})})):"explode"===u||"scale"===u||"blind"===u||"fold"===u?(e.current.css({position:"absolute"}),e.current.stop(!0,!0).show(u,p,function(){e.last.hide(),e._setCurrentStates(t)})):"size"===u?(e.last.hide(),e.current.stop(!0,!0).show(u,p,function(){e.last.hide(),e._setCurrentStates(t)})):(h=p/2,e.last.hide(u,h,function(){e.last.hide(),e.current.stop(!0,!0).show(u,h,function(){e._setCurrentStates(t)})})):(e.last.hide(),e.current.show(),e._setCurrentStates(t)),e._thumbsScroll(t)))):(e._setCurrentStates(t),e.last.hide(),e.current.show(),void 0)},e.prototype._thumbsScroll=function(t){var e,i=this,n=i.options;i.thumbs&&i.thumbs[i.thumbWidgetName]&&(n.scrollWithSelection?(e=t-Math.ceil(n.thumbsDisplay/2)+1,t>0&&t<i._count-1&&i.thumbs[i.thumbWidgetName]("scrollTo",e)):t>n.thumbsDisplay+i.currentThumbIdx-1?i.thumbs[i.thumbWidgetName]("scrollTo",t-n.thumbsDisplay+1):t<i.currentThumbIdx&&i.thumbs[i.thumbWidgetName]("scrollTo",t))},e.prototype._setCurrentStates=function(t){var e=this,i=e.options,n,o,r;r=e.currentIdx,e.currentIdx=t,n=t+1<e._count,e.isPlaying&&n?(e.timeout=null,e.isPlaying=!1,e._play()):e.progressBar&&e.pause(),t+1>=e._count?e.nextBtn.add(e.playPauseBtn).removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled):e.nextBtn.add(e.playPauseBtn).removeClass(i.wijCSS.stateDisabled),0>=t?e.previousBtn.removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled):e.previousBtn.removeClass(i.wijCSS.stateDisabled),i.showCaption&&e._showCaption(e.images[t]),e.thumbs&&e.thumbs[e.thumbWidgetName]?(e.activeLi=e.thumbs.find(m).eq(t),e.isScrolling||e._highlightThumb(e.activeLi)):e.pager&&e.pager.is(":wijmo-wijpager")&&e.pager.wijpager("option","pageIndex",t),e._refreshCounter(),e._clearCss(),o={last:r,index:e.currentIdx,toImg:e.images[e.currentIdx]},e._trigger("afterTransition",null,o)},e.prototype._clearCss=function(){this.current.css({position:"",visibility:""})},e.prototype._resetState=function(){var t=this;t._stopAnimation(),t.isPlaying&&t.progressBar&&(t.progressBar.stop(),t.progressBar.css({width:"0%"}))},e.prototype._stopAnimation=function(){var t=this,e;e=t.content.find(".ui-effects-wrapper"),e.length&&e.stop(!0,!0),t.current.stop(!0,!0),t.last.stop(!0,!0)},e.prototype._checkPositionInElement=function(t,e){return t.X>=e.offset().left&&t.X<e.offset().left+e.width()&&t.Y>=e.offset().top&&t.Y<e.offset().top+e.height()},e.prototype.count=function(){return this._count},e.prototype._wijdestroy=function(){var t=this,e=t.options.wijCSS;t.frame.unwrap().remove(),t.options.thumbnails?i[t.namespace][t.thumbWidgetName]&&(t.thumbs[t.thumbWidgetName]("destroy"),t.element.find("li").unbind().removeClass(e.stateActive).filter("."+s).removeClass(s),t.thumbs.children("ul").unwrap().unwrap()):(t.pager&&t.pager.length&&t.pager.remove(),t.element.find("ul").css({display:""})),t.pointer&&t.pointer.remove(),t.element.removeClass([o,e.widget,e.content,e.cornerAll].join(" "))},e.prototype.destroy=function(){this._wijdestroy(),i.Widget.prototype.destroy.apply(this)},e.prototype.show=function(t){var e=this;e._resetState(),e._show(t)},e.prototype.next=function(){var t=this,e;t.options.disabled||(t._resetState(),e=t.currentIdx+1,e<t._count&&t._show(e))},e.prototype.previous=function(){var t=this,e;t.options.disabled||(t._resetState(),e=t.currentIdx-1,e>=0&&t._show(e))},e.prototype.play=function(){this._play()},e.prototype._play=function(t){var e=this,i=e.options;if(!e.isPlaying&&!i.disabled){if(0===i.interval)return e.pause();if(t)return void(e.isPlaying=!0);if(i.showTimer&&e.progressBar)e.progressBar.css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(i.wijCSS.iconPlay).addClass(i.wijCSS.iconPause),e.progressBar.animate({width:"100%"},i.interval,null,function(){e._show(e.currentIdx+1)});else{if(e.timeout)return;e.timeout=window.setTimeout(function(){e.timerCount<=1&&e.next(),e.timerCount--},i.interval),e.timerCount++}e.isPlaying=!0}},e.prototype.pause=function(){var t=this,e=t.options;if(e.showTimer&&t.progressBar)t.progressBar.stop(),t.progressBar.css({width:"0%"}),t.playPauseBtn.children("span:eq(0)").removeClass(e.wijCSS.iconPause).addClass(e.wijCSS.iconPlay);else{if(null===t.timeout)return;window.clearTimeout(t.timeout),t.timeout=null}t.isPlaying=!1},e.prototype.add=function(t,e){var n=this,o,r,s;if("string"==typeof t)o=i(t),s=n._initLi(o);else if(t.jquery)o=t,s=n._initLi(o);else{if(!i.isPlainObject(t))return;s=t}r=!e||e>n._count?n._count:0>e?0:e,n.images.splice(r,0,s),n._count++,n.thumbs&&n.thumbs[n.thumbWidgetName]&&(n.pointer&&n.pointer.is(":hidden")&&n.pointer.show(),n.thumbs[n.thumbWidgetName]("add",o,r)),1===n._count&&n.show(0),n._refreshStateWithItemsChanged(r)},e.prototype.remove=function(t){var e=this,i;if(i=isNaN(t)||t>=e._count?e._count-1:0>t?0:t,i>=0){if(e.images.splice(i,1),e._count--,e.thumbs&&e.thumbs[e.thumbWidgetName]&&e.thumbs[e.thumbWidgetName]("remove",i),e.currentIdx==i)e.current.children("img").remove(),e.last.children("img").remove(),e.picture=null,e.currentIdx=-1,e._count>0&&(i===e._count?e.show(i-1):e.show(i));else if(e.currentIdx>i){var n=e.currentIdx;e.currentIdx=-1,e.show(n)}e._refreshStateWithItemsChanged(i)}},e.prototype._refreshStateWithItemsChanged=function(t){var e=this,i=e.options;0===e._count?(e.nextBtn.removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled),e.previousBtn.removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled),e.playPauseBtn&&e.playPauseBtn.removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled),e.pointer&&e.pointer.hide()):e.currentIdx<=0?e.previousBtn.removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled):e.currentIdx>=e._count-1?(e.nextBtn.removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled),e.playPauseBtn&&e.playPauseBtn.removeClass(i.wijCSS.stateHover).addClass(i.wijCSS.stateDisabled)):(e.nextBtn.removeClass(i.wijCSS.stateDisabled),e.previousBtn.removeClass(i.wijCSS.stateDisabled),e.playPauseBtn&&e.playPauseBtn.removeClass(i.wijCSS.stateDisabled),e.pointer&&e.pointer.is(":hidden")&&e.pointer.show()),e._refreshCounter()},e.prototype._getExt=function(t){var e,i,n=/[0-9a-z]+$/i,o=t.indexOf("?");return o>-1&&(t=t.substring(0,o)),i=t.match(n),i&&(e=i[0].toLowerCase()),e},e.prototype._getPlayerName=function(t){if(0===t.indexOf("#")||t.indexOf("#")>0&&0===t.indexOf(document.location.href))return"inline";var e=["bmp","gif","jpg","jpeg","png"],n=["swf"],o=["flv","m4v"],r=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],s=["asf","avi","mpg","mpeg","wm","wmv"],a=this._getExt(t);if(a){if(i.inArray(a,e)>=0)return"img";if(i.inArray(a,n)>=0)return"swf";if(i.inArray(a,o)>=0)return"flv";if(i.inArray(a,s)>=0)return"wmp";if(i.inArray(a,r)>=0)return"qt"}return"unknown"},e.prototype._wrapFlash=function(t,e,n){var o=this,r=o.options,s=n,a,l="100%",h="100%",c=r.flashInstall,u=r.flashVersion,p=r.flashVars,g=r.flashParams,f=o._newId();"flv"===e&&(s=r.flvPlayer,p=i.extend({file:n,width:l,height:h,autostart:r.autoPlayMovies?"true":"false",controlbar:r.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},r.flashVars),g=i.extend({autostart:r.autoPlayMovies?"true":"false",allowscriptaccess:"always"},r.flashParams)),a=i("<div/>").addClass(d).appendTo(t),i("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",f).appendTo(a),S.flash.embedSWF(s,f,l,h,u,c,p,g)},e.prototype._newId=function(){var t="a|b|c|d|e|f|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|w|x|y|z",e=[],i="",n;for(e=t.split("|"),n=0;16>n;n++)i+=e[Math.round(25*Math.random())];return i},e}(t.wijmoWidget);e.wijgallery=w,w.prototype.thumbWidgetName="wijcarousel";var y=function(){function t(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijgallery')",this.autoPlay=!1,this.scrollWithSelection=!1,this.showTimer=!0,this.interval=5e3,this.showCaption=!0,this.showThumbnailCaptions=!1,this.data=[],this.showControls=!1,this.control="",this.controlPosition={},this.showCounter=!0,this.counter="[i] of [n]",this.showPager=!1,this.pagingPosition={},this.thumbnailOrientation="horizontal",this.thumbnailDirection="after",this.transitions={animated:"slide",duration:1e3,easing:null},this.showControlsOnHover=!0,this.thumbsDisplay=5,this.thumbsLength=100,this.beforeTransition=null,this.afterTransition=null,this.loadCallback=null,this.showMovieControls=!1,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0,wmode:"transparent"},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.mode="img"}return t}();w.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new y),i.wijmo.registerWidget("wijgallery",w.prototype)}(t.gallery||(t.gallery={}));var e=t.gallery}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){var i=jQuery;!function(t){t._map=[],t._map[0]="east",t.east=0,t._map[1]="west",t.west=1,t._map[2]="south",t.south=2,t._map[3]="north",t.north=3}(e.Compass||(e.Compass={}));var n=e.Compass,o=function(){function t(){}return t.mod360=function(t){var e=t%360;return 0>t&&(e+=360),e},t.getAngle=function(t,e,i){var n=this,o=n.distance(e,i),r=n.distance(e,t),s=n.distance(i,t),a=o*o,l=r*r,h=s*s,d=Math.acos((h-l-a)/(-2*r*o));return Math.round(180/Math.PI*d)},t.distance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},t.log=function(t,e){return 0>=t?NaN:1===e||0>e?NaN:Math.log(t)/Math.log(e)},t.generateValues=function(t,e,i){var n=[],o,r;if(e>t&&i>0)for(o=parseInt(((e-t)/i+1).toString(),10),r=0;o>r;r++)n.push(t+r*i);else 0===i&&n.push(t);return n},t.isInRange=function(t,e,i){return t>=e&&i>=t||e>=t&&t>=i},t.paintMarker=function(t,e,i,n,o,r,s){var a;return"rect"===e?t.rect(i-o/2,n-r/2,o,r):a=s?"tri"===e?t.isoTri(i,n,o,r):t.paintMarker(e,i,n,r):t.paintMarker(e,i,n,o)},t.formatString=function(t,e){if(i.isFunction(e))return e.call(this,t);if(""!==e){var n=/\{0(?::((?:n|d|p|c)\d?))?\}/gi,o,r;if(n.test(e))return o=e.match(n),r="$1",e.replace(/\{0(?::(?:(?:n|d|p|c)\d?))?\}/gi,Globalize.format(t,r))}return t},t.getPositionByAngle=function(t,e,i,n){var o={x:0,y:0},r=Raphael.rad(n);return o.x=t-i*Math.cos(r),o.y=e-i*Math.sin(r),o},t.donut=function(t,e,i,n,o,r,s){var a=this.getPositionByAngle,l=a(e,i,n,r),h=a(e,i,n,s),d=a(e,i,o,r),c=a(e,i,o,s),u=s-r>180,p;(s-r)%360!==0?(p=["M",l.x,l.y,"A",n,n,0,+u,1,h.x,h.y,"L",c.x,c.y,"A",o,o,0,+u,1,d.x,d.y,"L",l.x,l.y,"z"],t.path(p)):t.circle(e,i,n)},t}();e.GaugeUtil=o,Raphael.fn.isoTri=function(t,e,i,o,r){var s=t,a=e+o/2,l=t+i,h=e,d=t+i,c=e+o,u;return r==n.north?(s=t,a=e,l=t-i/2,h=e+o,d=t+i/2,c=e+o):r===n.east?(s=t-i/2,a=e-o/2,l=t-i/2,h=e+o/2,d=t+i/2,c=e):r===n.west&&(s=t-i/2,a=e,l=t+i/2,h=e-o/2,d=t+i/2,c=e+o/2),u=["M",s,a,"L",l,h,"L",d,c,"z"],this.path(u.join(" "))};var r=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._create=function(){var t=this,e=t.options,n;window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t.element.is(":hidden")&&t.element.wijAddVisibilityObserver&&t.element.wijAddVisibilityObserver(function(){t.redraw(),t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver()},"wijgauge"),isNaN(e.width)&&t._setDefaultWidth(),isNaN(e.height)&&t._setDefaultHeight(),t._setDefaultWidthHeight(),
e.disabled&&t.disable(),e.face&&e.face.template&&"string"==typeof e.face.template&&window[e.face.template]&&(e.face.template=window[e.face.template]),e.pointer&&e.pointer.template&&"string"==typeof e.pointer.template&&window[e.pointer.template]&&(e.pointer.template=window[e.pointer.template]),e.cap&&e.cap.template&&"string"==typeof e.cap.template&&window[e.cap.template]&&(e.cap.template=window[e.cap.template]),t.element.addClass(e.wijCSS.widget).toggleClass(e.wijCSS.stateDisabled,e.disabled);try{t.canvas=Raphael(t.element[0],e.width,e.height)}catch(o){var r=t.element.css("display");n=i("<div></div>").insertBefore(t.element).append(t.element),t.element.addClass("ui-helper-hidden-accessible").appendTo(i("body")),"none"===r&&t.element.css("display","block"),t.canvas=Raphael(t.element[0],e.width,e.height),t.element.appendTo(n).unwrap().removeClass("ui-helper-hidden-accessible"),"none"===r&&t.element.css("display","none")}t._autoCalculate(),t._draw()},e.prototype._setDefaultWidth=function(){},e.prototype._setDefaultHeight=function(){},e.prototype._setDefaultWidthHeight=function(){var t=this,e=t.element,i=t.options,n=e.get(0).style,o=n.width,r=n.height;""!==o&&(i.width=e.width()),""!==r&&(i.height=e.height())},e.prototype._autoCalculate=function(){},e.prototype._setOption=function(e,n){var o=this,r=o.options,s=r[e];if("disabled"===e)o._handleDisabledOption(n,o.element),t.prototype._setOption.call(this,e,n);else if("value"===e)o._trigger("beforeValueChanged",null,{newValue:n,oldValue:s})&&(t.prototype._setOption.call(this,e,n),o._set_value(n,s)),o._trigger("valueChanged",null,{newValue:n,oldValue:s});else{if(t.prototype._setOption.call(this,e,n),i.isPlainObject(n)&&(r[e]=i.extend({},s,n)),"auto"===r.radius)return o._autoCalculate(),void o.redraw();o["_set_"+e]&&o["_set_"+e](n,s)}},e.prototype._set_value=function(t,e){this._setPointer()},e.prototype._set_max=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},e.prototype._set_min=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},e.prototype._set_width=function(){this.redraw()},e.prototype._set_height=function(){this.redraw()},e.prototype._set_isInverted=function(){this.redraw()},e.prototype._set_tickMajor=function(){this._redrawMarksAndLabels()},e.prototype._set_tickMinor=function(){this._redrawMarksAndLabels()},e.prototype._set_pointer=function(){var t=this;t.pointer&&(t.pointer.wijRemove(),t.pointer=null),t._paintPointer(),t._setPointer()},e.prototype._set_islogarithmic=function(){var t=this;t._redrawMarksAndLabels(),t._setPointer()},e.prototype._set_logarithmicBase=function(){var t=this;t._redrawMarksAndLabels(),t._setPointer()},e.prototype._set_labels=function(){this._redrawMarksAndLabels()},e.prototype._set_margin=function(t,e){t!==e&&this.redraw()},e.prototype._set_marginTop=function(t,e){this._set_margin(t,e)},e.prototype._set_marginBottom=function(t,e){this._set_margin(t,e)},e.prototype._set_marginLeft=function(t,e){this._set_margin(t,e)},e.prototype._set_marginRight=function(t,e){this._set_margin(t,e)},e.prototype._set_ranges=function(){var t=this;t._removeRanges(),t._paintRanges(),t._resetElementPosition()},e.prototype._set_face=function(){var t=this;t.face&&(t.face.wijRemove(),t.face=null,t._paintFace(),t._resetElementPosition(!0))},e.prototype._clearState=function(){var t=this;t.labels=[],t.majorMarks=[],t.minorMarks=[],t.face=null,t.pointer=null},e.prototype._resetElementPosition=function(t){var e=this;t&&e.ranges&&i.each(e.ranges,function(t,e){e.toFront()}),e.majorMarks&&i.each(e.majorMarks,function(t,e){e.toFront()}),e.minorMarks&&i.each(e.minorMarks,function(t,e){e.toFront()}),e.labels&&i.each(e.labels,function(t,e){e.toFront()}),e.pointer&&e.pointer.toFront(),e.cap&&e.cap.toFront()},e.prototype._redrawMarksAndLabels=function(){var t=this;t._removeMarksAndLabels(),t._drawMarksAndLabels()},e.prototype._removeMarksAndLabels=function(){var t=this;i.each(t.labels,function(e,i){i.wijRemove(),t.labels[e]=null}),i.each(t.majorMarks,function(e,i){i.wijRemove(),t.majorMarks[e]=null}),i.each(t.minorMarks,function(e,i){i.wijRemove(),t.minorMarks[e]=null})},e.prototype._drawMarksAndLabels=function(){var t=this;t.labels=[],t.majorMarks=[],t.minorMarks=[],t._paintMarks()},e.prototype._handleDisabledOption=function(t,e){var i=this;t?(i.disabledDiv||(i.disabledDiv=i._createDisabledDiv(e)),i.disabledDiv.appendTo("body")):i.disabledDiv&&(i.disabledDiv.remove(),i.disabledDiv=null)},e.prototype._createDisabledDiv=function(t){var e=this,n=e.options,o=t||e.element,r=o.offset(),s=n.width||o.outerWidth(),a=n.height||o.outerHeight(),l;return l=i("<div></div>").css({"z-index":"99999",position:"absolute",width:s,height:a,left:r.left,top:r.top}),Raphael.vml&&l.addClass(n.stateDisabled).css("background-color","#fff"),l},e.prototype._triggerPainted=function(){return this._trigger("painted")},e.prototype._draw=function(){var t=this,e=t.options;t.pointer=null,t._innerBbox={width:e.width-e.marginLeft-e.marginRight,height:e.height-e.marginTop-e.marginBottom,left:e.marginLeft,top:e.marginTop},t.face=t._paintFace(),t.ranges&&t._removeRanges(),t._paintRanges(),t._drawMarksAndLabels(),t._paintPointer(),t.pointer&&(t._setOffPointerValue(),t._setPointer()),i.wijraphael.clearRaphaelCache(),t._triggerPainted()},e.prototype.redraw=function(){var t=this,e=t.options;t.element.empty(),this._clearState(),t.canvas=Raphael(t.element[0],e.width,e.height),t._draw()},e.prototype.destroy=function(){var e=this;e._unbindEvents(e.majorMarks),e._unbindEvents(e.minorMarks),e._unbindEvents(e.labels),e.element.removeClass("ui-widget").empty(),e.disabledDiv&&(e.disabledDiv.remove(),e.disabledDiv=null),t.prototype.destroy.call(this)},e.prototype.getCanvas=function(){return this.canvas},e.prototype._percentage=function(){var t=this,e=t.options,i=e.max,n=e.min,o=e.value;return isNaN(o)?0:i===n?1:(o-n)/(i-n)},e.prototype._valueToLogical=function(t){var e=this,i=e.options,n=i.min,r=i.max,s=i.logarithmicBase,a,l;return n>t?0:t>r?1:(a=(t-n)/(r-n),l=i.islogarithmic?o.log(1+(s-1)*a,i.logarithmicBase):a)},e.prototype._logicalToValue=function(t){var e=this,i=e.options,n=i.max,o=i.min,r;if(0>t)return o;if(t>=1)return n;if(i.islogarithmic){if(i.logarithmicBase<=1)return i.min;r=(Math.pow(i.logarithmicBase,t)-1)/(i.logarithmicBase-1)}else r=t;return o+(n-o)*r},e.prototype._bindClickEvents=function(t){var e=this;i.each(t,function(t,n){i(n.node).bind("click."+e.widgetName,function(t){e._trigger("click",t,{ele:n})})})},e.prototype._unbindEvents=function(t){var e=this;i.each(t,function(t,n){i(n.node).unbind("."+e.widgetName)})},e.prototype._setOffPointerValue=function(){},e.prototype._setPointer=function(){},e.prototype._paintPointer=function(){},e.prototype._paintFace=function(){},e.prototype._paintRanges=function(){var t=this,e=t.options,n=e.ranges||[];t.ranges=[],i.each(n,function(e,i){t._paintRange(i)})},e.prototype._paintRange=function(t){},e.prototype._removeRanges=function(){var t=this;i.each(t.ranges,function(e,i){i.wijRemove(),t.ranges[e]=null})},e.prototype._paintMarks=function(){var t=this,e=t.options,n=o.generateValues,r=n(e.min,e.max,e.tickMajor.interval),s=n(e.min,e.max,e.tickMinor.interval),a=e.labels,l=a.visible;e.tickMajor.visible&&i.each(r,function(i,n){t.majorMarks.push(t._paintMark(n,e.tickMajor,!0)),l&&t.labels.push(t._paintLabel(n,a))}),e.tickMinor.visible&&i.each(s,function(n,o){var s=!1;i.each(r,function(t,e){return o===e?(s=!0,!1):void 0}),s||t.minorMarks.push(t._paintMark(o,e.tickMinor,!1))}),t._bindClickEvents(t.majorMarks),t._bindClickEvents(t.minorMarks),t._bindClickEvents(t.labels)},e.prototype._paintMark=function(t,e,i){},e.prototype._paintLabel=function(t,e){},e}(t.wijmoWidget);e.wijgauge=r;var s=function(){function t(){this.value=0,this.max=100,this.min=0,this.width=600,this.height=400,this.tickMajor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:2,visible:!0,marker:"rect",offset:0,interval:10},this.tickMinor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:1,visible:!1,marker:"rect",offset:0,interval:5},this.pointer={length:1,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:0,shape:"tri",visible:!0,template:null},this.islogarithmic=!1,this.logarithmicBase=10,this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},visible:!0,offset:0},this.animation={enabled:!0,duration:2e3,easing:">"},this.face={style:{fill:"270-#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null},this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.ranges=[],this.isInverted=!1,this.beforeValueChanged=null,this.valueChanged=null,this.painted=null}return t}();r.prototype.options=i.extend({},t.wijmoWidget.prototype.options,new s)}(t.gauge||(t.gauge={}));var e=t.gauge}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype._setDefaultWidth=function(){var t=this.options;t.width="horizontal"===t.orientation?310:70},i.prototype._setDefaultHeight=function(){var t=this.options;t.height="horizontal"===t.orientation?70:310},i.prototype._set_orientation=function(){var t=this;t._setDefaultWidth(),t._setDefaultHeight(),t.markBbox=null,t.redraw()},i.prototype._set_xAxisLocation=function(){this.redraw()},i.prototype._set_xAxisLength=function(){this.redraw()},i.prototype._set_yAxisLocation=function(){this.redraw()},i.prototype._clearState=function(){e.prototype._clearState.call(this),this.markBbox&&(this.markBbox=null)},i.prototype._create=function(){e.prototype._create.call(this),this.element.addClass(this.options.wijCSS.linearGauge)},i.prototype._paintLabel=function(e,i){var n=this,o=n.options,r=i.format,s=i.style,a=i.offset,l=e,h=n.options.tickMajor,d=h.position||"inside",c,u,p,g;return""!==r&&(l=t.GaugeUtil.formatString(e,r)),p=n._getMarkerBbox(),g=n._getLabelBBox(l),c=n._valueToPoint(e,0),"horizontal"===o.orientation?("inside"===d?c.y=p.y-g.height:c.y=p.y+p.height+g.height/2,c.y+=a):("inside"===d?c.x=p.x-g.width/2:c.x=p.x+p.width+g.width/2,c.x+=a),u=n.canvas.text(c.x,c.y,l),u.attr(s),$.wijraphael.addClass($(u.node),o.wijCSS.linearGaugeLabel),u},i.prototype._getLabelBBox=function(t){var e=this,i=e.options,n,o;return n=e.canvas.text(0,0,t),n.attr(i.gaugeLableStyle),o=n.wijGetBBox(),n.remove(),o},i.prototype._getMarkerBbox=function(){var t=this,e=t.options,i=e.tickMajor,n;return t.markBbox||(n=t._paintMark(0,i),t.markBbox=n.wijGetBBox(),n.remove()),t.markBbox},i.prototype._paintMark=function(e,i,n){var o=this,r=o.options,s=i.marker||"rect",a="rect"===s?5:2,l=o._valueToPoint(e,0),h=i.position||"inside",d=i.offset||0,c=n?2:1,u,p,g=$.extend({},i.style);return u=a*i.factor,$.isFunction(s)?s.call(o,o.canvas,l,r):("cross"===s&&(g.stroke=g.fill),p="horizontal"===r.orientation?t.GaugeUtil.paintMarker(o.canvas,s,l.x,l.y,c,u,!0):t.GaugeUtil.paintMarker(o.canvas,s,l.x,l.y,u,c),p.attr(g),$.wijraphael.addClass($(p.node),r.wijCSS.linearGaugeMarker),o._applyPosition(p,h,d,e),p)},i.prototype._applyPosition=function(t,e,i,n){var o=0,r=0,s=this,a="horizontal"===s.options.orientation,l=t.wijGetBBox();switch(e){case"inside":a?r-=l.width/2+i:o-=l.width/2+i;break;case"outside":a?r+=l.width/2+i:o+=l.width/2+i;break;case"center":a?r-=i:o-=i}t.attr("transform","t"+o+","+r)},i.prototype._paintFace=function(){var t=this,e,i=t.options,n=t._innerBbox.width,o=t._innerBbox.height,r=t._innerBbox.left,s=t._innerBbox.top,a={width:n,height:o,x:r,y:s,canvas:t.canvas};return i.face&&i.face.template&&$.isFunction(i.face.template)?i.face.template.call(t,a):(e=t.canvas.rect(r,s,n,o,5),i.face&&i.face.style&&e.attr(i.face.style),$.wijraphael.addClass($(e.node),i.wijCSS.linearGaugeFace),e)},i.prototype._paintPointer=function(){var e=this,i=e.options,n=e._valueToPoint(i.min,0),o=e._innerBbox.width,r=e._innerBbox.height,s=e._innerBbox.left,a=e._innerBbox.top,l=i.pointer,h,d,c,u;l.visible&&(u="horizontal"===i.orientation?r:o,c=u*l.offset,d=u*l.length,l.template&&$.isFunction(l.template)?h=l.template.call(e.canvas,n,$.extend({},i.pointer,{offset:c,length:d,gaugeBBox:e._innerBbox})):(h="horizontal"===i.orientation?"rect"===l.shape?e.canvas.rect(n.x-l.width/2,r-d-c+a,l.width,d):e.canvas.isoTri(n.x,r-d-c+a,l.width,d,t.Compass.north):"rect"===l.shape?e.canvas.rect(o-d-c+s,n.y-l.width/2,d,l.width):e.canvas.isoTri(o-d-c+s,n.y-l.width/2,d,l.width),h.attr(l.style)),$.wijraphael.addClass($(h.node),i.wijCSS.linearGaugePointer),e.pointer=h)},i.prototype._setPointer=function(){var t=this,i=t.options;t.pointer&&(e.prototype._setPointer.call(this),t._setLinearPointer(i.value))},i.prototype._setLinearPointer=function(t){var e=this,i=e.options,n=e._valueToPoint(i.min,0),o=e._valueToPoint(t,0),r=i.animation,s={x:0,y:0};"horizontal"===i.orientation?s.x=o.x-n.x:s.y=o.y-n.y,r.enabled?e.pointer.stop().wijAnimate({transform:"t"+s.x+","+s.y},r.duration,r.easing):e.pointer.attr("transform","t"+s.x+","+s.y)},i.prototype._minScreenPoint=function(t){var e=this,i=e.options,n=e._innerBbox.width,o=e._innerBbox.height,r=e._innerBbox.left,s=e._innerBbox.top,a=i.yAxisLocation+t;return"horizontal"===i.orientation?{x:n*i.xAxisLocation+r,y:o*a+s}:{x:n*a+r,y:o*(1-i.xAxisLocation)+s}},i.prototype._maxScreenPoint=function(t){var e=this,i=e.options,n=e._innerBbox.width,o=e._innerBbox.height,r=e._innerBbox.left,s=e._innerBbox.top,a=i.yAxisLocation+t,l=i.xAxisLocation+i.xAxisLength;return"horizontal"===i.orientation?{x:n*l+r,y:o*a+s}:{x:n*a+r,y:o*(1-l)+s}},i.prototype._paintRange=function(t){var e=this,i=e.options,n=isNaN(t.startValue)?0:t.startValue,o=isNaN(t.endValue)?0:t.endValue,r=isNaN(t.startWidth)?isNaN(t.width)?0:t.width:t.startWidth,s=isNaN(t.endWidth)?isNaN(t.width)?0:t.width:t.endWidth,a=t.startDistance||0,l=t.endDistance||0,h,d;n!==o&&(o>n?(h=Math.max(n,i.min),d=Math.min(i.max,o)):(h=Math.max(i.min,o),d=Math.min(i.max,n)),e._drawRange(h,d,a,l,r,s,t))},i.prototype._drawRange=function(t,e,i,n,o,r,s){var a=this,l=a.options,h=l.orientation,d=a._innerBbox.width,c=a._innerBbox.height,u=a._innerBbox.left,p=a._innerBbox.top,g=a._valueToPoint(t,0),f=a._valueToPoint(e,0),m,w,y,v,_,S;"horizontal"===h?(_=o*c,S=r*c,0!==i&&(g.y=i*c+p),0!==n&&(f.y=n*c+p),m={x:g.x,y:g.y-_},w={x:f.x,y:f.y-S}):(_=o*d,S=r*d,0!==i&&(g.x=i*d+u),0!==n&&(f.x=n*d+u),m={x:g.x-_,y:g.y},w={x:f.x-S,y:f.y}),y=["M",g.x,g.y,"L",f.x,f.y,"L",w.x,w.y,"L",m.x,m.y,"Z"],v=a.canvas.path(y.concat(" ")),v.attr(s.style),$.wijraphael.addClass($(v.node),l.wijCSS.linearGaugeRange),a.ranges.push(v)},i.prototype._valueToPoint=function(t,e){var i=this,n=i.options,o=n.isInverted,r,s,a;return n.max===n.min?{x:0,y:0}:(r=i._valueToLogical(t),s=i._minScreenPoint(e),a=i._maxScreenPoint(e),o?{x:s.x*r+a.x*(1-r),y:s.y*r+a.y*(1-r)}:{x:s.x*(1-r)+a.x*r,y:s.y*(1-r)+a.y*r})},i}(t.wijgauge);t.wijlineargauge=e,e.prototype.widgetEventPrefix="wijlineargauge";var i=function(){function t(){this.initSelector=":jqmData(role='wijlineargauge')",this.wijCSS={linearGauge:"wijmo-wijlineargauge",linearGaugeLabel:"wijmo-wijlineargauge-label",linearGaugeMarker:"wijmo-wijlineargauge-mark",linearGaugeFace:"wijmo-wijlineargauge-face",linearGaugePointer:"wijmo-wijlineargauge-pointer",linearGaugeRange:"wijmo-wijlineargauge-range"},this.orientation="horizontal",this.xAxisLocation=.1,this.xAxisLength=.8,this.yAxisLocation=.5,this.width="auto",this.height="auto",this.pointer={length:.5,width:4,offset:0,visible:!0,template:null,shape:"tri",style:{fill:"#1E395B",stroke:"#1E395B"}},this.marginLeft=5,this.marginTop=5,this.marginRight=5,this.marginBottom=5}return t}();e.prototype.options=$.extend(!0,{},t.wijgauge.prototype.options,new i),$.wijmo.registerWidget("wijlineargauge",e.prototype)}(t.gauge||(t.gauge={}));var e=t.gauge}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(t){var e=180,i=9,n=5,o=function(o){function r(){o.apply(this,arguments)}return __extends(r,o),r.prototype._create=function(){var t=this;o.prototype._create.call(this),t.element.addClass(this.options.wijCSS.radialGauge)},r.prototype._set_radius=function(){var t=this;t._redrawMarksAndLabels(),t.pointer.wijRemove(),t._paintPointer(),t._setPointer()},r.prototype._set_startAngle=function(){var t=this;t._redrawMarksAndLabels(),t._setPointer()},r.prototype._set_sweepAngle=function(t){var e=this;t>360&&(e.options.endAngle=360),e._redrawMarksAndLabels(),e._setPointer()},r.prototype._set_width=function(){var t=this;t._autoCalculate(),o.prototype._set_width.call(this)},r.prototype._set_height=function(){var t=this;t._autoCalculate(),o.prototype._set_height.call(this)},r.prototype._set_origin=function(){var t=this;t._autoCalculate()},r.prototype._set_cap=function(){var t=this;t.pointer.wijRemove(),t._paintPointer(),t._setPointer()},r.prototype._clearState=function(){o.prototype._clearState.call(this),this.markBbox=null},r.prototype._valueToAngleIncludeOffset=function(i){return t.GaugeUtil.mod360(this._valueToAngle(i)+e)},r.prototype._valueToAngle=function(t){var e=this,i=e._valueToLogical(t);return e._logicalToAngle(i)},r.prototype._angleToValue=function(t){var e=this,i=e._angleToLogical(t);return e._logicalToValue(i)},r.prototype._logicalToAngle=function(t){var e=this,i=e.options,n=i.startAngle,o=i.sweepAngle,r=i.isInverted;return r?n*t+(n+o)*(1-t):n*(1-t)+(n+o)*t},r.prototype._angleToLogical=function(e){var i=this,n=i.options,o=n.startAngle,r=n.isInverted,s=t.GaugeUtil.mod360(e-o),a=n.sweepAngle,l,h;return 0===a||0===s?r?1:0:(0>a&&(s=360-s,a=-a),l=s-a,l>0?(h=360-s,h>l?1:0):r?1-s/a:s/a)},r.prototype._generatePoints=function(t,e,o,r){var s=this,a=s.options.isInverted,l=parseInt((i+i*(Math.abs(parseInt((e-t).toString(),10))/(i*n))).toString(),10),h=[],d,c,u,p,g;for(g=0;l>g;g++)d=g/(l-1),c=o+(r-o)*d,p=t+(e-t)*d,u=s._angleToValue(p),h.push(s._valueToPoint(u,c));return h},r.prototype._valueToPoint=function(t,e){var i=this,n=i._valueToAngleIncludeOffset(t)*Math.PI/180,o=e;return{x:o*Math.cos(n),y:o*Math.sin(n)}},r.prototype._pointToValue=function(e){var i=t.GaugeUtil.mod360(180*Math.atan2(e.x,-e.y)/Math.PI);return this._angleToValue(i)},r.prototype._radiusScreen=function(t){var e=this,i=e.options;return Math.max(i.radius*t,0)},r.prototype._autoCalculate=function(){var e=this,i=e.options,n=i.width,o=i.height,r,s,a,l=t.GaugeUtil.formatString(i.max,i.labels.format),h=0,d,c=o-i.marginTop-i.marginBottom,u=n-i.marginLeft-i.marginRight;e.centerPoint={x:i.marginLeft+u*i.origin.x,y:i.marginTop+c*i.origin.y},e.radius=i.radius,"auto"===i.radius&&(e.faceRadius=Math.min(u,c)/2,d=e._getFaceBorder(),e.faceRadius-=d,r=e._getMarkerbbox(i.tickMajor).width,s=e._getMarkerbbox(i.tickMinor).width,a=e._getLabelBBox(l).width,"center"===i.tickMajor.position?(h-=r/2,h-=a):"outside"===i.tickMajor.position&&(h-=r,h-=a),"center"===i.tickMinor.position?h=Math.min(h,-s/2):"outside"===i.tickMinor.position&&(h=Math.min(h,-s)),e.radius=e.faceRadius+h,"inside"!==i.tickMajor.position&&(e.faceRadius+=h))},r.prototype._getFaceBorder=function(){var t=this,e=t._paintFace(),i=e.attr("stroke-width")||1;return"set"===e.type&&(i=e[0].attr("stroke-width")||1),e.wijRemove(),i},r.prototype._getMaxRangeWidth=function(){var t=this,e=t.options,i=0;return $.each(e.ranges,function(t,e){i=Math.max(i,e.width||0),i=Math.max(i,e.startWidth||0),i=Math.max(i,e.endWidth||0)}),i},r.prototype._getMarkerbbox=function(t){var e=this,i=e._paintMarkEle(t),n=i.wijGetBBox();return i.wijRemove(),{width:n.width,height:n.height}},r.prototype._paintMark=function(t,e,i){var n=this,o,r=e.position||"inside",s=e.offset||0;return o=n._paintMarkEle(e),o.attr(e.style),$.wijraphael.addClass($(o.node),n.options.wijCSS.radialGaugeMarker),$(o.node).data("value",t),n._applyAlignment(o,r,s),n._setMarkValue(t,o),o},r.prototype._applyAlignment=function(t,e,i){if(t){var n=t.wijGetBBox(),o=n.width/2,r=0;switch(e){case"outside":r-=o+i;break;case"inside":r+=o+i}t.transform("t"+r+",0")}},r.prototype._paintMarkEle=function(e){var i=this,n=i.options,o={x:i.centerPoint.x-i.radius,y:i.centerPoint.y},r=e.marker||"circle",s="rect"===r?5:2,a=2,l,h=e.style["stroke-width"]||0;return("tri"===r||"invertedTri"===r)&&(s=5,a=3),"cross"===r&&(e.style.fill=e.style.stroke||e.style.fill),isNaN(o.x)&&(o.x=0),l=s*e.factor,a+=2*h,l+=2*h,$.isFunction(r)?r.call(i,i.canvas,o,n):t.GaugeUtil.paintMarker(i.canvas,r,o.x,o.y,l,a)},r.prototype._setMarkValue=function(t,e){var i=this,n=i._valueToAngle(t);e.transform(Raphael.format("r{0},{1},{2}...",n,i.centerPoint.x,i.centerPoint.y))},r.prototype._paintLabel=function(e,i){var n=this,o=n._valueToAngle(e),r=i.format,s=i.style,a=i.offset,l=e.toString(),h=n.options.tickMajor,d=h.position||"inside",c,u,p,g,f;switch(""!==r&&(l=t.GaugeUtil.formatString(e,r)),p=n._getMarkerBbox(),f=n._getLabelBBox(l),d){case"inside":g=p.x+p.width+f.width/2;break;case"outside":g=p.x-f.width/2;break;default:g=p.x-f.width/2}return g=n.centerPoint.x-g+a,c=t.GaugeUtil.getPositionByAngle(n.centerPoint.x,n.centerPoint.y,g,o),u=n.canvas.text(c.x,c.y,l),u.attr(s),$.wijraphael.addClass($(u.node),n.options.wijCSS.radialGaugeLabel),u},r.prototype._getLabelBBox=function(t){var e=this,i=e.options,n,o;return n=e.canvas.text(0,0,t),n.attr(i.gaugeLableStyle),o=n.wijGetBBox(),n.wijRemove(),o},r.prototype._getMarkerBbox=function(){var t=this,e=t.options,i=e.tickMajor,n;return t.markBbox||(n=t._paintMarkEle(i),t._applyAlignment(n,i.position,i.offset||0),t.markBbox=n.wijGetBBox(),n.wijRemove()),t.markBbox},r.prototype._paintFace=function(){var t=this,e=t.options,i=Math.min(e.width,e.height)/2,n,o;return t.faceRadius&&(i=t.faceRadius),e.face&&e.face.template&&$.isFunction(e.face.template)?(o={canvas:t.canvas,r:i,origin:{x:t.centerPoint.x,y:t.centerPoint.y}},e.face.template.call(t,o)):(n=t.canvas.circle(t.centerPoint.x,t.centerPoint.y,i),e.face&&e.face.style&&n.attr(e.face.style),$.wijraphael.addClass($(n.node),e.wijCSS.radialGaugeFace),n)},r.prototype._paintPointer=function(){var t=this,e=t.options,i=e.pointer,n=t.radius*i.length,o={x:t.centerPoint.x-n+i.offset*t.radius,y:t.centerPoint.y-i.width/2},r;i.visible&&(e.cap&&e.cap.behindPointer&&e.cap.visible&&t._paintCap(),i.template&&$.isFunction(i.template)?r=i.template.call(t.canvas,o,$.extend({},i,{length:n})):(r="rect"===i.shape?t.canvas.rect(o.x-i.width/2,o.y,n,i.width):t.canvas.isoTri(o.x-i.width/2,o.y,n,i.width),r.attr(i.style)),t.pointer=r,$.wijraphael.addClass($(r.node),e.wijCSS.radialGaugePointer),(!e.cap||!e.cap.behindPointer)&&e.cap.visible&&t._paintCap())},r.prototype._paintCap=function(){var t=this,e=t.options,i=e.cap,n;return i&&i.template&&$.isFunction(i.template)?(n={canvas:t.canvas,origin:{x:t.centerPoint.x,y:t.centerPoint.y}},t.cap=i.template.call(t,n),t.cap):(t.cap=t.canvas.circle(t.centerPoint.x,t.centerPoint.y,i.radius),i&&i.style&&t.cap.attr(i.style),$.wijraphael.addClass($(t.cap.node),e.wijCSS.radialGaugeCap),t.cap)},r.prototype._paintRange=function(t){var e=this,i=e.options,n=isNaN(t.startValue)?0:t.startValue,o=isNaN(t.endValue)?0:t.endValue,r=isNaN(t.startWidth)?isNaN(t.width)?0:t.width:t.startWidth,s=isNaN(t.endWidth)?isNaN(t.width)?0:t.width:t.endWidth,a=t.startDistance||1,l=t.endDistance||1,h,d;n!==o&&(o>n?(h=Math.max(n,i.min),d=Math.min(i.max,o)):(h=Math.max(i.min,o),d=Math.min(i.max,n)),a*=e.radius,l*=e.radius,e._drawRange(h,d,a,l,r,s,t))},r.prototype._drawRange=function(t,e,i,n,o,r,s){var a=this,l=a._valueToAngle(t),h=a._valueToAngle(e),d=a._generatePoints(l,h,o+i,r+n),c=a._generatePoints(l,h,i,n),u,p,g="";for($.each(d,function(t,e){g+=0===t?"M"+$.round(e.x+a.centerPoint.x)+" "+$.round(e.y+a.centerPoint.y):"L"+$.round(e.x+a.centerPoint.x)+" "+$.round(e.y+a.centerPoint.y)}),u=c.length-1;u>=0;u--)g+="L"+$.round(c[u].x+a.centerPoint.x)+" "+$.round(c[u].y+a.centerPoint.y);g+="Z",p=a.canvas.path(g),p.attr(s.style),a.ranges.push(p),$.wijraphael.addClass($(p.node),a.options.wijCSS.radialGaugeRange)},r.prototype._setOffPointerValue=function(){var t=this,e=t._valueToAngle(0);t.pointer.transform(Raphael.format("r{0},{1},{2}",e,t.centerPoint.x,t.centerPoint.y))},r.prototype._setPointer=function(){var t=this,e=t.options,i=t._valueToAngle(e.value),n=e.animation;t.pointer&&(o.prototype._setPointer.call(this),n.enabled?t.pointer.stop().wijAnimate({transform:"r"+i+","+t.centerPoint.x+","+t.centerPoint.y},n.duration,n.easing):t.pointer.transform(Raphael.format("r{0},{1},{2}",i,t.centerPoint.x,t.centerPoint.y)))},r}(t.wijgauge);t.wijradialgauge=o,o.prototype.widgetEventPrefix="wijradialgauge";var r=function(){function t(){this.initSelector=":jqmData(role='wijradialgauge')",this.wijCSS={radialGauge:"wijmo-wijradialgauge",radialGaugeLabel:"wijmo-wijradialgauge-label",radialGaugeMarker:"wijmo-wijradialgauge-mark",radialGaugeFace:"wijmo-wijradialgauge-face",radialGaugePointer:"wijmo-wijradialgauge-pointer",radialGaugeCap:"wijmo-wijradialgauge-cap",radialGaugeRange:"wijmo-wijradialgauge-range"},this.radius="auto",this.startAngle=0,this.sweepAngle=180,this.pointer={length:.8,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:.15,shape:"tri",visible:!0,template:null},this.origin={x:.5,y:.5},this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},offset:30,visible:!0},this.tickMinor={position:"inside",offset:30,style:{fill:"#1E395B"},visible:!0,factor:1,marker:"rect",interval:5},this.tickMajor={position:"inside",offset:27,style:{fill:"#1E395B",stroke:"#1E395B","stroke-width":1},visible:!0,interval:10,factor:2,marker:"rect"},this.cap={radius:15,style:{fill:"#1E395B",stroke:"#1E395B"},behindPointer:!1,visible:!0,template:null},this.face={style:{fill:"r(0.9, 0.60)#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null}}return t}();o.prototype.options=$.extend(!0,{},t.wijgauge.prototype.options,new r),$.wijmo.registerWidget("wijradialgauge",o.prototype)}(t.gauge||(t.gauge={}));var e=t.gauge}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijlightbox";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var o=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._keyDownHandler=function(e){var i=this.options,n=this,o=t.getKeyCodeEnum();if(e.keyCode&&e.keyCode===o.ESCAPE)return n._isFullSize()?n._toggleFullSize():i.closeOnEscape&&n._close(),void e.preventDefault();if(i.keyNav&&e.keyCode)switch(e.keyCode){case o.LEFT:case o.DOWN:n.back(),e.preventDefault();break;case o.RIGHT:case o.UP:n.next(),e.preventDefault();break;case o.HOME:i.groupItems.length>0&&n.show(0),e.preventDefault();break;case o.END:i.groupItems.length>0&&n.show(i.groupItems.length-1),e.preventDefault()}},n.prototype._create=function(){var t=this.options,e=this;window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t.groupItems||(t.groupItems=[]),this._defaults={transAnimation:{animated:"fade",duration:400,easing:"linear"},resizeAnimation:{animated:"sync",duration:400},textShowOption:{duration:300,easing:"linear"},textHideOption:{duration:300,easing:"linear"}},this._parse(),this.container=i("<div/>").addClass("wijmo-wijlightbox "+t.wijCSS.widget+" wijmo-wijlightbox-controls-"+t.controlsPosition).css("z-index",t.zIndex).attr({tabIndex:-1,role:"dialog"}).bind("keydown.wijlightbox",i.proxy(e,"_keyDownHandler")).appendTo(document.body).hide(),this.frame=i("<div></div>").addClass(["wijmo-wijlightbox-frame",t.wijCSS.content,t.wijCSS.cornerAll,t.wijCSS.helperClearFix].join(" ")).appendTo(this.container),this.content=i("<div></div>").addClass("wijmo-wijlightbox-content").appendTo(this.frame),void 0===t.activeIndex?("number"!=typeof t.activeIndex&&t.cookie&&(t.activeIndex=parseInt(e._cookie(),10)),t.activeIndex=t.activeIndex||(t.groupItems.length?0:-1)):null===t.activeIndex&&(t.activeIndex=-1),t.activeIndex=t.activeIndex>=0&&t.groupItems[t.activeIndex]||t.activeIndex<0?t.activeIndex:0,this._initClickBehavior(),this._createTimerBar(),this._createDialogButtons(),this._createCtrlButtons(),this._createText(),this._createCounter(),this._refreshCounter(),this.toolBox&&this.toolBox.find(".wijmo-wijlightbox-toolbox-button").bind({mouseover:function(){e._addState("hover",i(this))},mouseout:function(){e._removeState("hover",i(this))},mousedown:function(){e._addState("active",i(this))},mouseup:function(){e._removeState("active",i(this))}}),this._groupMode()&&this._createNavButtons(),this._initHoverBehavior(),this.container.width(this.frame.outerWidth())},n.prototype.destroy=function(){var t=this.options,e=this;return this._hideWaiting(),this._hideOverlay(),t.cookie&&this._cookie(null,t.cookie),this.container.remove(),i.Widget.prototype.destroy.apply(e,arguments),e},n.prototype._setOption=function(t,e){var n=this.options[t];switch(i.Widget.prototype._setOption.apply(this,arguments),t){case"groupItems":this.options.activeIndex>=e.length?this.show(e.length-1):this.options.activeIndex<0&&e.length?this.show(0):this.show(this.options.activeIndex);break;case"activeIndex":this.show(e);break;case"textPosition":this._resetText();break;case"clickPause":this._initClickBehavior();break;case"showNavButtons":this._createNavButtons();break;case"showControlsOnHover":this._initHoverBehavior();break;case"controlsPosition":this._set_controlsPosition(n,e)}},n.prototype._set_controlsPosition=function(t,e){t!==e&&(this._removeCounter(),this._removeNavButtons(),this.container.removeClass("wijmo-wijlightbox-controls-outside wijmo-wijlightbox-controls-inside").addClass("wijmo-wijlightbox-controls-"+e),this._createCounter(),this._createNavButtons())},n.prototype._initClickBehavior=function(){var t=this.options,e=this;this.content.unbind("click"),t.clickPause?this._groupMode()&&this.content.click(function(){e[e.isPlaying()?"stop":"play"]()}):this._groupMode()&&this.content.click(function(n){if(e.isPlaying())return!1;var o=i.extend({},i(this).offset(),{width:i(this).outerWidth(!0),height:i(this).outerHeight(!0)});n.pageX>=o.left&&n.pageX<o.left+o.width/2?e.backBtn.hasAllClasses(t.wijCSS.stateDisabled)||e.back():e.nextBtn.hasAllClasses(t.wijCSS.stateDisabled)||e.next()})},n.prototype._initHoverBehavior=function(){var t=this.options,e=this;this.frame.unbind(".wijlightbox"),t.showControlsOnHover&&this.frame.bind({"mouseenter.wijlightbox":function(){return e.container.data("moving.wijlightbox")?!1:void e._showAccessories(!0)},"mouseleave.wijlightbox":function(){return e.container.data("moving.wijlightbox")?!1:void e._hideAccessories(!0)},"mousemove.wijlightbox":function(){e.container.data("moving.wijlightbox")===!1&&e.container.data("accessvisible.wijlightbox")===!1&&e.frame.trigger("mouseenter")}})},n.prototype._getPlugins=function(){var t=this.container.data("plugins.wijlightbox"),e,n,o;return t||(t={},window.navigator.plugins&&window.navigator.plugins.length?(e=[],i.each(window.navigator.plugins,function(t,i){e.push(i.name)}),e=e.join(","),o=e.indexOf("Flip4Mac")>-1,t={fla:e.indexOf("Shockwave Flash")>-1,qt:e.indexOf("QuickTime")>-1,wmp:!o&&e.indexOf("Windows Media")>-1,f4m:o}):(n=function(t){var e;try{e=new ActiveXObject(t)}catch(i){}return!!e},t={fla:n("ShockwaveFlash.ShockwaveFlash"),qt:n("QuickTime.QuickTime"),wmp:n("wmplayer.ocx"),f4m:!1}),this.container.data("plugins.wijlightbox",t)),t},n.prototype._sanitizeSelector=function(t){return t.replace(/:/g,"\\:")},n.prototype._getFragmentId=function(t){var e=/^#.+/,n=i(t).attr("href")||"",o=n.split("#")[0],r=i("base")[0];return o&&(o===window.location.toString().split("#")[0]||r&&o===r.attributes.href)&&(n=t.hash,t.href=n),e.test(n)?this._sanitizeSelector(n):""},n.prototype._parseLink=function(t){var e=this,n=this.options,o=i(t),r={href:void 0,player:void 0,img:void 0,gallery:void 0},s,a,l,h,d=["href","player","title","alt","height","width","gallery","wijvideosrc"];if(o.length>0&&"a"===o[0].tagName.toLowerCase()){if(s=o.attr("rel"),i.each(d,function(t,e){r[e]=o.attr(e)||""}),!r.href)return;r.player||(r.player=n.player||e._getPlayerName(r.href)),
a=o.find("img"),a&&0===a.length&&(a=o),a&&a.length>=1&&(i.each(["title","alt"],function(t,e){r[e]=a.attr(e)||r[e]}),r.img=a),s&&(l=s.match(/\[(.*?)\]/),l&&(r.gallery=l[1]||r.gallery),i.each(s.split(";"),function(t,e){var i=e.match(/\s*([a-z_]*?)\s*=\s*(.+)\s*/);i&&(r[i[1]]=i[2])})),"inline"===r.player&&(r.href=e._getFragmentId(t)),r.gallery?(h=n.groupItems.length,n.groupItems[h]=r,o.bind({click:function(t){return t.stopPropagation(),t.preventDefault(),n.disabled||e._open(a,h),!1}})):o.bind({click:function(t){return t.stopPropagation(),t.preventDefault(),n.disabled||e._open(a,r),!1}})}},n.prototype._parse=function(){var t=this;this._parseLink(this.element),this.element.find('a[rel^="wijlightbox"], a[rel^="lightbox"]').each(function(e,i){t._parseLink(i)})},n.prototype._showAccessories=function(t){this.container.data("accessvisible.wijlightbox",!0),this._showNavButtons(t),this._showToolboxButtons(t),this._showCounter(t)},n.prototype._hideAccessories=function(t){this.container.data("accessvisible.wijlightbox",!1),this._hideNavButtons(t),this._hideToolboxButtons(t),this._hideCounter(t)},n.prototype._groupMode=function(){var t=this.options;return t.groupItems&&t.groupItems.length>1},n.prototype._resetText=function(){this._removeText(),this._createText()},n.prototype._createText=function(t){var e=this,n=e.options,o,r,s,a,l;"none"!==n.textPosition&&(this.container.find(".wijmo-wijlightbox-text").length||(o=n.textPosition.toLowerCase(),r=i("<div></div>").addClass("wijmo-wijlightbox-text wijmo-wijlightbox-text-"+o+" "+n.wijCSS.content+" "+n.wijCSS.helperClearFix),a=i("<h3></h3>").addClass("wijmo-wijlightbox-title wijmo-wijlightbox-title-"+o+" "+n.wijCSS.helperClearFix).appendTo(r),l=i("<p></p>").addClass("wijmo-wijlightbox-detail wijmo-wijlightbox-detail-"+o+" "+n.wijCSS.helperClearFix).appendTo(r),"inside"===n.textPosition?r.addClass(n.wijCSS.content+" "+n.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame):"outside"===n.textPosition?r.addClass([n.wijCSS.content,n.wijCSS.cornerAll,n.wijCSS.helperClearFix].join(" ")).width(this.frame.width()).appendTo(this.container):("overlay"===n.textPosition||"titleOverlay"===n.textPosition)&&(s=i("<div></div>").addClass("wijmo-wijlightbox-mask wijmo-wijlightbox-mask-"+o+" "+n.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame),r.width(this.frame.width()).appendTo(this.frame),"titleOverlay"===n.textPosition&&r.bind({mouseenter:function(){s.stop(),r.stop();var t=a.outerHeight(!0)+l.outerHeight(!0),o=i.extend({},e._defaults.textShowOption,n.textShowOption,{queue:!1});s.animate({height:t},o),r.animate({height:t},o)},mouseleave:function(){s.stop(),r.stop();var t=a.height(),o=i.extend({},e._defaults.textHideOption,n.textHideOption,{queue:!1});s.animate({height:t},o),r.animate({height:t},o)}})),this._refreshText(t)))},n.prototype._removeText=function(){this.container.find(".wijmo-wijlightbox-text,.wijmo-wijlightbox-mask").remove()},n.prototype._getActiveItem=function(){var t=this.options;return t.groupItems&&t.groupItems.length&&t.activeIndex>=0&&t.activeIndex<t.groupItems.length?t.groupItems[t.activeIndex]:null},n.prototype._refreshText=function(t){var e=this,n=this.options,o,r,s,a,l;if("none"!==n.textPosition&&(o=this.container.data("item.wijlightbox")||this._getActiveItem())){r=this.container.find(".wijmo-wijlightbox-text"),s=this.container.find(".wijmo-wijlightbox-title"),a=this.container.find(".wijmo-wijlightbox-detail"),l=this.container.find(".wijmo-wijlightbox-mask"),l.stop(),r.stop(),s.html(o.title),a.html(o.alt),"outside"===n.textPosition&&r.width(this.frame.width());var h=s.outerHeight(!0),d=a.outerHeight(!0),c=i.extend({},e._defaults.textShowOption,n.textShowOption,{queue:!1});if("overlay"===n.textPosition||"titleOverlay"===n.textPosition){var u=h+("overlay"===n.textPosition?d:0);r.height(0),l.height(0),r.animate({height:u},c),l.animate({height:u},c)}else t?r.height(h+d):(r.height(0),r.animate({height:h+d},c))}},n.prototype._addState=function(t,e){e.is(":not(."+this.options.wijCSS.stateDisabled+")")&&e.addClass("ui-state-"+t)},n.prototype._removeState=function(t,e){e.removeClass("ui-state-"+t)},n.prototype._createNavButtons=function(){var t=this,e=this.options;return e.showNavButtons&&this._groupMode()?(this.backBtn||(this.backBtn=i("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-prev "+e.wijCSS.stateDefault+" "+("inside"===e.controlsPosition?e.wijCSS.cornerRight:e.wijCSS.cornerLeft)).append("<span class='"+e.wijCSS.icon+" "+e.wijCSS.iconArrowLeft+"'></span>").hide().appendTo(this.frame).bind({click:function(){return i(this).hasAllClasses(e.wijCSS.stateDisabled)||t.back(),!1},mouseover:function(){t._addState("hover",i(this))},mouseout:function(){t._removeState("hover",i(this))},mousedown:function(){t._addState("active",i(this))},mouseup:function(){t._removeState("active",i(this))}})),void(this.nextBtn||(this.nextBtn=i("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-next "+e.wijCSS.stateDefault+" "+("inside"===e.controlsPosition?e.wijCSS.cornerLeft:e.wijCSS.cornerRight)).append("<span class='"+e.wijCSS.icon+" "+e.wijCSS.iconArrowRight+"'></span>").hide().appendTo(this.frame).bind({click:function(){return i(this).hasAllClasses(e.wijCSS.stateDisabled)||t.next(),!1},mouseover:function(){t._addState("hover",i(this))},mouseout:function(){t._removeState("hover",i(this))},mousedown:function(){t._addState("active",i(this))},mouseup:function(){t._removeState("active",i(this))}})))):void this._removeNavButtons()},n.prototype._removeNavButtons=function(){this.backBtn&&(this.backBtn.remove(),this.backBtn=void 0),this.nextBtn&&(this.nextBtn.remove(),this.nextBtn=void 0)},n.prototype._refreshNavButtons=function(){var t=this.options,e;this.backBtn&&(e=0===t.activeIndex?"addClass":"removeClass",this.backBtn[e](t.wijCSS.stateDisabled)),this.nextBtn&&(e=t.activeIndex>=t.groupItems.length-1?"addClass":"removeClass",this.nextBtn[e](t.wijCSS.stateDisabled))},n.prototype._showNavButtons=function(t){this.isPlaying()||this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeIn(t?600:0,function(){i(this).css("opacity","")})},n.prototype._hideNavButtons=function(t){this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeOut(t?600:0)},n.prototype._createToolbox=function(){this.toolBox||(this.toolBox=i("<div></div>").addClass("wijmo-wijlightbox-toolbox").appendTo(this.frame))},n.prototype._showToolboxButtons=function(t){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeIn(t?600:0,function(){i(this).css("opacity","")})},n.prototype._hideToolboxButtons=function(t){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeOut(t?600:0)},n.prototype._createCtrlButtons=function(){var t=this,e=this.options,n=e.wijCSS;if(!e.ctrlButtons||0===e.ctrlButtons.length||!this._groupMode())return void this._removeCtrlButtons();this._createToolbox();var o=e.ctrlButtons.split("|");1===o.length&&o[0]===e.ctrlButtons&&(o=e.ctrlButtons.split(",")),i.each(o,function(o,r){r=i.trim(r),"play"!==r||this.playBtn?"stop"===r&&!this.stopBtn&&(t.stopBtn=i("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button","wijmo-wijlightbox-toolbox-button-stop",n.stateDefault,n.stateDisabled,n.cornerAll].join(" ")).append("<span class='"+n.icon+" "+n.iconStop+"'></span>").hide().click(function(){return t.isPlaying()&&(t.stop(),t.show(0)),!1})):t.playBtn=i("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button"," wijmo-wijlightbox-toolbox-button-play ",n.stateDefault,n.cornerAll].join(" ")).append("<span class='"+n.icon+" "+n.iconPlay+"'></span>").hide().click(function(){return t.isPlaying()?t.stop():(e.activeIndex>=e.groupItems.length-1&&t.show(0),t.play()),!1})}),this.stopBtn&&this.stopBtn.appendTo(this.toolBox),this.playBtn&&this.playBtn.appendTo(this.toolBox)},n.prototype._removeCtrlButtons=function(){this.playBtn&&(this.playBtn.remove(),this.playBtn=void 0),this.stopBtn&&(this.stopBtn.remove(),this.stopBtn=void 0)},n.prototype._refreshCtrlButtons=function(){var t=this.options.wijCSS;if(this.playBtn){var e=this.playBtn.find("."+t.icon);e&&(e.removeClass(t.iconPause+" "+t.iconPlay),e.addClass(this.isPlaying()?t.iconPause:t.iconPlay))}this.stopBtn&&this.stopBtn[this.isPlaying()?"removeClass":"addClass"](t.stateDisabled)},n.prototype._createDialogButtons=function(){var t=this,e=this.options,n;return e.dialogButtons&&0!==e.dialogButtons.length?(this._createToolbox(),n=e.dialogButtons.split("|"),1===n.length&&n[0]===e.dialogButtons&&(n=e.dialogButtons.split(",")),i.each(n,function(n,o){o=i.trim(o),"close"!==o||this.closeBtn?"fullSize"===o&&!this.fullBtn&&(t.fullBtn=i("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-fullsize "+e.wijCSS.stateDefault+" "+e.wijCSS.cornerAll).append("<span class='"+e.wijCSS.icon+" "+e.wijCSS.iconArrow4Diag+"'></span>").hide().click(function(){return t._toggleFullSize(),!1})):t.closeBtn=i("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-close "+e.wijCSS.stateDefault+" "+e.wijCSS.cornerAll).append("<span class='"+e.wijCSS.icon+" "+e.wijCSS.iconClose+"'></span>").hide().click(function(){return t._close(),!1})}),this.closeBtn&&this.closeBtn.appendTo(this.toolBox),this.fullBtn&&this.fullBtn.appendTo(this.toolBox),this.btnSep||(this.btnSep=i("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-separator").appendTo(this.toolBox)),void 0):void this._removeDialogButtons()},n.prototype._removeDialogButtons=function(){this.closeBtn&&(this.closeBtn.remove(),this.closeBtn=void 0),this.fullBtn&&(this.fullBtn.remove(),this.fullBtn=void 0)},n.prototype._refreshDialogButtons=function(){var t=this.options.wijCSS;if(this.fullBtn){var e=this.fullBtn.find("."+t.icon);e&&(e.removeClass(t.iconArrow4Diag+" "+t.iconNewWin),e.addClass(this._isFullSize()?t.iconNewWin:t.iconArrow4Diag))}},n.prototype._createTimerBar=function(){var t=this,e=t.options;return e.showTimer&&t._groupMode()?(t._createToolbox(),void(t.timerBar||(t.timerBar=i("<div></div>").addClass("wijmo-wijlightbox-timerbar "+e.wijCSS.content+" ui-priority-secondary "+e.wijCSS.cornerAll).appendTo(t.toolBox),t.timerMeter=i("<div></div>").addClass("wijmo-wijlightbox-timermeter ui-progressbar-value "+e.wijCSS.content+" "+e.wijCSS.cornerAll).appendTo(t.toolBox)))):void t._removeTimerBar()},n.prototype._removeTimerBar=function(){this.timerMeter&&(this.timerMeter.remove(),this.timerMeter=void 0),this.timerBar&&(this.timerBar.remove(),this.timerBar=void 0)},n.prototype._createCounter=function(){var t=this,e=t.options;return e.showCounter&&t._groupMode()?void(t.counter||(t.counter=i("<div></div>").addClass("wijmo-wijlightbox-counter "+e.wijCSS.stateDefault+" "+("inside"===e.controlsPosition?e.wijCSS.cornerTL:e.wijCSS.cornerAll)).hide().appendTo(t.frame))):void t._removeCounter()},n.prototype._removeCounter=function(){this.counter&&(this.counter.remove(),this.counter=void 0)},n.prototype._refreshCounter=function(t){var e=this,n=this.options,o="";if(this.counter&&this._groupMode()&&(this.counter.empty(),n.showCounter&&n.groupItems.length>1&&this.counter)){void 0===t&&(t=n.activeIndex);var r=n.groupItems.length;if("sequence"===n.counterType){var s=0,a=r,l=parseInt(n.counterLimit,10)||0;if(l>=2&&r>l){var h=Math.floor(l/2);s=Math.min(a-l,Math.max(s,t-h)),a=Math.min(a,s+l)}for(;s!==a;)i("<a></a>").addClass("wijmo-wijlightbox-counter-item "+n.wijCSS.content+" "+n.wijCSS.stateDefault+(s===t?" wijmo-wijlightbox-counter-active "+n.wijCSS.stateActive:"")).text((++s).toString()).appendTo(this.counter);this.counter.find("a").click(function(t,n){return i(this).hasClass("wijmo-wijlightbox-counter-active")?!1:(e.show(parseInt(i(this).text(),10)-1),!1)})}else{var d=n.counterFormat||"[i] of [n]";o=d.replace("[i]",t+1),o=o.replace("[n]",r),i("<span></span>").text(o).appendTo(this.counter)}}},n.prototype._showCounter=function(t){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeIn(t?600:0,function(){i(this).css("opacity","")})},n.prototype._hideCounter=function(t){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeOut(t?600:0)},n.prototype._cookie=function(t,e){var n=this.cookie||(this.cookie=this.options.cookie.name);return i.cookie.apply(null,[n].concat(i.makeArray(arguments)))},n.prototype._showOverlay=function(){this.container.data("overlay.wijlightbox")||this.container.data("overlay.wijlightbox",new i.wijmo.wijlightbox.overlay(this))},n.prototype._hideOverlay=function(){var t=this.container.data("overlay.wijlightbox");t&&(t.close(),this.container.removeData("overlay.wijlightbox"))},n.prototype._hasOverlay=function(){return this.container.hasData("overlay.wijlightbox")},n.prototype._showWaiting=function(){this.container.data("waiting.wijlightbox")||this.container.data("waiting.wijlightbox",new i.wijmo.wijlightbox.overlay(this,!0))},n.prototype._hideWaiting=function(){var t=this.container.data("waiting.wijlightbox");t&&(t.close(),this.container.removeData("waiting.wijlightbox"))},n.prototype._hasWaiting=function(){return this.container.hasData("waiting.wijlightbox")},n.prototype._getUrl=function(t){var e=this.options,i="string"==typeof t?t:t.href,n=e.rootUrl;return n&&n.length>0&&(-1===n.indexOf("//")&&(n=window.location.protocol+"//"+window.location.host+(n.startsWith("/")?"":"/")+n),"/"!==n.substr(n.length-1,1)&&(n+="/"),i=n+("/"===i.substr(0,1)?i.substr(1):i)),i},n.prototype._preload=function(){var t=this.options,e;for(e=Math.max(0,t.activeIndex);e<Math.min(t.activeIndex+5,t.groupItems.length);e++)t.groupItems[e].image||(t.groupItems[e].image=new Image,t.groupItems[e].image.src=this._getUrl(t.groupItems[e]))},n.prototype._slideAnimate=function(t,e,n){var o=["position","top","bottom","left","right","width","height"],r=i.setMode(e,t.mode||"show"),s="show"===r,a=t.direction||"left",l="up"===a||"down"===a?"top":"left",h="up"===a||"left"===a,d,c={};i.save(e,o),e.show(),d=t.distance||e["top"===l?"outerHeight":"outerWidth"](!0),i.createWrapper(e).css({overflow:"hidden"}),s&&e.css(l,h?isNaN(d)?parseInt("-"+d):-d:d),c[l]=(s?h?"+=":"-=":h?"-=":"+=")+d,e.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&e.hide(),i.restore(e,o),i.removeWrapper(e),n()}})},n.prototype._slideTo=function(t,e,n,o,r){var s=this.options,a=this,l=t.getElement(),h,d,c,u,p,g,f,m;l.parent().is(".wijmo-wijlightbox-aniwrapper")?h=l.parent():(h=i.createWrapper(l).css({overflow:"hidden"}),h.removeClass("ui-effects-wrapper"),h.addClass("wijmo-wijlightbox-aniwrapper")),h.parent().is(".wijmo-wijlightbox-aniwrapper")?d=h.parent():(d=i.createWrapper(h).css({overflow:"hidden"}),d.removeClass("ui-effects-wrapper"),d.addClass("wijmo-wijlightbox-aniwrapper")),c=s.slideDirection||"horizontal",u=l.outerWidth(),p=l.outerHeight(),"horizontal"===c?(l.width(u).css("float",o?"left":"right"),h.width(2*u).css({left:o?0:-1*u,position:"absolute"})):(l.height(p),h.width(u).css({top:o?0:-1*p,position:"absolute"}).height(2*p)),e.appendTo(h),g=e.getElement(),"horizontal"===c?g.width(u).css("float",o?"left":"right"):g.height(p),this.container.data("animating.wijlightbox",!0),f=function(){for(l=h.children(":last");l.parent().is(".wijmo-wijlightbox-aniwrapper");)l.parent().replaceWith(l);l.css({"float":"",width:"",height:""}),s.autoSize&&!a._isFullSize()?a._resize(r):(i.isFunction(r)&&r.apply(a),a._refreshText())},m={mode:"hide",direction:"horizontal"===c?o?"left":"right":o?"up":"down",easing:n.easing,distance:"horizontal"===c?u:p,duration:n.duration},i.effects?h.effect("slide",m,f):a._slideAnimate(m,h,f)},n.prototype._moveFrom=function(t,e,n){var o=this,r=this.options,s;return i.isFunction(e)?(n=e,e=i.extend({},o._defaults.resizeAnimation,r.resizeAnimation)):e=i.extend({},o._defaults.resizeAnimation,r.resizeAnimation,e),o._removeText(),"none"===e.animated||e.duration<=0?(o._createText(),i.isFunction(n)&&n.apply(o),this.container.data("moving.wijlightbox",!1),void 0):(s=i.extend({width:o.frame.width(),height:o.frame.height()},o.container.offset()),o.frame.width(t.width).height(t.height),o.container.css({left:t.left,top:t.top,width:o.frame.outerWidth(),position:"absolute",opacity:""}),o._moveTo(s,e,function(){o.frame.width(s.width),o.container.width(o.frame.outerWidth()),o._createText(),o.container.data("moving.wijlightbox",!1),i.isFunction(n)&&n.apply(o)}),void 0)},n.prototype._moveTo=function(t,e,n){var o=this,r=this.options;i.isFunction(e)?(n=e,e=i.extend({},o._defaults.resizeAnimation,r.resizeAnimation)):e=i.extend({},o._defaults.resizeAnimation,r.resizeAnimation,e);var s=e.duration/2,a=e.animated,l=o._isOpen(),h="wh"===a?{left:t.left,top:void 0}:{top:t.top},d="wh"===a?{top:t.top,left:void 0}:{left:t.left},c="wh"===a?{width:t.width,height:void 0}:{height:t.height},u="wh"===a?{height:t.height,width:void 0}:{width:t.width};return"wh"===a||"hw"===a?(l&&o.container.animate(h,{duration:s,easing:e.easing,queue:!0}),void o.frame.animate(c,{duration:s,easing:e.easing,complete:function(){l&&o.container.animate(d,{duration:s,easing:e.easing,queue:!0}),o.frame.animate(u,{duration:s,easing:e.easing,complete:function(){o.container.data("moving.wijlightbox",!1),i.isFunction(n)&&n.apply(o)}})}})):(l&&o.container.animate({left:t.left,top:t.top},{duration:e.duration,easing:e.easing,queue:!0}),void o.frame.animate({width:t.width,height:t.height,opacity:1},{duration:e.duration,easing:e.easing,complete:function(){o.container.data("moving.wijlightbox",!1),i.isFunction(n)&&n.apply(o)}}))},n.prototype.show=function(t){return this._show(t),this},n.prototype._resize=function(t){var e=this,n=i.extend({},e.container.offset(),{width:e.frame.width(),height:e.frame.height()});e._size(),e._isOpen()&&e._position(),e._moveFrom(n,t)},n.prototype._onAfterShow=function(){var t=this,e=this.options,i;t._refreshNavButtons(),t.container.data("animating.wijlightbox",!1),e.modal||t._hideOverlay(),i={index:e.activeIndex,item:e.groupItems[e.activeIndex]},t._trigger("show",null,i),t._startTimer()},n.prototype._show=function(t,e,n){var o=this,r=this.options,s,a;if(this.container.data("showing.wijlightbox"))return s=[function(){o._show(t,e,n)}],this.container.queue("showqueue",s),this;if(a=r.activeIndex,!i.isPlainObject(t)){if(a=t,0>a||a>=r.groupItems.length)return this;t=r.groupItems[a]}t&&this.container.data("item.wijlightbox",t),this._groupMode()&&this._preload(),i.isFunction(e)&&(n=e,e=void 0),n||(n=o._onAfterShow);var l={index:a,item:t};if(o._trigger("beforeShow",null,l)===!1)return this;this.container.data("showing.wijlightbox",!0);var h=function(){i.isFunction(n)&&n.apply(o),o.container.data("showing.wijlightbox",!1),o.container.dequeue("showqueue"),o.container.clearQueue("showqueue")};o._refreshCounter(a);var d=this.container.data("player.wijlightbox"),c,u=function(){o.container.data("playerwidth.wijlightbox",c.width),o.container.data("playerheight.wijlightbox",c.height);var t=i.extend({},o._defaults.transAnimation,r.transAnimation);if(r.activeIndex===a||"none"===t.animated||t.duration<=0||!o._isOpen())return r.activeIndex=a,d&&d.remove(),c.appendTo(o.content),o._refreshText(),h(),void 0;if(r.cookie&&o._cookie(r.activeIndex,r.cookie),"slide"===t.animated)e=void 0===e?a>r.activeIndex:e,o._slideTo(d,c,t,e,h),r.activeIndex=a;else{r.activeIndex=a;var n=function(){c&&(c.appendTo(o.content,!0),c.fadeIn(t.duration,h))};i.browser.msie&&o.frame.trigger("mouseleave");var s=function(){d&&d.remove(),r.autoSize&&!o._isFullSize()?o._resize(n):(n(),o._refreshText())};d?d.fadeOut(.4*t.duration,s):s()}};return c=this._createPlayer(t,u),this},n.prototype.next=function(){var t=this.options;if(!this._groupMode())return!1;var e=t.activeIndex+1;return t.loop&&(e%=t.groupItems.length),e<t.groupItems.length?(this._show(e,!0),!0):!1},n.prototype.back=function(){var t=this.options;if(!this._groupMode())return!1;var e=t.activeIndex-1;return t.loop&&(e=0>e?t.groupItems.length-1:e),e>=0?(this._show(e,!1),!0):!1},n.prototype.adjustPosition=function(){this._position()},n.prototype.isPlaying=function(){return!!this.container.data("playing.wijlightbox")},n.prototype._startTimer=function(){if(this.isPlaying()&&this._groupMode()){var t=this.options,e=this,i;t.showTimer===!0?(this.timerMeter||this._createTimerBar(),i=this.timerBar.width(),e.timerMeter.width("0"),e.timerMeter.animate({width:i},t.delay,null,function(){e.isPlaying()&&!e.next()&&e.stop()})):window.setTimeout(function(){e.isPlaying()&&!e.next()&&e.stop()},t.delay)}},n.prototype.play=function(){return this._groupMode()?(this.container.data("playing.wijlightbox")||this.container.data("playing.wijlightbox",!0),this._refreshCtrlButtons(),this._hideNavButtons(),this._startTimer(),void 0):!1},n.prototype.stop=function(){this.container.removeData("playing.wijlightbox"),this._refreshCtrlButtons(),this._removeTimerBar()},n.prototype._size=function(t,e){var n=this.options,o=n.width,r=n.height,s=n.autoSize?this.container.data("playerwidth.wijlightbox")||o:o,a=n.autoSize?this.container.data("playerheight.wijlightbox")||r:r,l,h=a/s;if("boolean"==typeof t)e=t;else if(i.isPlainObject(t)&&"width"in t&&"height"in t)o=t.width,r=t.height;else if(l=this.container.data("player.wijlightbox"),n.autoSize&&l&&"img"===l.name&&(s>o&&(s=o,a=Math.round(o*h)),a>r&&(a=r,s=Math.round(r/h))),o=s,r=a,e)return{width:o,height:r};this.frame.width(o).height(r),this.container.width(this.frame.outerWidth(!0))},n.prototype._position=function(){var t=this.options,e=[],n=[0,0],o,r=t.position;r&&(("string"==typeof r||"object"==typeof r&&"0"in r)&&(e=r.split?r.split(" "):[r[0],r[1]],1===e.length&&(e[1]=e[0]),i.each(["left","top"],function(t,i){+e[t]===e[t]&&(n[t]=e[t],e[t]=i)}),r={my:e.join(" "),at:e.join(" "),offset:n.join(" ")}),r=i.extend({},t.position,r)),o=this.container.is(":visible"),o||this.container.show(),this.container.css({top:0,left:0}).position(r),o||this.container.hide()},n.prototype._getRelRect=function(t){var e;return t&&(i.isPlainObject(t)&&"left"in t&&"top"in t&&"width"in t&&"height"in t?e=i.merge({},t):t=i(t),t.jquery&&t.length&&(e=i.extend({},t.offset(),{width:t.width(),height:t.height()}))),e},n.prototype._close=function(t){var e=this.options,n=this,o,r,s;if(this._isOpen()&&(r={rel:t},!1!==this._trigger("beforeClose",null,r)))return t=r.rel,!t&&this._groupMode()&&(t=e.groupItems[e.activeIndex].img),this.container.data("moving.wijlightbox",!0),this._hideAccessories(!1),this._hideWaiting(),this._hideOverlay(),this.stop(),s=function(){n._removePlayer(),n.container.hide(),n._trigger("close"),n.container.unbind("keypress.wijlightbox"),n.container.removeData("open.wijlightbox").removeData("rect.wijlightbox").removeData("moving.wijlightbox").removeData("fullsize.wijlightbox"),i(document).unbind("keydown.wijlightbox").unbind("click.wijlightbox")},o=this._getRelRect(t),o||this.container.data("rect.wijlightbox")&&(o=this.container.data("rect.wijlightbox")),this._removeText(),o?void this._moveTo(o,{animated:"sync",duration:200},s):(s.call(),this)},n.prototype._isOpen=function(){return!!this.container.data("open.wijlightbox")},n.prototype._open=function(t,e){if(!this._isOpen()){var n=this.options,o=this;this.toolBox&&(this._isFullSize()?this.toolBox.css({top:"2px",right:"4px"}):this.toolBox.css({top:"",right:""}));var r=function(){n.modal&&o._showOverlay(),n.showControlsOnHover?this._hideAccessories(!1):this._showAccessories(!1);var e=o._getRelRect(t);if(o.container.css("opacity",0),o.container.show(),o._size(),o._createText(!0),o._refreshText(!0),o._position(),o.container.data("open.wijlightbox",!0),t&&e)o.container.data("rect.wijlightbox",e),o._moveFrom(e,{animated:"sync"});else{var r=i.extend({},o._defaults.transAnimation,n.transAnimation);"fade"===r.animated?(o.container.hide(),o.container.fadeIn(r.duration,function(){o._createText()})):o._createText(),this.container.data("moving.wijlightbox",!1)}i(document).bind("keydown.wijlightbox",i.proxy(o,"_keyDownHandler")).bind("click.wijlightbox",function(t){var e=t.target||t.srcElement;o._isOpen()&&!!n.closeOnOuterClick&&e!==o.container.get(0)&&i(e).parents().index(o.container)<0&&o._close()}),n.autoPlay&&this.play(),o._refreshNavButtons(),o._refreshDialogButtons();var s={index:n.activeIndex,item:n.groupItems[n.activeIndex]};o._trigger("show",null,s),o._trigger("open")};return this.container.data("moving.wijlightbox",!0),this._show(e,!0,r),this}},n.prototype._getWinRect=function(){var t=i(window);return i.extend({width:t.width(),height:t.height()},t.offset()||{left:2,top:2})},n.prototype._resizeHandler=function(){var t=this;t._removeText(),t._size(t._getWinRect()),t._createText()},n.prototype._isFullSize=function(){return!!this.container.data("fullsize.wijlightbox")},n.prototype._toggleFullSize=function(){var t=this,e=i(window);if(t._isOpen()){if(this._isFullSize())t.toolBox&&t.toolBox.css({top:"",right:""}),this.container.data("fullsize.wijlightbox",!1),e.unbind("resize.wijlightbox",i.proxy(this,"_resizeHandler")),t._resize(function(){t._adjustPlayerSize(t.content.innerWidth(),t.content.innerHeight())});else{this.container.data("fullsize.wijlightbox",!0),e.bind("resize.wijlightbox",i.proxy(this,"_resizeHandler"));var n=t._getWinRect(),o=this.frame.borderSize();n.width-=o.width,n.height-=o.height,t._removeText(),t._moveTo(n,{animated:"sync"},function(){t.toolBox&&t.toolBox.css({top:"2px",right:"4px"}),t.frame.width(n.width),t.container.width(t.frame.outerWidth()),t._createText(),t._adjustPlayerSize(t.content.innerWidth(),t.content.innerHeight())})}this._refreshDialogButtons()}},n.prototype._getExt=function(t){var e,i,n=/[0-9a-z]+$/i,o=t.indexOf("?");return o>-1&&(t=t.substring(0,o)),i=t.match(n),i&&(e=i[0].toLowerCase()),e},n.prototype._getPlayerName=function(t){if(0===t.indexOf("#")||t.indexOf("#")>0&&0===t.indexOf(document.location.href))return"inline";var e=["bmp","gif","jpg","jpeg","png"],n=["swf"],o=["flv","m4v"],r=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],s=["asf","avi","mpg","mpeg","wm","wmv"],a=["mp4","mpg","mpeg","ogg","ogv"],l=this._getExt(t);if(l){if(i.inArray(l,e)>=0)return"img";if(i.inArray(l,n)>=0)return"swf";if(i.inArray(l,o)>=0)return"flv";if(i.inArray(l,s)>=0)return"wmp";if(i.inArray(l,r)>=0)return"qt";if(i.inArray(l,a)>=0)return"wijvideo"}return"iframe"},n.prototype._adjustPlayerSize=function(t,e){var i=this.container.data("player.wijlightbox");i&&i.adjustSize&&i.adjustSize(t,e)},n.prototype._removePlayer=function(){var t=this.container.data("player.wijlightbox");t&&(t.remove(),this.container.data("player.wijlightbox",null))},n.prototype._createPlayer=function(t,e,n){var o=t.player;if(!i.isFunction(i.wijmo.wijlightbox[o]))throw"unknown player "+o;var r=this,s=!1,a,l=function(){s=!0,this._hideWaiting(),i.isFunction(e)&&window.setTimeout(function(){e.apply(r)},1)},h=function(){this._hideWaiting(),i.isFunction(n)&&n.apply(r)};return a=new i.wijmo.wijlightbox[o](this,t,l,h),this.container.data("player.wijlightbox",a),window.setTimeout(function(){s===!1&&r._showWaiting()},200),a},n}(t.wijmoWidget);e.wijlightbox=o;var r=function(){function t(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijlightbox')",this.textPosition="overlay",this.width=600,this.height=400,this.autoSize=!0,this.player="",this.groupItems=null,this.rootUrl="",this.ctrlButtons="",this.dialogButtons="close",this.counterType="default",this.counterFormat="[i] of [n]",this.counterLimit=10,this.showCounter=!0,this.showNavButtons=!0,this.showTimer=!1,this.controlsPosition="inside",this.showControlsOnHover=!0,this.clickPause=!1,this.keyNav=!1,this.modal=!1,this.position={my:"center",at:"center",of:window,collision:"fit",using:function(t){var e=i(this).css(t).offset().top;0>e&&i(this).css("top",t.top-e)}},this.zIndex=1e3,this.closeOnEscape=!0,this.closeOnOuterClick=!0,this.autoPlay=!1,this.delay=2e3,this.loop=!0,this.cookie=null,this.transAnimation={animated:"fade",duration:400,easing:"linear"},this.slideDirection="horizontal",this.resizeAnimation={animated:"sync",duration:400},this.textShowOption={duration:300,easing:"linear"},this.textHideOption={duration:300,easing:"linear"},this.showMovieControls=!0,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.beforeShow=null,this.show=null,this.open=null,this.beforeClose=null,this.close=null}return t}();o.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new r),i.wijmo.registerWidget("wijlightbox",o.prototype),i.extend(i.wijmo.wijlightbox,{img:function(t,e,n,o){this.name="img",this.lightbox=t,this.item=e,this.url=this.lightbox._getUrl(e);var r=this;i("<img></img>").css({width:"auto",height:"auto",display:"none"}).appendTo(document.body).bind({load:function(){var o=i(this);r.width=e.width?parseInt(e.width,10):o.width(),r.height=e.height?parseInt(e.height,10):o.height(),o.remove(),n&&i.isFunction(n)&&n.apply(t)},error:function(){i(this).remove(),o&&i.isFunction(o)&&o.apply(t)}}).attr("src",this.url)},swf:function(t,e,n,o){this.name="swf";var r=t.options;this.id="flashhost",this.lightbox=t,this.item=e,this.url=this.lightbox._getUrl(e),this.width=e.width?parseInt(e.width,10):r.width,this.height=e.height?parseInt(e.height,10):r.height,n&&i.isFunction(n)&&n.apply(t)},iframe:function(t,e,n,o){this.name="swf",this.lightbox=t,this.item=e,this.url=this.lightbox._getUrl(e),e.width&&(this.width=parseInt(e.width,10)),e.height&&(this.height=parseInt(e.height,10)),this.$iframe=i("<iframe></iframe>").addClass("wijmo-wijlightbox-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true"}).hide().appendTo(t.content).bind("load",function(){n&&i.isFunction(n)&&n.apply(t)}).attr("src",this.url)},inline:function(t,e,n,o){this.name="inline";var r=t.options,s=r.wijCSS,a="wijmo-wijlightbox-frame "+s.content;if(" "+s.cornerAll+" "+s.helperClearFix,this.lightbox=t,this.item=e,this.width=e.width?parseInt(e.width,10):r.width,e.height)this.height=parseInt(e.height,10);else{var l=i(this.item.href).clone().show().append('<br clear="all" />').wrap('<div class="wijmo-wijlightbox '+s.widget+'"><div class="'+a+'"><div class="'+a+'"><div class="wijmo-wijlightbox-content"> </div></div></div></div>').appendTo(document.body).width(this.width);this.height=l.outerHeight(!0)+10,l.unwrap(),l.remove()}n&&i.isFunction(n)&&n.apply(t)},flv:function(t,e,n,o){this.name="flv";var r=t.options;this.id="flvhost",this.lightbox=t,this.item=e,this.url=this.lightbox._getUrl(e);var s=20;this.width=e.width?parseInt(e.width,10):r.width,this.height=e.height?parseInt(e.height,10):r.height,r.showMovieControls&&(this.height+=s),n&&i.isFunction(n)&&n.apply(t)},wmp:function(t,e,n,o){var r=t.options,s;this.name="wmp",this.id="wmphost",this.lightbox=t,this.item=e,this.url=this.lightbox._getUrl(e),s=i.browser.msie?70:45,this.width=e.width?parseInt(e.width,10):r.width,this.height=e.height?parseInt(e.height,10):r.height,r.showMovieControls&&(this.height+=s),n&&i.isFunction(n)&&n.apply(t)},qt:function(t,e,n,o){var r=t.options,s=16;this.name="qt",this.id="qthost",this.lightbox=t,this.item=e,this.url=this.lightbox._getUrl(e),this.width=e.width?parseInt(e.width,10):r.width,this.height=e.height?parseInt(e.height,10):r.height,r.showMovieControls&&(this.height+=s),n&&i.isFunction(n)&&n.apply(t)},wijvideo:function(t,e,n,o){var r=t.options;this.name="wijvideo",this.id="wijvideohost",this.lightbox=t,this.item=e,this.url=this.lightbox._getUrl(e),this.wijvideosrc=e.wijvideosrc&&""!==e.wijvideosrc?this.lightbox._getUrl(e.wijvideosrc):null,this.width=e.width?parseInt(e.width,10):r.width,this.height=e.height?parseInt(e.height,10):r.height,n&&i.isFunction(n)&&n.apply(t)}}),i.extend(i.wijmo.wijlightbox.img.prototype,{appendTo:function(t,e){this.$element=i("<img></img>").addClass("wijmo-wijlightbox-image").attr("src",this.url),e&&this.$element.hide(),this.lightbox.options.transAnimation&&"fade"==this.lightbox.options.transAnimation.animated?(t.children().length&&t.empty(),
this.$element.prependTo(t)):this.$element.appendTo(t)},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(t,e){this.$element&&this.$element.fadeOut(t,e)},fadeIn:function(t,e){this.$element&&this.$element.fadeIn(t,e)},getElement:function(){return this.$element}}),i.extend(i.wijmo.wijlightbox.swf.prototype,{appendTo:function(t){this.$container=i("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(t);var e=this.lightbox.options,n=e.flashInstall,o=e.flashVersion,r=e.flashVars,s=e.flashParams;S.flash.embedSWF(this.item.href,this.id,"100%","100%",o,n,r,s)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(t,e){this.$container&&this.$container.fadeOut(t,e)},fadeIn:function(t,e){this.$container&&this.$container.fadeIn(t,e)},getElement:function(){return this.$container}}),i.extend(i.wijmo.wijlightbox.iframe.prototype,{appendTo:function(t,e){e||this.$iframe.show()},remove:function(){this.$iframe&&this.$iframe.remove()},fadeOut:function(t,e){this.$iframe&&this.$iframe.fadeOut(t,e)},fadeIn:function(t,e){this.$iframe&&this.$iframe.fadeIn(t,e)},getElement:function(){return this.$iframe}}),i.extend(i.wijmo.wijlightbox.inline.prototype,{appendTo:function(t,e){this.$element=i(this.item.href).clone().appendTo(t),e||this.$element.show()},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(t,e){this.$element&&this.$element.fadeOut(t,e)},fadeIn:function(t,e){this.$element&&this.$element.fadeIn(t,e)},getElement:function(){return this.$element}}),i.extend(i.wijmo.wijlightbox.flv.prototype,{appendTo:function(t){this.$container=i("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(t);var e=this.lightbox.options,n="100%",o="100%",r=e.flvPlayer,s=e.flashInstall,a=e.flashVersion,l=i.extend({file:this.url,width:n,height:o,autostart:e.autoPlayMovies?"true":"false",controlbar:e.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},e.flashVars),h=i.extend({autostart:e.autoPlayMovies?"true":"false",allowscriptaccess:"always"},e.flashParams);S.flash.embedSWF(r,this.id,n,o,a,s,l,h)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(t,e){this.$container&&this.$container.fadeOut(t,e)},fadeIn:function(t,e){this.$container&&this.$container.fadeIn(t,e)},getElement:function(){return this.$container}}),i.extend(i.wijmo.wijlightbox.wmp.prototype,{appendTo:function(t){this.$container=i("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(t);var e=this.lightbox.options,n='<object id="'+this.id+'" name="'+this.id+'" height="'+this.height+'" width="'+this.width+'"',o={autostart:e.autoPlayMovies?1:0,url:void 0,uimode:void 0,showcontrols:void 0},r;i.browser.msie?(n+=' classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"',o.url=this.url,o.uimode=e.showMovieControls?"full":"none"):(n+=' type="video/x-ms-wmv"',n+=' data="'+this.url+'"',o.showcontrols=e.showMovieControls?1:0),n+=">";for(r in o)n+='<param name="'+r+'" value="'+o[r]+'">';n+="</object>",this.$container.html(n)},remove:function(){if(i.browser.msie)try{window[this.id].controls.stop(),window[this.id].URL="movie"+now()+".wmv",window[this.id]=function(){}}catch(t){}this.$container.remove()},fadeOut:function(t,e){this.$container&&this.$container.fadeOut(t,e)},fadeIn:function(t,e){this.$container&&this.$container.fadeIn(t,e)},getElement:function(){return this.$container}}),i.extend(i.wijmo.wijlightbox.qt.prototype,{appendTo:function(t,e){this.$container=i("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(t);var n=this.lightbox.options,o=n.autoPlayMovies?"true":"false",r=n.showMovieControls?"true":"false",s=i.browser.msie?"<object":"<embed",a={id:this.id,name:this.id,width:this.width,height:this.height,kioskmode:"true",classid:void 0,codebase:void 0,type:void 0,src:void 0,autoplay:void 0,controller:void 0},l,h;i.browser.msie?(a.classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",a.codebase="http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"):(a.type="video/quicktime",a.src=this.url,a.autoplay=o,a.controller=r);for(l in a)a[l]&&(s+=" "+l+'="'+a[l]+'"');if(s+=">",i.browser.msie){var d={src:this.url,scale:"aspect",controller:r,autoplay:o};for(h in d)s+='<param name="'+h+'" value="'+d[h]+'">'}s+=i.browser.msie?"</object>":"</embed>",e&&t.hide(),this.$container.html(s),e&&t.show()},remove:function(){try{document[this.id].Stop(),document[this.id]=null}catch(t){}this.$container.remove()},fadeOut:function(t,e){e.call()},fadeIn:function(t,e){e.call()},getElement:function(){return this.$container}}),i.extend(i.wijmo.wijlightbox.wijvideo.prototype,{appendTo:function(t){var e=this.lightbox.options;this.$container=i("<video/>").css({overflow:"hidden"}).attr({width:this.width,height:this.height,autoPlay:e.autoPlayMovies?"true":"false",controls:e.showMovieControls?"controls":""}).appendTo(t),!this.url||i("<source/>").attr({src:this.url}).appendTo(this.$container),!this.wijvideosrc||i("<source/>").attr({src:this.wijvideosrc}).appendTo(this.$container),this.$container.wijvideo({fullScreenButtonVisible:!1})},remove:function(){this.$container.remove()},fadeOut:function(t,e){this.$container&&this.$container.fadeOut(t,e)},fadeIn:function(t,e){this.$container&&this.$container.fadeIn(t,e)},getElement:function(){return this.$container},adjustSize:function(t,e){this.$container.wijvideo("setWidth",t),this.$container.wijvideo("setHeight",e)}}),i.extend(i.wijmo.wijlightbox,{overlay:function(t,e){if(this.mask=i("<div></div>").addClass(t.options.wijCSS.overlay+" wijmo-wijlightbox-overlay"+(e?" wijmo-wijlightbox-waitingoverlay":"")).appendTo(document.body).css({width:this.width(),height:this.height()}).bind("click",function(){return t.options.closeOnOuterClick&&t._close(),!1}),i.fn.bgiframe&&this.mask.bgiframe(),e){this.mask.css("z-index",this.zIndex);var n=i("<div></div>").addClass("wijmo-wijlightbox-waiting").css("z-index",this.zIndex+1).appendTo(this.mask);n.css({left:(this.mask.width()-n.width())/2,top:(this.mask.height()-n.height())/2})}i(window).bind("resize.wijlightbox-overlay",i.proxy(this,"resize")),window.setTimeout(function(){var t;this.mask&&(t=i.wijmo.wijlightbox.overlay,i(document).bind(t.events,function(e){return i(e.target).zIndex()<t.zIndex?!1:void 0}))},1)}}),i.extend(i.wijmo.wijlightbox.overlay.prototype,{mask:null,zIndex:1e3,events:i.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(t){return t+".wijlightbox-overlay"}).join(" "),close:function(){i(document).unbind(".wijlightbox-overlay"),i(window).unbind(".wijlightbox-overlay"),this.mask.remove(),this.mask=void 0},height:function(){var t,e;return i.browser.msie&&parseInt(i.browser.version)<7?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),e=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),e>t?i(window).height():t):i(document).height()},width:function(){var t,e;return i.browser.msie&&parseInt(i.browser.version)<7?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),e=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),e>t?i(window).width():t):i(document).width()},resize:function(){this.mask&&this.mask.css({width:this.width(),height:this.height()})}})}(t.lightbox||(t.lightbox={}));var e=t.lightbox}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){var i=function(i){function n(){i.apply(this,arguments)}return __extends(n,i),n.prototype._create=function(){var t=this,e=t.options,n=t._getDefFill(),o=e.seriesStyles,r,s;$.each(e.seriesList,function(t,i){return"bar"===i.type?($.extend(!0,e.axis,{x:{compass:"west"},y:{compass:"south"}}),!0):void("pie"===i.type&&i.pieSeriesList&&(i.data=i.pieSeriesList))}),$.extend(!0,{compass:"east"},e.hint),e.is100Percent&&(e.is100Percent=!1),e.yAxes&&$.isArray(e.yAxes)&&e.yAxes.length>0&&(s=[],$.each(e.yAxes,function(t,i){s.push($.extend({},e.axis.y,i))}),e.axis.y=s),t._handleChartStyles(),o=e.seriesStyles,$.each(e.seriesList,function(e,i){if(t._isStockSeries(i)){var n=o[e],r=i.type,s=n.fill,a=$.extend({},n);n&&(n.highLow||(n.highLow=a),"hloc"===r?(n.open||(n.open=a),n.close||(n.close=a)):(n.fallingClose||(n.fallingClose=a),n.raisingClose||(n.raisingClose=a)))}}),e.seriesStyles=o,t._isContainsStock()&&(t.isContainsStock=!0,t._handleXData()),i.prototype._create.call(this),t.chartElement.addClass(e.wijCSS.compositechart)},n.prototype._setOption=function(t,e){"is100Percent"!==t&&i.prototype._setOption.call(this,t,e)},n.prototype._supportStacked=function(){return!0},n.prototype.destroy=function(){var t=this,e=t.chartElement,n=e.data("fields"),o=n&&n.aniBarsAttr;e.removeClass(t.options.wijCSS.compositechart),i.prototype.destroy.call(this),t._destroyRaphaelArray(o),e.data("fields",null)},n.prototype._isBarChart=function(){return!0},n.prototype._clearChartElement=function(){var t=this,e=t.options,n=t.chartElement,o=n.data("fields");o&&o.allElements&&($.each(o.allElements,function(e,i){"scatters"===e&&i.length&&$.each(i,function(t,e){e.length&&($.each(e,function(t,i){i&&i.remove&&i.remove(),e[t]=null}),i[t]=null)}),t._destroyRaphaelArray(i)}),o.allElements=null),i.prototype._clearChartElement.call(this),o&&o.ctracers&&(o.ctracers=null),t.element.removeData("plotInfos"),e.seriesTransition.enabled||o&&o.aniBarsAttr&&(o.aniBarsAttr=null)},n.prototype._bindData=function(){var t=this,e=t.options,i=e.dataSource,n=e.seriesList,o=e.data,r;$.each(n,function(e,n){var s=n.data,a,l,h,d=n.dataSource||i,c=n.type,u,p,g,f=[];d&&s&&("pie"===c?(u=s.label,p=s.value,g=s.offset,u&&u.bind&&(u=t._getBindData(d,u.bind)),p&&p.bind&&(p=t._getBindData(d,p.bind)),g&&g.bind&&(g=t._getBindData(d,g.bind)),u&&$.isArray(u)&&u.length&&p&&$.isArray(p)&&p.length&&($.each(p,function(t,e){var i,n=0;t>=0&&t<u.length&&(i=u[t]),g&&$.isArray(p)&&g.length&&t>=0&&t<g.length&&(n="undefined"==typeof g[t]?0:g[t]),f.push({data:e,label:i,offset:n,legendEntry:!0})}),n.data=f)):(a=s.x,l=s.y,h=s.y1,a&&a.bind?s.x=t._getBindData(d,a.bind):o&&o.x&&o.x.bind&&(void 0===r&&(r=t._getBindData(d,o.x.bind)),s.x=r),l&&l.bind&&(s.y=t._getBindData(d,l.bind)),h&&h.bind&&(s.y1=t._getBindData(d,h.bind))))})},n.prototype.getElement=function(t,e,i){var n=this.chartElement,o=n.data("fields"),r=o.chartElements;switch(t){case"bar":case"column":return r.bars[e];case"line":case"area":return r.paths[e];case"linemarkers":return r.markersSet[e];case"pie":return this._getPie(r,e,i)}return null},n.prototype._getPie=function(t,e,i){if(void 0!==i)return t["sectors"+i]?t["sectors"+i][e]:null;var n=[];return $.each(t,function(t,e){/sectors/.test(t)&&"sectors"!==t&&$.each(e,function(t,e){n.push(e)})}),0===n.length&&(n=t.sectors),n[e]},n.prototype._paintLegendIcon=function(t,e,n,o,r,s,a,l,h,d){var c=this,u=this.options,p=h.type,g,f,m=3,w=!1,y,v;return"line"===p||"area"===p||"spline"===p||"bezier"===p?(g=c.canvas.path(Raphael.format("M{0},{1}L{2},{3}",t,e+o/2,t+n,e+o/2)),r&&(u.legend.size&&u.legend.size.height&&(m=u.legend.size.height),g.attr($.extend(!0,{},r,{"stroke-width":m}))),w=!0,h.markers&&h.markers.visible&&(y=h.markers.type,v=h.markerStyle,v=$.extend({fill:r.stroke,stroke:r.stroke,opacity:1},v),r["stroke-dasharray"]&&g.attr({"stroke-width":1,"stroke-dasharray":r["stroke-dasharray"]}),y||(y="circle"),f=this.canvas.paintMarker(y,t+n/2,e+o/2,3),$.wijraphael.addClass($(f.node),Raphael.format("{0} {1} {2}",u.wijCSS.legend,u.wijCSS.legendDot,u.wijCSS.canvasObject)),f.attr(v),$(f.node).data("index",a).data("legendIndex",s),this.legendDots[s]=f)):"scatter"===p?(v=h.markerStyle,y=h.markerType,v=$.extend({fill:r.stroke,stroke:r.stroke,opacity:1},v),y||(y="circle"),g=c.canvas.paintMarker(y,t+n/2,e+o/2,3),g.attr(v),h.visible===!1&&($(d.node).data("dotOpacity",g.attr("opacity")||1),g.attr("opacity",.3)),w=!0):"bubble"===p?(v=h.markerStyle,v=$.extend({fill:r.stroke,stroke:r.stroke,opacity:1},v),h.markers&&(y=h.markers.type),y||(y="circle"),g=c.canvas.paintMarker(y,t+n/2,e+o/2,Math.min(n,o)/2),g.attr(v),w=!0):g=i.prototype._paintLegendIcon.call(this,t,e,n,o,r,s,a,l,h,d),w&&($.wijraphael.addClass($(g.node),l),$(g.node).data("legendIndex",s).data("index",a),c.legendIcons.push(g)),g},n.prototype._showHideStockSeries=function(t,e){$.each(t,function(t,i){i.hl&&i.hl[e](),i.o&&i.o[e](),i.c&&i.c[e](),i.path&&i.path[e](),i.h&&i.h[e](),i.l&&i.l[e](),i.oc&&i.oc[e]()})},n.prototype._showSerieEles=function(t){var e=t.type,i=t.eles,n=this.options.showChartLabels,o;switch(e){case"pie":i.sector&&(i.sector.show(),i.sector.shadow&&i.sector.shadow.show(),i.sector.tracker&&i.sector.tracker.show()),i.label&&i.label.show();break;case"line":case"spline":case"bezier":case"area":i.markers&&$.each(i.markers,function(t,e){return o=$(e.node).data("wijchartDataObj"),o&&o.lineSeries&&o.lineSeries.markers&&!o.lineSeries.markers.visible?!0:void e.show()}),i.dcl&&$.each(i.dcl,function(t,e){n&&e.show()}),i.path&&(o=$(i.path.node).data("wijchartDataObj"),(o.visible||o.visible||!o.markers||!o.markers.visible)&&(i.path.show(),i.path.shadow&&i.path.shadow.show(),i.path.area&&i.path.area.show(),i.path.tracker&&i.path.tracker.show(),$(i.path.node).data("wijchartDataObj")&&$(i.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(i.path.node).data("wijchartDataObj").virtualMarkers,function(t,e){e.visible=!0})));break;case"bar":case"column":$.each(i,function(t,e){e.bar&&(e.bar.show(),e.bar.shadow&&e.bar.shadow.show(),e.bar.tracker&&e.bar.tracker.show(),$(e.bar.node).data("wijchartDataObj")&&($(e.bar.node).data("wijchartDataObj").visible=!0)),e.dcl&&e.dcl.show(),e.animatedBar&&!e.animatedBar.removed&&e.animatedBar.show()});break;case"scatter":$.each(i,function(t,e){e.show(),e.label&&e.label.show(),$(e.element).data("wijchartDataObj")&&($(e.element).data("wijchartDataObj").visible=!0)});break;case"hloc":case"hl":case"candlestick":this._showHideStockSeries(i,"show");break;case"bubble":$.each(i,function(t,e){e.bubble&&(e.bubble.show(),e.bubble.tracker&&e.bubble.tracker.show()),e.dcl&&e.dcl.show(),e.symbol&&e.symbol.show()})}},n.prototype._hideSerieEles=function(t){var e=t.type,i=t.eles;switch(e){case"pie":i.sector&&(i.sector.hide(),i.sector.shadow&&i.sector.shadow.hide(),i.sector.tracker&&i.sector.tracker.hide()),i.label&&i.label.hide();break;case"line":case"spline":case"bezier":case"area":i.markers&&$.each(i.markers,function(t,e){e.hide()}),i.dcl&&$.each(i.dcl,function(t,e){e.hide()}),i.path&&(i.path.hide(),i.path.shadow&&i.path.shadow.hide(),i.path.area&&i.path.area.hide(),i.path.tracker&&i.path.tracker.hide(),$(i.path.node).data("wijchartDataObj")&&$(i.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(i.path.node).data("wijchartDataObj").virtualMarkers,function(t,e){e.visible=!1}));break;case"bar":case"column":$.each(i,function(t,e){e.bar&&(e.bar.hide(),e.bar.shadow&&e.bar.shadow.hide(),e.bar.tracker&&e.bar.tracker.hide(),$(e.bar.node).data("wijchartDataObj")&&($(e.bar.node).data("wijchartDataObj").visible=!1)),e.dcl&&e.dcl.hide(),e.animatedBar&&!e.animatedBar.removed&&e.animatedBar.hide()});break;case"scatter":$.each(i,function(t,e){e.hide(),e.label&&e.label.hide(),$(e.element).data("wijchartDataObj")&&($(e.element).data("wijchartDataObj").visible=!1)});break;case"hloc":case"hl":case"candlestick":this._showHideStockSeries(i,"hide");break;case"bubble":$.each(i,function(t,e){e.bubble&&(e.bubble.hide(),e.bubble.tracker&&e.bubble.tracker.hide()),e.dcl&&e.dcl.hide(),e.symbol&&e.symbol.hide()})}},n.prototype._indicatorLineShowing=function(t){var e;i.prototype._indicatorLineShowing.call(this,t),$.each(t,function(t,i){e=i.type,"column"===e||"bar"===e?i.bar.attr(i.hoverStyle):"marker"===e?i.marker.attr(i.markerHoverStyle):"scatter"===e&&(i.dot.attr(i.hoverStyle),i.dot.scale(1.5,1.5))})},n.prototype._removeIndicatorStyles=function(t){var e;$.each(t,function(t,i){e=i.type,"column"===e||"bar"===e?i.bar.attr(i.style):"marker"===e?(i.marker.attr(i.markerStyle),i.marker.transform("s1")):"scatter"===e&&(i.dot.attr(i.style),i.dot.scale(1,1))})},n.prototype._paintTooltip=function(){var t=this,e=t.chartElement,n=e.data("fields")||{},o=n.ctracers||[];i.prototype._paintTooltip.call(this),t.tooltip&&$.each(o,function(e,i){i.trackers&&i.trackers.length&&0===e&&t.tooltip.setOptions({relatedElement:i.trackers[0]})})},n.prototype._isContainsStock=function(){var t=!1,e=this,i=e.options,n=i.seriesList;return $.each(n,function(e,i){var n=i.type;return"hloc"===n||"hl"===n||"candlestick"===n?(t=!0,!1):void 0}),t},n.prototype._handleXData=function(){},n.prototype._isStockSeries=function(t){var e=t.type;return"hloc"===e||"hl"===e||"candlestick"===e},n.prototype._paintChartArea=function(){var t=this,e=t.options,n=e.data;t._isSeriesDataEmpty()||($.each(e.seriesList,function(e,i){var n=i.data;t._isStockSeries(i)&&(n.y=[].concat(n.high).concat(n.low))}),i.prototype._paintChartArea.call(this),$.each(e.seriesList,function(e,i){t._isStockSeries(i)&&delete i.data.y}))},n.prototype._isSeriesDataEmpty=function(){var t=this,e=t.options.seriesList;return e&&0!==e.length?($.each(e,function(t,e){var i=e.type;if("hloc"===i||"candlestick"===i){if(!(e.data&&e.data.x&&e.data.high&&e.data.low&&e.data.open&&e.data.close))return!0}else if("hl"===i){if(!(e.data&&e.data.x&&e.data.high&&e.data.low))return!0}else{if(!("pie"!==i||e.data&&e.label&&0!==e.label.length))return!0;if(!(e.data&&(e.data.x&&e.data.y||e.data.xy)))return!0}}),!1):!0},n.prototype._validateSeriesData=function(t){var e=this.options.type,i=t.data;if("hl"===e){if(void 0===i.x&&void 0===i.high&&void 0===i.low)return!1}else if(void 0===i.x&&void 0===i.high&&void 0===i.low&&void 0===i.open&&void 0===i.close)return!1;return!0},n.prototype._isStockChart=function(){return this.isContainsStock?!0:!1},n.prototype._calculateStockParameters=function(t,e){if("x"===t.id){var i=e.unitMinor,n=e.autoMin,o=e.autoMax,r=this._getStockAdjustment(t);this.timeUtil&&this.timeUtil.getCount&&(t.max=this.timeUtil.getCount()-1),0===r?r=i:r>i&&0!==i&&(r=Math.floor(r/i)*i),n&&(t.min-=r),o&&(t.max+=r),this._calculateMajorMinor(e,t)}},n.prototype._getStockAdjustment=function(t){var e=this,i=e.options,n=t.max,o=t.min,r,s=i.seriesList;return $.each(s,function(t,e){r=r?Math.max(e.data.x.length):e.data.x.length}),(n-o)/r},n.prototype._calculateMajorMinor=function(t,n){var o=this,r=o.options,s=n.bounds||o.canvasBounds,a=t.autoMajor,l=t.autoMinor,h=n.max,d=n.min,c=n.isTime,u=n.tinc,p=n.annoFormatString,g=null,f=null,m=null,w=null,y=null,v=null,_=null,S=null,x=null,b=h-d,C=0,D=0,I=0,j=0;return o.isContainsStock?(a&&(x=$.extend(!0,{},r.textStyle,t.textStyle,t.labels.style),"x"===n.id?(0>d&&(d=0),h>o.timeUtil.getCount()-1&&(h=o.timeUtil.getCount()-1),h=o.timeUtil.getOATime(h),d=o.timeUtil.getOATime(d),o.formatString?p=o.formatString:(p=p||e.ChartDataUtil.getTimeDefaultFormat(h,d),o.formatString=p),g=Globalize.format($.fromOADate(h),p,o._getCulture()),f=Globalize.format($.fromOADate(d),p,o._getCulture()),y=o._text(-1e3,-1e3,g).attr(x),v=o._text(-1e3,-1e3,f).attr(x),m=y.wijGetBBox(),w=v.wijGetBBox(),y.wijRemove(),y=null,v.wijRemove(),v=null):(_=e.ChartDataUtil.nicePrecision(b),S=_+1,(0>S||S>15)&&(S=0),y=o._text(-1e3,-1e3,$.round(h,S).toString()).attr(x),v=o._text(-1e3,-1e3,$.round(d,S).toString()).attr(x),m=y.wijGetBBox(),w=v.wijGetBBox(),y.wijRemove(),y=null,v.wijRemove(),v=null),m.width<w.width&&(m.width=w.width),m.height<w.height&&(m.height=w.height),o._isVertical(t.compass)?(D=s.endY-s.startY-n.vOffset-n.axisTextOffset,j=D/m.height,I=Number.POSITIVE_INFINITY===j?0:parseInt(j.toString(),10)):(C=s.endX-s.startX-n.vOffset-n.axisTextOffset,j=C/m.width,I=Number.POSITIVE_INFINITY===j?0:parseInt(j.toString(),10)),j=b,I>0&&(b/=I,n.tprec=e.ChartDataUtil.nicePrecision(b),j=e.ChartDataUtil.niceNumber(2*b,-_,!0),b>j&&(j=e.ChartDataUtil.niceNumber(b,-_+1,!1)),b>j&&(j=e.ChartDataUtil.niceTickNumber(b))),t.unitMajor=j),void(l&&t.unitMajor&&!isNaN(t.unitMajor)&&(t.unitMinor=t.unitMajor/2))):void i.prototype._calculateMajorMinor.call(this,t,n)},n.prototype._getTickText=function(t){var e=this,i=e.formatString;return e.isContainsStock?Globalize.format(e.timeUtil.getTime(t),i,e._getCulture()):t},n.prototype._AdjustAxisBounds=function(t,i){var n=this,o=n.options,r,s,a,l,h=t.max,d=t.min,c=h-d,u=e.ChartDataUtil.nicePrecision(c),p=u+1,g=t.bounds,f=$.extend(!0,{},o.textStyle,i.textStyle,i.labels.style);r=n._text(-1e3,-1e3,$.round(h,p).toString()).attr(f),s=n._text(-1e3,-1e3,$.round(d,p).toString()).attr(f),a=r.wijGetBBox(),l=s.wijGetBBox(),t.isStartAxis||(g.startY+=l.height),t.isLastAxis||(g.endY-=a.height/2)},n.prototype._initYAxisHeight=function(){var t=this,e=t.options,i=e.axis,n=i.y,o=t.canvasBounds,r=o.endX-o.startX,s=o.endY-o.startY,a=t.axisInfo,l=a.y,h=0,d=-1,c=0,u;$.isArray(n)&&($.each(n,function(t,e){e.height&&!isNaN(e.height)?h+=e.height:"auto"===e.height&&(d=t),l[t].height=e.height}),d>-1&&(l[d].height=s-h),$.each(l,function(e,i){var r=i.height;return void 0===r?!0:(r>0&&(i.isPartAxis=!0,i.isLastAxis=parseInt(e)===n.length-1,i.isStartAxis=0===parseInt(e)),u?i.bounds={startY:u.endY,endY:u.endY+r}:i.bounds={startY:o.startY,endY:o.startY+r},i.bounds.startX=o.startX,i.bounds.endX=o.endX,t._AdjustAxisBounds(i,n[e]),i.bounds&&(u=$.extend({},i.bounds)),void 0)}))},n.prototype._getDataExtreme=function(t){var e=this;return e._initYAxisHeight(),i.prototype._getDataExtreme.call(this,t)},n.prototype._paintPlotArea=function(){var e=this,i=e.options,n="seriesList",o="seriesStyles",r="seriesHoverStyles",s=i[o],a=i[r],l=e.canvasBounds,h={},d=0,c=-1,u=[],p=$.isArray(i.axis.y),g={canvas:e.canvas,tooltip:e.tooltip,bounds:l,widgetName:e.widgetName,seriesTransition:i.seriesTransition,showChartLabels:i.showChartLabels,textStyle:i.textStyle,chartLabelStyle:i.chartLabelStyle,chartLabelFormatString:i.chartLabelFormatString,shadow:i.shadow,hint:i.hint,animation:i.animation,disabled:i.disabled,culture:e._getCulture(),widget:this,wijCSS:i.wijCSS,mouseDown:function(t,i){e._trigger("mouseDown",t,i)},mouseUp:function(t,i){e._trigger("mouseUp",t,i)},mouseOver:function(t,i){e._trigger("mouseOver",t,i)},mouseOut:function(t,i){e._trigger("mouseOut",t,i)},mouseMove:function(t,i){e._trigger("mouseMove",t,i)},click:function(t,i){e._trigger("click",t,i)}},f=e.chartElement.data("fields"),m,w,y,v=e._isContainsStock();f&&(f.ctracers=[]),v&&e._handleXData(),$.each(i[n],function(t,e){var l=e.type,u={},g=l,f={},m=$.extend({},s[d]),w=$.extend({},a[d]),y=e.yAxis;return l&&0!==l.length?(("spline"===g||"bezier"===g)&&(g="line"),u=h[g],u||(u="pie"===l?[]:{},h[g]=u,e.hint&&(u.hint=e.hint,i.hint.content||(i.hint.content=e.hint.content),i.hint.title||(i.hint.title=e.hint.title))),"pie"===l?($.each(e.data,function(e,i){m=$.extend({},s[d]),w=$.extend({},a[d]),f[n]||(f[n]=[]),f[o]||(f[o]=[]),f[r]||(f[r]=[]),i.pieID=t+1,f[n].push(i),f[o].push(m),f[r].push(w),-1===c&&(c=d),d++}),f.sIndex=c,f.radius=e.radius,f.center=e.center,f.label=e.label,c=-1,u.push(f),!0):("column"===l?u.horizontal=!1:"bar"===l?u.horizontal=!0:"spline"===l?e.fitType="spline":"bezier"===l&&(e.fitType="bezier"),"stock"===g&&e.data.high&&e.data.low&&(e.data.y=[].concat(e.data.high).concat(e.data.low)),p&&(u.yAxis=y||0),("line"===l||"spline"===l||"bezier"===l)&&(delete m.fill,delete w.fill),u[n]||(u[n]=[]),u[o]||(u[o]=[]),u[r]||(u[r]=[]),"scatter"===l&&(u.showChartLabels=i.showChartLabels,void 0!==e.showChartLabels&&(u.showChartLabels=e.showChartLabels)),e.sIndex=d,u[n].push(e),u[o].push(m),u[r].push(w),d++,void 0)):!0}),$.each(h,function(n,o){var r=t.chart,s=o.yAxis,a=i.chartLabel;switch(void 0!==s&&e.axisInfo.y[s].bounds&&(g.bounds=e.axisInfo.y[s].bounds),n){case"pie":var h;$.each(o,function(t,i){var o=i.center,s=i.radius||50,a,h=l.endX-l.startX,d=l.endY-l.startY;2*s>h&&(s=h/2),2*s>d&&(s=d/2),i.radius=s,a=o?{startX:o.x-s,startY:o.y-s,endX:o.x+s,endY:o.y+s}:{startX:l.startX+h/2-s,startY:l.startY+d/2-s,endX:l.startX+2*s,endY:l.startY+2*s},m=$.extend(!0,{},g,{bounds:a,radius:s},i),y=new r.PieChartRender(e.chartElement,m),y.render(),e.chartElement.data("fields").aniSectorAttrs=null,e.chartElement.data("fields").aniLabelAttrs=null,e._savechartData(n,i.sIndex)});break;case"bar":case"column":m=$.extend(!0,{},g,{stacked:i.stacked,axis:i.axis,clusterOverlap:i.clusterOverlap,clusterWidth:i.clusterWidth,clusterSpacing:i.clusterSpacing,is100Percent:i.is100Percent,clusterRadius:i.clusterRadius,isYTime:e.axisInfo.y[0].isTime,isXTime:e.axisInfo.x.isTime,yAxisInfo:e.axisInfo.y,yAxisIndex:s},o),y=new r.BarChartRender(e.chartElement,m),y.render(),u=[],$.each(o.seriesList,function(t,e){u.push(e.sIndex)}),e._savechartData(n,u);break;case"line":case"spline":case"bezier":case"area":w=e._getyAxisGroup(o),$.each(w,function(t,o){e.aniPathsAttr||(e.aniPathsAttr=[]),m=$.extend(!0,{},g,{axis:i.axis,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,type:"area"===n?"area":"line",hole:i.hole},o),m.aniPathsAttr=e.aniPathsAttr,m.chartLabelEles=e.chartLabelEles,m.axis.y=i.axis.y[t]||i.axis.y,m.extremeValue={txx:e.extremeValue.txx,txn:e.extremeValue.txn,tyx:e.extremeValue.y[t].tyx,tyn:e.extremeValue.y[t].tyn},y=new r.LineChartRender(e.chartElement,m),y.render(),u=[],$.each(o.seriesList,function(t,e){u.push(e.sIndex)}),e._savechartData(n,u,!0)});break;case"scatter":w=e._getyAxisGroup(o),$.each(w,function(t,o){m=$.extend(!0,{},g,{axis:i.axis,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,zoomOnHover:i.zoomOnHover},o),m.axis.y=i.axis.y[t]||i.axis.y,y=new r.ScatterChartRender(e.chartElement,m),y.render(),u=[],$.each(o.seriesList,function(t,e){u.push(e.sIndex)}),e._savechartData(n,u)});break;case"hloc":case"hl":case"candlestick":break;case"bubble":w=e._getyAxisGroup(o),a||(a={visible:i.showChartLabels,style:i.chartLabelStyle}),$.each(w,function(t,o){m=$.extend(!0,{},g,{axis:i.axis,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,xAxisInfo:e.axisInfo.x,yAxisInfo:e.axisInfo.y,chartLabel:a,minimumSize:i.minimumSize||5,maximumSize:i.maximumSize||20,sizingMethod:i.sizingMethod||"diameter"},o),m.axis.y=i.axis.y[t]||i.axis.y,m.yAxisInfo=e.axisInfo.y[t]||e.axisInfo.y[0],y=new r.BubbleChartRender(e.chartElement,m),y.render(),u=[],$.each(o.seriesList,function(t,e){u.push(e.sIndex)}),e._savechartData(n,u)})}}),e.chartElement.data("fields").seriesEles=null,e._bindtooltip()},n.prototype._savechartData=function(t,e,i){var n=this,o=n.chartElement.data("fields"),r=o.seriesEles,s=o.allElements||{},a,l=e;$.isArray(l)&&(l=0),$.each(r,function(i,o){$.isArray(e)?(n.seriesEles[e[l]]={eles:o,type:t},l++):(n.seriesEles[l]={eles:o,type:t},l++)}),i||(a=o.ctracers||[],a.push({trackers:o.trackers,type:t}),o.ctracers=a),o&&o.chartElements&&$.each(o.chartElements,function(t,e){n._copyElements(s,t,e)}),o.allElements=s},n.prototype._copyElements=function(t,e,i){var n;i&&$.isArray(i)?(n=t[e]||[],t[e]=n.concat(i)):i&&(n=t[e]||[],n.concat([i]))},n.prototype._getyAxisGroup=function(t){var e={};return $.each(t.seriesList,function(i,n){var o=n.yAxis||0;e[o]||(e[o]={seriesList:[],seriesStyles:[],seriesHoverStyles:[]}),e[o].seriesList.push(n),e[o].seriesStyles.push(t.seriesStyles[i]),e[o].seriesHoverStyles.push(t.seriesHoverStyles[i])}),e},n.prototype._bindtooltip=function(){var t=this,e=t.widgetName,i=t.chartElement.data("fields");i&&i.ctracers&&$.each(i.ctracers,function(t,e){var i=e.type;"hloc"!==i&&e.trackers&&e.trackers.toFront()}),t.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mouseover."+e,$.proxy(t._tooltipMouseOver,t)),t.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mouseout."+e,$.proxy(t._tooltipMouseOut,t)),t.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mousemove."+e,$.proxy(t._tooltipMouseMove,t))},n.prototype._tooltipMouseOver=function(t){var e=t.target,i=this,n=i.tooltip,o=i.options.hint,r=null,s=o.title,a=o.content,l=o.style,h=$.isFunction(s),d=$.isFunction(a),c,u,p,g;if(p=$(i.canvas.canvas.parentNode).offset(),!i.indicatorLine&&($(e).data("owner")&&(e=$(e).data("owner")),e=$(e),c=e.data("wijchartDataObj"),i.tooltip))if(r=n.getOptions(),(h||d)&&(h&&(r.title=$.proxy(s,c)),d&&(r.content=$.proxy(a,c))),"line"===c.type||"marker"===c.type){if("marker"===c.type&&(c=c.lineSeries),c.path.removed)return;(i.hoverLine!==c||null===i.hoverLine)&&(i.isNewLine=!0,i.hoverLine&&(i.hoverLine.path.removed||(i.hoverLine.path.wijAttr(i.hoverLine.lineStyle),i.hoverPoint&&!i.hoverPoint.isSymbol&&(i.hoverPoint.marker.wijAttr(i.hoverPoint.markerStyle),i.hoverPoint.marker.transform("s1")))),c.lineHoverStyle&&c.path.wijAttr(c.lineHoverStyle),i.hoverLine=c,i.hoverPoint=null,i.hoverVirtualPoint=null)}else"scatter"===c.type||"element"===o.relativeTo?(i._clearHoverState(),"scatter"===c.type?u=c.dot.getBBox():e[0]&&e[0].raphael&&e[0].raphaelid&&(g=i.canvas.getById(e[0].raphaelid),g&&(u=g.getBBox())),r.style.stroke=l.stroke||e.attr("stroke"),u&&i.tooltip.showAt({x:u.x+u.width/2,y:u.y},t)):(i._clearHoverState(),r.style.stroke=l.stroke||e.attr("stroke"),i.tooltip.showAt({x:t.pageX-p.left,y:t.pageY-p.top},t))},n.prototype._tooltipMouseMove=function(t){var e=this,i=t.target,n,o=e.options.hint,r=$(e.canvas.canvas.parentNode).offset();$(i).data("owner")&&(i=$(i).data("owner")),i=$(i),n=i.data("wijchartDataObj"),e.tooltip&&!this.indicatorLine&&"line"!==n.type&&"marker"!==n.type&&"scatter"!==n.type&&"element"!==o.relativeTo&&e.tooltip.showAt({x:t.pageX-r.left,y:t.pageY-r.top},t)},n.prototype._tooltipMouseOut=function(t){var e=this,i=t.target,n;$(i).data("owner")&&(i=$(i).data("owner")),i=$(i),n=i.data("wijchartDataObj"),"line"!==n.type&&"marker"!==n.type&&!e.indicatorLine&&e.tooltip&&e.tooltip.hide()},n.prototype._mouseMoveInsidePlotArea=function(t,e){var n=this,o=n.tooltip,r=n.options.hint,s,a,l=0,h,d,c,u,p=null,g=null,f=null,m=r.title,w=r.content,y=$.isFunction(m),v=$.isFunction(w),_=0,S;if(o&&(f=o.getOptions()),n.hoverLine&&!n.indicatorLine){if(S=n.hoverLine,n.isNewLine&&(r.enable&&o&&o.hide(),n.isNewLine=!1),s=S.lineMarkers,a=S.virtualMarkers,l=-1,h={x:0,y:0},s&&s.length){if($.each(s,function(t,i){if(i.removed)return!0;var n=i.wijGetBBox(),o=n.x+n.width/2,r=Math.abs(o-e.left);(0===t||_>r)&&(_=r,l=t,h={x:o,y:n.y+n.height/2})}),n.hoverPoint&&n.hoverPoint.index===l)return;if(l>-1){if(s[l].removed)return;d=$(s[l].node).data("wijchartDataObj"),d&&(n.hoverPoint&&!n.hoverPoint.isSymbol&&(n.hoverPoint.removed||(n.hoverPoint.marker.wijAttr(n.hoverPoint.markerStyle),n.hoverPoint.marker.transform("s1"))),d.isSymbol||d.marker.removed||d.marker.wijAttr(d.markerHoverStyle)),n.hoverPoint=d,n.hoverVirtualPoint=a[l]}}else{if($.each(a,function(t,i){var n=Math.abs(i.x-e.left);(0===t||_>n)&&(_=n,l=t,h={x:i.x,y:i.y})}),n.hoverVirtualPoint&&n.hoverVirtualPoint.index===l)return;l>-1&&(n.hoverPoint=null,n.hoverVirtualPoint=a[l])}o&&(g=n.hoverVirtualPoint,c=g.valX,u=g.valY,(y||v)&&(y&&(f.title=function(){var t={pointIndex:l,lineIndex:S.index,x:c,y:u,label:S.label,data:g,fmt:m},e=$.proxy(t.fmt,t),i=e();return i}),v&&(f.content=function(){var t={pointIndex:l,lineIndex:S.index,x:c,y:u,label:S.label,data:g,fmt:w},e=$.proxy(t.fmt,t),i=e();return i})),p=$.extend({stroke:S.path.attr("stroke")},r.style),f.style.stroke=p.stroke,o.showAt(h))}i.prototype._mouseMoveInsidePlotArea.call(this,t,e)},n.prototype._mouseDownInsidePlotArea=function(t,e){i.prototype._mouseDownInsidePlotArea.call(this,t,e),this._clearHoverState(!0)},n.prototype._mouseMoveOutsidePlotArea=function(t,e){var n=this;n._clearHoverState(),i.prototype._mouseMoveOutsidePlotArea.call(this,t,e)},n.prototype._clearHoverState=function(t){var e=this,i=e.tooltip,n=e.options.hint;e.hoverLine&&(n.enable&&i&&!t&&i.hide(),e.hoverLine.path.removed||(e.hoverLine.path.wijAttr(e.hoverLine.lineStyle),e.hoverPoint&&!e.hoverPoint.isSymbol&&(e.hoverPoint.marker.wijAttr(e.hoverPoint.markerStyle),e.hoverPoint.marker.transform("s1")))),
e.hoverLine=null,e.hoverPoint=null,e.hoverVirtualPoint=null},n.prototype._getTooltipText=function(t,e){return""},n.prototype._calculateParameters=function(t,e){var n=this,o=!1,r,s;return i.prototype._calculateParameters.call(this,t,e),n.isContainsStock?void n._calculateStockParameters(t,e):($.each(n.options.seriesList,function(t,e){return"column"===e.type||"bar"===e.type?(o=!0,!1):void 0}),void(o&&"x"===t.id&&(r=e.unitMinor,s=n._getBarAdjustment(t),0===s?s=r:s>r&&0!==r&&(s=Math.floor(s/r)*r),t.min-=s,t.max+=s,n._calculateMajorMinor(e,t))))},n.prototype._getBarAdjustment=function(t){var e=0,i=this.options,n=t.max,o=t.min,r=0;return $.each(i.seriesList,function(t,i){return"pie"===i.type?!0:void 0===i.data.x||void 0===i.data.y?!0:(r=i.data.x.length,void(r>e&&(e=r)))}),e>1?(n-o)/e*i.clusterWidth*.0125:1===e?(0===o&&1===n&&(o=-1,t.min=o),.0125*(n-o)):0},n}(e.wijchartcore);e.wijcompositechart=i,i.prototype.widgetEventPrefix="wijcompositechart";var n=function(){function t(){this.initSelector=":jqmData(role='wijcompositechart')",this.wijCSS={compositechart:"wijmo-wijcompositechart",barLabel:"wijbarchart-label",barElement:"wijbarchart",barTracker:"bartracker",bubbleElement:"wijbubblechart-bubble",bubbleTracker:"bubbletracker",bubbleLabel:"wijbubblechart-label",bubbleSymbol:"wijbubblechart-symbol",scatterElement:"wijscatterchart",pieLabel:"wijpiechart-label",pieElement:"wijpiechart",pieTracker:"pietracker",lineLabel:"wijlinechart-label",lineElement:"wijlinechart",areaElement:"wijlinechart-area",lineTracker:"linetracker",canvasMarker:"wijchart-canvas-marker"},this.stacked=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.seriesList=[],this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return t}();i.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),$.wijmo.registerWidget("wijcompositechart",i.prototype)}(t.chart||(t.chart={}));var e=t.chart}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";var i=jQuery,n="wijdatepager",o="wijmo-wijdatepager",r="wijmo-wijdatepager-increment",s="wijmo-wijdatepager-decrement",a="wijmo-wijdatepager-container",l="wijmo-wijdatepager-pages",h="wijmo-wijdatepager-pagelabel",d="wijmo-wijdatepager-pagelabel-first",c="wijmo-wijdatepager-pagelabel-last",u="wijmo-wijdatepager-pageheader",p="wijmo-wijdatepager-pagerange",g="wijmo-wijdatepager-tooltip",f="wijmo-wijdatepager-tooltip-inner",m="wijmo-wijdatepager-triangle",w="wijmo-wijdatepager-width-smallest",y="wijmo-wijdatepager-width-small",v="wijmo-wijdatepager-width-medium",_="wijmo-wijdatepager-width-normal",S=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._setOption=function(t,e){switch(i.wijmo.widget.prototype._setOption.apply(this,arguments),t){case"culture":this.options.culture=e,this._initBackground();break;case"selectedDate":this.options.selectedDate=e,this._initBackground();break;case"disabled":e?this._disable():this._enable();break;case"viewType":this.options.viewType=e,this._initBackground();break;case"nextTooltip":this.element.find("."+r).attr("title",e);break;case"prevTooltip":this.element.find("."+s).attr("title",e);break;case"firstDayOfWeek":this.options.firstDayOfWeek=e,"week"===this.options.viewType&&this._initBackground()}return this},e.prototype._disable=function(){this.element.addClass(this.options.wijCSS.stateDisabled),this.element.find("."+s).button("option","disabled",!0),this.element.find("."+r).button("option","disabled",!0)},e.prototype._enable=function(){this.element.removeClass(this.options.wijCSS.stateDisabled),this.element.find("."+s).button("option","disabled",!1),this.element.find("."+r).button("option","disabled",!1)},e.prototype._create=function(){var t=this.options,e,n,h;window.wijmoApplyWijTouchUtilEvents&&(i=window.wijmoApplyWijTouchUtilEvents(i)),t.selectedDate||(t.selectedDate=new Date),this._dtpagernamespacekey="dtpager"+(new Date).getTime(),this.element.addClass(o).addClass(t.wijCSS.wijdatepager).addClass(t.wijCSS.widget).addClass(t.wijCSS.helperClearFix),e=i.proxy(this.invalidate,this),i(window).bind("resize."+this._dtpagernamespacekey,e),this.element.disableSelection&&this.element.disableSelection(),this.element.append(i("<a></a>").addClass(s).addClass(t.wijCSS.wijdatepagerDecButton).append(i("<span>"+t.prevTooltip+"</span>"))).append(i("<div></div>").addClass(a).addClass(t.wijCSS.wijdatepagerContainer).addClass(t.wijCSS.content).append(i("<div></div>").addClass(l).addClass(t.wijCSS.wijdatepagerPages))).append(i("<a></a>").addClass(r).addClass(t.wijCSS.wijdatepagerIncButton).append(i("<span>"+t.nextTooltip+"</span>"))),i.wijmo.widget.prototype._create.apply(this,arguments),n=this.element.find("."+s),h=this.element.find("."+r),null==i.mobile?(n.button({icons:{primary:t.wijCSS.iconArrowLeft},text:!1}),h.button({icons:{primary:t.wijCSS.iconArrowRight},text:!1})):(n.html(""),n.attr("data-icon","arrow-l"),n.button({text:!1}),h.html(""),h.attr("data-icon","arrow-r"),h.button({text:!1})),n.click(i.proxy(this.goLeft,this)),h.click(i.proxy(this.goRight,this)),this._initBackground(),t.disabled&&this._disable()},e.prototype.destroy=function(){this.element.removeClass(o).removeClass(this.options.wijCSS.wijdatepager),i(window).unbind("."+this._dtpagernamespacekey)},e.prototype.refresh=function(){this.invalidate()},e.prototype.invalidate=function(){var t,e=this.options,n=e.selectedDate,o,d=this.element.find("."+a),c=this.element.find("."+s),u=this.element.find("."+r),p=this.element.innerWidth(),g=c.is(":visible")?c.outerWidth(!0):0,f=u.is(":visible")?u.outerWidth(!0):0,m,S,x,b,C;t=this.element.find("."+h+"."+this._getDateClass(n)),1!==t.length?t=i(this.element.find("."+h)[this._index]):(o=this.element.find("."+h).index(t),this._index=o),C="."+h,b=e.wijCSS.stateActive.split(" "),i.each(b,function(t){C+="."+b[t]}),this.element.find(C).removeClass(e.wijCSS.stateActive),t.addClass(this.options.wijCSS.stateActive),d.css("left",g),this.element.removeClass(w).removeClass(e.wijCSS.wijdatepagerWidthSmallest).removeClass(y).removeClass(e.wijCSS.wijdatepagerWidthSmall).removeClass(v).removeClass(e.wijCSS.wijdatepagerWidthMedium).removeClass(_).removeClass(e.wijCSS.wijdatepagerWidthNormal),300>p?this.element.addClass(w).addClass(e.wijCSS.wijdatepagerWidthSmallest):475>p?this.element.addClass(y).addClass(e.wijCSS.wijdatepagerWidthSmall):600>p?this.element.addClass(v).addClass(e.wijCSS.wijdatepagerWidthMedium):this.element.addClass(_).addClass(e.wijCSS.wijdatepagerWidthNormal),d.outerWidth(p-g-f),i.browser.msie&&parseInt(i.browser.version,10)<=7&&(m=this.element.find("."+l),S=m.find("."+h),x=Math.round(m.width()/this._datesDef.length)-(S.outerWidth(!0)-S.width()),S.width(x))},e.prototype.goLeft=function(t){var e=this.options;if(!e.disabled)return this._setSelectedIndex(this._index-1,!0),t?(t.preventDefault(),!1):void 0},e.prototype.goRight=function(){var t=this.options;t.disabled||this._setSelectedIndex(this._index+1)},e.prototype._getCulture=function(t){return"undefined"==typeof t&&(t=null),Globalize.findClosestCulture(t||this.options.culture)},e.prototype._isRTL=function(){return!!this._getCulture().isRTL},e.prototype._initBackground=function(t,e){"undefined"==typeof t&&(t=!1),"undefined"==typeof e&&(e=!1);var n=this,o,r,s,a,g,f=this,m=f.options,w,y=i("<div></div>");this._isInAnimate||(this._index=0,this._datesDef=this._getDatesDefinition(),this._min=0,this._max=this._datesDef.length-1,i.each(this._datesDef,function(t,e){var o=i("<div>"+n._datesDef[t].l+"</div>").addClass(h).addClass(m.wijCSS.wijdatepagerPageLabel).addClass(n._getDateClass(e.d));0===t&&o.addClass(d).addClass(m.wijCSS.wijdatepagerPageLabelFirst),e.range&&o.addClass(p).addClass(m.wijCSS.wijdatepagerPageRange),e.header&&o.addClass(u).addClass(m.wijCSS.wijdatepagerPageHeader).addClass(m.wijCSS.stateHighlight),t===n._max&&o.addClass(c).addClass(m.wijCSS.wijdatepagerPageLabelLast),y.append(o)}),o=y.html(),s=this.element.find("."+l),t?(this._isInAnimate=!0,r=s.clone(!0),s.html(o),a=s.find("."+h),e?(r.insertAfter(s),g=i(a[this._index]).offset().left,s.css("opacity",0).css("left",-r.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),r.css("left",0).stop().animate({left:r.outerWidth(!0)+"px",opacity:0},function(){r.remove(),f._isInAnimate=!1,f.invalidate()})):(r.insertBefore(s),g=i(a[this._index]).offset().left,s.css("opacity",0).css("left",r.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),r.stop().animate({left:"-"+r.outerWidth(!0)+"px",opacity:0},function(){r.remove(),f._isInAnimate=!1,f.invalidate()}))):(s.html(o),this.invalidate()),a=s.find("."+h),a.hover(i.proxy(this._pagelabelHover,this),i.proxy(this._pagelabelHout,this)),a.bind("mousedown",i.proxy(this._pagelabelMouseDown,this)),a.click(i.proxy(function(t){var e=i(t.target),n;n=this.element.find("."+h).index(e),this._setSelectedIndex(n)},this)))},e.prototype._getDateClass=function(t){return"c1dt"+t.getFullYear()+"_"+t.getMonth()+"_"+t.getDate()},e.prototype._addDays=function(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate()+e)},e.prototype._getDatesDefinition=function(){var t=this.options,e=t.viewType.toLowerCase(),i,n,o,r,s,a=[],l=t.selectedDate;switch(e){case"week":for(o=new Date(l.getFullYear(),l.getMonth(),-6),i=t.firstDayOfWeek-o.getDay(),Math.abs(i)>6&&(i=o.getDay()-t.firstDayOfWeek),o=this._addDays(o,i),s=new Date(l.getFullYear(),l.getMonth()+1,7),i=0;s>o||o.getMonth()===l.getMonth();)r=this._addDays(o,7),a.push({l:this._formatString(this.localizeString("weekViewLabelFormat","{0:MMM dd}-{1:dd}"),o,this._addDays(o,6)),d:o,d2:this._addDays(o,6)}),l>=o&&r>=l&&(this._index=i),o=r,i+=1;break;case"month":for(n=new Date(l.getFullYear()-1,0,1),a.push({l:n.getFullYear(),d:n,range:!0}),n=new Date(l.getFullYear(),0,1),a.push({l:n.getFullYear(),d:n,header:!0}),i=0;12>i;i+=1)n=new Date(l.getFullYear(),i,1),a.push({l:this._formatString(this.localizeString("monthViewLabelFormat","{0:MMM}"),n),d:n}),r=new Date(l.getFullYear(),i+1,1),l>=n&&r>=l&&(this._index=i+2);n=new Date(l.getFullYear()+1,0,1),a.push({l:n.getFullYear(),d:n,range:!0});break;default:for(n=new Date(l.getFullYear(),l.getMonth(),0),a.push({l:Globalize.format(n,"MMM",this._getCulture()),d:n,range:!0}),n=new Date(l.getFullYear(),l.getMonth(),1),a.push({l:Globalize.format(n,"MMM",this._getCulture()),d:n,header:!0}),o=n,i=2;o.getMonth()===l.getMonth();)r=new Date(o.getFullYear(),o.getMonth(),o.getDate()+1),a.push({l:this._formatString(this.localizeString("dayViewLabelFormat","{0:d }"),o),d:o}),l>=o&&r>=l&&(this._index=i),o=r,i+=1;n=new Date(l.getFullYear(),l.getMonth()+1,1),a.push({l:Globalize.format(n,"MMM",this._getCulture()),d:n,range:!0})}return a},e.prototype._setSelectedIndex=function(t,e){"undefined"==typeof e&&(e=!1);var i=this.options,n;if(!i.disabled&&t>=this._min&&t<=this._max&&(this._dragActivated&&this._showTooltip(t),this._index!==t)){if(this._datesDef[t].header){if(!e)return;t-=1}this._index=t,n=this._datesDef[t].d,i.selectedDate=n,this._max>2&&0===this._index?this._initBackground(!0,!0):this._index===this._max?("week"===i.viewType&&(i.selectedDate=new Date(i.selectedDate.getFullYear(),i.selectedDate.getMonth(),i.selectedDate.getDate()+7)),this._initBackground(!0,!1),i.selectedDate=n):this.invalidate(),this._trigger("selectedDateChanged",null,{selectedDate:i.selectedDate})}},e.prototype._pagelabelHover=function(t){var e=i(t.target),n=this.options;e.hasClass(u)||e.addClass(n.wijCSS.stateHover)},e.prototype._showTooltip=function(t){var e=this.options,n=this._datesDef[t],o=e.viewType,r,s=this.element.find("."+h)[t];switch(this._tooltip||(this._tooltip=i("<div></div>").addClass(g).addClass(e.wijCSS.wijdatepagerTooltip).append(i("<div></div>").addClass(f).addClass(e.wijCSS.wijdatepagerTooltipInner)).append(i("<div></div>").addClass(m).addClass(e.wijCSS.wijdatepagerTriangle)),this.element.append(this._tooltip),this._tooltip.wijpopup()),r="",o){case"week":r=n.d.getMonth()!==n.d2.getMonth()?this._formatString(this.localizeString("weekViewTooltip2MonthesFormat","{0:MMMM d} - {1:MMMM d, yyyy}"),n.d,n.d2):this._formatString(this.localizeString("weekViewTooltipFormat","{0:MMMM d} - {1:d, yyyy}"),n.d,n.d2);break;case"month":r=this._formatString(this.localizeString("monthViewTooltipFormat","{0:MMMM yyyy}"),n.d);break;default:r=this._formatString(this.localizeString("dayViewTooltipFormat","{0:dddd, MMMM d, yyyy}"),n.d)}i.ui&&(this._tooltip.wijpopup("show",{of:s,my:"center bottom",at:"center top",offset:"-10 -10"}),this._tooltip.find("."+f).html(r))},e.prototype._hideTooltip=function(){this._tooltip.wijpopup("hide")},e.prototype._pagelabelHout=function(t){i(t.target).removeClass(this.options.wijCSS.stateHover)},e.prototype._pagelabelMouseDown=function(t){if(this._dragActivated=!1,!this.options.disabled){t.preventDefault();var e=i(t.target),n;e.hasClass(u)||(n=this.element.find("."+h).index(e),this._dragActivated=!0,this._setSelectedIndex(n),this._mouseDownTimeFix20555=(new Date).getTime(),this._startClientX=t.pageX,this._startInd=n,i(document).bind("mousemove."+this._dtpagernamespacekey,i.proxy(this._pageindicatorMouseMove,this)),i(document).bind("mouseup."+this._dtpagernamespacekey,i.proxy(this._pageindicatorMouseUp,this)))}},e.prototype._detectLeftButton=function(t){return t.originalEvent&&(t=t.originalEvent),"buttons"in t?1===t.buttons:"which"in t?1===t.which:1===t.button},e.prototype._pageindicatorMouseMove=function(t){if(!this._detectLeftButton(t))return void this._pageindicatorMouseUp();if(t.preventDefault(),!this._isInAnimate){var e=this.element.find("."+h)[this._startInd],i,n;e&&(i=e.offsetLeft+Math.round(e.offsetWidth/2)+(t.pageX-this._startClientX),n=this._findClosesPageIndexByPos(i),this._prevMoveInd!==n&&(this._prevMoveInd=n,this._mouseDownTimeFix20555+150>(new Date).getTime()||-1!==n&&n!==this._index&&this._setSelectedIndex(n)))}},e.prototype._pageindicatorMouseUp=function(){this._dragActivated=!1,i(document).unbind("."+this._dtpagernamespacekey),this._hideTooltip()},e.prototype._findClosesPageIndexByPos=function(t){var e=this.element.find("."+l).find("."+h),i;for(i=0;i<e.length;i+=1)if(e[i].offsetLeft<t&&e[i].offsetLeft+e[i].offsetWidth>t)return i;return-1},e.prototype.localizeString=function(t,e){var i=this.options;return i.localization&&i.localization[t]?i.localization[t]:e},e.prototype._formatString=function(t,e,i,n){var o,r=arguments,s,a,l=this;if(r.length<=1)return Globalize.format(r);if("string"==typeof t&&"function"==typeof window[t]&&(t=window[t]),"function"==typeof t){for(a=[],s=1;s<r.length;s+=1)a[s-1]=r[s];return t.apply(this,a)}return o=new RegExp("\\{(\\d+)(?:,([-+]?\\d+))?(?:\\:([^(^}]+)(?:\\(((?:\\\\\\)|[^)])+)\\)){0,1}){0,1}\\}","g"),t.replace(o,function(t,e,i,n,o){return t=r[Number(e)+1],n?Globalize.format(t,n,l._getCulture()):t})},e}(t.wijmoWidget);e.wijdatepager=S;var x=function(){function t(){this.wijCSS={wijdatepager:"",wijdatepagerIncButton:"",wijdatepagerDecButton:"",wijdatepagerContainer:"",wijdatepagerPages:"",wijdatepagerPageLabel:"",wijdatepagerPageLabelFirst:"",wijdatepagerPageLabelLast:"",wijdatepagerPageHeader:"",wijdatepagerPageRange:"",wijdatepagerTooltip:"",wijdatepagerTooltipInner:"",wijdatepagerTriangle:"",wijdatepagerWidthSmallest:"",wijdatepagerWidthSmall:"",wijdatepagerWidthMedium:"",wijdatepagerWidthNormal:""},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-c",stateDefault:"ui-btn-up-c"},this.initSelector=":jqmData(role='wijdatepager')",this.culture="",this.localization=null,this.firstDayOfWeek=0,this.selectedDate=null,this.viewType="day",this.nextTooltip="right",this.prevTooltip="left",this.selectedDateChanged=null}return t}();S.prototype.options=i.extend(!0,{},t.wijmoWidget.prototype.options,new x),i.wijmo.registerWidget(n,S.prototype)}(t.datepager||(t.datepager={}));var e=t.datepager}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";function i(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function n(){var t,e,i;for(t="",i=0;32>i;i+=1)(8===i||12===i||16===i||20===i)&&(t+="-"),e=Math.floor(16*Math.random()).toString(16).toUpperCase(),t+=e;return t}function o(t,e,i){c?(u=amplify.store("wijevcal_tables1"),u||(u={}),u[t]||(u[t]={fields:e},amplify.store("wijevcal_tables1",u),amplify.store("wijevcal_tbl_"+t,{})),i&&i()):l&&l.transaction(function(n){n.executeSql("SELECT COUNT(*) FROM "+t,[],function(){i&&i()},function(n,o){n.executeSql("CREATE TABLE "+t+" "+e,[],i,i)})})}function r(t,e,i,n){var o={rowsAffected:0,rows:new Array},r,s,a,h,d,p,g,f,m,w,y,v,_,S;if(e||(e=[]),o.rows.item||(o.rows.item=function(t){return this[t]}),c)try{if(a=new RegExp("(SELECT) *(.*) *FROM (\\w+)"),h=new RegExp("(INSERT OR REPLACE|INSERT) *(.*) *INTO *(\\w*) *\\(([\\w|,| ]*)\\)"),d=new RegExp("(DELETE) *(.*) *FROM (\\w+) *(\\w*)WHERE (\\w+)='*([^']+)"),t.match(h)){if(p=h.exec(t),p&&p.length>1){if(g=p[3],f=u[g],m=amplify.store("wijevcal_tbl_"+g),m)for(y=p[4].split(","),r={},s=0;s<y.length;s+=1)y[s]&&(0===s&&(m[e[s]]=r),v=y[s].replace(" ",""),r[v]=e[s]);amplify.store("wijevcal_tbl_"+g,m)}}else if(t.match(a)){if(p=a.exec(t),p&&p.length>1&&(g=p[3],f=u[g],m=amplify.store("wijevcal_tbl_"+g),m)){if(_=t.replace(a,""),0===_.toUpperCase().indexOf(" WHERE "))for(_=_.substr(7),S=_.split(" OR "),s=0;s<S.length;s+=1)S[s]=S[s].split("="),_=S[s][1],0===_.indexOf("'")?(_=_.substring(1,_.length-1),S[s][1]=_):S[s][1]=parseFloat(_);for(w in m)if(m.hasOwnProperty(w)&&(r=m[w]))if(S)for(s=0;s<S.length;s+=1)r[S[s][0]]===S[s][1]&&o.rows.push(r);else o.rows.push(r)}}else t.match(d)&&(p=d.exec(t),p&&p.length>1&&(g=p[3],f=u[g],m=amplify.store("wijevcal_tbl_"+g),m&&m[p[6]]&&delete m[p[6]],amplify.store("wijevcal_tbl_"+g,m)));i&&i(o)}catch(x){n&&n(x)}else{if(!l)return void n("Local data storage not found.");l.transaction(function(o){o.executeSql(t,e,function(t,e){i&&i(e)},function(t,e){n&&n(e.message)})})}}var s=jQuery,a="wijevcal",l,h="C1EventsCalendarDB",d="1.1",c=!1,u,p=function(t){function e(){t.apply(this,arguments),this._dynIdCounter=0}return __extends(e,t),e.prototype._setOption=function(t,e){var i=this,n=s.when.apply(this,i._defferObjs),o;n.always(function(){i._setOptionCallbacks.fire(),i._setOptionCallbacks.empty(),i._defferObjs=[]}),"pending"===n.state()?this._setOptionCallbacks.add(function(){o=s.isPlainObject(e)?s.extend(!0,{},e):s.isArray(e)?[].concat(e):e,i._setOptionInternal(t,o)}):this._setOptionInternal(t,e)},e.prototype._setOptionInternal=function(t,e){var n=this.options,o;switch(t){case"dataSource":n.dataSource=e,this._needLoadLocalStorage=!1,n.eventsData=[],this._bindDataView();break;case"eventsData":n.eventsData=e,n.appointments=e,this._needLoadLocalStorage=!1,this._onEventsDataChanged(),this._bindEvents();break;case"appointments":n.eventsData=e,n.appointments=e,this._needLoadLocalStorage=!1,this._onEventsDataChanged(),this._bindEvents();break;case"localization":this._setLocalization(e);break;case"culture":n.culture=e,this.element.find(".wijmo-wijdatepager").wijdatepager("option","culture",n.culture),this._editEventDialog&&this._editEventDialog.find(".wijmo-wijinput-date").wijinputdate("option","culture",n.culture),this.element.find(".wijmo-wijcalendar").wijcalendar("option","culture",n.culture),this._redrawActiveView();break;case"disabled":n.disabled!==e&&(n.disabled=e,this._ensureDisabled());break;case"enableLogs":n.enableLogs=e,this._initLogPanel();break;case"selectedDate":return void(e&&(e=i(e),n.selectedDates[0].getTime()!==e.getTime()&&(n.selectedDates[0]=e,this._onSelectedDatesChanged())));case"selectedDates":return void(e&&(n.selectedDates=e,this._onSelectedDatesChanged()));case"statusBarVisible":return n.statusBarVisible=e,this._initStatusbar(),this.invalidate(),void 0;case"headerBarVisible":return n.headerBarVisible=e,this._initHeaderbar(),this.invalidate(),void 0;case"navigationBarVisible":return n.navigationBarVisible=e,this._initNavigationbar(),this.invalidate(),void 0;case"rightPaneVisible":return n.rightPaneVisible=e,this._initRightPane(),this.invalidate(),void 0;case"timeInterval":case"timeIntervalHeight":case"timeRulerInterval":case"timeRulerFormat":n[t]!==e&&(n[t]=e,this._redrawActiveView());break;case"firstDayOfWeek":n[t]!==e&&(n[t]=e,this._redrawActiveView(),o=this._getCulture(),o&&o.calendar&&(o.calendar.firstDay=e,this.element.find(".wijmo-wijcalendar").wijcalendar("refresh")));break;case"viewType":n.viewType!==e&&(n.viewType=e,this._onViewTypeChanged())}s.wijmo.widget.prototype._setOption.apply(this,arguments)},e.prototype._setLocalization=function(t){this._destroyInternal(),this.options.localization=t,this._create(),this._init()},e.prototype._ensureDisabled=function(){var t=this.options;if(t.disabled){this.element.addClass(t.wijCSS.stateDisabled);try{this.element.find(".wijmo-wijcalendar").wijcalendar("option","disabled",!0),this.element.find(".wijmo-wijsuperpanel").wijsuperpanel("option","disabled",!0),this.element.find(".wijmo-wijdatepager").wijdatepager("option","disabled",!0),s().buttonset&&this.element.find(".ui-buttonset").buttonset("option","disabled",!0),this.element.find(".wijmo-wijev-today.ui-button").button("option","disabled",!0)}catch(e){this.log(e,"error")}this._unbindEvents()}else{this.element.removeClass(t.wijCSS.stateDisabled);try{this.element.find(".wijmo-wijcalendar").wijcalendar("option","disabled",!1),this.element.find(".wijmo-wijsuperpanel").wijsuperpanel("option","disabled",!1),this.element.find(".wijmo-wijdatepager").wijdatepager("option","disabled",!1),s().buttonset&&this.element.find(".ui-buttonset").buttonset("option","disabled",!1),this.element.find(".wijmo-wijev-today.ui-button").button("option","disabled",!1)}catch(e){this.log(e,"error")}this._bindEvents(),this._updateTitleText()}},e.prototype._onViewTypeChanged=function(){this._renderActiveView(),this._updateTitleText(),this._trigger("viewTypeChanged",null,this.options.viewType),this.element.find(".wijmo-wijev-datepager").wijdatepager("option","viewType",this.options.viewType)},e.prototype._onSelectedDatesChanged=function(){var t=this.options;t.selectedDate=t.selectedDates[0],this.element.find(".wijmo-wijev-datepager").wijdatepager("option","selectedDate",t.selectedDate),this._trigger("selectedDatesChanged",null,{selectedDates:t.selectedDates}),this._renderActiveView(),this._updateTitleText()},e.prototype._updateHeaderTitleText=function(){var t=this.options,e=t.titleFormat,i=t.selectedDates[0],n=t.selectedDates[t.selectedDates.length-1];if(e[t.viewType])e=e[t.viewType];else{if(e[t.viewType]===!1)return void this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title").hide();e=e.toString()}"list"===t.viewType&&(n=this._addDays(i,14)),this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title").show().html(this._formatString(e,i,n))},e.prototype._updateTitleText=function(){var t=this.options,e=t.selectedDates[0],i=t.selectedDates[t.selectedDates.length-1],n=new Date,o=!1;o=0===this._compareDayDates(e,n)||n>e&&i>n,null==s.mobile&&this.element.find(".wijmo-wijev-navigationbar .wijmo-wijev-today").button("option","disabled",o),this._updateHeaderTitleText()},e.prototype.localizeString=function(t,e){var i=this.options;return i.localization&&i.localization[t]?i.localization[t]:e},e.prototype._create=function(){var t=this;window.wijmoApplyWijTouchUtilEvents&&(s=window.wijmoApplyWijTouchUtilEvents(s)),this._defferObjs=[],this._chromeLoadDataDeffer=s.Deferred(),this._defferObjs.push(this._chromeLoadDataDeffer),this._setOptionCallbacks=s.Callbacks("once"),this._needLoadLocalStorage=!0,(this.options.appointments&&this.options.appointments.length||this.options.eventsData&&this.options.eventsData.length)&&(this._needLoadLocalStorage=!1),s.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options);var e,i,n=this.options;n.colors||(n.colors=["red","darkorchid","green","blue","cornflowerblue","yellow","bronze"]),this.wijevcalnamespacekey||(this.wijevcalnamespacekey="wijevcal"+(new Date).getTime()),this.element[0].id||(this.element[0].id="wijevcal_dynid_"+(new Date).getTime()),this._uidPref=this.element[0].id+"evcdynid",this.element.addClass("wijmo-wijevcal wijmo-wijev "+n.wijCSS.widget+" "+n.wijCSS.helperReset+" "+n.wijCSS.stateDefault),s('<div class="wijmo-wijev-headerbar '+n.wijCSS.header+" "+n.wijCSS.cornerTop+'"><fieldset class="wijmo-wijev-tools"><input id="'+this._uidPref+'_daybtn" name="viewselection" type="radio" class="wijmo-wijev-day" /><label for="'+this._uidPref+'_daybtn">'+this.localizeString("buttonDayView","Day")+'</label><input id="'+this._uidPref+'_weekbtn" name="viewselection" type="radio" class="wijmo-wijev-week" /><label for="'+this._uidPref+'_weekbtn">'+this.localizeString("buttonWeekView","Week")+'</label><input id="'+this._uidPref+'_monthbtn" name="viewselection" type="radio" class="wijmo-wijev-month" /><label for="'+this._uidPref+'_monthbtn">'+this.localizeString("buttonMonthView","Month")+'</label><input id="'+this._uidPref+'_listbtn" name="viewselection" type="radio" class="wijmo-wijev-list" /><label for="'+this._uidPref+'_listbtn">'+this.localizeString("buttonListView","List")+"</label></fieldset></div>").appendTo(this.element),s('<div class="wijmo-wijev-view-container"><div class="wijmo-wijev-leftpane wijmo-wijev-viewdetails '+n.wijCSS.content+' wijmo-wijev-day-details"><div class="wijmo-wijev-leftpane-inner"><div class="wijmo-wijev-daycalendar"></div><div class="wijmo-wijev-monthday-container"><div class="wijmo-wijev-monthday-label">...</div><div class="wijmo-wijev-fulldate-label">'+this.localizeString("activityLoading","Loading...")+'</div><div class="wijmo-wijev-year-label">...</div></div><div class="wijmo-wijev-agenda-container '+n.wijCSS.content+" "+n.wijCSS.cornerAll+" "+n.wijCSS.helperClearFix+'"></div></div></div><div class="wijmo-wijev-leftpane wijmo-wijev-viewdetails '+n.wijCSS.content+' wijmo-wijev-list-details"><div class="wijmo-wijev-leftpane-inner"><div class="wijmo-wijev-agenda-container '+n.wijCSS.content+" "+n.wijCSS.cornerAll+" "+n.wijCSS.helperClearFix+'">&nbsp;</div></div></div><div class="wijmo-wijev-rightpane">&nbsp;</div></div>').appendTo(this.element),s('<div class="wijmo-wijev-loading-modal-frame"></div><div class="wijmo-wijev-loading"><div class="wijmo-wijev-loading-text">'+this.localizeString("activityLoading","Loading...")+"</div></div>").appendTo(this.element),s('<div class="wijmo-wijev-navigationbar '+n.wijCSS.header+" "+n.wijCSS.cornerBottom+" "+n.wijCSS.helperClearFix+'"><a class="wijmo-wijev-today">'+this.localizeString("buttonToday","today")+'</a><div class="wijmo-wijev-datepager"></div></div>').appendTo(this.element),s('<div class="wijmo-wijev-statusbar '+n.wijCSS.header+" "+n.wijCSS.cornerBottom+'"></div>').appendTo(this.element),e=this.element.find(".wijmo-wijev-navigationbar"),i=this.element.find(".wijmo-wijev-headerbar .wijmo-wijev-tools"),e.find(".wijmo-wijev-today").button({text:this.localizeString("buttonToday","today")}).click(s.proxy(this._onTodayClick,this)),this.element.find(".wijmo-wijev-datepager").wijdatepager({selectedDate:n.selectedDate,localization:n.datePagerLocalization,culture:n.culture,viewType:n.viewType,nextTooltip:this.localizeString("navigatorBarNextTooltip","right"),prevTooltip:this.localizeString("navigatorBarPrevTooltip","left"),firstDayOfWeek:n.firstDayOfWeek,selectedDateChanged:s.proxy(function(t,e){this.goToDate(e.selectedDate)},this)}),null==s.mobile?(i.find(".wijmo-wijev-day").button().button("widget").addClass(n.wijCSS.stateDefault),i.find(".wijmo-wijev-week").button().button("widget").addClass(n.wijCSS.stateDefault),i.find(".wijmo-wijev-month").button().button("widget").addClass(n.wijCSS.stateDefault),i.find(".wijmo-wijev-list").button().button("widget").addClass(n.wijCSS.stateDefault),i.buttonset()):(i.attr("data-role","controlgroup"),i.attr("data-type","horizontal"),i.parent().trigger("create"),i.controlgroup("refresh")),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){t.element.wijRemoveVisibilityObserver&&t.element.wijRemoveVisibilityObserver(),t._redrawActiveView()},"wijevcal"),i.find(".wijmo-wijev-day").click(s.proxy(this._onDayViewClick,this)),i.find(".wijmo-wijev-week").click(s.proxy(this._onWeekViewClick,this)),i.find(".wijmo-wijev-month").click(s.proxy(this._onMonthViewClick,this)),i.find(".wijmo-wijev-list").click(s.proxy(this._onListViewClick,this)),this.showLoadingLabel()},e.prototype.showLoadingLabel=function(t,e){t===!1?this.element.find(".wijmo-wijev-loading-text").hide():(this.element.find(".wijmo-wijev-loading-text").show(),t||(t=this.localizeString("activityLoading","Loading..."))),(void 0===e||e===!0)&&this.element.find(".wijmo-wijev-loading-modal-frame").show(),this.element.find(".wijmo-wijev-loading").show(),this.element.find(".wijmo-wijev-loading-text").html(t)},e.prototype.hideLoadingLabel=function(){this.element.find(".wijmo-wijev-loading-modal-frame").hide(),this.element.find(".wijmo-wijev-loading").hide()},e.prototype._init=function(){var t=this.options;t.selectedDates&&t.selectedDates.length>0?t.selectedDate=t.selectedDates[0]=i(t.selectedDates[0]):t.selectedDate?(t.selectedDate=i(t.selectedDate),t.selectedDates||(t.selectedDates=[]),t.selectedDates[0]=t.selectedDate):(t.selectedDate=i(new Date),t.selectedDates=[t.selectedDate]),t.disabled&&this.element.addClass(t.wijCSS.stateDisabled),this._initHeaderbar(),this._initNavigationbar(),this._initStatusbar(),this._initRightPane(),t.fullScreen&&this._onFullScreenModeChanged(t.fullScreen),this._initLogPanel(),this._initLocalDataStorage(),this.element.ajaxError(jQuery.proxy(this._onAjaxError,this)),s(window).bind("resize."+this.wijevcalnamespacekey,s.proxy(this._onWindowResize,this)),this._renderActiveView(),this._bindDataView()},e.prototype._onFullScreenModeChanged=function(t){},e.prototype._isDataViewLoaded=function(t){return t&&(t.isLoaded()||t.count()>0)},e.prototype._isDataview=function(t){return t&&"object"==typeof t&&!s.isArray(t)?!0:void 0},e.prototype._getDataViewInst=function(){return this.element.data("wijdataview")},e.prototype._bindDataView=function(){var t=this.options,e=t.dataSource,e,i=this;!e&&this._getDataViewInst()&&(e=this._getDataViewInst(),e=t.dataSource=e),e&&this._isDataview(e)?this._isDataViewLoaded(e)?(this._dataView=e,this._setOption("eventsData",e.toArray())):e.element.bind("dataloaded",function(){i._dataView=e,i._setOption("eventsData",e.toArray())}):this._dataView=null},e.prototype._initLocalDataStorage=function(){try{if(c=!1,window.amplify&&window.amplify.store)try{u=amplify.store("wijevcal_tables1"),c=!0,this.log("Using amplify.store for the local data storage")}catch(t){return this.log("amplify.store exception:"+t),void this._loadData()}else{if(!window.openDatabase)return this.log(this.localizeString("logCouldntOpenLocalStorage","Couldn't open built-in local data storage. Please, add amplify.store references.")),void this._loadData();try{l=window.openDatabase(h,d,"Wijmo Events Calendar Offline DB",2e5)}catch(e){return this.log("web sql database error: "+e),void this._loadData()}if(!l)return this.log("Failed to open the database on disk. This is probably because the version was bad or there is not enough space left in this domain's quota"),void this._loadData();this.log("Using Web SQL Database for the local data storage.")}o("calendars","(id TEXT PRIMARY KEY, name TEXT, location TEXT, description TEXT, color TEXT, tag TEXT)");var i=s.Deferred(),n=this;this._defferObjs.push(i),o("events","(id TEXT PRIMARY KEY, calendar TEXT, subject TEXT, location TEXT, start TIMESTAMP, end TIMESTAMP, description TEXT, color TEXT, allday INTEGER, properties TEXT, tag TEXT)",function(){n._loadData(),i.resolve()})}catch(r){this.log("local datastorage initialization error:"+r)}},e.prototype._initStatusbar=function(){
var t=this.element.find(".wijmo-wijev-statusbar");return this.options.statusBarVisible?(t.css("float","left"),t.show(),this.statusbarEventsAdded||(this.statusbarEventsAdded=!0),void 0):void t.hide()},e.prototype._initHeaderbar=function(){var t=this.element.find(".wijmo-wijev-headerbar");return this.options.headerBarVisible?void t.show():void t.hide()},e.prototype._initNavigationbar=function(){var t=this.element.find(".wijmo-wijev-navigationbar");return this.options.navigationBarVisible?void t.show():void t.hide()},e.prototype._initRightPane=function(){var t=this.element.find(".wijmo-wijev-rightpane");return this.options.rightPaneVisible?void t.show():void t.hide()},e.prototype._initLogPanel=function(){this.options.enableLogs?(this._createLogPanel(),this.log=this._log):(this.logDialog&&this.logDialog.wijdialog("close"),this.log=function(){})},e.prototype._handleServerError=function(t){return t&&0===t.toString().indexOf("error:")?(this.status(t.toString(),"error"),!0):!1},e.prototype._loadData=function(){var t=this.options,e=this,i,n,o,a,l,h,d,c,u,p,g,f,m;if(this.showLoadingLabel(),p=function(t){"Local data storage not found."===t&&(m=!0),e.hideLoadingLabel()},t.calendars=[],l=this._calendarsById={},c=function(n){if(t.calendars=[],n){if("string"==typeof n){if(e._handleServerError(n))return void p(n);try{n=e._jsonParse(n)}catch(r){return void e.status("Unable to parse received calendars data. "+r,"error")}}for(n.calendars&&n.calendars.length&&(n=n.calendars),i=0;i<n.length;i+=1)o=e._cloneObj(n[i]),o.prevData=e._cloneObj(o),t.calendars.push(o),l[o.id]=o;e._onCalendarsChanged()}},t.dataStorage.loadCalendars?t.dataStorage.loadCalendars(c,p):t.webServiceUrl?s.getJSON(t.webServiceUrl+"?clientId="+this.element[0].id+"&command=loadCalendars&calendars="+t.calendars,c):r("SELECT * FROM calendars",[],function(r){for(i=0,n=r.rows.length;n>i;i+=1)o=e._cloneObj(r.rows.item(i)),o.prevData=e._cloneObj(o),t.calendars.push(o),l[o.id]=o;e._onCalendarsChanged()},p),this._dataView&&(t.eventsData=this._dataView.toArray()),h=this._eventsDataById?this._eventsDataById:this._eventsDataById={},u=function(t){if(t){if("string"==typeof t){if(e._handleServerError(t))return void p(t);try{t=e._jsonParse(t)}catch(n){return void e.log("Unable to parse received calendars data. "+n)}}for(t.events&&t.events.length&&(t=t.events),i=0;i<t.length;i+=1)a=e._readEventData(t[i]),e._storeEventWithSort(a);e._onEventsDataChanged(),e._onInitialized()}},t.dataStorage.loadEvents)t.dataStorage.loadEvents(t.visibleCalendars,u,p),e._chromeLoadDataDeffer.resolve();else if(t.webServiceUrl)s.ajax({url:t.webServiceUrl+"?clientId="+this.element[0].id+"&command=loadEvents&timestamp="+(new Date).getTime(),dataType:"text",cache:!1,contentType:"application/json; charset=utf-8",type:"POST",success:u,error:p}),e._chromeLoadDataDeffer.resolve();else{if(this._dataView)return void this._onInitialized();for(d="SELECT * FROM events where ",i=0;i<t.visibleCalendars.length;i+=1)i>0&&(d+=" OR "),d+="calendar='"+t.visibleCalendars[i]+"'";r(d,[],function(o){if(e._needLoadLocalStorage)for(t.eventsData=[],i=0,n=o.rows.length;n>i;i+=1)a=e._readEventData(o.rows.item(i)),e._storeEventWithSort(a);e._onEventsDataChanged(),e._onInitialized(),e._chromeLoadDataDeffer.resolve()},function(){p.apply(this,arguments),m&&(e._onEventsDataChanged(),e._onInitialized()),e._chromeLoadDataDeffer.resolve()})}},e.prototype._onInitialized=function(){this._ensureDisabled(),this.hideLoadingLabel(),this._trigger("initialized")},e.prototype._readEventData=function(t){var e=this._cloneObj(t);return e.start=new Date(e.start),e.end=new Date(e.end),"string"==typeof e.allday&&("false"===e.allday&&(e.allday=!1),"true"===e.allday&&(e.allday=!0)),e.start.getTime()>=e.end.getTime()&&(e.end=this._addMinutes(e.start,this.options.timeInterval)),this._deSerializeProperties(e.properties,e),e.prevData=this._cloneObj(e),e},e.prototype._prepareEventsForView=function(){this._eventsView=this.getOccurrences()},e.prototype._cloneObj=function(t){var e={},i;for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},e.prototype._onDayViewClick=function(){var t=this.options;t.disabled||("day"!==t.viewType&&(t.viewType="day",this._onViewTypeChanged()),t.selectedDates=[t.selectedDate],this._onSelectedDatesChanged())},e.prototype._onWeekViewClick=function(){var t=this.options,e,i,n;if(!t.disabled){for("week"!==t.viewType&&(t.viewType="week",this._onViewTypeChanged()),e=t.selectedDate,n=t.firstDayOfWeek-e.getDay(),Math.abs(n)>6&&(n=e.getDay()-t.firstDayOfWeek),e=this._addDays(e,n),t.selectedDates=[],n=0;7>n;n+=1)i=this._addDays(e,n),t.selectedDates.push(i);this._onSelectedDatesChanged()}},e.prototype._onMonthViewClick=function(){var t=this.options;t.disabled||"month"!==t.viewType&&(t.viewType="month",this._onViewTypeChanged())},e.prototype._onListViewClick=function(){var t=this.options;t.disabled||("list"!==t.viewType&&(t.viewType="list",this._onViewTypeChanged()),t.selectedDates=[t.selectedDate],this._onSelectedDatesChanged())},e.prototype._ensureEditCalendarDialogCreated=function(){var t=this.options,e,i={};this._editCalendarDialog||(e=t.editCalendarTemplate,e||(e="<p><label>"+this.localizeString("labelCalendarName","Calendar name")+'</label><input type="text" class="wijmo-wijev-name" value=""> <div class="wijmo-wijev-color-button"><div class="wijmo-wijev-color ui-wijmo-wijev-event-color-default">&nbsp;</div></div></p><p><label>'+this.localizeString("labelLocation","Location")+'</label><input type="text" class="wijmo-wijev-location" value=""></p><p><label>'+this.localizeString("labelDescription","Description")+'</label><textarea class="wijmo-wijev-description" /></p>'),this._editCalendarDialog=s('<div class="wijmo-wijev-editcalendar-dialog">'+e+"</div>"),this.element.append(this._editCalendarDialog),i[this.localizeString("buttonSave","Save")]=s.proxy(function(){try{var t=this._validateAndReadCalendarDialogFields(this._editCalendarDialog);t.prevData?this.updateCalendar(t):this.addCalendar(t),this._editCalendarDialog.wijdialog("close")}catch(e){alert(e)}},this),this._editCalendarDialog.wijdialog({autoOpen:!0,height:340,width:440,modal:!0,title:this.localizeString("titleEditCalendar","Edit calendar"),buttons:i,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}}),this._editCalendarDialog.find(".wijmo-wijev-name, .wijmo-wijev-location, .wijmo-wijev-description").wijtextbox(),this._editCalendarDialog.find(".wijmo-wijev-color-button").button({icons:{primary:t.wijCSS.iconArrowDown}}).click(s.proxy(this._onColorButtonClick,{dlg:this._editCalendarDialog,self:this})))},e.prototype._ensureEditEventDialogCreated=function(){var t=this.options,e,i=!1,n=!1;this._editEventDialog||(e=this.options.editEventDialogTemplate,e||(e='<div class="wijmo-wijev-event-dialog '+this.options.wijCSS.content+" "+t.wijCSS.cornerAll+'"><ul class="wijmo-wijev-brief-content"><li><label>'+this.localizeString("labelName","name")+'</label><input type="text" name="subject" class="wijmo-wijev-subject" value=""><div class="wijmo-wijev-color-button"><div class="wijmo-wijev-color ui-wijmo-wijev-event-color-default">&nbsp;</div></div></li><li><label for="'+this._uidPref+'_alldaybtn">'+this.localizeString("labelAllDay","all-day")+'</label><input type="checkbox" class="wijmo-wijev-allday" id="'+this._uidPref+'_alldaybtn" /></li><li><label>'+this.localizeString("labelStarts","Starts")+'</label><input type="text" class="wijmo-wijev-start" value=""><input type="text" class="wijmo-wijev-start-time" value=""></li><li><label>'+this.localizeString("labelEnds","Ends")+'</label><input type="text" class="wijmo-wijev-end" value=""><input type="text" class="wijmo-wijev-end-time" value=""></li></ul><ul class="wijmo-wijev-detailed-content '+t.wijCSS.cornerAll+'"><li><label>'+this.localizeString("labelLocation","Location")+'</label><input type="text" class="wijmo-wijev-location" value=""></li><li><label>'+this.localizeString("labelRepeat","Repeat")+'</label><select class="wijmo-wijev-repeat"><option value="none">'+this.localizeString("repeatNone","None")+'</option><option value="daily">'+this.localizeString("repeatDaily","Every Day")+'</option><option value="workdays">'+this.localizeString("repeatWorkDays","Work days")+'</option><option value="weekly">'+this.localizeString("repeatWeekly","Every Week")+'</option><option value="monthly">'+this.localizeString("repeatMonthly","Every Month")+'</option><option value="yearly">'+this.localizeString("repeatYearly","Every Year")+"</option></select></li><li><label>"+this.localizeString("labelCalendar","Calendar")+'</label><select class="wijmo-wijev-calendar"></select></li><li class="wijmo-wijev-description-item"><label>'+this.localizeString("labelDescription","Description")+'</label><textarea class="wijmo-wijev-description" /></li></ul><div class="footer"><a href="#" class="wijmo-wijev-delete">'+this.localizeString("buttonDelete","Delete")+'</a><a href="#" class="wijmo-wijev-save">'+this.localizeString("buttonOK","OK")+'</a><a href="#" class="wijmo-wijev-cancel">'+this.localizeString("buttonCancel","Cancel")+'</a></div><div class="wijmo-wijev-angle"></div></div>'),this._editEventDialog=s(e),this.element.append(this._editEventDialog),this._editEventDialog.find(".wijmo-wijev-color-button").button({icons:{primary:t.wijCSS.iconArrowDown}}).click(s.proxy(this._onColorButtonClick,{dlg:this._editEventDialog,self:this})),this._editEventDialog.find(".wijmo-wijev-delete").button().click(s.proxy(function(){this.deleteEvent(this._editEventDialog.appt),this._editEventDialog.wijpopup("hide")},this)),this._editEventDialog.find(".wijmo-wijev-cancel").button().click(s.proxy(function(t){this._editEventDialog.wijpopup("hide"),t.preventDefault()},this)),this._editEventDialog.find(".wijmo-wijev-start").width(114).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!0,dateFormat:"d",dropDownOpen:function(t,e){i=!1},dropDownClose:function(t,e){i=!0,s(document).one("mouseup",function(){i=!1})},dateChanged:s.proxy(function(t,e){i&&(n=!0,s(document).one("mouseup",function(){n=!1}));var o=this._editEventDialog.find(".wijmo-wijev-end").wijinputdate("option","date");e.date>o&&this._editEventDialog.find(".wijmo-wijev-end").wijinputdate("option","date",e.date)},this)}),this._editEventDialog.find(".wijmo-wijev-start-time").width(80).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!1,dateFormat:"t",dateChanged:s.proxy(function(t,e){var i=this._editEventDialog.find(".wijmo-wijev-end-time").wijinputdate("option","date"),n=this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date");e.date.getDate()!==n.getDate()&&(e.date.setDate(n.getDate()),this._editEventDialog.find(".wijmo-wijev-start-time").wijinputdate("option","date",e.date)),e.date>i&&this._editEventDialog.find(".wijmo-wijev-end-time").wijinputdate("option","date",e.date)},this)}),this._editEventDialog.find(".wijmo-wijev-end").width(114).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!0,dateFormat:"d",dropDownOpen:function(t,e){i=!1},dropDownClose:function(t,e){i=!0,s(document).one("mouseup",function(){i=!1})},dateChanged:s.proxy(function(t,e){i&&(n=!0,s(document).one("mouseup",function(){n=!1}));var o=this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date");e.date<o&&this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date",e.date)},this)}),this._editEventDialog.find(".wijmo-wijev-end-time").width(80).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!1,dateFormat:"t"}),this._editEventDialog.find(".wijmo-wijev-allday").wijcheckbox().change(s.proxy(this._eventDialogEnsureTimePartState,this)),this._editEventDialog.find(".wijmo-wijev-subject,.wijmo-wijev-location,.wijmo-wijev-description").wijtextbox(),this._editEventDialog.find(".wijmo-wijev-save").button().click(s.proxy(function(t){try{var e=this._validateAndReadApptDialogFields(this._editEventDialog);e.prevData?this.updateEvent(e):this.addEvent(e),this._editEventDialog.wijpopup("hide")}catch(i){alert(i)}},this)),this._editEventDialog.wijpopup({autoHide:!0,hiding:s.proxy(function(t){return n?(n=!1,!1):(this._colorMenu&&this._colorMenu.wijpopup("hide"),void this.element.find(".wijmo-wijev-dayview .ui-selected").removeClass("ui-selected"))},this),shown:s.proxy(function(t){var e=this;this._dropDownInitialized?(this._editEventDialog.find(".wijmo-wijev-calendar").wijdropdown("refresh"),this._editEventDialog.find(".wijmo-wijev-repeat").wijdropdown("refresh")):(this._editEventDialog.find(".wijmo-wijev-calendar").wijdropdown().bind("change",function(t){var i=e._calendarsById[this.value];i&&i.color?e._addColorClass(e._editEventDialog.find(".wijmo-wijev-color"),i.color):e._editEventDialog.appt&&e._editEventDialog.appt.color&&e._addColorClass(e._editEventDialog.find(".wijmo-wijev-color"),e._editEventDialog.appt.color)}),this._editEventDialog.find(".wijmo-wijev-repeat").wijdropdown().bind("change",function(t){var i=this.value,n=e._editEventDialog.appt;switch(i){case"none":n.recurrenceState=null,n.recurrencePattern=null;break;case"daily":n.recurrenceState="master",n.recurrencePattern={parentRecurrenceId:n.id,recurrenceType:"daily"};break;case"workdays":n.recurrenceState="master",n.recurrencePattern={parentRecurrenceId:n.id,recurrenceType:"workdays"};break;case"weekly":n.recurrenceState="master",n.recurrencePattern={parentRecurrenceId:n.id,recurrenceType:"weekly"};break;case"monthly":n.recurrenceState="master",n.recurrencePattern={parentRecurrenceId:n.id,recurrenceType:"monthly"};break;case"yearly":n.recurrenceState="master",n.recurrencePattern={parentRecurrenceId:n.id,recurrenceType:"yearly"};break;case"custom":alert("show custom recurrence pattern.")}}),this._dropDownInitialized=!0),this._onEditEventDialogShown(this._editEventDialog,this._editEventDialog.appt),this._editEventDialog.find(".wijmo-wijev-subject").focus(),this._updateEditEventPopupCallout()},this)}))},e.prototype._updateEditEventPopupCallout=function(){if(this._editEventDialog&&this._editEventDialog._arrowTarget){var t=this._editEventDialog,e=s(t._arrowTarget),i=e.offset(),n=t.offset(),o;i.left===n.left?t.removeClass("wijmo-wijev-rightangle").removeClass("wijmo-wijev-leftangle"):i.left<n.left?t.removeClass("wijmo-wijev-rightangle").addClass("wijmo-wijev-leftangle"):t.removeClass("wijmo-wijev-leftangle").addClass("wijmo-wijev-rightangle"),o=Math.round(i.top-n.top+e.outerHeight(!0)/2),this._editEventDialog.find(".wijmo-wijev-angle").css("top",o)}},e.prototype._onColorButtonClick=function(){var t=this.self,e=this.dlg,i,n=t.options,o=n.colors,r="";if(o&&o.length>0)for(i=0;i<o.length;i+=1)r+='<span class="wijmo-wijev-listcolor wijmo-wijev-event-color-'+o[i]+'">&nbsp;</span>';t._colorMenu||(t._colorMenu=s('<div class="wijmo-wijev-color-menu '+n.wijCSS.content+" "+n.wijCSS.cornerAll+'"></div>'),e.append(t._colorMenu),t._colorMenu.wijpopup({autoHide:!0})),t._colorMenu.html(r),t._colorMenu.find(".wijmo-wijev-listcolor").click(s.proxy(function(i){this._addColorClass(e.find(".wijmo-wijev-color"),this._readColorFromClass(s(i.target),"default")),t._colorMenu.wijpopup("hide")},t)),t._colorMenu.wijpopup("show",{of:e.find(".wijmo-wijev-color-button"),my:"left top",at:"left bottom"})},e.prototype._validateAndReadCalendarDialogFields=function(t){var e=t.cal||{};if(e.name=t.find(".wijmo-wijev-name").val(),e.location=t.find(".wijmo-wijev-location").val(),e.description=t.find(".wijmo-wijev-description").val(),e.color=this._readColorFromClass(t.find(".wijmo-wijev-color"),e.color||"default"),!e.name)throw"Calendar name can not be empty";return e},e.prototype._validateAndReadApptDialogFields=function(t){var e=t.appt,n,o,r,s,a;n=i(t.find(".wijmo-wijev-start").wijinputdate("option","date")),o=i(t.find(".wijmo-wijev-end").wijinputdate("option","date")),r=t.find(".wijmo-wijev-start-time").wijinputdate("option","date"),s=t.find(".wijmo-wijev-end-time").wijinputdate("option","date");var l=60*(60*r.getHours()+r.getMinutes())+r.getSeconds(),h=60*(60*s.getHours()+s.getMinutes())+s.getSeconds();if(n.getTime()===o.getTime()&&l>h)throw this.localizeString("messageEndOccursBeforeStart","The end date you entered occurs before the start date.");return e.subject=t.find(".wijmo-wijev-subject").val(),e.location=t.find(".wijmo-wijev-location").val(),e.start=n,e.end=o,t.find(".wijmo-wijev-allday").length>0&&(e.allday=t.find(".wijmo-wijev-allday")[0].checked),e.allday?e.start.getTime()>=e.end.getTime()&&(e.end=this._addMinutes(e.start,this.options.timeInterval)):(e.start=new Date(e.start.getFullYear(),e.start.getMonth(),e.start.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()),e.end=new Date(e.end.getFullYear(),e.end.getMonth(),e.end.getDate(),s.getHours(),s.getMinutes(),s.getSeconds())),e.calendar=t.find(".wijmo-wijev-calendar").val(),e.description=t.find(".wijmo-wijev-description").val(),e.color=this._readColorFromClass(t.find(".wijmo-wijev-color"),e.color),a=e.recurrencePattern,a&&"master"===e.recurrenceState&&(a.startTime=e.start,a.endTime=e.end,a.patternStartDate=e.start),e},e.prototype._bindApptToDialog=function(t){if(t){var e=this._editEventDialog,i,n;e.appt=t,e.find(".wijmo-wijev-subject").val(t.subject||""),e.find(".wijmo-wijev-location").val(t.location||"");try{e.find(".wijmo-wijev-start").wijinputdate("option","date",t.start),e.find(".wijmo-wijev-start-time").wijinputdate("option","date",t.start),e.find(".wijmo-wijev-end").wijinputdate("option","date",t.end),e.find(".wijmo-wijev-end-time").wijinputdate("option","date",t.end)}catch(o){alert("[e0001a] wijinputdate/wijtextselection firefox error\n"+o)}e.find(".wijmo-wijev-allday").length>0&&(e.find(".wijmo-wijev-allday")[0].checked=t.allday),e.find(".wijmo-wijev-allday").wijcheckbox("refresh"),this._fillCalendarsSelect(e.find(".wijmo-wijev-calendar"),t.calendar),this._loadRepeatValue(t,e.find(".wijmo-wijev-repeat")),e.find(".wijmo-wijev-description").val(t.description||""),t.prevData?e.find(".wijmo-wijev-delete").show():e.find(".wijmo-wijev-delete").hide(),e.find(".wijmo-wijev-calendar").length>0&&(i=this._calendarsById[e.find(".wijmo-wijev-calendar")[0].value]),n=t.color,!n&&i&&i.color&&(n=i.color),this._addColorClass(e.find(".wijmo-wijev-color"),n),this._eventDialogEnsureTimePartState()}},e.prototype._onEditEventDialogShown=function(t,e){"exception"===e.recurrenceState?t.find(".wijmo-wijev-repeat").wijdropdown("option","disabled",!0):t.find(".wijmo-wijev-repeat").wijdropdown("option","disabled",!1)},e.prototype._eventDialogEnsureTimePartState=function(){var t=this._editEventDialog;t.find(".wijmo-wijev-allday").length>0&&(t.find(".wijmo-wijev-allday")[0].checked?(t.find(".wijmo-wijev-start-time").wijinputdate("option","disabled",!0),t.find(".wijmo-wijev-end-time").wijinputdate("option","disabled",!0)):(t.find(".wijmo-wijev-start-time").wijinputdate("option","disabled",!1),t.find(".wijmo-wijev-end-time").wijinputdate("option","disabled",!1)))},e.prototype._loadRepeatValue=function(t,e){var i="none";if(t.recurrencePattern)switch(t.recurrencePattern.recurrenceType){case"daily":i="daily";break;case"workdays":i="workdays";break;case"weekly":i="weekly";break;case"monthly":i="monthly";break;case"yearly":i="yearly";break;default:i="custom"}e.val(i)},e.prototype._addColorClass=function(t,e){var i,n=new RegExp("wijmo-wijev-event-color-(\\w+)\\s*");t.length>0&&(i=t[0].className,t[0].className=i.replace(n,""),t.addClass("wijmo-wijev-event-color-"+(e||"default")))},e.prototype._readColorFromClass=function(t,e){var i=new RegExp("wijmo-wijev-event-color-(\\w+)\\s*"),n;return t.length>0&&(n=i.exec(t[0].className),n&&n.length>1)?n[1]:e},e.prototype._fillCalendarsSelect=function(t,e){var i="",n=this.options,o,r,s,a=n.calendars.slice(0),l=n.visibleCalendars;if(l&&l.length>0)for(o=0;o<l.length;o+=1){for(s=!1,r=0;r<a.length;r+=1)a[r].name===l[o]&&(s=!0);s||a.push({id:l[o],name:l[o]})}if(0===a.length)return void t.html("");for(o=0;o<a.length;o+=1)i+='<option value="'+a[o].id+'">'+a[o].name+"</option>";t.html(i).val(e)},e.prototype._bindCalendarToDialog=function(t){if(t){var e=this._editCalendarDialog;e.cal=t,e.find(".wijmo-wijev-name").val(t.name||""),e.find(".wijmo-wijev-location").val(t.location||""),e.find(".wijmo-wijev-description").val(t.description||""),this._addColorClass(e.find(".wijmo-wijev-color"),t.color)}},e.prototype._onTodayClick=function(){return this.options.disabled?void 0:(this.goToday(),!1)},e.prototype._bindEvents=function(){this._eventsAttached||(s(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-appointment",s.proxy(this._onAppointmentClick,this)),s(this.element).on("mousedown."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-appointment",s.proxy(this._onDayViewAppointmentMouseDown,this)),s(this.element).on("mousedown."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-appointment",s.proxy(this._onMonthViewAppointmentMouseDown,this)),s(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-timeinterval",s.proxy(this._onDayViewTimeIntervalClick,this)),s(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-allday-cell",s.proxy(this._onDayViewAllDayCellClick,this)),s(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcellheader",s.proxy(this._onMonthViewDayLabelClick,this)),s(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcell-showmore",s.proxy(this._onMonthViewDayLabelClick,this)),s(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-weekview .wijmo-wijev-daylabel",s.proxy(this._onMonthViewDayLabelClick,this)),s(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcell",s.proxy(this._onMonthViewCellClick,this)),this._eventsAttached=!0)},e.prototype._unbindEvents=function(){this._eventsAttached&&(s(this.element).off("mousedown."+this.wijevcalnamespacekey),s(this.element).off("click."+this.wijevcalnamespacekey),this._eventsAttached=!1)},e.prototype.destroy=function(){this._destroyInternal(),s.wijmo.widget.prototype.destroy.apply(this,arguments)},e.prototype._destroyInternal=function(){var t=this.options;this.element.removeClass("wijmo-wijev wijmo-wijevcal "+t.wijCSS.widget+" "+t.wijCSS.helperReset),s(window).unbind("resize."+this.wijevcalnamespacekey),this._unbindEvents(),this.element.empty(),this.wijevcalnamespacekey=null,this._uidPref=null,this._isUpdating=null,this._resolveDayApptConflictsTimeout=null,this._pendingRedrawActiveView=null,this._listViewDetailsInit=null,this._dayViewDetailsInit=null,this._eventsAttached=null,this.statusbarEventsAdded=null,this._dataView=null,this._eventsView=null,this._eventsDataById=null,this._calendarsById=null,this._dayViewCache=null,this._templateDayColumn=null,this._templateDayHeader=null,this._dayViewScrollToEvent=null,this._maxAllDayEventCount=null,this._dayColumnsToResolve=null,this._dayColumnResolveIdx=null,this.logDialog=null,this.logPanel=null,this._editCalendarDialog=null,this._editEventDialog=null,this._renderAgendaEventsTimeoutId=null,this.__targetAppt=null,this._isApptResize=null,this.__startApptH=null,this.__startApptY=null,this.__startClientY=null,this._apptDragResizeFlag=null,this._apptMovedFlag=null,this._movedFromTimeInervalApptElem=null,this.__targetApptChanged=null,this._defferObjs=null,this._setOptionCallbacks=null,this._chromeLoadDataDeffer=null,s.wijmo.wijevcal.prototype.options.eventsData=[]},e.prototype.deleteCalendar=function(t,e,i){var n,o=this.options.calendars,a=t.id||t,l=!1,h,d,c,u=this;for(n=0;n<o.length;n+=1)if(o[n].id===a){if(l=!0,t=o[n],!this._trigger("beforeDeleteCalendar",null,{data:t}))return!1;delete this._calendarsById[t.id],o.splice(n,1);break}if(!l)for(n=0;n<o.length;n+=1)if(o[n].name===a){if(l=!0,t=o[n],!this._trigger("beforeDeleteCalendar",null,{data:t}))return!1;delete this._calendarsById[t.id],o.splice(n,1);break}if(!l)return this.status("Calendar with id/name '"+a+"' not found."),!1;if(this.showLoadingLabel(this.localizeString("activityDeletingCalendar","Deleting calendar...")),h=function(i){u.status("Calendar '"+t.name+"' deleted."),u._onCalendarsChanged(),u.hideLoadingLabel(),e&&e(i)},d=function(e){u.status("Unable to delete calendar '"+t.name+"': "+e),u.hideLoadingLabel(),i&&i(e)},this.options.dataStorage.deleteCalendar)this.options.dataStorage.deleteCalendar(t,h,d);else if(this.options.webServiceUrl){try{c=this._jsonStringify(t)}catch(p){return this.status("Unable to prepare calendar data for server. "+p,"error"),void d("Unable to prepare calendar data for server. "+p)}s.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=deleteCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+c,success:h,error:d})}else r("DELETE FROM calendars WHERE id='"+t.id+"'",[],h,d)},e.prototype.addCalendar=function(t,e,i){var n,o,a,l=this,h=!1;if(!this._trigger("beforeAddCalendar",null,{data:t,prevData:t.prevData||{}})){if(t.prevData)for(o in t.prevData)t.prevData.hasOwnProperty(o)&&(t[o]=t.prevData[o]);return!1}if(t.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,t.id="dynid"+this._dynIdCounter+"ts"+(new Date).getTime()),s.each(l.options.calendars,function(e,i){return t.name===i.name?(h=!0,!1):void 0}),!h)if(this.showLoadingLabel(this.localizeString("activityCreatingCalendar","Creating calendar...")),n=function(i){return l._handleServerError(i)?void a(i):(l._readUpdatedServerDataIfAny(i,t),l._calendarsById[t.id]?l.status("Calendar '"+t.name+"' added."):(l.options.calendars.push(t),l._calendarsById[t.id]=t,l.status("Calendar '"+t.name+"' added.")),t.prevData=l._cloneObj(t),l._onCalendarsChanged(),l.hideLoadingLabel(),e&&e(i),void 0)},a=function(e){l.status("Unable to add calendar '"+t.name+"': "+e),l.hideLoadingLabel(),i&&i(e)},this.options.dataStorage.addCalendar)this.options.dataStorage.addCalendar(t,n,a);else if(this.options.webServiceUrl){try{o=this._jsonStringify(t)}catch(d){return this.status("Unable prepare calendar data for server."+d,"error"),void a("Unable to prepare calendar data for server."+d)}s.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=addCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+o,success:n,error:a})}else r("INSERT OR REPLACE INTO calendars (id, name, location, description, color, tag) VALUES(?,?,?,?,?,?);",[t.id,t.name,t.location,t.description,t.color,t.tag],n,a)},e.prototype.updateCalendar=function(t,e,i){var n,o,a,l=this;if(!this._trigger("beforeUpdateCalendar",null,{data:t,prevData:t.prevData||{}})){if(t.prevData)for(o in t.prevData)t.prevData.hasOwnProperty(o)&&(t[o]=t.prevData[o]);return!1}if(t.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,t.id="dynid"+this._dynIdCounter+"ts"+(new Date).getTime()),this.showLoadingLabel(this.localizeString("activityUpdatingCalendar","Updating calendar...")),n=function(i){var n=!1,o=l.options.visibleCalendars;return l._handleServerError(i)?void a(i):(l._readUpdatedServerDataIfAny(i,t),l._calendarsById[t.id]?(s.each(o,function(e,i){return i===t.prevData.name?(o[e]=t.name,!1):void 0}),l.status("Calendar '"+t.name+"' updated.")):(s.each(l.options.calendars,function(e,i){return t.name===i.name?(n=!0,!1):void 0}),n||(l.options.calendars.push(t),l._calendarsById[t.id]=t,l.status("Calendar '"+t.name+"' added."))),t.prevData=l._cloneObj(t),l._onCalendarsChanged(),l.hideLoadingLabel(),e&&e(i),void 0)},a=function(e){l.status("Unable to update calendar '"+t.name+"': "+e),l.hideLoadingLabel(),i&&i(e)},this.options.dataStorage.updateCalendar)this.options.dataStorage.updateCalendar(t,n,a);else if(this.options.webServiceUrl){try{o=this._jsonStringify(t)}catch(h){return this.status("Unable prepare calendar data for server. "+h,"error"),void a("Unable to prepare calendar data for server. "+h)}s.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=updateCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+o,success:n,error:a})}else r("INSERT OR REPLACE INTO calendars (id, name, location, description, color, tag) VALUES(?,?,?,?,?,?);",[t.id,t.name,t.location,t.description,t.color,t.tag],n,a)},e.prototype._initEventData=function(t){return s.extend({allday:!1,location:null,subject:null,description:null,color:null,tag:null},t)},e.prototype.addEvent=function(t,e,i){var o,a,l,h=this;if(!this._trigger("beforeAddEvent",null,{data:t,prevData:t.prevData||{}})){if(t.prevData)for(l in t.prevData)t.prevData.hasOwnProperty(l)&&(t[l]=t.prevData[l]);return!1}if(t.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,t.id=n()),t.calendar||(t.calendar="Default"),this.showLoadingLabel(this.localizeString("activityCreatingEvent","Creating event...")),a=function(e){if(h.hideLoadingLabel(),h.status("Unable to add event '"+t.subject+"': "+e,"error"),t.prevData)for(l in t.prevData)t.prevData.hasOwnProperty(l)&&(t[l]=t.prevData[l]);i&&i(e)},o=function(i){return h._handleServerError(i)?void a(i):(h._readUpdatedServerDataIfAny(i,t),h._eventsDataById[t.id]&&"exception"!==t.recurrenceState?h.status("Event '"+t.subject+"' added."):(h._storeEventWithSort(t),h.status("Event '"+t.subject+"' added.")),t.prevData=h._cloneObj(t),h._onEventsDataChanged(),h.hideLoadingLabel(),e&&e(i),void 0)},this.options.dataStorage.addEvent)this.options.dataStorage.addEvent(t,o,a);else if(this.options.webServiceUrl){try{l=this._jsonStringify(t)}catch(d){return this.status("Unable prepare event data for server. "+d,"error"),void a("Unable to prepare event data for server. "+d)}s.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=addEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+l,success:o,error:a})}else{if(t=h._initEventData(t),!c&&!window.openDatabase)return void o.call(this,{rowsAffected:0,rows:[t]});r("INSERT OR REPLACE INTO events (id, calendar, subject, location, start, end, description, color, allday, properties, tag) VALUES(?,?,?,?,?,?,?,?,?,?,?);",[t.id,t.calendar,t.subject,t.location,t.start.getTime(),t.end.getTime(),t.description,t.color,t.allday,this._serializeProperties(t),t.tag],o,a)}},e.prototype._storeEventWithSort=function(t){var e=this.options.eventsData,i,n;for(this._eventsDataById[t.id]=t,i=0,n=e.length;n>i;i+=1){if(e[i].start>t.start)return void e.splice(i,0,t);if(e[i].start.getTime()===t.start.getTime()&&e[i].subject>t.subject)return void e.splice(i,0,t)}e.push(t)},e.prototype._readUpdatedServerDataIfAny=function(t,e){var i=null,n;if("string"==typeof t&&0===t.indexOf("update:")){t=t.toString().substr("update:".length);try{i=this._jsonParse(t)}catch(o){this.status("Unable to read updated server data. "+o,"warning")}if(i)for(n in i)i[n]&&(e[n]=i[n]);
}},e.prototype.updateEvent=function(t,e,i){var n,o,a,l=this;if(!this._trigger("beforeUpdateEvent",null,{data:t,prevData:t.prevData||{}})){if(t.prevData)for(a in t.prevData)t.prevData.hasOwnProperty(a)&&(t[a]=t.prevData[a]);return this._updateAppointmentVisual(t),!1}if(t.calendar||(t.calendar="Default"),this.showLoadingLabel(this.localizeString("activityUpdatingEvent","Updating event...")),o=function(e){if(l.hideLoadingLabel(),l.status("Unable to update event '"+t.subject+"': "+e,"error"),t.prevData)for(a in t.prevData)t.prevData.hasOwnProperty(a)&&(t[a]=t.prevData[a]);l._updateAppointmentVisual(t),i&&i(e)},!t.id)return void o("id is empty");if("exception"===t.recurrenceState||"occurrence"===t.recurrenceState){if(!this._eventsDataById[t.parentRecurrenceId])return void o("Unable to find master event for event with id:"+t.id);if("occurrence"===t.recurrenceState)return this.log(this._formatString("[updateEvent->addEvent] recurrenceState for event {0} changed to 'exception'.",t.id)),t.recurrenceState="exception",this.addEvent(t,e,i)}if(n=function(i){return l._handleServerError(i)?void o(i):(l._readUpdatedServerDataIfAny(i,t),l._eventsDataById[t.id]?(s.extend(l._eventsDataById[t.id],t),l.status("Event '"+t.subject+"' updated.")):(l._storeEventWithSort(t),l.status("Event '"+t.subject+"' added.")),t.prevData=l._cloneObj(t),l._onEventsDataChanged(),l.hideLoadingLabel(),e&&e(i),void 0)},this.options.dataStorage.updateEvent)this.options.dataStorage.updateEvent(t,n,o);else if(this.options.webServiceUrl){try{a=this._jsonStringify(t)}catch(h){return this.status("Unable prepare event data for server. "+h,"error"),void o("Unable to prepare event data for server. "+h)}s.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=updateEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+a,success:n,error:o})}else{if(t=l._initEventData(t),!c&&!window.openDatabase)return void n.call(this,{rowsAffected:0,rows:[t]});r("INSERT OR REPLACE INTO events (id, calendar, subject, location, start, end, description, color, allday, properties, tag) VALUES(?,?,?,?,?,?,?,?,?,?,?);",[t.id,t.calendar,t.subject,t.location,t.start.getTime(),t.end.getTime(),t.description,t.color,t.allday,this._serializeProperties(t),t.tag],n,o)}},e.prototype._serializeProperties=function(t){var e="",i={};i.parentRecurrenceId=t.parentRecurrenceId,i.recurrenceState=t.recurrenceState,i.recurrencePattern=t.recurrencePattern,i.color=t.color,i.allday=t.allday;try{e=this._jsonStringify(i)}catch(n){this.status("Unable save additional event properties. "+n,"error")}return e},e.prototype._deSerializeProperties=function(t,e){var i={},n;if(t){if("string"==typeof t)try{i=this._jsonParse(t)}catch(o){return void this.status("Unable to load additional event properties. "+o,"error")}else i=t;i.parentRecurrenceId&&(e.parentRecurrenceId=i.parentRecurrenceId),i.recurrenceState&&(e.recurrenceState=i.recurrenceState),i.recurrencePattern&&(e.recurrencePattern=i.recurrencePattern),i.color&&(e.color=i.color),i.allday&&(e.allday=i.allday)}e&&e.recurrencePattern&&(n=e.recurrencePattern,n.patternStartDate=n.patternStartDate?new Date(n.patternStartDate):n.patternStartDate,n.startTime=n.startTime?new Date(n.startTime):n.startTime,n.endTime=n.endTime?new Date(n.endTime):n.endTime,n.startTime.getTime()>=n.endTime.getTime()&&(n.endTime=this._addMinutes(n.startTime,this.options.timeInterval)))},e.prototype._jsonStringify=function(t){var e;if(window.__JSONC1)e=window.__JSONC1.stringify(t);else{if(!window.JSON)throw"JSON not found.";e=JSON.stringify(t)}return e},e.prototype._jsonParse=function(t){var e,i,n;if(window.__JSONC1)e=window.__JSONC1.parse(t);else{if(!window.JSON)throw"JSON variable not found.";i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,n=/^\/Date\((d|-|.*)\)\/$/,e=window.JSON.parse(t,function(t,e){if("string"==typeof e){var o=i.exec(e),r;if(o)return new Date(Date.UTC(+o[1],+o[2]-1,+o[3],+o[4],+o[5],+o[6]));if(o=n.exec(e))return r=o[1].split(/[-,.]/),new Date(+r[0])}return e})}return e},e.prototype.getOccurrences=function(t,e){var i=this.options,n=i.eventsData,o,r,s,a,l,h,d,c,u=100,p,g,f,m=[],w=[],y=[],v={};for(this._eventsDataById||(this._eventsDataById={}),l=0,d=n.length;d>l;l+=1)if(o=n[l],this._eventsDataById[o.id]=o,"master"===o.recurrenceState)switch(a=o.recurrencePattern,a.removedOccurrences&&(y=y.concat(a.removedOccurrences)),c=a.occurrences||u,p=a.patternStartDate||o.start,g=a.startTime||o.start,f=a.endTime||o.end,a.recurrenceType){case"daily":for(h=0;c>h;h+=1)r=this._cloneObj(o),r.parentRecurrenceId=o.id,r.recurrenceState="occurrence",r.start=this._setTime(this._addDays(p,h),g),r.end=this._setTime(r.start,f,g),r.recurrencePattern=null,this._testIsEventInTimeInterval(r,t,e)&&(r.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",o.id,r.start),v[r.id]=r);break;case"workdays":for(h=0;c>h;h+=1)r=this._cloneObj(o),r.parentRecurrenceId=o.id,r.recurrenceState="occurrence",r.start=this._setTime(this._addDays(p,h),g),0!==r.start.getDay()&&6!==r.start.getDay()&&(r.end=this._setTime(r.start,f,g),r.recurrencePattern=null,this._testIsEventInTimeInterval(r,t,e)&&(r.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",o.id,r.start),v[r.id]=r));break;case"weekly":for(h=0;c>h;h+=1)r=this._cloneObj(o),r.parentRecurrenceId=o.id,r.recurrenceState="occurrence",r.start=this._setTime(this._addDays(p,7*h),g),r.end=this._setTime(r.start,f,g),r.recurrencePattern=null,this._testIsEventInTimeInterval(r,t,e)&&(r.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",o.id,r.start),v[r.id]=r);break;case"monthly":for(h=0;c>h;h+=1)r=this._cloneObj(o),r.parentRecurrenceId=o.id,r.recurrenceState="occurrence",r.start=this._setTime(new Date(p),g),r.start.setMonth(r.start.getMonth()+h),r.end=this._setTime(r.start,f,g),r.recurrencePattern=null,this._testIsEventInTimeInterval(r,t,e)&&(r.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",o.id,r.start),v[r.id]=r);break;case"yearly":for(h=0;c>h;h+=1)r=this._cloneObj(o),r.parentRecurrenceId=o.id,r.recurrenceState="occurrence",r.start=this._setTime(new Date(p),g),r.start.setYear(r.start.getFullYear()+h),r.end=this._setTime(r.start,f,g),r.recurrencePattern=null,this._testIsEventInTimeInterval(r,t,e)&&(r.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",o.id,r.start),v[r.id]=r);break;case"monthlyNth":break;case"yearlyNth":}else this._testIsEventInTimeInterval(o,t,e)&&("exception"===o.recurrenceState?w.push(o):"removed"===o.recurrenceState?(y.push(o.id),this.log("[warning] Seems we found removed event inside events storage, id:"+o.id)):m.push(o));for(l=0,d=w.length;d>l;l+=1)s=w[l],v[s.id]&&delete v[s.id],m.push(s),this._eventsDataById[s.id]=s;for(l=0,d=y.length;d>l;l+=1)v[y[l]]&&delete v[y[l]];for(l in v)r=v[l],m.push(r),this._eventsDataById[r.id]=r;return m},e.prototype._testIsEventInTimeInterval=function(t,e,i){return e&&i?t.start<i&&t.end>e?!0:!1:!0},e.prototype.deleteEvent=function(t,e,i){t.id&&(t=t.id);var n=this._eventsDataById[t],o,a,l,h,d=this,u,p;if(!this._trigger("beforeDeleteEvent",null,{data:n}))return!1;if(this.showLoadingLabel(this.localizeString("activityDeletingEvent","Deleting event...")),h=function(t){d.status("Unable to delete event '"+(n?n.subject:"undefined")+"': "+t),d.hideLoadingLabel(),i&&i(t)},"exception"===n.recurrenceState||"occurrence"===n.recurrenceState)if(p=this._eventsDataById[n.parentRecurrenceId]){if(this.log(this._formatString("[deleteEvent] removing {0} with id {1}. Updating master event with id {2}",n.recurrenceState,n.id,p.id)),p.recurrencePattern.removedOccurrences||(p.recurrencePattern.removedOccurrences=[]),p.recurrencePattern.removedOccurrences.push(n.id),this.updateEvent(p,e,i),"occurrence"===n.recurrenceState)return void this.log("No need to delete occurrence from store. Master event should be updated.")}else if("exception"!==n.recurrenceState)return h("Unable to find master event with id "+n.parentRecurrenceId),!1;if("master"===n.recurrenceState,l=function(i){if(d._handleServerError(i))return void h(i);if(d._eventsDataById[n.id]){for(a=d.options.eventsData,o=0;o<a.length;o+=1)a[o].id===t&&a.splice(o,1);delete d._eventsDataById[n.id],d.status("Event '"+n.subject+"' deleted.")}else d.status("Event '"+n.subject+"' deleted.");n.prevData=d._cloneObj(n),d._onEventsDataChanged(),d.hideLoadingLabel(),e&&e(i)},this.options.dataStorage.deleteEvent)this.options.dataStorage.deleteEvent(n,l,h);else if(this.options.webServiceUrl){try{u=this._jsonStringify(n)}catch(g){return this.status("Unable prepare event data for server. "+g,"error"),void h("Unable prepare event data for server. "+g)}s.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=deleteEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+u,success:l,error:h})}else{if(!c&&!window.openDatabase)return void l.call(this,{rowsAffected:0,rows:[n]});r("DELETE FROM events WHERE id='"+t+"'",[],l,h)}},e.prototype.beginUpdate=function(){this._isUpdating=!0,this.showLoadingLabel("Updating...")},e.prototype.endUpdate=function(){this._isUpdating=!1,this._pendingRedrawActiveView&&this._redrawActiveView(),this.hideLoadingLabel()},e.prototype.goToEvent=function(t){t.id&&(t=t.id);var e=this.options,i,n=this.findEventById(t);switch(e.viewType){case"day":case"week":case"list":i=this.element.find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn ."+this._eventIdToCssClass(t)),i.length>0?this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",i):(this._dayViewScrollToEvent=n,this.goToDate(n.start));break;case"month":this.goToDate(n.start)}},e.prototype.isAllDayEvent=function(t){var e=t;return t.id||(e=this.findEventById(t)),e.allday?(e.end.getTime()-e.start.getTime())/864e5>=1?!0:!0:!1},e.prototype.goToDate=function(t){t=i(t);var e=this.options,n=t.getDay(),o,r,s,a,l,h=e.selectedDates;if(h&&h.length>0){if(this._isContainsDayDate(h,t))return;if(l=h[0],s=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),a=Date.UTC(l.getFullYear(),l.getMonth(),l.getDate()),r=(s-a)/864e5,"week"===e.viewType)for(o=0;o<h.length;o+=1)if(h[o].getDay()===n){r-=o;break}for(o=0;o<h.length;o+=1)h[o]=this._addDays(h[o],r);this._onSelectedDatesChanged()}else e.selectedDates=[t],this._onSelectedDatesChanged()},e.prototype.goToTime=function(t){var e=this.element.find(".wijmo-wijev-daycolumn .wijmo-wijev-timeinterval:first-child"),i=this.element.find(".wijmo-wijev-daycolumn .wijmo-wijev-timeinterval:last-child"),n=e.position().top,o=i.position().top+i.height(),r,s,a;a=86400,s=60*t.getHours()*60+60*t.getMinutes(),r=(o-n)*s/a+n,this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("vScrollTo",r)},e.prototype.goToday=function(){this.goToDate(new Date)},e.prototype.goLeft=function(){var t,e=this.options,i=e.viewType,n=e.selectedDates;"month"===i?this.goToDate(this._addMonths(n[0],-1)):(t=-7,1===n.length&&(t=-1),this.goToDate(this._addDays(n[0],t)))},e.prototype.goRight=function(){var t,e=this.options,i=e.viewType,n=e.selectedDates;"month"===i?this.goToDate(this._addMonths(n[0],1)):(t=7,1===n.length&&(t=1),this.goToDate(this._addDays(n[0],t)))},e.prototype.refresh=function(){this.invalidate()},e.prototype.invalidate=function(){var t=this.options;switch(t.viewType.toLowerCase()){case"list":case"day":case"week":this._invalidateDayView();break;case"month":this._invalidateMonthView()}},e.prototype.showEditCalendarDialog=function(t){var e=this.options,i=e.calendars,n;if(t){if(!t.name)for(n=0;n<i.length;n+=1)if(i[n].name===t){t=i[n];break}}else t={name:"",description:"",location:"",color:""};this._ensureEditCalendarDialogCreated(),this._bindCalendarToDialog(t),this._editCalendarDialog.wijdialog("open")},e.prototype.showEditEventDialog=function(t,e,i){var n=this.options,o,r,a,l=e?s(e):i?s(i.target):null;this._ensureEditEventDialogCreated(),this.element.find(".wijmo-wijev-dayview .ui-selected").removeClass("ui-selected"),l&&l.hasClass("wijmo-wijev-daylabel")&&(l=l.parent(".wijmo-wijev-allday-cell")),t?(this._editEventDialog._arrowTarget=l,t.prevData||(t.prevData=this._cloneObj(n)),"occurrence"===t.recurrenceState&&(o=this._eventsDataById[t.parentRecurrenceId],window.confirm(this._formatString(this.localizeString("promptOpenOccurrenceFormat","{2}  is recurring event. Do you want to open only this occurrence?"),t.start,t.end,t.subject,t.location))||(t=o))):(t={subject:this.localizeString("textNewEvent","New event")},t.isNewEvent=!0,l&&l.length>0?(this._editEventDialog._arrowTarget=l,l.addClass("ui-selected"),r=l.parent(".wijmo-wijev-daycolumn"),r.length<1&&(r=l.parent(".wijmo-wijev-dayheadercolumn")),r=r[0],l.hasClass("wijmo-wijev-allday-cell")?t.allday=!0:l.hasClass("wijmo-wijev-monthcellcontainer")?(r=l[0],t.allday=!0):t.allday=!1,r&&(a=this._parseDateFromClass(r.className,t.allday?null:l[0].className),t.start=a,t.allday?t.end=this._addMinutes(t.start,1440):t.end=this._addMinutes(t.start,n.timeInterval))):(t.start=new Date(n.selectedDates[0]),t.end=this._addMinutes(t.start,n.timeInterval))),this._trigger("beforeEditEventDialogShow",null,{data:t,targetCell:l})&&(this._bindApptToDialog(t),this._editEventDialog.wijpopup("show",{of:l,my:"left center",at:"right center",within:this.element.parent(),offset:(l&&i?Math.round(i.offsetX-l.width()):10)+" 0",collision:"fit"}))},e.prototype._renderActiveView=function(){var t=this.options,e=this.element.find(".wijmo-wijev-headerbar .wijmo-wijev-tools");switch(this.element.find(".wijmo-wijev-view").hide(),this.element.find(".wijmo-wijev-viewdetails").hide(),this.element.find(".wijmo-wijev-"+t.viewType.toLowerCase()+"-details").show(),t.viewType.toLowerCase()){case"day":case"week":case"list":this.element.find(".wijmo-wijev-view.wijmo-wijev-dayview").show(),this._renderDayView();break;case"month":this.element.find(".wijmo-wijev-view.wijmo-wijev-monthview").show(),this._renderMonthView()}e.find(".wijmo-wijev-"+t.viewType.toLowerCase())[0].checked=!0,s().buttonset&&e.buttonset("refresh")},e.prototype._redrawActiveView=function(){if(this._isUpdating)return void(this._pendingRedrawActiveView=!0);switch(this.options.viewType.toLowerCase()){case"day":case"week":case"list":this._clearDayViewCache(),this._templateDayColumn=null}this._renderActiveView()},e.prototype._getDayColumnDates=function(t){var e=this.options,i=e.selectedDates,n,o,r;if(i||(i=[new Date]),"week"===e.viewType)for(n=e.selectedDate||i[0],r=e.firstDayOfWeek-n.getDay(),Math.abs(r)>6&&(r=n.getDay()-e.firstDayOfWeek),n=this._addDays(n,r),i=[],r=0;7>r;r+=1)o=this._addDays(n,r),i.push(o);return t&&(e.selectedDates=i),i},e.prototype._renderDayView=function(){var t=this.options,e=0,i=1440,n,o,r,a=this._getDayColumnDates(!0),l,h,d,c,u=new Date,p,g=!1,f=this.element.find(".wijmo-wijev-dayview"),m,w,y,v=0,_;if(0===f.length&&(f=s('<div class="wijmo-wijev-view wijmo-wijev-dayview '+t.wijCSS.content+'"><h3 class="wijmo-wijev-header-title">title</h3><div class="wijmo-wijev-dayview-inner"><div class="wijmo-wijev-headercontainer"><div class="wijmo-wijev-sizer"><div class="wijmo-wijev-gmtlabel">'+this.localizeString("labelAllDay","all-day")+'</div></div></div><div class="wijmo-wijev-scrollpanel"><div class="wijmo-wijev-scrollcontent"><div class="wijmo-wijev-timeruler"><div class="wijmo-wijev-currenttime-indicator"><div class="wijmo-wijev-currenttime-indicator-arrow '+t.wijCSS.stateError+'"></div><div class="wijmo-wijev-currenttime-indicator-line '+t.wijCSS.stateError+'"></div></div></div></div></div></div></div>'),f.appendTo(this.element.find(".wijmo-wijev-view-container")),this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel({hScroller:{scrollBarVisibility:"hidden"},animationOptions:{disabled:!0}})),f.removeClass("wijmo-wijev-weekview wijmo-wijev-listview"),f.addClass("wijmo-wijev-"+t.viewType.toLowerCase()+"view"),m=this.element.find(".wijmo-wijev-headercontainer"),w=this.element.find(".wijmo-wijev-scrollcontent"),y=w.find(".wijmo-wijev-timeruler"),!this._templateDayColumn){for(y.find(".wijmo-wijev-timerulerinterval").remove(),n='<div class="wijmo-wijev-daycolumn">',_=!0;i>e;)o="wijmo-wijev-timeinterval "+t.wijCSS.content+" wijmo-wijev-minute-"+e,_&&(o+=" wijmo-wijev-oddrow"),_=!_,r="wijmo-wijev-timerulerinterval "+t.wijCSS.content+" wijmo-wijev-minute-"+e,n+='<div class="'+o+'" style="height: '+t.timeIntervalHeight+'px"></div>',e+=t.timeInterval,v+=t.timeInterval,v>=t.timeRulerInterval&&(o+=" wijmo-wijev-timeinterval-hourstart",r+=" wijmo-wijev-timerulerinterval-hourstart",y.append(s('<div class="'+r+'" style="height:'+v/t.timeInterval*t.timeIntervalHeight+'px">'+this._formatString(t.timeRulerFormat,new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,e-v))+"</div>")),v=0);n+="</div>",this._templateDayColumn=s(n),this._templateDayHeader=s('<div class="wijmo-wijev-dayheadercolumn '+t.wijCSS.content+'"><div class="wijmo-wijev-allday-cell '+t.wijCSS.content+'"><div class="wijmo-wijev-daylabel">3 Monday</div></div></div>')}for(m.find(".wijmo-wijev-dayheadercolumn").remove(),w.find(".wijmo-wijev-daycolumn").remove(),l=0,p=a.length;p>l;l+=1)c=a[l],h=this._getCachedDayHeader(c),d=this._getCachedDayColumn(c),h?(h=s(h),h.find(".wijmo-wijev-daylabel").html(this._formatDayHeaderDate(c))):(h=this._templateDayHeader.clone(!0),d=this._templateDayColumn.clone(!0),h.addClass(this._dayDateToCssClass(c)),h.find(".wijmo-wijev-daylabel").html(this._formatDayHeaderDate(c)),d.addClass(this._dayDateToCssClass(c)),g?g=!1:(d.addClass("wijmo-wijev-leftborder"),h.addClass("wijmo-wijev-leftborder")),0===this._compareDayDates(c,u)&&(d.addClass("wijmo-wijev-today "+t.wijCSS.stateHighlight),d.addClass("wijmo-wijev-leftborder"),d.addClass("wijmo-wijev-rightborder"),h.addClass("wijmo-wijev-today").find(".wijmo-wijev-allday-cell").addClass(t.wijCSS.stateHighlight),h.addClass("wijmo-wijev-leftborder"),h.addClass("wijmo-wijev-rightborder"),g=!0),l===p-1&&(d.addClass("wijmo-wijev-rightborder"),h.addClass("wijmo-wijev-rightborder"))),m.append(h),w.append(d);this._invalidateDayView(),this._renderDayViewAppointments()},e.prototype._getCachedDayHeader=function(t){var e=null;return this._dayViewCache&&this._dayViewCache[t]&&(e=this._dayViewCache[t].h),e},e.prototype._getCachedDayColumn=function(t){var e=null;return this._dayViewCache&&this._dayViewCache[t]&&(e=this._dayViewCache[t].c),e},e.prototype._storeDayCache=function(t,e,i){this._dayViewCache||(this._dayViewCache={}),this._dayViewCache[t]={h:e,c:i}},e.prototype._clearViewsCache=function(){this._clearDayViewCache(),this._clearListViewCache()},e.prototype._clearDayViewCache=function(){this._dayViewCache={}},e.prototype._clearListViewCache=function(){var t=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container .wijmo-wijsuperpanel-templateouterwrapper");t[0]||(t=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container .wijmo-wijsuperpanel-contentwrapper-touch")),t.data("wijevcal_agenda_initialized",!1),t.data("wijevcal_agenda_loadedeventscount",0)},e.prototype._invalidateDayView=function(t){var e=this.element.find(".wijmo-wijev-headercontainer"),i=this.element.find(".wijmo-wijev-scrollcontent"),n=i.find(".wijmo-wijev-timeruler"),o=e.find(".wijmo-wijev-dayheadercolumn"),r=i.find(".wijmo-wijev-daycolumn"),a=this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title"),l,h,d,c,u,p,g,f=n.outerWidth(),m,w,y,v,_;for(this._updateHeaderTitleText(),l=a.is(":visible")?a.outerHeight(!0):0,this._invalidateView(),this._maxAllDayEventCount||(this._maxAllDayEventCount=0),c=e.find(".wijmo-wijev-dayheadercolumn .wijmo-wijev-appointment").outerHeight(!0),c||(c=17),u=e.find(".wijmo-wijev-daylabel").outerHeight(!0),p=0,m=0;m<o.length;m+=1)g=s(o[m]).find(".wijmo-wijev-allday-cell .wijmo-wijev-appointment").length,g>p&&(p=g);switch(d=c*p+u+c,e.outerHeight(d+Math.round(c/2)),e.find(".wijmo-wijev-allday-cell").outerHeight(d),h=this.element.find(".wijmo-wijev-view").width(),w=h-f,w-=18,y=this.element.find(".wijmo-wijev-view").innerHeight()-e.outerHeight(!0)-l,v=Math.floor(w/r.length),e.outerWidth(h),i.outerWidth(h),o.outerWidth(v),r.outerWidth(v),this._invalidateCurrentTimeIndicator(),_=this.element.find(".wijmo-wijev-scrollpanel"),_.outerWidth(h),_.outerHeight(y),_.wijsuperpanel("refresh"),this.options.viewType.toLowerCase()){case"day":this._updateDayViewDetails();break;case"list":this._updateListViewDetails()}},e.prototype._updateDayViewDetails=function(){var t=this.options,e=t.selectedDate,i=this.element.find(".wijmo-wijev-leftpane"),n=i.find(".wijmo-wijev-agenda-container");this._dayViewDetailsInit||(this._dayViewDetailsInit=!0,this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar({culture:t.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),showTitle:!1,showOtherMonthDays:!1,showWeekNumbers:!1,selectionMode:{day:!0,days:!1},selectedDatesChanged:s.proxy(function(e,i){i.dates&&!t.disabled&&this.goToDate(i.dates[0])},this),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous")}),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-agenda-container").wijsuperpanel()),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar("option","displayDate",e).wijcalendar("unSelectAll").wijcalendar("selectDate",e),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar("refresh"),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-monthday-label").html(e.getDate()),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-fulldate-label").html(this._formatString(this.localizeString("dayDetailsLabelFulldateFormat","{0:dddd, MMMM d}"),e)),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-year-label").html(this._formatString(this.localizeString("dayDetailsLabelYearFormat","{0:yyyy}"),e)),this._updateAgendaList(this.element.find(".wijmo-wijev-day-details  .wijmo-wijev-agenda-container"),e,e,!1)},e.prototype._listViewAgendaScrolled=function(t,e){var i=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container"),n=i.wijsuperpanel("option","vScroller"),o,r=n.scrollValue,a=n.scrollMax-2*n.scrollLargeChange,l=t.type,h=!1,d;"wijsuperpanelscroll"===l?(d=e.position,o=i.find(".wijmo-wijsuperpanel-contentwrapper-touch"),i.height()+d>=o.height()&&(h=!0)):o=i.find(".wijmo-wijsuperpanel-templateouterwrapper"),(r>=a||h)&&o.data("wijevcal_agenda_loadnextpage")&&(o.data("wijevcal_agenda_loadnextpage",!1),o.find(".wijmo-wijev-agenda-more-events").show().html(this.localizeString("agendaLoadingMoreEvents","Loading more events...")),this._renderAgendaEventsTimeoutId&&(clearTimeout(this._renderAgendaEventsTimeoutId),this._renderAgendaEventsTimeoutId=null),this._renderAgendaEventsTimeoutId=setTimeout(s.proxy(function(){this._renderAgendaEventsTimeoutId=null,this._renderAgendaEvents(o,null,null,!0,i),o.find(".wijmo-wijev-agenda-more-events").remove()},this),100))},e.prototype._updateListViewDetails=function(){this._listViewDetailsInit||(this._listViewDetailsInit=!0,s.support.isTouchEnabled&&s.support.isTouchEnabled()?this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container").wijsuperpanel({scroll:s.proxy(this._listViewAgendaScrolled,this)}):this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container").wijsuperpanel({scrolled:s.proxy(this._listViewAgendaScrolled,this)})),this._updateAgendaList(this.element.find(".wijmo-wijev-list-details  .wijmo-wijev-agenda-container"),null,null,!0)},e.prototype._updateAgendaList=function(t,e,i,n){var o=this.element.find(".wijmo-wijev-leftpane"),r=t;return t.outerHeight(o.innerHeight()-t[0].offsetTop),r.find(".wijmo-wijsuperpanel-templateouterwrapper").length>0&&(r=r.find(".wijmo-wijsuperpanel-templateouterwrapper")),s.support.isTouchEnabled&&s.support.isTouchEnabled()&&(r=r.find(".wijmo-wijsuperpanel-contentwrapper-touch")),n&&r.data("wijevcal_agenda_initialized")?void(t.data("wijmo-wijsuperpanel")&&t.wijsuperpanel("refresh")):(r.data("wijevcal_agenda_initialized",!0),r.data("wijevcal_agenda_loadedeventscount",0),r.html(""),this._renderAgendaEvents(r,e,i,n,t),void 0)},e.prototype._renderAgendaEvents=function(t,e,n,o,r){var a=this._eventsView,l,h,d,c,u=0,p,g="",f="",m=null,w=null,y=this.options,v,_,S=100,x=this,b=t.data("wijevcal_agenda_loadedeventscount");if(e&&(m=i(e),w=this._addDays(i(n),1),c=(w.getTime()-m.getTime())/864e5),a){if(d=a.length<S+b||!o?a.length:S+b,t.data("wijevcal_agenda_loadedeventscount",d),m)for(;c>u;){for(v=this._addDays(m,u),v=new Date(v.getFullYear(),v.getMonth(),v.getDate()),_=new Date(v.getFullYear(),v.getMonth(),v.getDate(),23,59,59),p=0,f="",h=b;d>h;h+=1)l=a[h],l.start<w&&l.end>m&&l.start<_&&l.start>=v&&(f+=this._renderAgendaAppointmentVisual(l),p+=1);""!==f&&(g+='<div class="wijmo-wijev-agenda-day-container '+this._dayDateToCssClass(v)+'">',o&&(g+=this._renderAgendaDayHeader(v)),g+='<ul class="wijmo-wijev-agenda-list">'+f+"</ul>",g+="</div>"),u+=1}else for(f="",h=b;d>h;h+=1)l=a[h],(h===b||v.getDate()!==l.start.getDate())&&(v=l.start,0!==h&&(g+='<ul class="wijmo-wijev-agenda-list">'+f+"</ul>",g+="</div>"),g+='<div class="wijmo-wijev-agenda-day-container '+this._dayDateToCssClass(v)+'">',o&&(g+=this._renderAgendaDayHeader(v)),f=""),f+=this._renderAgendaAppointmentVisual(l),p+=1,h===d-1&&(g+='<ul class="wijmo-wijev-agenda-list">'+f+"</ul>",g+="</div>",d<a.length?(g+='<div class="wijmo-wijev-agenda-more-events">',g+=this._formatString(this.localizeString("agendaMoreEventsFormat","More events ({0})..."),a.length-d),g+="<div>",t.data("wijevcal_agenda_loadnextpage",!0)):t.data("wijevcal_agenda_loadnextpage",!1));s(g).appendTo(t)}t.on("click",".wijmo-wijev-agenda-event",s.proxy(this._onAgendaEventClick,this)).on("mouseover",".wijmo-wijev-agenda-event",function(t){x.options.disabled||s(this).addClass(y.wijCSS.stateHover)}).on("mouseout",".wijmo-wijev-agenda-event",function(t){x.options.disabled||s(this).removeClass(y.wijCSS.stateHover).removeClass(y.wijCSS.stateActive)}).on("mousedown",".wijmo-wijev-agenda-event",function(){x.options.disabled||s(this).addClass(y.wijCSS.stateActive)}).on("mouseup",".wijmo-wijev-agenda-event",function(){x.options.disabled||s(this).removeClass(y.wijCSS.stateActive)}),r.data("wijmo-wijsuperpanel")&&r.wijsuperpanel("refresh")},e.prototype._renderAgendaDayHeader=function(t){var e='<div class="wijmo-wijev-agenda-header '+this.options.header+'"><div class="wijmo-wijev-weekday">'+this._formatString("{0:dddd}",t)+'</div><div class="wijmo-wijev-date">'+this._formatString(this.localizeString("agendaHeaderFullDateFormat","{0:MMMM d, yyyy}"),t)+"</div></div>";return e},e.prototype._onAgendaEventClick=function(t){if(!this.options.disabled){var e=s(t.target);e.hasClass("wijmo-wijev-agenda-event")||(e=e.parent(".wijmo-wijev-agenda-event")),e.length>0&&this.goToEvent(this._parseEventIdFromClass(e[0].className))}},e.prototype._renderAgendaAppointmentVisual=function(t){var e='<li class="wijmo-wijev-agenda-event '+this._dayDateToCssClass(t.start)+" "+this._eventIdToCssClass(t.id)+" "+this.options.wijCSS.stateDefault+" "+this.options.wijCSS.helperClearFix+'"><div class="wijmo-wijev-agenda-event-color wijmo-wijev-event-color-'+(t.color||"default")+'"><div></div></div><div class="wijmo-wijev-agenda-event-title">'+t.subject+'</div><div class="wijmo-wijev-agenda-event-time">'+(this.isAllDayEvent(t)?this.localizeString("labelAllDay","all-day"):this._formatString(this.localizeString("agendaTimeFormat","{0:hh:mm tt} to {1:hh:mm tt}"),t.start,t.end))+"</div></li>";return e},e.prototype._invalidateCurrentTimeIndicator=function(){var t=this.element.find(".wijmo-wijev-timeruler .wijmo-wijev-currenttime-indicator"),e=new Date,i=this.options;e=e.getMinutes()+60*e.getHours(),t.css("top",e/i.timeInterval*i.timeIntervalHeight)},e.prototype._onEventsDataChanged=function(){this._clearViewsCache(),this._prepareEventsForView(),this._renderActiveView(),this._trigger("eventsDataChanged",null,{eventsData:this.options.eventsData})},e.prototype._onCalendarsChanged=function(){this._trigger("calendarsChanged",null,{calendars:this.options.calendars})},e.prototype._renderDayViewAppointments=function(){var t=this._eventsView,e,i,n,o,r,a=this.element.find(".wijmo-wijev-headercontainer"),l=this.element.find(".wijmo-wijev-scrollcontent"),h=a.find(".wijmo-wijev-dayheadercolumn"),d=l.find(".wijmo-wijev-daycolumn"),c,u,p=this.options,g=this._getDayColumnDates(),f=g[0],m,w,y,v,_,S,x,b,C,D=[];if(m=g[g.length-1],m=new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59,59),t)for(n=0,r=g.length;r>n;n+=1)if(d[n]._cached)D.push(d[n]);else{for(c=g[n],c=new Date(c.getFullYear(),c.getMonth(),c.getDate()),u=new Date(c.getFullYear(),c.getMonth(),c.getDate(),23,59,59),i=0,o=t.length;o>i;i+=1)e=t[i],e.start<m&&e.end>f&&e.start<u&&e.end>c&&(this.isAllDayEvent(e)?(w=!0,y=s(this._getAllDayEventMarkup(e)),s(h[n]).find(".wijmo-wijev-allday-cell").append(y)):(v=e.start,_=e.end,c>v&&(v=c),_>u&&(_=u),S=(v-c)/1e3/60,x=(_-c)/1e3/60,b=Math.round(S*p.timeIntervalHeight/p.timeInterval),C=Math.round(x*p.timeIntervalHeight/p.timeInterval),y=s(this._getEventMarkup(e)),y.css("top",b),y.outerHeight(C-b),s(d[n]).append(y)));this._storeDayCache(g[n],h[n],d[n]),d[n]._cached=!0,D.push(d[n])}this._dayColumnsToResolve=D,this._dayColumnResolveIdx=0,this._resolveDayApptConflictsTimeout||(clearTimeout(this._resolveDayApptConflictsTimeout),this._resolveDayApptConflictsTimeout=null),this._resolveDayApptConflictsTimeout=setTimeout(s.proxy(this._resolveDayViewAppointmentConflictsCb1,this),1),w&&this._invalidateDayView(!0),this._dayViewScrollToEvent&&(y=this.element.find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn ."+this._eventIdToCssClass(this._dayViewScrollToEvent.id)),y.length>0&&this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",y))},e.prototype._getAllDayEventMarkup=function(t){return'<div class="wijmo-wijev-appointment '+this._eventIdToCssClass(t.id)+'"><div class=" wijmo-wijev-colordot wijmo-wijev-event-color-'+(t.color||"default")+'"></div><div class="wijmo-wijev-event-title">'+t.subject+"</div></div>"},e.prototype._getEventMarkup=function(t){return'<div class="wijmo-wijev-appointment wijmo-wijev-event-color-'+(t.color||"default")+" "+this._eventIdToCssClass(t.id)+'"><div class="wijmo-wijev-content"><div class="wijmo-wijev-title">'+this._formatString(this.options.eventTitleFormat,t.start,t.end,t.subject,t.location,"",t.description)+'</div></div><div class="wijmo-wijev-resizer"><div class="'+this.options.wijCSS.icon+" "+this.options.wijCSS.iconHGripSolid+'">&nbsp;</div></div></div>'},e.prototype._resolveDayViewAppointmentConflictsCb1=function(){this._resolveDayApptConflictsTimeout=null,!this._dayColumnsToResolve||this._dayColumnResolveIdx>=this._dayColumnsToResolve.length||(this._resolveDayViewAppointmentConflicts(this._dayColumnsToResolve[this._dayColumnResolveIdx]),this._dayColumnResolveIdx=this._dayColumnResolveIdx+1,setTimeout(s.proxy(this._resolveDayViewAppointmentConflictsCb1,this),1))},e.prototype._resolveDayViewAppointmentConflicts=function(t){var e=s(t).find(".wijmo-wijev-appointment"),i,n=[],o,r,a,l,h,d,c,u,p=0;for(i=s(e).toArray().sort(this._sortOffsetTop),r=0,d=e.length;d>r;r+=1)if(!(p>r)){for(l=i[r],a=r;d>a;a+=1)if(a!==r){if(h=i[a],!(l.offsetTop<h.offsetTop+h.offsetHeight&&l.offsetTop+l.offsetHeight>h.offsetTop))break;n[r]||(n[r]=[l]),n[r].push(h),h.offsetTop+h.offsetHeight>l.offsetTop+l.offsetHeight&&(l=h)}p=a}for(r=0,d=n.length;d>r;r+=1)if(o=n[r])for(c=o.length,o.sort(this._sortOffsetTop),a=0;c>a;a+=1)l=o[a],l.style.width=Math.floor(100/c)+"%",u=Math.floor(100*a/c),l.style.marginLeft=u+"%",l.style.zIndex=u},e.prototype._sortOffsetTop=function(t,e){return t.offsetTop<e.offsetTop?-1:t.offsetTop>e.offsetTop?1:0},e.prototype._onDayViewTimeIntervalClick=function(t){this.options.disabled||this.options.readOnly||this.showEditEventDialog(null,t.target,t)},e.prototype._onDayViewAllDayCellClick=function(t){if(!this.options.disabled&&!this.options.readOnly){var e=s(t.target);e.hasClass("wijmo-wijev-appointment")||e.parents(".wijmo-wijev-appointment").length>0||e.hasClass("wijmo-wijev-daylabel")||e.parents(".wijmo-wijev-daylabel").length>0||this.showEditEventDialog(null,t.target,t);
}},e.prototype._onMonthViewDayLabelClick=function(t){if(!this.options.disabled){var e=s(t.target).parents(".wijmo-wijev-monthcellcontainer"),i=this.options,n;e.length<1&&(e=s(t.target).parents(".wijmo-wijev-dayheadercolumn")),e[0]&&(n=this._parseDateFromClass(e[0].className),"day"!==i.viewType&&(i.viewType="day",this._onViewTypeChanged()),i.selectedDates=[new Date(n)],this._onSelectedDatesChanged())}},e.prototype._onMonthViewCellClick=function(t){if(!this.options.disabled){var e=s(t.target).parent(".wijmo-wijev-monthcellcontainer");this.options.readOnly||e.length<1||this.showEditEventDialog(null,e,t)}},e.prototype._onAppointmentClick=function(t){var e=s(t.target),i;this.options.disabled||this.options.readOnly||this._apptDragResizeFlag||(e.hasClass("wijmo-wijev-appointment")||(e=e.parents(".wijmo-wijev-appointment")),e.length>0&&(i=this.findEventById(e[0].className),this.showEditEventDialog(i,e,t)))},e.prototype.findEventById=function(t){var e;return t&&(e=t.indexOf("apptid_"),-1!==e&&(t=this._parseEventIdFromClass(t)),this._eventsDataById)?this._eventsDataById[t]:null},e.prototype._onMonthViewAppointmentMouseDown=function(t){if(!this.options.disabled&&!this.options.readOnly){var e=s(t.target),i=e.hasClass("wijmo-wijev-appointment")?e:e.parents(".wijmo-wijev-appointment");t.preventDefault(),this.__targetAppt=i,s(document).bind("mouseup.tmp_wijevcal",s.proxy(this._onMonthViewAppointmentMouseUp,this)),this.element.find(".wijmo-wijev-monthview .wijmo-wijev-monthcellcontainer").bind("mouseover.tmp_wijevcal",s.proxy(this._onMonthViewCellMouseOver,this))}},e.prototype._onDayViewAppointmentMouseDown=function(t){if(!this.options.disabled&&!this.options.readOnly){var e=s(t.target),i=e.hasClass("wijmo-wijev-appointment")?e:e.parents(".wijmo-wijev-appointment"),n=e.hasClass("wijmo-wijev-resizer")||e.parents(".wijmo-wijev-resizer").length>0;this.options.disabled||(this._isApptResize=n,t.preventDefault(),this._isApptResize?(this.__startApptH=i[0].offsetHeight,this.__startApptY=i[0].offsetTop):this.__startApptY=i[0].offsetTop,this.__startClientY=t.clientY,this.__targetAppt=i,s(document).bind("mousemove.tmp_wijevcal",s.proxy(this._onDayViewAppointmentMouseMove,this)),s(document).bind("mouseup.tmp_wijevcal",s.proxy(this._onDayViewAppointmentMouseUp,this)),s(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn").bind("mouseover.tmp_wijevcal",s.proxy(this._onDayViewColumnMouseOver,this)),s(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-allday-cell").bind("mouseover.tmp_wijevcal",s.proxy(this._onDayViewAllDayMouseOver,this)))}},e.prototype._onDayViewAppointmentMouseMove=function(t){if(!this.options.disabled){t.preventDefault();var e=t.clientY-this.__startClientY,i,n=this.options,o,r;t.ctrlKey||(e=Math.round(e/n.timeIntervalHeight)*n.timeIntervalHeight),0!==e&&!this._apptDragResizeFlag&&(this._apptDragResizeFlag=!0,this.__targetAppt.addClass("wijmo-wijev-dragging"),this.__targetAppt.css("width","100%").css("margin-left","0").css("z-index","1000")),this._apptDragResizeFlag&&(this._isApptResize?(o=this.__startApptH+e,0>o?(o=Math.abs(o),i=this.__startApptY-o,i>=0&&(this.__targetAppt.css("height",o),this.__targetAppt.css("top",i))):this.__targetAppt.css("height",o)):(i=this.__startApptY+e,0>i&&(i=0),this.__targetAppt.css("top",i),r=this.__targetAppt.offset().top,this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",this.__targetAppt),this.__startApptY=this.__startApptY-(this.__targetAppt.offset().top-r)),this._onApptVisualDargOrResize(this.__targetAppt,this.findEventById(this.__targetAppt[0].className)))}},e.prototype._onDayViewAppointmentMouseUp=function(t){if(!this.options.disabled&&(this.__targetAppt&&this.__targetAppt.removeClass("wijmo-wijev-dragging"),s(document).unbind(".tmp_wijevcal"),s(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn").unbind(".tmp_wijevcal"),s(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-allday-cell").unbind(".tmp_wijevcal"),this._apptDragResizeFlag||this._apptMovedFlag)){var e=this.findEventById(this.__targetAppt[0].className);this._onApptVisualDargOrResize(this.__targetAppt,e),this._apptMovedFlag=!1,this._movedFromTimeInervalApptElem=null,this.updateEvent(e),window.setTimeout(s.proxy(function(){this.__targetAppt&&!this.__targetAppt.hasClass("wijmo-wijev-dragging")&&(this._apptDragResizeFlag=!1,this._resolveDayViewAppointmentConflicts(this.__targetAppt.parents(".wijmo-wijev-daycolumn")))},this),1)}},e.prototype._updateAppointmentVisual=function(t){var e=this.element.find(".wijmo-wijev-dayview ."+this._eventIdToCssClass(t.id)),n=this.options,o,r,s,a,l,h,d,c;1===e.length&&(this._addColorClass(e,t.color),e.find(".wijmo-wijev-title").html(this._formatString(n.eventTitleFormat,t.start,t.end,t.subject,t.location,"",t.description)),l=i(t.start),o=(t.start-l)/1e3/60,r=(t.end-l)/1e3/60,s=Math.round(o*n.timeIntervalHeight/n.timeInterval),a=Math.round(r*n.timeIntervalHeight/n.timeInterval),e.css("top",s),e.css("height",a-s),h=this._dayDateToCssClass(l),1!==e.parents(".wijmo-wijev-daycolumn."+h).length&&(d=e[0].parentNode,c=this.element.find(".wijmo-wijev-daycolumn."+h),d.removeChild(e[0]),e.appendTo(c)))},e.prototype._onApptVisualDargOrResize=function(t,e){if(!this.options.disabled){var n=this.options,o=t[0].offsetTop,r=o+t[0].offsetHeight,s,a,l,h,d,c,u,p;p=t.parents(".wijmo-wijev-dayheadercolumn").length>0?t.parents(".wijmo-wijev-dayheadercolumn")[0]:t.parents(".wijmo-wijev-daycolumn")[0],u=this._parseDateFromClass(p.className,null),s=Math.round(o*n.timeInterval/n.timeIntervalHeight),a=Math.round(r*n.timeInterval/n.timeIntervalHeight),l=new Date(60*s*1e3+u.getTime()),h=new Date(60*a*1e3+u.getTime()),e&&(this._isApptResize?d=h:(c=e.end.getTime()-e.start.getTime(),d=new Date(l.getTime()+c)),e.allday=t.parents(".wijmo-wijev-dayheadercolumn").length>0,e.start=l,e.end=d,t.find(".wijmo-wijev-title").html(this._formatString(n.eventTitleFormat,e.start,e.end,e.subject,e.location,"",e.description)),!this._isApptResize&&d.getTime()!==h.getTime()&&t.css("height",Math.round((e.end-i(e.start))/1e3/60*n.timeIntervalHeight/n.timeInterval)-Math.round((e.start-i(e.start))/1e3/60*n.timeIntervalHeight/n.timeInterval)))}},e.prototype._onDayViewColumnMouseOver=function(t){if(!this.options.disabled){var e=s(t.target).parents(".wijmo-wijev-daycolumn"),i=this.__targetAppt.parents(".wijmo-wijev-daycolumn");if(!(e.length<1)){if(i.length<1){if(i=this.__targetAppt.parents(".wijmo-wijev-dayheadercolumn"),i.length<1)return;this._movedFromTimeInervalApptElem?(this.__targetAppt.replaceWith(this._movedFromTimeInervalApptElem),this.__targetAppt=s(this._movedFromTimeInervalApptElem),this._movedFromTimeInervalApptElem=null):this.__targetAppt.html(this._getEventMarkup(this.findEventById(this.__targetAppt[0].className)))}e[0].className!==i[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this._resolveDayViewAppointmentConflicts(i),this.__targetAppt.appendTo(e),this._apptMovedFlag=!0)}}},e.prototype._onMonthViewCellMouseOver=function(t){if(!this.options.disabled){var e=s(t.target),i=e.hasClass("wijmo-wijev-monthcellcontainer")?e:e.parents(".wijmo-wijev-monthcellcontainer"),n=this.__targetAppt.parents(".wijmo-wijev-monthcellcontainer");i.length<1||n.length<1||i[0].className!==n[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this.__targetAppt.appendTo(i.find(".wijmo-wijev-monthcell")),this.__targetApptChanged=!0)}},e.prototype._onMonthViewAppointmentMouseUp=function(){if(!this.options.disabled){var t,e=this.__targetAppt.parents(".wijmo-wijev-monthcellcontainer")[0],n=this._parseDateFromClass(e.className,null),o;s(document).unbind(".tmp_wijevcal"),this.element.find(".wijmo-wijev-monthview .wijmo-wijev-monthcellcontainer").unbind(".tmp_wijevcal"),this.__targetApptChanged&&(this.__targetApptChanged=!1,t=this.findEventById(this.__targetAppt[0].className),o=(n.getTime()-i(t.start).getTime())/864e5,t.start=this._addDays(t.start,o),t.end=this._addDays(t.end,o),this.updateEvent(t))}},e.prototype._onDayViewAllDayMouseOver=function(t){if(!this.options.disabled){var e=s(t.target).parents(".wijmo-wijev-dayheadercolumn"),i=this.__targetAppt.parents(".wijmo-wijev-daycolumn"),n;e.length<1||(i.length>0?(n=s(this._getAllDayEventMarkup(this.findEventById(this.__targetAppt[0].className))),this._movedFromTimeInervalApptElem=this.__targetAppt[0].cloneNode(!0),this.__targetAppt.replaceWith(n),this.__targetAppt=n):i=this.__targetAppt.parents(".wijmo-wijev-dayheadercolumn"),i.length<1||e[0].className!==i[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this._resolveDayViewAppointmentConflicts(i),this.__targetAppt.appendTo(s(e).find(".wijmo-wijev-allday-cell")),this._apptMovedFlag=!0))}},e.prototype._renderMonthView=function(){var t=this.options,e=t.selectedDate,i=t.firstDayOfWeek,n=!1,o=!1,r,a,l,h=new Date,d,c,u=!1,p,g=["","","","","","",""],f,m,w=this.element.find(".wijmo-wijev-view.wijmo-wijev-monthview"),y,v=t.dayHeaderFormat,_=t.firstRowDayHeaderFormat;for(e||(e=new Date),a=new Date(e.getFullYear(),e.getMonth(),1);a.getDay()!==parseInt(i);)a=this._addDays(a,-1);for(l=new Date(e.getFullYear(),e.getMonth(),this._daysInMonth(e.getMonth(),e.getFullYear())),r=a,d=0,c=0;l>r||7>d;)if(r>l&&(l=r),f="",p="wijmo-wijev-monthcellcontainer "+t.wijCSS.content+" "+this._dayDateToCssClass(r),o=r.getMonth()!==e.getMonth(),o&&(p+=" wijmo-wijev-othermonth"),u?u=!1:(p+=" wijmo-wijev-leftborder",6===d&&(p+=" wijmo-wijev-rightborder")),n=0===this._compareDayDates(r,h),n&&(p+=" wijmo-wijev-today",p+=" wijmo-wijev-rightborder",u=!0),f+='<div class="'+p+'">',f+='<div class="wijmo-wijev-monthcellheader',o&&(f+=" "+t.wijCSS.prioritySecondary),n&&(f+=" "+t.wijCSS.stateHighlight),f+='">',n&&(f+='<span class="wijmo-wijev-todaylabel">'+this.localizeString("labelToday","Today")+"</span>"),f+=0===c?this._formatString(_,r):this._formatString(v,r),f+="</div>",f+='<div class="wijmo-wijev-monthcell',o&&(f+=" "+t.wijCSS.prioritySecondary),n&&(f+=" "+t.wijCSS.stateHighlight),f+='"></div>',f+="</div>",g[d]=g[d]+f,d+=1,r=this._addDays(r,1),d>6){if(r>l)break;d=0,c+=1}for(0===w.length&&(w=s('<div class="wijmo-wijev-view wijmo-wijev-monthview '+t.wijCSS.content+'"><h3 class="wijmo-wijev-header-title">title</h3><div class="wijmo-wijev-monthview-inner"></div></div>'),w.appendTo(this.element.find(".wijmo-wijev-view-container"))),y=w.find(".wijmo-wijev-monthview-inner"),y.find(".wijmo-wijev-monthcolumn").remove(),r=a,m=0;7>m;m+=1)y.append('<div class="wijmo-wijev-monthcolumn">'+g[m]+"</div>"),r=this._addDays(r,1);this._invalidateMonthView(),this._renderMonthViewAppointments()},e.prototype._invalidateMonthView=function(){var t=this.element.find(".wijmo-wijev-monthview"),e=t.find(".wijmo-wijev-monthview-inner"),i=t.find(".wijmo-wijev-monthcolumn"),n=t.find(".wijmo-wijev-monthcellcontainer"),o=this.element.find(".wijmo-wijev-monthview .wijmo-wijev-header-title"),r,a,l,h,d,c,u,p;this._invalidateView(),i.length<1||(r=t.innerWidth(),a=t.innerHeight()-o.outerHeight(!0),e.outerWidth(r),e.outerHeight(a),r-=e.outerWidth(!0)-e.innerWidth(),a-=e.outerHeight(!0)-e.innerHeight(),l=Math.floor(r/i.length),i.outerWidth(l),p=r-l*i.length,p>0&&s(i[i.length-1]).outerWidth(l+p),u=s(i[0]).find(".wijmo-wijev-weekdayname").outerHeight(!0),u||(u=0),h=Math.floor((a-u)/s(i[0]).find(".wijmo-wijev-monthcellcontainer").length),n.height(h),d=s(n[0]).find(".wijmo-wijev-monthcellheader").outerHeight(!0),c=h-d,n.find(".wijmo-wijev-monthcell").outerHeight(c))},e.prototype._renderMonthViewAppointments=function(){var t=this._eventsView,e,i,n,o,r,a=this.element.find(".wijmo-wijev-monthcellcontainer"),l,h,d,c;if(t)for(n=0,r=a.length;r>n;n+=1)for(l=a[n],h=this._parseDateFromClass(l.className),d=new Date(h.getFullYear(),h.getMonth(),h.getDate(),23,59,59),i=0,o=t.length;o>i;i+=1)e=t[i],e.start<d&&e.end>h&&(c=s('<div class="wijmo-wijev-appointment '+this._eventIdToCssClass(e.id)+'"><div class=" wijmo-wijev-colordot wijmo-wijev-event-color-'+(e.color||"default")+'"></div><div class="wijmo-wijev-event-title">'+e.subject+"</div></div>"),s(l).find(".wijmo-wijev-monthcell").append(c));a.find(".wijmo-wijev-monthcell").each(s.proxy(function(t,e){var i=s(e),n=i.find(".wijmo-wijev-appointment"),o=i.outerHeight(),r=n.outerHeight(),a=n.length*r,l=0;a>o&&(n.each(function(t,e){t*r+r>o&&(e.style.display="none",l+=1)}),l>0&&i.find(".wijmo-wijev-monthcell-showmore").length<1&&i.append(s('<div class="wijmo-wijev-monthcell-showmore">'+this._formatString(this.localizeString("monthCellMoreEventsFormat","{0}  more..."),l)+"</div>")))},this))},e.prototype.log=function(t,e){},e.prototype._log=function(t,e){var i;this.logPanel&&(i=new Date,this.logPanel.prepend(s('<span class="'+(e?e:"wijmo-wijev-information")+'">['+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+"] "+t+"</span><br/>")))},e.prototype._createLogPanel=function(){if(!this.logPanel){this.logDialog=s('<div title="Log"><div class="wijmo-wijev-log"></div></div>'),this.logDialog.appendTo(this.element);var t={};t[this.localizeString("buttonClearAll","Clear All")]=function(){s(this).find(".wijmo-wijev-log").html("")},t[this.localizeString("buttonClose","Close")]=function(){s(this).wijdialog("close")},this.logPanel=this.logDialog.wijdialog({captionButtons:{},buttons:t,width:600,height:420,position:["right","top"]}).find(".wijmo-wijev-log")}this.logDialog.wijdialog("open")},e.prototype.status=function(t,e){this.element.find(".wijmo-wijev-statusbar").html("<span class='"+(e?e:"wijmo-wijev-status")+"'>"+t+"</span>"),this.log(t,e?e:"wijmo-wijev-status"),this.statusbarEventsAdded||(this.statusbarEventsAdded=!0,this._initStatusbar())},e.prototype._invalidateView=function(){var t=this.element.find(".wijmo-wijev-rightpane"),e=this.element.find(".wijmo-wijev-leftpane"),i=this.element.find(".wijmo-wijev-headerbar"),n=this.element.find(".wijmo-wijev-navigationbar"),o=this.element.find(".wijmo-wijev-statusbar"),r=this.element.find(".wijmo-wijev-view-container"),a=this.element.find(".wijmo-wijev-view"),l,h,d,c,u,p,g,f,m,w;for(l=this.element.innerWidth()-(r.outerWidth(!0)-r.innerWidth()),h=this.element.innerHeight()-(r.outerHeight(!0)-r.innerHeight()),d=i.is(":visible")?i.outerHeight(!0):0,c=n.is(":visible")?n.outerHeight(!0):0,u=o.is(":visible")?o.outerHeight(!0):0,r.outerWidth(l),r.outerHeight(h-d-c-u),f=0,w=0;w<e.length;w+=1)s(e[w]).is(":visible")&&(f+=s(e[w]).outerWidth());m=t.is(":visible")?t.outerWidth():0,p=h-d-c-u,g=l-m-f-1,a.outerHeight(p),a.outerWidth(g),i.outerWidth(g+f),n.outerWidth(this.element.innerWidth()),o.outerWidth(g+f+m),e.outerHeight(h-d-c-u),t.outerHeight(h+100),this.element.find(".wijmo-wijev-datepager").wijdatepager("refresh")},e.prototype._daysInMonth=function(t,e){var i=new Date(e,t+1,0);return i.getDate()},e.prototype._addMinutes=function(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()+e)},e.prototype._addDays=function(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate()+e,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())},e.prototype._setTime=function(t,e,i){var n;return t=new Date(t),t.setHours(e.getHours()),t.setMinutes(e.getMinutes()),t.setSeconds(e.getSeconds()),t.setMilliseconds(e.getMilliseconds()),i&&(n=Math.floor((e.getTime()-i.getTime())/864e5),n>0&&(t=this._addDays(t,n))),t},e.prototype._addMonths=function(t,e){return new Date(t.getFullYear(),t.getMonth()+e,t.getDate())},e.prototype._compareDayDates=function(t,e){return t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e>t?-1:t>e?1:0},e.prototype._dayDateToCssClass=function(t){return"wijmo-wijev-date_"+t.getFullYear()+"_"+t.getMonth()+"_"+t.getDate()},e.prototype._parseDateFromClass=function(t,e,i){var n,o,r,s=new RegExp("wijmo-wijev-minute-(\\d+)\\s"),a=new RegExp("wijmo-wijev-date_(\\d+_\\d+_\\d+)\\s");return t?(r=a.exec(t+" ")[1].split("_"),n=new Date(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)),e&&(o=s.exec(e+" "),o&&(o=parseInt(o[1],10),n.setMinutes(o))),n):i||null},e.prototype._eventIdToCssClass=function(t){return"apptid_"+t},e.prototype._parseEventIdFromClass=function(t){var e="",i,n;return i=new RegExp("apptid_(\\S+)"),n=i.exec(t),n&&n.length>1&&(e=n[1]),e},e.prototype._isContainsDayDate=function(t,e){var i;if(!t)return!1;for(i=0;i<t.length;i+=1)if(0===this._compareDayDates(t[i],e))return!0},e.prototype._formatString=function(t,e,i,n,o,r,s,a){var l,h=arguments,d,c,u=this;if(h.length<=1)return Globalize.format(h);if("string"==typeof t&&("_formatWeekTitle"===t?t=this._formatWeekTitle:"_formatMonthTitle"===t?t=this._formatMonthTitle:"function"==typeof window[t]&&(t=window[t])),"function"==typeof t){for(c=[],d=1;d<h.length;d+=1)c[d-1]=h[d];return t.apply(this,c)}return l=new RegExp("\\{(\\d+)(?:,([-+]?\\d+))?(?:\\:([^(^}]+)(?:\\(((?:\\\\\\)|[^)])+)\\)){0,1}){0,1}\\}","g"),t.replace(l,function(t,e,i,n,o){return t=h[Number(e)+1],n?Globalize.format(t,n,u._getCulture()):t})},e.prototype._formatMonthTitle=function(t){return this._formatString(this.localizeString("monthViewHeaderFormat","{0:MMMM yyyy}"),t)},e.prototype._formatWeekTitle=function(t,e){return t.getMonth()!==e.getMonth()?this._formatString(this.localizeString("weekViewHeaderFormat2Months","{0:MMMM} - {1:MMMM yyyy}"),t,e):this._formatString(this.localizeString("weekViewHeaderFormat","{0:MMMM yyyy}"),t)},e.prototype._formatDayHeaderDate=function(t){var e=this.options,i=e.viewType.toLowerCase(),n=this.options.dayViewHeaderFormat;if(n[i])n=n[i];else if(!n[i])return"";return this._formatString(n,t)},e.prototype._getCulture=function(t){return Globalize.findClosestCulture(t||this.options.culture)},e.prototype._isRTL=function(){return!!this._getCulture().isRTL},e.prototype._onAjaxError=function(t,e,i,n){e?(this.status("Ajax error "+e.status+" ("+e.statusText+")","error"),this.log("Error, requested url: "+i.url,"error"),e.responseText&&this.log("Error, response text: "+e.responseText,"error")):(this.status("Ajax error detected.","error"),this.log("Error, requested url: "+i.url,"error"))},e.prototype._onWindowResize=function(){this.invalidate()},e}(t.wijmoWidget);e.wijevcal=p;var g=function(){function t(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-c",stateDefault:"ui-btn-up-c"},this.initSelector=":jqmData(role='wijevcal')",this.culture="",this.localization=null,this.datePagerLocalization=null,this.readOnly=!1,this.webServiceUrl="",this.colors=null,this.dataStorage={addEvent:null,updateEvent:null,deleteEvent:null,loadEvents:null,addCalendar:null,updateCalendar:null,deleteCalendar:null,loadCalendars:null},this.dataSource=null,this.eventsData=[],this.appointments=[],this.calendars=[],this.disabled=!1,this.editCalendarTemplate="",this.enableLogs=!1,this.eventTitleFormat="{2}",this.titleFormat={day:!1,week:"_formatWeekTitle",month:"_formatMonthTitle",list:!1},this.firstDayOfWeek=0,this.headerBarVisible=!0,this.navigationBarVisible=!0,this.rightPaneVisible=!1,this.selectedDate=null,this.selectedDates=null,this.statusBarVisible=!1,this.timeInterval=30,this.timeIntervalHeight=15,this.timeRulerInterval=60,this.timeRulerFormat="{0:h tt}",this.dayHeaderFormat="{0:d }",this.firstRowDayHeaderFormat="{0:ddd d}",this.dayViewHeaderFormat={day:"all-day events",week:"{0:d dddd}",list:"{0:d dddd}"},this.viewType="day",this.visibleCalendars=new Array("Default"),this.calendarsChanged=null,this.initialized=null,this.selectedDatesChanged=null,this.viewTypeChanged=null,this.beforeEditEventDialogShow=null,this.beforeAddEvent=null,this.beforeUpdateEvent=null,this.beforeDeleteEvent=null,this.beforeAddCalendar=null,this.beforeUpdateCalendar=null,this.beforeDeleteCalendar=null,this.eventsDataChanged=null}return t}();p.prototype.options=s.extend(!0,{},t.wijmoWidget.prototype.options,new g),s.wijmo.registerWidget(a,p.prototype)}(t.evcal||(t.evcal={}));var e=t.evcal}(wijmo||(wijmo={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i},wijmo;!function(t){!function(e){"use strict";function i(){return document.location.hash.match(/^#\w+=/)}var n=jQuery,o="wijappview",r={menu:"menu",content:"content",header:"header",footer:"footer",page:"appviewpage"},s={adjusted:o+"-adjusted"},a="",l=!1;n.fn.findRole=function(t){return this.find(":jqmData(role='"+t+"')")};var h=function(t){function e(){t.apply(this,arguments),this._updatingUrl=!1}return __extends(e,t),e.prototype._appViewCSS=function(){return this.options.wijCSS.wijappview},e.prototype._initMenu=function(){if(this._menuDiv=this.element.findRole(r.menu),!this._menuDiv.length)throw"A DIV with data-role='"+r.menu+"' not found!";if(this._linkList=this._menuDiv.find("ul"),!this._linkList.length)throw"Invalid markup. Link list not found";this._menuDiv.addClass(this._appViewCSS().menu)},e.prototype._initPages=function(t,e){var i=this._pageStore,o=this._appViewCSS();t.each(function(){var t=n(this).addClass(o.page),i=t.attr("id"),r=e;t.jqmData("url")||(i&&(r+="#"+i),t.attr("data-url",r))})},e.prototype._initPageContainer=function(){var t=this._appViewCSS(),e=this._pageStore;this._pageContainer=n("<div/>").addClass(t.pageContainer).prependTo(this.element);var i=this.element.findRole(r.page);this._initPages(i,this._documentUrl),i.each(function(t){e.push(n(this).clone()),t>0&&n(this).remove()}),this._firstPage=i.first().addClass(t.pageActive).appendTo(this._pageContainer),this._initCurrentPage()},e.prototype._getUrl=function(t){var e=t.is("form")?"action":"href",i=t.attr(e);return i&&"#"!==i?(n.mobile.path.isRelativeUrl(i)&&t.parents(":jqmData(url)").each(function(t,e){var o=n(e).jqmData("url");return o&&n.mobile.path.isAbsoluteUrl(o)?(i=n.mobile.path.makeUrlAbsolute(i,o),!1):void 0}),i):null},e.prototype._hijackLinks=function(t){var e=this;t.on("click."+o,"a, .ui-btn",function(t){if(!t.isDefaultPrevented()){var i=e._findClosestLink(t.target);if(i&&n(i).jqmData("appviewpage")!==!1){var o=e._getUrl(n(i));o&&(t.preventDefault(),t.stopPropagation(),e.changePage(o))}}})},e.prototype._hijackForms=function(t){var e=this;t.on("submit."+o,"form",function(t){if(!t.isDefaultPrevented()){var i=n(t.currentTarget),o=i.closest("."+e._appViewCSS().page);if(n.mobile.ajaxEnabled&&!i.is(":jqmData(ajax='false')")&&i.jqmHijackable().length){var r=i.attr("method"),s=i.attr("target"),a=e._getUrl(i);t.preventDefault(),t.stopPropagation(),e.changePage(a,{type:r&&r.length&&r.toLowerCase()||"get",data:i.serialize(),reloadPage:!0})}}})},e.prototype._initNavigation=function(){var t=this;this._onPopStateScoped=this._onPopStateScoped||n.proxy(this._onPopState,this),n(window).bind("popstate."+o,this._onPopStateScoped),n(window).bind("appviewpagehashchange."+o,function(){return t._navigateToCurrentLocation()}),this._onNavigateScoped=this._onNavigateScoped||n.proxy(this._onNavigate,this),n(n.mobile.pageContainer).bind("navigate."+o,this._onNavigateScoped)},e.prototype._create=function(){this._pageStore=[],this._documentUrl=this._removePageUrlParam(location.href),this.element.attr("data-url",this._documentUrl),this._jqmPageEnclosingWidget=this._findJqmPage(),this.element.addClass(this._appViewCSS().outerDiv),this._initMenu(),this._initPageContainer(),this._hijackLinks(this.element),this._hijackForms(this.element),this._initNavigation(),this._navigateToCurrentLocation()},e.prototype.destroy=function(){t.prototype.destroy.call(this);var e="."+o;this.element.unbind(e),n(window).unbind(e),n(n.mobile.pageContainer).unbind(e)},e.prototype._findJqmPage=function(){for(var t=this.element;t.length;t=t.parent()){var e=t.jqmData("mobile-page");if(e)return e}return null},e.prototype._initCurrentPage=function(){var t=this._appViewCSS(),e=this.activePage();e.findRole(r.content).addClass(t.content);var i=e.findRole(r.header).addClass(t.header),n=i.jqmData("position"),o=!n||"fixed"===n;o&&i.addClass("ui-header-fixed"),this.element.toggleClass(t.withFixedHeader,o)},e.prototype._findClosestLink=function(t){for(;t&&("string"!=typeof t.nodeName||"a"!==t.nodeName.toLowerCase());)t=t.parentNode;return t},e.prototype._clickHandler=function(t){var e=n(t.currentTarget),i=e.is("li")?e.jqmData("url"):e.is("a")?e.attr("href"):null;i&&(t.preventDefault(),t.stopPropagation(),this.changePage(i))},e.prototype._inheritAttribute=function(t,e,i){t.attr(i)&&!e.attr(i)&&e.attr(i,t.attr(i))},e.prototype._findInCache=function(t){return n(n.grep(this._pageStore,function(e){return e.jqmData("url")===t})[0]).clone()},e.prototype.loadPage=function(t,e){var i=this;t=t||"";var o=n.Deferred(),s=n.mobile.path,a=n.extend({},this.options.loadSettings,e),l=!t||"#"===t.charAt(0),h=null,d=null,c=this._makeAbsoluteUrl(t);if(a.data)switch(a.type){case"get":c=s.addSearchParams(c,a.data),a.data=void 0;break;case"post":a.reloadPage=!0}var u=n.Event("pagebeforeload"),p={url:t,absUrl:c,dataUrl:c,deferred:o,options:a};if(this._trigger(u.type,u,p),u.isDefaultPrevented())return o.promise();if(!n.mobile.allowCrossDomainPages&&!s.isSameDomain(s.parseLocation(),c))return o.reject(c,e),o.promise();var g=c&&s.getFilePath(c).replace(/#.+/,""),f=n.ajax({url:g,type:a.type,data:a.data,dataType:"html",success:function(a,l,u){function f(t){return s.isAbsoluteUrl(t)||/^(\w+:|#|\/)/.test(t)?null:s.makeUrlAbsolute(t,g)}var m=n("<div></div>"),w=new RegExp("(<[^>]+\\bdata-"+n.mobile.ns+"role=[\"']?"+r.page+"[\"']?[^>]*>)"),y=new RegExp("\\bdata-"+n.mobile.ns+"url=[\"']?([^\"'>]*)[\"']?");n.browser.msie&&parseFloat(n.browser.version)<=7&&(a=a.replace(/<a[^>]+href=['"][^'"]+['"]/g,function(t){return t.replace(/href=['"]([^'"]+)['"]/,function(t,e){return e=f(e)||e,"href='"+e+"'"})})),m.get(0).innerHTML=a;var v=i._getAllPages(m,t);v.length||(v=n("<div/>").attr("data-role",r.page).html(a.split(/<\/?body[^>]*>/gim)[1]));var _=a.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;_&&~_.indexOf("&")&&(_=n("<div>"+_+"</div>").text()),v.each(function(t,e){e=n(e),e.attr("data-external-page",!0),!e.jqmData("title")&&_&&e.attr("data-title",_);var i=s.get(g);e.find("[src], [href]").each(function(){var t=n(this).is("[href]")?"href":n(this).is("[src]")?"src":"action",e=f(n(this).attr(t));e&&n(this).attr(t,e)})}),i._initPages(v,g),h=v.filter(function(){return n(this).jqmData("url")===c}),h.length||(h=v.first()),p.xhr=u,p.textStatus=l,p.page=h,p.allPages=v,i._trigger("pageload",null,p),v.each(function(t,e){i._pageStore.push(n(e).clone())}),o.resolve(c,e,h,d)},error:function(t,r,s){p.xhr=t,p.textStatus=r,p.errorThrown=s;var a=n.Event("pageloadfailed");i._trigger(a.type,a,p),a.isDefaultPrevented()||o.reject(c,e)}});return o.fail(function(){f.abort()}),o},e.prototype._getAllPages=function(t,e){return t.findRole(r.page)},e.prototype.activePage=function(){return this._pageContainer.children("."+this._appViewCSS().pageActive).first()},e.prototype.isMenuUrl=function(t){var e=this;return t=t.toLowerCase(),this._menuDiv.find("a").is(function(){var i=e._getUrl(n(this));return i?i.toLowerCase()===t:!1})},e.prototype._showLoading=function(){n.mobile.loading("show")},e.prototype._hideLoading=function(){n.mobile.loading("hide")},e.prototype.changePage=function(t,e){var i=this;e=n.extend({updateUrl:!0},this.options.loadSettings,e);var o={toPage:t,options:e};this._curRequest&&"pending"===this._curRequest.state()&&this._curRequest.rejectWith&&this._curRequest.rejectWith(this,[t,e,!0]);var a,h;if("string"==typeof t){a=this.activePage().data("url"),h=this._makeAbsoluteUrl(t);var d=h.indexOf("#");if(d>=0&&h.substr(0,d)===a.split("#")[0]){var c=this._findInCache(h);c.length&&(t=c)}}if("string"==typeof t)return this._updateUIBeforeChange(h),e.showLoadMsg&&this._showLoading(),this._curRequest=this.loadPage(t,e).always(function(){e.showLoadMsg&&i._hideLoading(),i._curRequest=null}).done(function(t,e,n,o){i._updateUIAfterChange(n.jqmData("url")),i.changePage(n,e)}).fail(function(t,e,n){n||i._updateUI(a),i._trigger("pagechangefailed",null,o)}),void 0;var u=n.Event("pagebeforechange");if(this._trigger(u.type,u,o),!u.isDefaultPrevented()){var p=t.jqmData("url"),g=null;this._updateUI(p),p&&(g=this._makeRelative(p),null!=g&&(g=this._makeRelative(g)));var f=t.jqmData("title"),m=t.findRole("header"),w=this._appViewCSS();if(!m.length&&f&&(m=n("<div data-role='header'/>").append(n("<h2/>").text(f)).prependTo(t)),m.length&&!m.jqmData(s.adjusted)){m.jqmData(s.adjusted,!0);var y=this._firstPage.findRole(r.header);y&&this._inheritAttribute(y,m,"data-position"),this.isMenuUrl(p)&&!m.find("a[data-icon=back]").length&&n("<a/>").attr({href:this._documentUrl,"data-icon":"back"}).text("Back").prependTo(m)}f&&(document.title=f),this._pageContainer.children().removeClass(w.pageActive),t.addClass(w.pageActive).appendTo(this._pageContainer.empty()),this._initCurrentPage(),(e.updateUrl||l)&&(this._updateUrl(p,g,document.title),l=!1),t.jqmData("page",this._jqmPageEnclosingWidget).trigger("pagecreate").trigger(this.widgetEventPrefix+"pageinit",o),this._trigger("pagechange",null,o)}},e.prototype._updateUIBeforeChange=function(t){var e=this,i=t===this._documentUrl,o=this._linkList.find("li"),r=this._appViewCSS().menuItemActive;if(i)o.removeClass(r);else{var s=o.filter(function(){var i=e._getUrl(n(this).find("a"));return i&&i.toLowerCase()===t.toLowerCase()});s.length&&!s.hasClass(r)&&(o.removeClass(r),s.addClass(r))}},e.prototype._updateUIAfterChange=function(t){var e=this._appViewCSS(),i=t===this._documentUrl;this.element.toggleClass(e.inPage,!i)},e.prototype._updateUI=function(t){this._updateUIBeforeChange(t),this._updateUIAfterChange(t)},e.prototype._changePageIfDifferent=function(t,e){var i="string"==typeof t?t:t.jqmData("url");this.activePage().jqmData("url")!==i&&this.changePage(t,e)},e.prototype._onNavigate=function(t){var e=new RegExp("^#?"+this.options.urlParamName+"=");(history.state&&history.state.wijappview||document.location.hash.match(e))&&t.preventDefault()},e.prototype._removePageUrlParam=function(t){return t.replace(/\#.*$/,"")},e.prototype._addUrl=function(t){var e=this.options.urlParamName,i=this._removePageUrlParam(location.href);return t&&(i+="#"+e+"="+t),i},e.prototype._makeRelative=function(t){var e=n.mobile.path.parseLocation(),i=t;if(t){var o=e.domain+e.directory;t.substr(0,e.hrefNoHash.length)===e.hrefNoHash?i=t.substr(e.hrefNoHash.length):t.substr(0,o.length)===o&&(i=t.substr(o.length))}return i},e.prototype._makeAbsoluteUrl=function(t){var e=n.mobile.path,i=this.activePage(),o=e.makeUrlAbsolute(i.jqmData("url")||this._documentUrl,this._documentUrl);return!o.match(/\/$/)&&!o.match(/\./)&&(o+="/"),t&&e.makeUrlAbsolute(t,o)},e.prototype._onPopState=function(t){this._updatingUrl||(history.state&&history.state.wijappview?this._changePageIfDifferent(history.state.absUrl||this._firstPage,{updateUrl:!1}):this._navigateToCurrentLocation())},e.prototype._navigateToCurrentLocation=function(){var t=new RegExp("#"+this.options.urlParamName+"=(.+)"),e=t.exec(location.href)||a&&t.exec(a),i=e?n.mobile.path.makeUrlAbsolute(e[1],this._documentUrl):this._firstPage;a="",this._changePageIfDifferent(i,{updateUrl:!1})},e.prototype._updateUrl=function(t,e,i){this._updatingUrl=!0;try{n.mobile.urlHistory.ignoreNextHashChange=!0,document.location.hash=t===this._documentUrl?"":this.options.urlParamName+"="+e}finally{this._updatingUrl=!1}},e}(t.wijmoWidget);e.wijappview=h;var d="wijmo-wijappview",c=d+"-",u=function(){function t(){this.urlParamName="appviewpage",this.loadSettings={type:"GET",data:void 0,reloadPage:!1,showLoadMsg:!1},this.wijCSS={wijappview:{outerDiv:d,inPage:c+"in-page",menu:c+"menu",menuItemActive:"ui-btn-down-b",page:c+"page",pageActive:c+"page-active",pageContainer:c+"page-container",content:c+"content",header:c+"header",withFixedHeader:c+"with-fixed-header"}}}return t}();e.wijappview_options=u,h.prototype.options=n.extend({},t.wijmoWidget.prototype.options,new u),n.mobile&&(n.wijmo.registerWidget(o,h.prototype),n(window).bind("hashchange",function(t){i()&&(t.stopImmediatePropagation(),n(window).trigger("appviewpagehashchange"))}),i()&&(a=document.location.hash,n(window).bind("pagecontainercreate",function(){document.location.hash="",l=!0})))}(t.appview||(t.appview={}));
var e=t.appview}(wijmo||(wijmo={}));