$(function(){function t(){w.find("a").addClass("static")}function i(){for(var t=w.find("a"),i=0;g+c>i;i++)for(var n=i,e=0;c>e&&!(e*g>n);e++)!function(n){setTimeout(function(){t.eq(n).addClass("show-g")},50*i)}(n),n+=g-1}function n(){for(var t=w.find("a"),i=0;g+c>i;i++)for(var n=h-i,e=c-1;e>=0&&!(n>(e+1)*g-1);e--)!function(n){setTimeout(function(){t.eq(n).addClass("show-g")},50*i)}(n),n-=g-1}function e(){return 0==d?h-1:a()+h-1>data.length-1?h-1:h-2}function a(t){return void 0===t&&(t=d),0==t?0:(h-2)*t+1}function r(){return data.length>a(d+1)}function o(){return d>0}var d=0,h=12,s=210,u=s,l=s,g,c;data=[];var f=$(".works-gallery"),p=$("#loading"),w=$("#gallery");$.get("load.php",function(t){data=t.data,w.trigger("data-ready")}),w.on("data-ready window-resized page-turned",function(d,h){var s=[],g=[];w.trigger("loading");var c=data.slice(a(),a()+e());return $.each(c,function(){g.push($.loadImage(this.thumb));var t="",i=this.thumb.indexOf("~"),n=this.thumb.lastIndexOf("/");-1!=i&&(t=this.thumb.substr(n+1,i-1-n)),s.push('<a href="'+this.large+'" class="swipebox '+t+'"style="width:'+u+"px;height:"+l+"px;background-image:url("+this.thumb+')"></a>')}),o()&&s.unshift('<a class="prev" style="width:'+u+"px;height:"+l+'px;"></a>'),r()&&s.push('<a class="next" style="width:'+u+"px;height:"+l+'px;"></a>'),s.length?void $.when.apply($,g).always(function(){"window-resized"==d.type?(w.html(s.join("")),t(),$("#gallery .swipebox").swipebox()):w.fadeOut(function(){w.html(s.join("")),"page-turned"==d.type&&"br"==h?n():i(),$("#gallery .swipebox").swipebox(),w.show()}),w.trigger("loading-finished")}):!1}),w.on("loading",function(){p.show()}),w.on("loading-finished",function(){p.hide()}),w.on("click",".next",function(){d++,w.trigger("page-turned",["br"])}),w.on("click",".prev",function(){d--,w.trigger("page-turned",["tl"])}),$(window).on("resize",function(t){var i=f.width(),n=f.height(),e,a,r;g=Math.ceil(i/s),r=(g*s-i)/g,u=Math.ceil(s-r),u%2!=0&&(u-=1),e=g*u,c=Math.ceil(n/s),r=(c*s-n)/c,l=Math.ceil(s-r),l%2!=0&&(l-=1),a=c*l,h=g*c,w.width(e).height(a),w.trigger("window-resized")}).resize()});